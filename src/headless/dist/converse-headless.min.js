!function(e){function t(t){for(var n,i,o=t[0],s=t[1],a=0,u=[];a<o.length;a++)i=o[a],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&u.push(r[i][0]),r[i]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);for(c&&c(t);u.length;)u.shift()()}var n={},r={1:0};function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise((function(t,i){n=r[e]=[t,i]}));t.push(n[2]=o);var s,a=document.createElement("script");a.charset="utf-8",a.timeout=120,i.nc&&a.setAttribute("nonce",i.nc),a.src=function(e){return i.p+""+({0:"emojis"}[e]||e)+".js"}(e);var c=new Error;s=function(t){a.onerror=a.onload=null,clearTimeout(u);var n=r[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+i+": "+o+")",c.name="ChunkLoadError",c.type=i,c.request=o,n[1](c)}r[e]=void 0}};var u=setTimeout((function(){s({type:"timeout",target:a})}),12e4);a.onerror=a.onload=s,document.head.appendChild(a)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var o=window.webpackJsonp=window.webpackJsonp||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var a=0;a<o.length;a++)t(o[a]);var c=s;i(i.s=322)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"c",(function(){return _})),n.d(t,"b",(function(){return y})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return w}));var r=n(8);const i=function(e,t){const n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n},o=function(e){if("string"!=typeof e)throw new Error("str2binl was passed a non-string");const t=[];for(let n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<n%32;return t},s=function(e,t,n,r,o,s){return i((a=i(i(t,e),i(r,s)))<<(c=o)|a>>>32-c,n);var a,c},a=function(e,t,n,r,i,o,a){return s(t&n|~t&r,e,t,i,o,a)},c=function(e,t,n,r,i,o,a){return s(t&r|n&~r,e,t,i,o,a)},u=function(e,t,n,r,i,o,a){return s(t^n^r,e,t,i,o,a)},d=function(e,t,n,r,i,o,a){return s(n^(t|~r),e,t,i,o,a)},l=function(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;let n,r,o,s,l=1732584193,f=-271733879,h=-1732584194,p=271733878;for(let t=0;t<e.length;t+=16)n=l,r=f,o=h,s=p,l=a(l,f,h,p,e[t+0],7,-680876936),p=a(p,l,f,h,e[t+1],12,-389564586),h=a(h,p,l,f,e[t+2],17,606105819),f=a(f,h,p,l,e[t+3],22,-1044525330),l=a(l,f,h,p,e[t+4],7,-176418897),p=a(p,l,f,h,e[t+5],12,1200080426),h=a(h,p,l,f,e[t+6],17,-1473231341),f=a(f,h,p,l,e[t+7],22,-45705983),l=a(l,f,h,p,e[t+8],7,1770035416),p=a(p,l,f,h,e[t+9],12,-1958414417),h=a(h,p,l,f,e[t+10],17,-42063),f=a(f,h,p,l,e[t+11],22,-1990404162),l=a(l,f,h,p,e[t+12],7,1804603682),p=a(p,l,f,h,e[t+13],12,-40341101),h=a(h,p,l,f,e[t+14],17,-1502002290),f=a(f,h,p,l,e[t+15],22,1236535329),l=c(l,f,h,p,e[t+1],5,-165796510),p=c(p,l,f,h,e[t+6],9,-1069501632),h=c(h,p,l,f,e[t+11],14,643717713),f=c(f,h,p,l,e[t+0],20,-373897302),l=c(l,f,h,p,e[t+5],5,-701558691),p=c(p,l,f,h,e[t+10],9,38016083),h=c(h,p,l,f,e[t+15],14,-660478335),f=c(f,h,p,l,e[t+4],20,-405537848),l=c(l,f,h,p,e[t+9],5,568446438),p=c(p,l,f,h,e[t+14],9,-1019803690),h=c(h,p,l,f,e[t+3],14,-187363961),f=c(f,h,p,l,e[t+8],20,1163531501),l=c(l,f,h,p,e[t+13],5,-1444681467),p=c(p,l,f,h,e[t+2],9,-51403784),h=c(h,p,l,f,e[t+7],14,1735328473),f=c(f,h,p,l,e[t+12],20,-1926607734),l=u(l,f,h,p,e[t+5],4,-378558),p=u(p,l,f,h,e[t+8],11,-2022574463),h=u(h,p,l,f,e[t+11],16,1839030562),f=u(f,h,p,l,e[t+14],23,-35309556),l=u(l,f,h,p,e[t+1],4,-1530992060),p=u(p,l,f,h,e[t+4],11,1272893353),h=u(h,p,l,f,e[t+7],16,-155497632),f=u(f,h,p,l,e[t+10],23,-1094730640),l=u(l,f,h,p,e[t+13],4,681279174),p=u(p,l,f,h,e[t+0],11,-358537222),h=u(h,p,l,f,e[t+3],16,-722521979),f=u(f,h,p,l,e[t+6],23,76029189),l=u(l,f,h,p,e[t+9],4,-640364487),p=u(p,l,f,h,e[t+12],11,-421815835),h=u(h,p,l,f,e[t+15],16,530742520),f=u(f,h,p,l,e[t+2],23,-995338651),l=d(l,f,h,p,e[t+0],6,-198630844),p=d(p,l,f,h,e[t+7],10,1126891415),h=d(h,p,l,f,e[t+14],15,-1416354905),f=d(f,h,p,l,e[t+5],21,-57434055),l=d(l,f,h,p,e[t+12],6,1700485571),p=d(p,l,f,h,e[t+3],10,-1894986606),h=d(h,p,l,f,e[t+10],15,-1051523),f=d(f,h,p,l,e[t+1],21,-2054922799),l=d(l,f,h,p,e[t+8],6,1873313359),p=d(p,l,f,h,e[t+15],10,-30611744),h=d(h,p,l,f,e[t+6],15,-1560198380),f=d(f,h,p,l,e[t+13],21,1309151649),l=d(l,f,h,p,e[t+4],6,-145523070),p=d(p,l,f,h,e[t+11],10,-1120210379),h=d(h,p,l,f,e[t+2],15,718787259),f=d(f,h,p,l,e[t+9],21,-343485551),l=i(l,n),f=i(f,r),h=i(h,o),p=i(p,s);return[l,f,h,p]},f={hexdigest:function(e){return function(e){let t="";for(let n=0;n<4*e.length;n++)t+="0123456789abcdef".charAt(e[n>>2]>>n%4*8+4&15)+"0123456789abcdef".charAt(e[n>>2]>>n%4*8&15);return t}(l(o(e),8*e.length))},hash:function(e){return function(e){let t="";for(let n=0;n<32*e.length;n+=8)t+=String.fromCharCode(e[n>>5]>>>n%32&255);return t}(l(o(e),8*e.length))}};var h=n(4);const p=function(e){var t,n,r="",i=e.length;for(t=0;t<i;t++)(n=e.charCodeAt(t))>=0&&n<=127?r+=e.charAt(t):n>2047?(r+=String.fromCharCode(224|n>>12&15),r+=String.fromCharCode(128|n>>6&63),r+=String.fromCharCode(128|n>>0&63)):(r+=String.fromCharCode(192|n>>6&31),r+=String.fromCharCode(128|n>>0&63));return r},g=function(e){e=e||{};for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){let n="",r="",i="";const o=e[t],s="object"==typeof o,a=escape(unescape(s?o.value:o));s&&(n=o.expires?";expires="+o.expires:"",r=o.domain?";domain="+o.domain:"",i=o.path?";path="+o.path:""),document.cookie=t+"="+a+n+r+i}};var m=n(21);function v(e,t){return new w.Builder(e,t)}function _(e){return new w.Builder("message",e)}function y(e){return new w.Builder("iq",e)}function b(e){return new w.Builder("presence",e)}const w={VERSION:"1.3.6",NS:{HTTPBIND:"http://jabber.org/protocol/httpbind",BOSH:"urn:xmpp:xbosh",CLIENT:"jabber:client",AUTH:"jabber:iq:auth",ROSTER:"jabber:iq:roster",PROFILE:"jabber:iq:profile",DISCO_INFO:"http://jabber.org/protocol/disco#info",DISCO_ITEMS:"http://jabber.org/protocol/disco#items",MUC:"http://jabber.org/protocol/muc",SASL:"urn:ietf:params:xml:ns:xmpp-sasl",STREAM:"http://etherx.jabber.org/streams",FRAMING:"urn:ietf:params:xml:ns:xmpp-framing",BIND:"urn:ietf:params:xml:ns:xmpp-bind",SESSION:"urn:ietf:params:xml:ns:xmpp-session",VERSION:"jabber:iq:version",STANZAS:"urn:ietf:params:xml:ns:xmpp-stanzas",XHTML_IM:"http://jabber.org/protocol/xhtml-im",XHTML:"http://www.w3.org/1999/xhtml"},XHTML:{tags:["a","blockquote","br","cite","em","img","li","ol","p","span","strong","ul","body"],attributes:{a:["href"],blockquote:["style"],br:[],cite:["style"],em:[],img:["src","alt","style","height","width"],li:["style"],ol:["style"],p:["style"],span:["style"],strong:[],ul:["style"],body:[]},css:["background-color","color","font-family","font-size","font-style","font-weight","margin-left","margin-right","text-align","text-decoration"],validTag(e){for(let t=0;t<w.XHTML.tags.length;t++)if(e===w.XHTML.tags[t])return!0;return!1},validAttribute(e,t){if(void 0!==w.XHTML.attributes[e]&&w.XHTML.attributes[e].length>0)for(let n=0;n<w.XHTML.attributes[e].length;n++)if(t===w.XHTML.attributes[e][n])return!0;return!1},validCSS(e){for(let t=0;t<w.XHTML.css.length;t++)if(e===w.XHTML.css[t])return!0;return!1}},Status:{ERROR:0,CONNECTING:1,CONNFAIL:2,AUTHENTICATING:3,AUTHFAIL:4,CONNECTED:5,DISCONNECTED:6,DISCONNECTING:7,ATTACHED:8,REDIRECT:9,CONNTIMEOUT:10,BINDREQUIRED:11,ATTACHFAIL:12},ErrorCondition:{BAD_FORMAT:"bad-format",CONFLICT:"conflict",MISSING_JID_NODE:"x-strophe-bad-non-anon-jid",NO_AUTH_MECH:"no-auth-mech",UNKNOWN_REASON:"unknown"},LogLevel:{DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},ElementType:{NORMAL:1,TEXT:3,CDATA:4,FRAGMENT:11},TIMEOUT:1.1,SECONDARY_TIMEOUT:.1,addNamespace(e,t){w.NS[e]=t},forEachChild(e,t,n){for(let r=0;r<e.childNodes.length;r++){const i=e.childNodes[r];i.nodeType!==w.ElementType.NORMAL||t&&!this.isTagEqual(i,t)||n(i)}},isTagEqual:(e,t)=>e.tagName===t,_xmlGenerator:null,xmlGenerator:()=>(w._xmlGenerator||(w._xmlGenerator=r.b()),w._xmlGenerator),xmlElement(e){if(!e)return null;const t=w.xmlGenerator().createElement(e);for(let e=1;e<arguments.length;e++){const n=arguments[e];if(n)if("string"==typeof n||"number"==typeof n)t.appendChild(w.xmlTextNode(n));else if("object"==typeof n&&"function"==typeof n.sort)for(let e=0;e<n.length;e++){const r=n[e];"object"==typeof r&&"function"==typeof r.sort&&void 0!==r[1]&&null!==r[1]&&t.setAttribute(r[0],r[1])}else if("object"==typeof n)for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&void 0!==n[e]&&null!==n[e]&&t.setAttribute(e,n[e])}return t},xmlescape:e=>e=(e=(e=(e=(e=e.replace(/\&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/'/g,"&apos;")).replace(/"/g,"&quot;"),xmlunescape:e=>e=(e=(e=(e=(e=e.replace(/\&amp;/g,"&")).replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&apos;/g,"'")).replace(/&quot;/g,'"'),xmlTextNode:e=>w.xmlGenerator().createTextNode(e),xmlHtmlNode(e){let t;if(r.a){t=(new r.a).parseFromString(e,"text/xml")}else t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e);return t},getText(e){if(!e)return null;let t="";0===e.childNodes.length&&e.nodeType===w.ElementType.TEXT&&(t+=e.nodeValue);for(let n=0;n<e.childNodes.length;n++)e.childNodes[n].nodeType===w.ElementType.TEXT&&(t+=e.childNodes[n].nodeValue);return w.xmlescape(t)},copyElement(e){let t;if(e.nodeType===w.ElementType.NORMAL){t=w.xmlElement(e.tagName);for(let n=0;n<e.attributes.length;n++)t.setAttribute(e.attributes[n].nodeName,e.attributes[n].value);for(let n=0;n<e.childNodes.length;n++)t.appendChild(w.copyElement(e.childNodes[n]))}else e.nodeType===w.ElementType.TEXT&&(t=w.xmlGenerator().createTextNode(e.nodeValue));return t},createHtml(e){let t;if(e.nodeType===w.ElementType.NORMAL){const n=e.nodeName.toLowerCase();if(w.XHTML.validTag(n))try{t=w.xmlElement(n);for(let r=0;r<w.XHTML.attributes[n].length;r++){const i=w.XHTML.attributes[n][r];let o=e.getAttribute(i);if(null!=o&&""!==o&&!1!==o&&0!==o)if("style"===i&&"object"==typeof o&&void 0!==o.cssText&&(o=o.cssText),"style"===i){const e=[],n=o.split(";");for(let t=0;t<n.length;t++){const r=n[t].split(":"),i=r[0].replace(/^\s*/,"").replace(/\s*$/,"").toLowerCase();if(w.XHTML.validCSS(i)){const t=r[1].replace(/^\s*/,"").replace(/\s*$/,"");e.push(i+": "+t)}}e.length>0&&(o=e.join("; "),t.setAttribute(i,o))}else t.setAttribute(i,o)}for(let n=0;n<e.childNodes.length;n++)t.appendChild(w.createHtml(e.childNodes[n]))}catch(e){t=w.xmlTextNode("")}else{t=w.xmlGenerator().createDocumentFragment();for(let n=0;n<e.childNodes.length;n++)t.appendChild(w.createHtml(e.childNodes[n]))}}else if(e.nodeType===w.ElementType.FRAGMENT){t=w.xmlGenerator().createDocumentFragment();for(let n=0;n<e.childNodes.length;n++)t.appendChild(w.createHtml(e.childNodes[n]))}else e.nodeType===w.ElementType.TEXT&&(t=w.xmlTextNode(e.nodeValue));return t},escapeNode:e=>"string"!=typeof e?e:e.replace(/^\s+|\s+$/g,"").replace(/\\/g,"\\5c").replace(/ /g,"\\20").replace(/\"/g,"\\22").replace(/\&/g,"\\26").replace(/\'/g,"\\27").replace(/\//g,"\\2f").replace(/:/g,"\\3a").replace(/</g,"\\3c").replace(/>/g,"\\3e").replace(/@/g,"\\40"),unescapeNode:e=>"string"!=typeof e?e:e.replace(/\\20/g," ").replace(/\\22/g,'"').replace(/\\26/g,"&").replace(/\\27/g,"'").replace(/\\2f/g,"/").replace(/\\3a/g,":").replace(/\\3c/g,"<").replace(/\\3e/g,">").replace(/\\40/g,"@").replace(/\\5c/g,"\\"),getNodeFromJid:e=>e.indexOf("@")<0?null:e.split("@")[0],getDomainFromJid(e){const t=w.getBareJidFromJid(e);if(t.indexOf("@")<0)return t;{const e=t.split("@");return e.splice(0,1),e.join("@")}},getResourceFromJid(e){if(!e)return null;const t=e.split("/");return t.length<2?null:(t.splice(0,1),t.join("/"))},getBareJidFromJid:e=>e?e.split("/")[0]:null,_handleError(e){void 0!==e.stack&&w.fatal(e.stack),e.sourceURL?w.fatal("error: "+this.handler+" "+e.sourceURL+":"+e.line+" - "+e.name+": "+e.message):e.fileName?w.fatal("error: "+this.handler+" "+e.fileName+":"+e.lineNumber+" - "+e.name+": "+e.message):w.fatal("error: "+e.message)},log(e,t){e===this.LogLevel.FATAL&&"object"==typeof window.console&&"function"==typeof window.console.error&&window.console.error(t)},debug(e){this.log(this.LogLevel.DEBUG,e)},info(e){this.log(this.LogLevel.INFO,e)},warn(e){this.log(this.LogLevel.WARN,e)},error(e){this.log(this.LogLevel.ERROR,e)},fatal(e){this.log(this.LogLevel.FATAL,e)},serialize(e){if(!e)return null;"function"==typeof e.tree&&(e=e.tree());const t=[...Array(e.attributes.length).keys()].map(t=>e.attributes[t].nodeName);t.sort();let n=t.reduce((t,n)=>"".concat(t," ").concat(n,'="').concat(w.xmlescape(e.attributes.getNamedItem(n).value),'"'),"<".concat(e.nodeName));if(e.childNodes.length>0){n+=">";for(let t=0;t<e.childNodes.length;t++){const r=e.childNodes[t];switch(r.nodeType){case w.ElementType.NORMAL:n+=w.serialize(r);break;case w.ElementType.TEXT:n+=w.xmlescape(r.nodeValue);break;case w.ElementType.CDATA:n+="<![CDATA["+r.nodeValue+"]]>"}}n+="</"+e.nodeName+">"}else n+="/>";return n},_requestId:0,_connectionPlugins:{},addConnectionPlugin(e,t){w._connectionPlugins[e]=t},Builder:class{constructor(e,t){"presence"!==e&&"message"!==e&&"iq"!==e||(t&&!t.xmlns?t.xmlns=w.NS.CLIENT:t||(t={xmlns:w.NS.CLIENT})),this.nodeTree=w.xmlElement(e,t),this.node=this.nodeTree}tree(){return this.nodeTree}toString(){return w.serialize(this.nodeTree)}up(){return this.node=this.node.parentNode,this}root(){return this.node=this.nodeTree,this}attrs(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(void 0===e[t]?this.node.removeAttribute(t):this.node.setAttribute(t,e[t]));return this}c(e,t,n){const r=w.xmlElement(e,t,n);return this.node.appendChild(r),"string"!=typeof n&&"number"!=typeof n&&(this.node=r),this}cnode(e){let t;const n=w.xmlGenerator();try{t=void 0!==n.importNode}catch(e){t=!1}const r=t?n.importNode(e,!0):w.copyElement(e);return this.node.appendChild(r),this.node=r,this}t(e){const t=w.xmlTextNode(e);return this.node.appendChild(t),this}h(e){const t=w.xmlGenerator().createElement("body");t.innerHTML=e;const n=w.createHtml(t);for(;n.childNodes.length>0;)this.node.appendChild(n.childNodes[0]);return this}},Handler:function(e,t,n,r,i,o,s){this.handler=e,this.ns=t,this.name=n,this.type=r,this.id=i,this.options=s||{matchBareFromJid:!1,ignoreNamespaceFragment:!1},this.options.matchBare&&(w.warn('The "matchBare" option is deprecated, use "matchBareFromJid" instead.'),this.options.matchBareFromJid=this.options.matchBare,delete this.options.matchBare),this.options.matchBareFromJid?this.from=o?w.getBareJidFromJid(o):null:this.from=o,this.user=!0}};w.Handler.prototype={getNamespace(e){let t=e.getAttribute("xmlns");return t&&this.options.ignoreNamespaceFragment&&(t=t.split("#")[0]),t},namespaceMatch(e){let t=!1;return!this.ns||(w.forEachChild(e,null,e=>{this.getNamespace(e)===this.ns&&(t=!0)}),t||this.getNamespace(e)===this.ns)},isMatch(e){let t=e.getAttribute("from");this.options.matchBareFromJid&&(t=w.getBareJidFromJid(t));const n=e.getAttribute("type");return!(!this.namespaceMatch(e)||this.name&&!w.isTagEqual(e,this.name)||this.type&&(Array.isArray(this.type)?-1===this.type.indexOf(n):n!==this.type)||this.id&&e.getAttribute("id")!==this.id||this.from&&t!==this.from)},run(e){let t=null;try{t=this.handler(e)}catch(e){throw w._handleError(e),e}return t},toString(){return"{Handler: "+this.handler+"("+this.name+","+this.id+","+this.ns+")}"}},w.TimedHandler=class{constructor(e,t){this.period=e,this.handler=t,this.lastCalled=(new Date).getTime(),this.user=!0}run(){return this.lastCalled=(new Date).getTime(),this.handler()}reset(){this.lastCalled=(new Date).getTime()}toString(){return"{TimedHandler: "+this.handler+"("+this.period+")}"}},w.Connection=class{constructor(e,t){this.service=e,this.options=t||{};const n=this.options.protocol||"";this.options.worker?this._proto=new w.WorkerWebsocket(this):0===e.indexOf("ws:")||0===e.indexOf("wss:")||0===n.indexOf("ws")?this._proto=new w.Websocket(this):this._proto=new w.Bosh(this),this.jid="",this.domain=null,this.features=null,this._sasl_data={},this.do_bind=!1,this.do_session=!1,this.mechanisms={},this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this.protocolErrorHandlers={HTTP:{},websocket:{}},this._idleTimeout=null,this._disconnectTimeout=null,this.authenticated=!1,this.connected=!1,this.disconnecting=!1,this.do_authentication=!0,this.paused=!1,this.restored=!1,this._data=[],this._uniqueId=0,this._sasl_success_handler=null,this._sasl_failure_handler=null,this._sasl_challenge_handler=null,this.maxRetries=5,this._idleTimeout=setTimeout(()=>this._onIdle(),100),g(this.options.cookies),this.registerSASLMechanisms(this.options.mechanisms);for(const e in w._connectionPlugins)if(Object.prototype.hasOwnProperty.call(w._connectionPlugins,e)){const t=function(){};t.prototype=w._connectionPlugins[e],this[e]=new t,this[e].init(this)}}reset(){this._proto._reset(),this.do_session=!1,this.do_bind=!1,this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this.authenticated=!1,this.connected=!1,this.disconnecting=!1,this.restored=!1,this._data=[],this._requests=[],this._uniqueId=0}pause(){this.paused=!0}resume(){this.paused=!1}getUniqueId(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}));return"string"==typeof e||"number"==typeof e?t+":"+e:t+""}addProtocolErrorHandler(e,t,n){this.protocolErrorHandlers[e][t]=n}connect(e,t,n,r,i,o,s){this.jid=e,this.authzid=w.getBareJidFromJid(this.jid),this.authcid=s||w.getNodeFromJid(this.jid),this.pass=t,this.connect_callback=n,this.disconnecting=!1,this.connected=!1,this.authenticated=!1,this.restored=!1,this.domain=w.getDomainFromJid(this.jid),this._changeConnectStatus(w.Status.CONNECTING,null),this._proto._connect(r,i,o)}attach(e,t,n,r,i,o,s){if(this._proto._attach)return this._proto._attach(e,t,n,r,i,o,s);{const e=new Error('The "attach" method is not available for your connection protocol');throw e.name="StropheSessionError",e}}restore(e,t,n,r,i){if(!this._sessionCachingSupported()){const e=new Error('The "restore" method can only be used with a BOSH connection.');throw e.name="StropheSessionError",e}this._proto._restore(e,t,n,r,i)}_sessionCachingSupported(){if(this._proto instanceof w.Bosh){if(!JSON)return!1;try{sessionStorage.setItem("_strophe_","_strophe_"),sessionStorage.removeItem("_strophe_")}catch(e){return!1}return!0}return!1}xmlInput(e){}xmlOutput(e){}rawInput(e){}rawOutput(e){}nextValidRid(e){}send(e){if(null!==e){if("function"==typeof e.sort)for(let t=0;t<e.length;t++)this._queueData(e[t]);else"function"==typeof e.tree?this._queueData(e.tree()):this._queueData(e);this._proto._send()}}flush(){clearTimeout(this._idleTimeout),this._onIdle()}sendPresence(e,t,n,r){let i=null;"function"==typeof e.tree&&(e=e.tree());let o=e.getAttribute("id");if(o||(o=this.getUniqueId("sendPresence"),e.setAttribute("id",o)),"function"==typeof t||"function"==typeof n){const e=this.addHandler(e=>{i&&this.deleteTimedHandler(i),"error"===e.getAttribute("type")?n&&n(e):t&&t(e)},null,"presence",null,o);r&&(i=this.addTimedHandler(r,()=>(this.deleteHandler(e),n&&n(null),!1)))}return this.send(e),o}sendIQ(e,t,n,r){let i=null;"function"==typeof e.tree&&(e=e.tree());let o=e.getAttribute("id");if(o||(o=this.getUniqueId("sendIQ"),e.setAttribute("id",o)),"function"==typeof t||"function"==typeof n){const e=this.addHandler(e=>{i&&this.deleteTimedHandler(i);const r=e.getAttribute("type");if("result"===r)t&&t(e);else{if("error"!==r){const e=new Error("Got bad IQ type of ".concat(r));throw e.name="StropheError",e}n&&n(e)}},null,"iq",["error","result"],o);r&&(i=this.addTimedHandler(r,()=>(this.deleteHandler(e),n&&n(null),!1)))}return this.send(e),o}_queueData(e){if(null===e||!e.tagName||!e.childNodes){const e=new Error("Cannot queue non-DOMElement.");throw e.name="StropheError",e}this._data.push(e)}_sendRestart(){this._data.push("restart"),this._proto._sendRestart(),this._idleTimeout=setTimeout(()=>this._onIdle(),100)}addTimedHandler(e,t){const n=new w.TimedHandler(e,t);return this.addTimeds.push(n),n}deleteTimedHandler(e){this.removeTimeds.push(e)}addHandler(e,t,n,r,i,o,s){const a=new w.Handler(e,t,n,r,i,o,s);return this.addHandlers.push(a),a}deleteHandler(e){this.removeHandlers.push(e);const t=this.addHandlers.indexOf(e);t>=0&&this.addHandlers.splice(t,1)}registerSASLMechanisms(e){this.mechanisms={},(e=e||[w.SASLAnonymous,w.SASLExternal,w.SASLOAuthBearer,w.SASLXOAuth2,w.SASLPlain,w.SASLSHA1]).forEach(e=>this.registerSASLMechanism(e))}registerSASLMechanism(e){this.mechanisms[e.name]=e}disconnect(e){if(this._changeConnectStatus(w.Status.DISCONNECTING,e),e?w.warn("Disconnect was called because: "+e):w.info("Disconnect was called"),this.connected){let e=!1;this.disconnecting=!0,this.authenticated&&(e=b({xmlns:w.NS.CLIENT,type:"unavailable"})),this._disconnectTimeout=this._addSysTimedHandler(3e3,this._onDisconnectTimeout.bind(this)),this._proto._disconnect(e)}else w.warn("Disconnect was called before Strophe connected to the server"),this._proto._abortAllRequests(),this._doDisconnect()}_changeConnectStatus(e,t,n){for(const n in w._connectionPlugins)if(Object.prototype.hasOwnProperty.call(w._connectionPlugins,n)){const r=this[n];if(r.statusChanged)try{r.statusChanged(e,t)}catch(e){w.error("".concat(n," plugin caused an exception changing status: ").concat(e))}}if(this.connect_callback)try{this.connect_callback(e,t,n)}catch(e){w._handleError(e),w.error("User connection callback caused an exception: ".concat(e))}}_doDisconnect(e){"number"==typeof this._idleTimeout&&clearTimeout(this._idleTimeout),null!==this._disconnectTimeout&&(this.deleteTimedHandler(this._disconnectTimeout),this._disconnectTimeout=null),w.debug("_doDisconnect was called"),this._proto._doDisconnect(),this.authenticated=!1,this.disconnecting=!1,this.restored=!1,this.handlers=[],this.timedHandlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this._changeConnectStatus(w.Status.DISCONNECTED,e),this.connected=!1}_dataRecv(e,t){const n=this._proto._reqToData(e);if(null===n)return;for(this.xmlInput!==w.Connection.prototype.xmlInput&&(n.nodeName===this._proto.strip&&n.childNodes.length?this.xmlInput(n.childNodes[0]):this.xmlInput(n)),this.rawInput!==w.Connection.prototype.rawInput&&(t?this.rawInput(t):this.rawInput(w.serialize(n)));this.removeHandlers.length>0;){const e=this.removeHandlers.pop(),t=this.handlers.indexOf(e);t>=0&&this.handlers.splice(t,1)}for(;this.addHandlers.length>0;)this.handlers.push(this.addHandlers.pop());if(this.disconnecting&&this._proto._emptyQueue())return void this._doDisconnect();const r=n.getAttribute("type");if(null!==r&&"terminate"===r){if(this.disconnecting)return;let e=n.getAttribute("condition");const t=n.getElementsByTagName("conflict");return null!==e?("remote-stream-error"===e&&t.length>0&&(e="conflict"),this._changeConnectStatus(w.Status.CONNFAIL,e)):this._changeConnectStatus(w.Status.CONNFAIL,w.ErrorCondition.UNKOWN_REASON),void this._doDisconnect(e)}w.forEachChild(n,null,e=>{const t=this.handlers;this.handlers=[];for(let n=0;n<t.length;n++){const r=t[n];try{(!r.isMatch(e)||!this.authenticated&&r.user||r.run(e))&&this.handlers.push(r)}catch(e){w.warn("Removing Strophe handlers due to uncaught exception: "+e.message)}}})}_connect_cb(e,t,n){let r;w.debug("_connect_cb was called"),this.connected=!0;try{r=this._proto._reqToData(e)}catch(e){if(e.name!==w.ErrorCondition.BAD_FORMAT)throw e;this._changeConnectStatus(w.Status.CONNFAIL,w.ErrorCondition.BAD_FORMAT),this._doDisconnect(w.ErrorCondition.BAD_FORMAT)}if(!r)return;if(this.xmlInput!==w.Connection.prototype.xmlInput&&(r.nodeName===this._proto.strip&&r.childNodes.length?this.xmlInput(r.childNodes[0]):this.xmlInput(r)),this.rawInput!==w.Connection.prototype.rawInput&&(n?this.rawInput(n):this.rawInput(w.serialize(r))),this._proto._connect_cb(r)===w.Status.CONNFAIL)return;let i;if(i=r.getElementsByTagNameNS?r.getElementsByTagNameNS(w.NS.STREAM,"features").length>0:r.getElementsByTagName("stream:features").length>0||r.getElementsByTagName("features").length>0,!i)return void this._proto._no_auth_received(t);const o=Array.from(r.getElementsByTagName("mechanism")).map(e=>this.mechanisms[e.textContent]).filter(e=>e);0!==o.length||0!==r.getElementsByTagName("auth").length?!1!==this.do_authentication&&this.authenticate(o):this._proto._no_auth_received(t)}sortMechanismsByPriority(e){for(let t=0;t<e.length-1;++t){let n=t;for(let r=t+1;r<e.length;++r)e[r].priority>e[n].priority&&(n=r);if(n!==t){const r=e[t];e[t]=e[n],e[n]=r}}return e}authenticate(e){this._attemptSASLAuth(e)||this._attemptLegacyAuth()}_attemptSASLAuth(e){e=this.sortMechanismsByPriority(e||[]);let t=!1;for(let n=0;n<e.length;++n){if(!e[n].test(this))continue;this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),this._sasl_challenge_handler=this._addSysHandler(this._sasl_challenge_cb.bind(this),null,"challenge",null,null),this._sasl_mechanism=new e[n],this._sasl_mechanism.onStart(this);const r=v("auth",{xmlns:w.NS.SASL,mechanism:this._sasl_mechanism.name});if(this._sasl_mechanism.isClientFirst){const e=this._sasl_mechanism.onChallenge(this,null);r.t(Object(m.btoa)(e))}this.send(r.tree()),t=!0;break}return t}_sasl_challenge_cb(e){const t=Object(m.atob)(w.getText(e)),n=this._sasl_mechanism.onChallenge(this,t),r=v("response",{xmlns:w.NS.SASL});return""!==n&&r.t(Object(m.btoa)(n)),this.send(r.tree()),!0}_attemptLegacyAuth(){null===w.getNodeFromJid(this.jid)?(this._changeConnectStatus(w.Status.CONNFAIL,w.ErrorCondition.MISSING_JID_NODE),this.disconnect(w.ErrorCondition.MISSING_JID_NODE)):(this._changeConnectStatus(w.Status.AUTHENTICATING,null),this._addSysHandler(this._onLegacyAuthIQResult.bind(this),null,null,null,"_auth_1"),this.send(y({type:"get",to:this.domain,id:"_auth_1"}).c("query",{xmlns:w.NS.AUTH}).c("username",{}).t(w.getNodeFromJid(this.jid)).tree()))}_onLegacyAuthIQResult(e){const t=y({type:"set",id:"_auth_2"}).c("query",{xmlns:w.NS.AUTH}).c("username",{}).t(w.getNodeFromJid(this.jid)).up().c("password").t(this.pass);return w.getResourceFromJid(this.jid)||(this.jid=w.getBareJidFromJid(this.jid)+"/strophe"),t.up().c("resource",{}).t(w.getResourceFromJid(this.jid)),this._addSysHandler(this._auth2_cb.bind(this),null,null,null,"_auth_2"),this.send(t.tree()),!1}_sasl_success_cb(e){if(this._sasl_data["server-signature"]){let t;const n=/([a-z]+)=([^,]+)(,|$)/,r=Object(m.atob)(w.getText(e)).match(n);if("v"===r[1]&&(t=r[2]),t!==this._sasl_data["server-signature"])return this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_data={},this._sasl_failure_cb(null)}w.info("SASL authentication succeeded."),this._sasl_mechanism&&this._sasl_mechanism.onSuccess(),this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null);const t=[],n=(e,t)=>{for(;e.length;)this.deleteHandler(e.pop());return this._onStreamFeaturesAfterSASL(t),!1};return t.push(this._addSysHandler(e=>n(t,e),null,"stream:features",null,null)),t.push(this._addSysHandler(e=>n(t,e),w.NS.STREAM,"features",null,null)),this._sendRestart(),!1}_onStreamFeaturesAfterSASL(e){this.features=e;for(let t=0;t<e.childNodes.length;t++){const n=e.childNodes[t];"bind"===n.nodeName&&(this.do_bind=!0),"session"===n.nodeName&&(this.do_session=!0)}return this.do_bind?(this.options.explicitResourceBinding?this._changeConnectStatus(w.Status.BINDREQUIRED,null):this.bind(),!1):(this._changeConnectStatus(w.Status.AUTHFAIL,null),!1)}bind(){if(!this.do_bind)return void w.log(w.LogLevel.INFO,'Strophe.Connection.prototype.bind called but "do_bind" is false');this._addSysHandler(this._onResourceBindResultIQ.bind(this),null,null,null,"_bind_auth_2");const e=w.getResourceFromJid(this.jid);e?this.send(y({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:w.NS.BIND}).c("resource",{}).t(e).tree()):this.send(y({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:w.NS.BIND}).tree())}_onResourceBindResultIQ(e){if("error"===e.getAttribute("type")){let t;return w.warn("Resource binding failed."),e.getElementsByTagName("conflict").length>0&&(t=w.ErrorCondition.CONFLICT),this._changeConnectStatus(w.Status.AUTHFAIL,t,e),!1}const t=e.getElementsByTagName("bind");if(!(t.length>0))return w.warn("Resource binding failed."),this._changeConnectStatus(w.Status.AUTHFAIL,null,e),!1;{const e=t[0].getElementsByTagName("jid");e.length>0&&(this.jid=w.getText(e[0]),this.do_session?this._establishSession():(this.authenticated=!0,this._changeConnectStatus(w.Status.CONNECTED,null)))}}_establishSession(){if(!this.do_session)throw new Error("Strophe.Connection.prototype._establishSession "+"called but apparently ".concat(w.NS.SESSION," wasn't advertised by the server"));this._addSysHandler(this._onSessionResultIQ.bind(this),null,null,null,"_session_auth_2"),this.send(y({type:"set",id:"_session_auth_2"}).c("session",{xmlns:w.NS.SESSION}).tree())}_onSessionResultIQ(e){if("result"===e.getAttribute("type"))this.authenticated=!0,this._changeConnectStatus(w.Status.CONNECTED,null);else if("error"===e.getAttribute("type"))return w.warn("Session creation failed."),this._changeConnectStatus(w.Status.AUTHFAIL,null,e),!1;return!1}_sasl_failure_cb(e){return this._sasl_success_handler&&(this.deleteHandler(this._sasl_success_handler),this._sasl_success_handler=null),this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_mechanism&&this._sasl_mechanism.onFailure(),this._changeConnectStatus(w.Status.AUTHFAIL,null,e),!1}_auth2_cb(e){return"result"===e.getAttribute("type")?(this.authenticated=!0,this._changeConnectStatus(w.Status.CONNECTED,null)):"error"===e.getAttribute("type")&&(this._changeConnectStatus(w.Status.AUTHFAIL,null,e),this.disconnect("authentication failed")),!1}_addSysTimedHandler(e,t){const n=new w.TimedHandler(e,t);return n.user=!1,this.addTimeds.push(n),n}_addSysHandler(e,t,n,r,i){const o=new w.Handler(e,t,n,r,i);return o.user=!1,this.addHandlers.push(o),o}_onDisconnectTimeout(){return w.debug("_onDisconnectTimeout was called"),this._changeConnectStatus(w.Status.CONNTIMEOUT,null),this._proto._onDisconnectTimeout(),this._doDisconnect(),!1}_onIdle(){for(;this.addTimeds.length>0;)this.timedHandlers.push(this.addTimeds.pop());for(;this.removeTimeds.length>0;){const e=this.removeTimeds.pop(),t=this.timedHandlers.indexOf(e);t>=0&&this.timedHandlers.splice(t,1)}const e=(new Date).getTime(),t=[];for(let n=0;n<this.timedHandlers.length;n++){const r=this.timedHandlers[n];if(this.authenticated||!r.user){r.lastCalled+r.period-e<=0?r.run()&&t.push(r):t.push(r)}}this.timedHandlers=t,clearTimeout(this._idleTimeout),this._proto._onIdle(),this.connected&&(this._idleTimeout=setTimeout(()=>this._onIdle(),100))}},w.SASLMechanism=class{constructor(e,t,n){this.name=e,this.isClientFirst=t,this.priority=n}static test(e){return!0}onStart(e){this._connection=e}onChallenge(e,t){throw new Error("You should implement challenge handling!")}onFailure(){this._connection=null}onSuccess(){this._connection=null}},w.SASLAnonymous=class extends w.SASLMechanism{constructor(){super(w.SASLAnonymous.name,!1,w.SASLAnonymous.priority)}static get name(){return"ANONYMOUS"}static get priority(){return 20}static test(e){return null===e.authcid}},w.SASLPlain=class extends w.SASLMechanism{constructor(){super(w.SASLPlain.name,!0,w.SASLPlain.priority)}static get name(){return"PLAIN"}static get priority(){return 50}static test(e){return null!==e.authcid}onChallenge(e){const{authcid:t,authzid:n,domain:r,pass:i}=e;if(!r)throw new Error("SASLPlain onChallenge: domain is not defined!");let o=n!=="".concat(t,"@").concat(r)?n:"";return o+="\0",o+=t,o+="\0",o+=i,p(o)}},w.SASLSHA1=class extends w.SASLMechanism{constructor(){super(w.SASLSHA1.name,!0,w.SASLSHA1.priority)}static get name(){return"SCRAM-SHA-1"}static get priority(){return 60}static test(e){return null!==e.authcid}onChallenge(e,t,n){const r=n||f.hexdigest(""+1234567890*Math.random());let i="n="+p(e.authcid);return i+=",r=",i+=r,e._sasl_data.cnonce=r,e._sasl_data["client-first-message-bare"]=i,i="n,,"+i,this.onChallenge=(e,t)=>{let n,r,i,o,s,a,c,u,d="c=biws,",l="".concat(e._sasl_data["client-first-message-bare"],",").concat(t,",");const f=e._sasl_data.cnonce,g=/([a-z]+)=([^,]+)(,|$)/;for(;t.match(g);){const e=t.match(g);switch(t=t.replace(e[0],""),e[1]){case"r":n=e[2];break;case"s":r=e[2];break;case"i":i=e[2]}}if(n.substr(0,f.length)!==f)return e._sasl_data={},e._sasl_failure_cb();d+="r="+n,l+=d,r=Object(m.atob)(r),r+="\0\0\0";const v=p(e.pass);for(o=a=h.a.core_hmac_sha1(v,r),c=1;c<i;c++){for(s=h.a.core_hmac_sha1(v,h.a.binb2str(a)),u=0;u<5;u++)o[u]^=s[u];a=s}o=h.a.binb2str(o);const _=h.a.core_hmac_sha1(o,"Client Key"),y=h.a.str_hmac_sha1(o,"Server Key"),b=h.a.core_hmac_sha1(h.a.str_sha1(h.a.binb2str(_)),l);for(e._sasl_data["server-signature"]=h.a.b64_hmac_sha1(y,l),u=0;u<5;u++)_[u]^=b[u];return d+=",p="+Object(m.btoa)(h.a.binb2str(_)),d},i}},w.SASLOAuthBearer=class extends w.SASLMechanism{constructor(){super(w.SASLOAuthBearer.name,!0,w.SASLOAuthBearer.priority)}static get name(){return"OAUTHBEARER"}static get priority(){return 40}static test(e){return null!==e.pass}onChallenge(e){let t="n,";return null!==e.authcid&&(t=t+"a="+e.authzid),t+=",",t+="",t+="auth=Bearer ",t+=e.pass,t+="",t+="",p(t)}},w.SASLExternal=class extends w.SASLMechanism{constructor(){super(w.SASLExternal.name,!0,w.SASLExternal.priority)}static get name(){return"EXTERNAL"}static get priority(){return 10}onChallenge(e){return e.authcid===e.authzid?"":e.authzid}},w.SASLXOAuth2=class extends w.SASLMechanism{constructor(){super(w.SASLXOAuth2.name,!0,w.SASLXOAuth2.priority)}static get name(){return"X-OAUTH2"}static get priority(){return 30}static test(e){return null!==e.pass}onChallenge(e){let t="\0";return null!==e.authcid&&(t+=e.authzid),t+="\0",t+=e.pass,p(t)}};t.f={Strophe:w,$build:v,$iq:y,$msg:_,$pres:b,SHA1:h.a,MD5:f,b64_hmac_sha1:h.a.b64_hmac_sha1,b64_sha1:h.a.b64_sha1,str_hmac_sha1:h.a.str_hmac_sha1,str_sha1:h.a.str_sha1}},function(e,t,n){"use strict";(function(e){n(142),n(55),n(321);var r=n(0);n.d(t,"e",(function(){return r.e})),n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"c",(function(){return r.c})),n.d(t,"d",(function(){return r.d})),e.$build=r.f.$build,e.$iq=r.f.$iq,e.$msg=r.f.$msg,e.$pres=r.f.$pres,e.Strophe=r.f.Strophe}).call(this,n(17))},function(e,t,n){var r;
/*!
 * Sizzle CSS Selector Engine v2.3.5
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://js.foundation/
 *
 * Date: 2020-03-14
 */!function(i){var o,s,a,c,u,d,l,f,h,p,g,m,v,_,y,b,w,S,x,E="sizzle"+1*new Date,A=i.document,N=0,O=0,j=fe(),T=fe(),C=fe(),I=fe(),R=function(e,t){return e===t&&(g=!0),0},M={}.hasOwnProperty,k=[],D=k.pop,P=k.push,L=k.push,F=k.slice,U=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},z="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",B="[\\x20\\t\\r\\n\\f]",H="(?:\\\\[\\da-fA-F]{1,6}"+B+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",q="\\["+B+"*("+H+")(?:"+B+"*([*^$|!~]?=)"+B+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+H+"))|)"+B+"*\\]",$=":("+H+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+q+")*)|.*)\\)|)",W=new RegExp(B+"+","g"),J=new RegExp("^"+B+"+|((?:^|[^\\\\])(?:\\\\.)*)"+B+"+$","g"),V=new RegExp("^"+B+"*,"+B+"*"),G=new RegExp("^"+B+"*([>+~]|"+B+")"+B+"*"),Y=new RegExp(B+"|>"),X=new RegExp($),Q=new RegExp("^"+H+"$"),K={ID:new RegExp("^#("+H+")"),CLASS:new RegExp("^\\.("+H+")"),TAG:new RegExp("^("+H+"|[*])"),ATTR:new RegExp("^"+q),PSEUDO:new RegExp("^"+$),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+B+"*(even|odd|(([+-]|)(\\d*)n|)"+B+"*(?:([+-]|)"+B+"*(\\d+)|))"+B+"*\\)|)","i"),bool:new RegExp("^(?:"+z+")$","i"),needsContext:new RegExp("^"+B+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+B+"*((?:-\\d)?\\d*)"+B+"*\\)|)(?=[^-]|$)","i")},Z=/HTML$/i,ee=/^(?:input|select|textarea|button)$/i,te=/^h\d$/i,ne=/^[^{]+\{\s*\[native \w/,re=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ie=/[+~]/,oe=new RegExp("\\\\[\\da-fA-F]{1,6}"+B+"?|\\\\([^\\r\\n\\f])","g"),se=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},ae=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ce=function(e,t){return t?"\0"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},ue=function(){m()},de=Ee((function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{L.apply(k=F.call(A.childNodes),A.childNodes),k[A.childNodes.length].nodeType}catch(e){L={apply:k.length?function(e,t){P.apply(e,F.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}function le(e,t,n,r){var i,o,a,c,u,l,h,p=t&&t.ownerDocument,g=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==g&&9!==g&&11!==g)return n;if(!r&&(m(t),t=t||v,y)){if(11!==g&&(u=re.exec(e)))if(i=u[1]){if(9===g){if(!(a=t.getElementById(i)))return n;if(a.id===i)return n.push(a),n}else if(p&&(a=p.getElementById(i))&&x(t,a)&&a.id===i)return n.push(a),n}else{if(u[2])return L.apply(n,t.getElementsByTagName(e)),n;if((i=u[3])&&s.getElementsByClassName&&t.getElementsByClassName)return L.apply(n,t.getElementsByClassName(i)),n}if(s.qsa&&!I[e+" "]&&(!b||!b.test(e))&&(1!==g||"object"!==t.nodeName.toLowerCase())){if(h=e,p=t,1===g&&(Y.test(e)||G.test(e))){for((p=ie.test(e)&&we(t.parentNode)||t)===t&&s.scope||((c=t.getAttribute("id"))?c=c.replace(ae,ce):t.setAttribute("id",c=E)),o=(l=d(e)).length;o--;)l[o]=(c?"#"+c:":scope")+" "+xe(l[o]);h=l.join(",")}try{return L.apply(n,p.querySelectorAll(h)),n}catch(t){I(e,!0)}finally{c===E&&t.removeAttribute("id")}}}return f(e.replace(J,"$1"),t,n,r)}function fe(){var e=[];return function t(n,r){return e.push(n+" ")>a.cacheLength&&delete t[e.shift()],t[n+" "]=r}}function he(e){return e[E]=!0,e}function pe(e){var t=v.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ge(e,t){for(var n=e.split("|"),r=n.length;r--;)a.attrHandle[n[r]]=t}function me(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function ve(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function _e(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function ye(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&de(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function be(e){return he((function(t){return t=+t,he((function(n,r){for(var i,o=e([],n.length,t),s=o.length;s--;)n[i=o[s]]&&(n[i]=!(r[i]=n[i]))}))}))}function we(e){return e&&void 0!==e.getElementsByTagName&&e}for(o in s=le.support={},u=le.isXML=function(e){var t=e.namespaceURI,n=(e.ownerDocument||e).documentElement;return!Z.test(t||n&&n.nodeName||"HTML")},m=le.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:A;return r!=v&&9===r.nodeType&&r.documentElement?(_=(v=r).documentElement,y=!u(v),A!=v&&(n=v.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",ue,!1):n.attachEvent&&n.attachEvent("onunload",ue)),s.scope=pe((function(e){return _.appendChild(e).appendChild(v.createElement("div")),void 0!==e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length})),s.attributes=pe((function(e){return e.className="i",!e.getAttribute("className")})),s.getElementsByTagName=pe((function(e){return e.appendChild(v.createComment("")),!e.getElementsByTagName("*").length})),s.getElementsByClassName=ne.test(v.getElementsByClassName),s.getById=pe((function(e){return _.appendChild(e).id=E,!v.getElementsByName||!v.getElementsByName(E).length})),s.getById?(a.filter.ID=function(e){var t=e.replace(oe,se);return function(e){return e.getAttribute("id")===t}},a.find.ID=function(e,t){if(void 0!==t.getElementById&&y){var n=t.getElementById(e);return n?[n]:[]}}):(a.filter.ID=function(e){var t=e.replace(oe,se);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},a.find.ID=function(e,t){if(void 0!==t.getElementById&&y){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];for(i=t.getElementsByName(e),r=0;o=i[r++];)if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),a.find.TAG=s.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):s.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[i++];)1===n.nodeType&&r.push(n);return r}return o},a.find.CLASS=s.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&y)return t.getElementsByClassName(e)},w=[],b=[],(s.qsa=ne.test(v.querySelectorAll))&&(pe((function(e){var t;_.appendChild(e).innerHTML="<a id='"+E+"'></a><select id='"+E+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&b.push("[*^$]="+B+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||b.push("\\["+B+"*(?:value|"+z+")"),e.querySelectorAll("[id~="+E+"-]").length||b.push("~="),(t=v.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||b.push("\\["+B+"*name"+B+"*="+B+"*(?:''|\"\")"),e.querySelectorAll(":checked").length||b.push(":checked"),e.querySelectorAll("a#"+E+"+*").length||b.push(".#.+[+~]"),e.querySelectorAll("\\\f"),b.push("[\\r\\n\\f]")})),pe((function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=v.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&b.push("name"+B+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&b.push(":enabled",":disabled"),_.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&b.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),b.push(",.*:")}))),(s.matchesSelector=ne.test(S=_.matches||_.webkitMatchesSelector||_.mozMatchesSelector||_.oMatchesSelector||_.msMatchesSelector))&&pe((function(e){s.disconnectedMatch=S.call(e,"*"),S.call(e,"[s!='']:x"),w.push("!=",$)})),b=b.length&&new RegExp(b.join("|")),w=w.length&&new RegExp(w.join("|")),t=ne.test(_.compareDocumentPosition),x=t||ne.test(_.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},R=t?function(e,t){if(e===t)return g=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!s.sortDetached&&t.compareDocumentPosition(e)===n?e==v||e.ownerDocument==A&&x(A,e)?-1:t==v||t.ownerDocument==A&&x(A,t)?1:p?U(p,e)-U(p,t):0:4&n?-1:1)}:function(e,t){if(e===t)return g=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,s=[e],a=[t];if(!i||!o)return e==v?-1:t==v?1:i?-1:o?1:p?U(p,e)-U(p,t):0;if(i===o)return me(e,t);for(n=e;n=n.parentNode;)s.unshift(n);for(n=t;n=n.parentNode;)a.unshift(n);for(;s[r]===a[r];)r++;return r?me(s[r],a[r]):s[r]==A?-1:a[r]==A?1:0},v):v},le.matches=function(e,t){return le(e,null,null,t)},le.matchesSelector=function(e,t){if(m(e),s.matchesSelector&&y&&!I[t+" "]&&(!w||!w.test(t))&&(!b||!b.test(t)))try{var n=S.call(e,t);if(n||s.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){I(t,!0)}return le(t,v,null,[e]).length>0},le.contains=function(e,t){return(e.ownerDocument||e)!=v&&m(e),x(e,t)},le.attr=function(e,t){(e.ownerDocument||e)!=v&&m(e);var n=a.attrHandle[t.toLowerCase()],r=n&&M.call(a.attrHandle,t.toLowerCase())?n(e,t,!y):void 0;return void 0!==r?r:s.attributes||!y?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},le.escape=function(e){return(e+"").replace(ae,ce)},le.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},le.uniqueSort=function(e){var t,n=[],r=0,i=0;if(g=!s.detectDuplicates,p=!s.sortStable&&e.slice(0),e.sort(R),g){for(;t=e[i++];)t===e[i]&&(r=n.push(i));for(;r--;)e.splice(n[r],1)}return p=null,e},c=le.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=c(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r++];)n+=c(t);return n},(a=le.selectors={cacheLength:50,createPseudo:he,match:K,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(oe,se),e[3]=(e[3]||e[4]||e[5]||"").replace(oe,se),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||le.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&le.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return K.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&X.test(n)&&(t=d(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(oe,se).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=j[e+" "];return t||(t=new RegExp("(^|"+B+")"+e+"("+B+"|$)"))&&j(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,n){return function(r){var i=le.attr(r,e);return null==i?"!="===t:!t||(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i.replace(W," ")+" ").indexOf(n)>-1:"|="===t&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,c){var u,d,l,f,h,p,g=o!==s?"nextSibling":"previousSibling",m=t.parentNode,v=a&&t.nodeName.toLowerCase(),_=!c&&!a,y=!1;if(m){if(o){for(;g;){for(f=t;f=f[g];)if(a?f.nodeName.toLowerCase()===v:1===f.nodeType)return!1;p=g="only"===e&&!p&&"nextSibling"}return!0}if(p=[s?m.firstChild:m.lastChild],s&&_){for(y=(h=(u=(d=(l=(f=m)[E]||(f[E]={}))[f.uniqueID]||(l[f.uniqueID]={}))[e]||[])[0]===N&&u[1])&&u[2],f=h&&m.childNodes[h];f=++h&&f&&f[g]||(y=h=0)||p.pop();)if(1===f.nodeType&&++y&&f===t){d[e]=[N,h,y];break}}else if(_&&(y=h=(u=(d=(l=(f=t)[E]||(f[E]={}))[f.uniqueID]||(l[f.uniqueID]={}))[e]||[])[0]===N&&u[1]),!1===y)for(;(f=++h&&f&&f[g]||(y=h=0)||p.pop())&&((a?f.nodeName.toLowerCase()!==v:1!==f.nodeType)||!++y||(_&&((d=(l=f[E]||(f[E]={}))[f.uniqueID]||(l[f.uniqueID]={}))[e]=[N,y]),f!==t)););return(y-=i)===r||y%r==0&&y/r>=0}}},PSEUDO:function(e,t){var n,r=a.pseudos[e]||a.setFilters[e.toLowerCase()]||le.error("unsupported pseudo: "+e);return r[E]?r(t):r.length>1?(n=[e,e,"",t],a.setFilters.hasOwnProperty(e.toLowerCase())?he((function(e,n){for(var i,o=r(e,t),s=o.length;s--;)e[i=U(e,o[s])]=!(n[i]=o[s])})):function(e){return r(e,0,n)}):r}},pseudos:{not:he((function(e){var t=[],n=[],r=l(e.replace(J,"$1"));return r[E]?he((function(e,t,n,i){for(var o,s=r(e,null,i,[]),a=e.length;a--;)(o=s[a])&&(e[a]=!(t[a]=o))})):function(e,i,o){return t[0]=e,r(t,null,o,n),t[0]=null,!n.pop()}})),has:he((function(e){return function(t){return le(e,t).length>0}})),contains:he((function(e){return e=e.replace(oe,se),function(t){return(t.textContent||c(t)).indexOf(e)>-1}})),lang:he((function(e){return Q.test(e||"")||le.error("unsupported lang: "+e),e=e.replace(oe,se).toLowerCase(),function(t){var n;do{if(n=y?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(e){var t=i.location&&i.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===_},focus:function(e){return e===v.activeElement&&(!v.hasFocus||v.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ye(!1),disabled:ye(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!a.pseudos.empty(e)},header:function(e){return te.test(e.nodeName)},input:function(e){return ee.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:be((function(){return[0]})),last:be((function(e,t){return[t-1]})),eq:be((function(e,t,n){return[n<0?n+t:n]})),even:be((function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e})),odd:be((function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e})),lt:be((function(e,t,n){for(var r=n<0?n+t:n>t?t:n;--r>=0;)e.push(r);return e})),gt:be((function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e}))}}).pseudos.nth=a.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})a.pseudos[o]=ve(o);for(o in{submit:!0,reset:!0})a.pseudos[o]=_e(o);function Se(){}function xe(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function Ee(e,t,n){var r=t.dir,i=t.next,o=i||r,s=n&&"parentNode"===o,a=O++;return t.first?function(t,n,i){for(;t=t[r];)if(1===t.nodeType||s)return e(t,n,i);return!1}:function(t,n,c){var u,d,l,f=[N,a];if(c){for(;t=t[r];)if((1===t.nodeType||s)&&e(t,n,c))return!0}else for(;t=t[r];)if(1===t.nodeType||s)if(d=(l=t[E]||(t[E]={}))[t.uniqueID]||(l[t.uniqueID]={}),i&&i===t.nodeName.toLowerCase())t=t[r]||t;else{if((u=d[o])&&u[0]===N&&u[1]===a)return f[2]=u[2];if(d[o]=f,f[2]=e(t,n,c))return!0}return!1}}function Ae(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function Ne(e,t,n,r,i){for(var o,s=[],a=0,c=e.length,u=null!=t;a<c;a++)(o=e[a])&&(n&&!n(o,r,i)||(s.push(o),u&&t.push(a)));return s}function Oe(e,t,n,r,i,o){return r&&!r[E]&&(r=Oe(r)),i&&!i[E]&&(i=Oe(i,o)),he((function(o,s,a,c){var u,d,l,f=[],h=[],p=s.length,g=o||function(e,t,n){for(var r=0,i=t.length;r<i;r++)le(e,t[r],n);return n}(t||"*",a.nodeType?[a]:a,[]),m=!e||!o&&t?g:Ne(g,f,e,a,c),v=n?i||(o?e:p||r)?[]:s:m;if(n&&n(m,v,a,c),r)for(u=Ne(v,h),r(u,[],a,c),d=u.length;d--;)(l=u[d])&&(v[h[d]]=!(m[h[d]]=l));if(o){if(i||e){if(i){for(u=[],d=v.length;d--;)(l=v[d])&&u.push(m[d]=l);i(null,v=[],u,c)}for(d=v.length;d--;)(l=v[d])&&(u=i?U(o,l):f[d])>-1&&(o[u]=!(s[u]=l))}}else v=Ne(v===s?v.splice(p,v.length):v),i?i(null,s,v,c):L.apply(s,v)}))}function je(e){for(var t,n,r,i=e.length,o=a.relative[e[0].type],s=o||a.relative[" "],c=o?1:0,u=Ee((function(e){return e===t}),s,!0),d=Ee((function(e){return U(t,e)>-1}),s,!0),l=[function(e,n,r){var i=!o&&(r||n!==h)||((t=n).nodeType?u(e,n,r):d(e,n,r));return t=null,i}];c<i;c++)if(n=a.relative[e[c].type])l=[Ee(Ae(l),n)];else{if((n=a.filter[e[c].type].apply(null,e[c].matches))[E]){for(r=++c;r<i&&!a.relative[e[r].type];r++);return Oe(c>1&&Ae(l),c>1&&xe(e.slice(0,c-1).concat({value:" "===e[c-2].type?"*":""})).replace(J,"$1"),n,c<r&&je(e.slice(c,r)),r<i&&je(e=e.slice(r)),r<i&&xe(e))}l.push(n)}return Ae(l)}Se.prototype=a.filters=a.pseudos,a.setFilters=new Se,d=le.tokenize=function(e,t){var n,r,i,o,s,c,u,d=T[e+" "];if(d)return t?0:d.slice(0);for(s=e,c=[],u=a.preFilter;s;){for(o in n&&!(r=V.exec(s))||(r&&(s=s.slice(r[0].length)||s),c.push(i=[])),n=!1,(r=G.exec(s))&&(n=r.shift(),i.push({value:n,type:r[0].replace(J," ")}),s=s.slice(n.length)),a.filter)!(r=K[o].exec(s))||u[o]&&!(r=u[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),s=s.slice(n.length));if(!n)break}return t?s.length:s?le.error(e):T(e,c).slice(0)},l=le.compile=function(e,t){var n,r=[],i=[],o=C[e+" "];if(!o){for(t||(t=d(e)),n=t.length;n--;)(o=je(t[n]))[E]?r.push(o):i.push(o);(o=C(e,function(e,t){var n=t.length>0,r=e.length>0,i=function(i,o,s,c,u){var d,l,f,p=0,g="0",_=i&&[],b=[],w=h,S=i||r&&a.find.TAG("*",u),x=N+=null==w?1:Math.random()||.1,E=S.length;for(u&&(h=o==v||o||u);g!==E&&null!=(d=S[g]);g++){if(r&&d){for(l=0,o||d.ownerDocument==v||(m(d),s=!y);f=e[l++];)if(f(d,o||v,s)){c.push(d);break}u&&(N=x)}n&&((d=!f&&d)&&p--,i&&_.push(d))}if(p+=g,n&&g!==p){for(l=0;f=t[l++];)f(_,b,o,s);if(i){if(p>0)for(;g--;)_[g]||b[g]||(b[g]=D.call(c));b=Ne(b)}L.apply(c,b),u&&!i&&b.length>0&&p+t.length>1&&le.uniqueSort(c)}return u&&(N=x,h=w),_};return n?he(i):i}(i,r))).selector=e}return o},f=le.select=function(e,t,n,r){var i,o,s,c,u,f="function"==typeof e&&e,h=!r&&d(e=f.selector||e);if(n=n||[],1===h.length){if((o=h[0]=h[0].slice(0)).length>2&&"ID"===(s=o[0]).type&&9===t.nodeType&&y&&a.relative[o[1].type]){if(!(t=(a.find.ID(s.matches[0].replace(oe,se),t)||[])[0]))return n;f&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(i=K.needsContext.test(e)?0:o.length;i--&&(s=o[i],!a.relative[c=s.type]);)if((u=a.find[c])&&(r=u(s.matches[0].replace(oe,se),ie.test(o[0].type)&&we(t.parentNode)||t))){if(o.splice(i,1),!(e=r.length&&xe(o)))return L.apply(n,r),n;break}}return(f||l(e,h))(r,t,!y,n,!t||ie.test(e)&&we(t.parentNode)||t),n},s.sortStable=E.split("").sort(R).join("")===E,s.detectDuplicates=!!g,m(),s.sortDetached=pe((function(e){return 1&e.compareDocumentPosition(v.createElement("fieldset"))})),pe((function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")}))||ge("type|href|height|width",(function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)})),s.attributes&&pe((function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")}))||ge("value",(function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue})),pe((function(e){return null==e.getAttribute("disabled")}))||ge(z,(function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}));var Te=i.Sizzle;le.noConflict=function(){return i.Sizzle===le&&(i.Sizzle=Te),le},void 0===(r=function(){return le}.call(t,n,t,e))||(e.exports=r)}(window)},function(e,t,n){"use strict";var r=n(53),i="object"==typeof self&&self&&self.Object===Object&&self,o=r.a||i||Function("return this")();t.a=o},function(e,t,n){"use strict";function r(e,t){e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;var n,r,s,u,d,l,f,h,p=new Array(80),g=1732584193,m=-271733879,v=-1732584194,_=271733878,y=-1009589776;for(n=0;n<e.length;n+=16){for(u=g,d=m,l=v,f=_,h=y,r=0;r<80;r++)p[r]=r<16?e[n+r]:c(p[r-3]^p[r-8]^p[r-14]^p[r-16],1),s=a(a(c(g,5),i(r,m,v,_)),a(a(y,p[r]),o(r))),y=_,_=v,v=c(m,30),m=g,g=s;g=a(g,u),m=a(m,d),v=a(v,l),_=a(_,f),y=a(y,h)}return[g,m,v,_,y]}function i(e,t,n,r){return e<20?t&n|~t&r:e<40?t^n^r:e<60?t&n|t&r|n&r:t^n^r}function o(e){return e<20?1518500249:e<40?1859775393:e<60?-1894007588:-899497514}function s(e,t){var n=u(e);n.length>16&&(n=r(n,8*e.length));for(var i=new Array(16),o=new Array(16),s=0;s<16;s++)i[s]=909522486^n[s],o[s]=1549556828^n[s];var a=r(i.concat(u(t)),512+8*t.length);return r(o.concat(a),672)}function a(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function c(e,t){return e<<t|e>>>32-t}function u(e){for(var t=[],n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<24-n%32;return t}function d(e){for(var t,n,r="",i=0;i<4*e.length;i+=3)for(t=(e[i>>2]>>8*(3-i%4)&255)<<16|(e[i+1>>2]>>8*(3-(i+1)%4)&255)<<8|e[i+2>>2]>>8*(3-(i+2)%4)&255,n=0;n<4;n++)8*i+6*n>32*e.length?r+="=":r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t>>6*(3-n)&63);return r}function l(e){for(var t="",n=0;n<32*e.length;n+=8)t+=String.fromCharCode(e[n>>5]>>>24-n%32&255);return t}n.d(t,"a",(function(){return f}));const f={b64_hmac_sha1:function(e,t){return d(s(e,t))},b64_sha1:function(e){return d(r(u(e),8*e.length))},binb2str:l,core_hmac_sha1:s,str_hmac_sha1:function(e,t){return l(s(e,t))},str_sha1:function(e){return l(r(u(e),8*e.length))}}},function(e,t,n){var r=n(85),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();e.exports=o},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){"use strict";(function(e){var r=n(53),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=o&&o.exports===i&&r.a.process,a=function(){try{var e=o&&o.require&&o.require("util").types;return e||s&&s.binding&&s.binding("util")}catch(e){}}();t.a=a}).call(this,n(56)(e))},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));!function(){let t=e.WebSocket;if(void 0===t)try{t=n(155)}catch(e){throw new Error('You must install the "ws" package to use Strophe in nodejs.')}}();const r=function(){let t=e.DOMParser;if(void 0===t)try{t=n(83).DOMParser}catch(e){throw new Error('You must install the "xmldom" package to use Strophe in nodejs.')}return t}();function i(){if("undefined"==typeof document)try{return(new(0,n(83).DOMImplementation)).createDocument("jabber:client","strophe",null)}catch(e){throw new Error('You must install the "xmldom" package to use Strophe in nodejs.')}if(void 0===document.implementation.createDocument||document.implementation.createDocument&&document.documentMode&&document.documentMode<10){const e=function(){const e=["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.5.0","Msxml2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XMLDOM"];for(let t=0;t<e.length;t++)try{return new ActiveXObject(e[t])}catch(e){}}();return e.appendChild(e.createElement("strophe")),e}return document.implementation.createDocument("jabber:client","strophe",null)}}).call(this,n(17))},function(e,t){var n=Array.isArray;e.exports=n},function(e,t,n){var r=n(132)("wks"),i=n(133),o=n(6).Symbol,s="function"==typeof o;(e.exports=function(e){return r[e]||(r[e]=s&&o[e]||(s?o:i)("Symbol."+e))}).store=r},function(e,t){var n=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=n)},,function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t,n){"use strict";(function(e){var r=n(3),i=n(143),o="object"==typeof exports&&exports&&!exports.nodeType&&exports,s=o&&"object"==typeof e&&e&&!e.nodeType&&e,a=s&&s.exports===o?r.a.Buffer:void 0,c=(a?a.isBuffer:void 0)||i.a;t.a=c}).call(this,n(56)(e))},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t,n){e.exports=function(){"use strict";var e="millisecond",t="second",n="minute",r="hour",i="day",o="week",s="month",a="quarter",c="year",u=/^(\d{4})-?(\d{1,2})-?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?.?(\d{1,3})?$/,d=/\[([^\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,l=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},f={s:l,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),r=Math.floor(n/60),i=n%60;return(t<=0?"+":"-")+l(r,2,"0")+":"+l(i,2,"0")},m:function(e,t){var n=12*(t.year()-e.year())+(t.month()-e.month()),r=e.clone().add(n,s),i=t-r<0,o=e.clone().add(n+(i?-1:1),s);return Number(-(n+(t-r)/(i?r-o:o-r))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(u){return{M:s,y:c,w:o,d:i,D:"date",h:r,m:n,s:t,ms:e,Q:a}[u]||String(u||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},h={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},p="en",g={};g[p]=h;var m=function(e){return e instanceof b},v=function(e,t,n){var r;if(!e)return p;if("string"==typeof e)g[e]&&(r=e),t&&(g[e]=t,r=e);else{var i=e.name;g[i]=e,r=i}return!n&&r&&(p=r),r||!n&&p},_=function(e,t){if(m(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new b(n)},y=f;y.l=v,y.i=m,y.w=function(e,t){return _(e,{locale:t.$L,utc:t.$u,$offset:t.$offset})};var b=function(){function l(e){this.$L=this.$L||v(e.locale,null,!0),this.parse(e)}var f=l.prototype;return f.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(y.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(u);if(r)return n?new Date(Date.UTC(r[1],r[2]-1,r[3]||1,r[4]||0,r[5]||0,r[6]||0,r[7]||0)):new Date(r[1],r[2]-1,r[3]||1,r[4]||0,r[5]||0,r[6]||0,r[7]||0)}return new Date(t)}(e),this.init()},f.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},f.$utils=function(){return y},f.isValid=function(){return!("Invalid Date"===this.$d.toString())},f.isSame=function(e,t){var n=_(e);return this.startOf(t)<=n&&n<=this.endOf(t)},f.isAfter=function(e,t){return _(e)<this.startOf(t)},f.isBefore=function(e,t){return this.endOf(t)<_(e)},f.$g=function(e,t,n){return y.u(e)?this[t]:this.set(n,e)},f.year=function(e){return this.$g(e,"$y",c)},f.month=function(e){return this.$g(e,"$M",s)},f.day=function(e){return this.$g(e,"$W",i)},f.date=function(e){return this.$g(e,"$D","date")},f.hour=function(e){return this.$g(e,"$H",r)},f.minute=function(e){return this.$g(e,"$m",n)},f.second=function(e){return this.$g(e,"$s",t)},f.millisecond=function(t){return this.$g(t,"$ms",e)},f.unix=function(){return Math.floor(this.valueOf()/1e3)},f.valueOf=function(){return this.$d.getTime()},f.startOf=function(e,a){var u=this,d=!!y.u(a)||a,l=y.p(e),f=function(e,t){var n=y.w(u.$u?Date.UTC(u.$y,t,e):new Date(u.$y,t,e),u);return d?n:n.endOf(i)},h=function(e,t){return y.w(u.toDate()[e].apply(u.toDate("s"),(d?[0,0,0,0]:[23,59,59,999]).slice(t)),u)},p=this.$W,g=this.$M,m=this.$D,v="set"+(this.$u?"UTC":"");switch(l){case c:return d?f(1,0):f(31,11);case s:return d?f(1,g):f(0,g+1);case o:var _=this.$locale().weekStart||0,b=(p<_?p+7:p)-_;return f(d?m-b:m+(6-b),g);case i:case"date":return h(v+"Hours",0);case r:return h(v+"Minutes",1);case n:return h(v+"Seconds",2);case t:return h(v+"Milliseconds",3);default:return this.clone()}},f.endOf=function(e){return this.startOf(e,!1)},f.$set=function(o,a){var u,d=y.p(o),l="set"+(this.$u?"UTC":""),f=(u={},u.day=l+"Date",u.date=l+"Date",u[s]=l+"Month",u[c]=l+"FullYear",u[r]=l+"Hours",u[n]=l+"Minutes",u[t]=l+"Seconds",u[e]=l+"Milliseconds",u)[d],h=d===i?this.$D+(a-this.$W):a;if(d===s||d===c){var p=this.clone().set("date",1);p.$d[f](h),p.init(),this.$d=p.set("date",Math.min(this.$D,p.daysInMonth())).$d}else f&&this.$d[f](h);return this.init(),this},f.set=function(e,t){return this.clone().$set(e,t)},f.get=function(e){return this[y.p(e)]()},f.add=function(e,a){var u,d=this;e=Number(e);var l=y.p(a),f=function(t){var n=_(d);return y.w(n.date(n.date()+Math.round(t*e)),d)};if(l===s)return this.set(s,this.$M+e);if(l===c)return this.set(c,this.$y+e);if(l===i)return f(1);if(l===o)return f(7);var h=(u={},u[n]=6e4,u[r]=36e5,u[t]=1e3,u)[l]||1,p=this.$d.getTime()+e*h;return y.w(p,this)},f.subtract=function(e,t){return this.add(-1*e,t)},f.format=function(e){var t=this;if(!this.isValid())return"Invalid Date";var n=e||"YYYY-MM-DDTHH:mm:ssZ",r=y.z(this),i=this.$locale(),o=this.$H,s=this.$m,a=this.$M,c=i.weekdays,u=i.months,l=function(e,r,i,o){return e&&(e[r]||e(t,n))||i[r].substr(0,o)},f=function(e){return y.s(o%12||12,e,"0")},h=i.meridiem||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r},p={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:y.s(a+1,2,"0"),MMM:l(i.monthsShort,a,u,3),MMMM:l(u,a),D:this.$D,DD:y.s(this.$D,2,"0"),d:String(this.$W),dd:l(i.weekdaysMin,this.$W,c,2),ddd:l(i.weekdaysShort,this.$W,c,3),dddd:c[this.$W],H:String(o),HH:y.s(o,2,"0"),h:f(1),hh:f(2),a:h(o,s,!0),A:h(o,s,!1),m:String(s),mm:y.s(s,2,"0"),s:String(this.$s),ss:y.s(this.$s,2,"0"),SSS:y.s(this.$ms,3,"0"),Z:r};return n.replace(d,(function(e,t){return t||p[e]||r.replace(":","")}))},f.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},f.diff=function(e,i,u){var d,l=y.p(i),f=_(e),h=6e4*(f.utcOffset()-this.utcOffset()),p=this-f,g=y.m(this,f);return g=(d={},d[c]=g/12,d[s]=g,d[a]=g/3,d[o]=(p-h)/6048e5,d.day=(p-h)/864e5,d[r]=p/36e5,d[n]=p/6e4,d[t]=p/1e3,d)[l]||p,u?g:y.a(g)},f.daysInMonth=function(){return this.endOf(s).$D},f.$locale=function(){return g[this.$L]},f.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),r=v(e,t,!0);return r&&(n.$L=r),n},f.clone=function(){return y.w(this.$d,this)},f.toDate=function(){return new Date(this.valueOf())},f.toJSON=function(){return this.isValid()?this.toISOString():null},f.toISOString=function(){return this.$d.toISOString()},f.toString=function(){return this.$d.toUTCString()},l}();return _.prototype=b.prototype,_.extend=function(e,t){return e(t,b,_),_},_.locale=v,_.isDayjs=m,_.unix=function(e){return _(1e3*e)},_.en=g[p],_.Ls=g,_}()},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(39),i=n(162),o=n(163),s=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":s&&s in Object(e)?i(e):o(e)}},function(e,t,n){var r=n(180),i=n(183);e.exports=function(e,t){var n=i(e,t);return r(n)?n:void 0}},function(e,t,n){var r=n(33);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){"use strict";const r=n(157),i=n(158);e.exports={atob:r,btoa:i}},function(e,t,n){(function(t){e.exports=function e(t,n,r){function i(s,a){if(!n[s]){if(!t[s]){if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[s]={exports:{}};t[s][0].call(u.exports,(function(e){var n=t[s][1][e];return i(n||e)}),u,u.exports,e,t,n,r)}return n[s].exports}for(var o=!1,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,n,r){(function(e){"use strict";var t,r,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var o=0,s=new i(d),a=e.document.createTextNode("");s.observe(a,{characterData:!0}),t=function(){a.data=o=++o%2}}else if(e.setImmediate||void 0===e.MessageChannel)t="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){d(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(d,0)};else{var c=new e.MessageChannel;c.port1.onmessage=d,t=function(){c.port2.postMessage(0)}}var u=[];function d(){var e,t;r=!0;for(var n=u.length;n;){for(t=u,u=[],e=-1;++e<n;)t[e]();n=u.length}r=!1}n.exports=function(e){1!==u.push(e)||r||t()}}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){"use strict";var r=e(1);function i(){}var o={},s=["REJECTED"],a=["FULFILLED"],c=["PENDING"];function u(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,e!==i&&h(this,e)}function d(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function l(e,t,n){r((function(){var r;try{r=t(n)}catch(t){return o.reject(e,t)}r===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,r)}))}function f(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function h(e,t){var n=!1;function r(t){n||(n=!0,o.reject(e,t))}function i(t){n||(n=!0,o.resolve(e,t))}var s=p((function(){t(i,r)}));"error"===s.status&&r(s.value)}function p(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}t.exports=u,u.prototype.catch=function(e){return this.then(null,e)},u.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===s)return this;var n=new this.constructor(i);return this.state!==c?l(n,this.state===a?e:t,this.outcome):this.queue.push(new d(n,e,t)),n},d.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},d.prototype.otherCallFulfilled=function(e){l(this.promise,this.onFulfilled,e)},d.prototype.callRejected=function(e){o.reject(this.promise,e)},d.prototype.otherCallRejected=function(e){l(this.promise,this.onRejected,e)},o.resolve=function(e,t){var n=p(f,t);if("error"===n.status)return o.reject(e,n.value);var r=n.value;if(r)h(e,r);else{e.state=a,e.outcome=t;for(var i=-1,s=e.queue.length;++i<s;)e.queue[i].callFulfilled(t)}return e},o.reject=function(e,t){e.state=s,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},u.resolve=function(e){return e instanceof this?e:o.resolve(new this(i),e)},u.reject=function(e){var t=new this(i);return o.reject(t,e)},u.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var s=new Array(n),a=0,c=-1,u=new this(i);++c<n;)d(e[c],c);return u;function d(e,i){t.resolve(e).then((function(e){s[i]=e,++a!==n||r||(r=!0,o.resolve(u,s))}),(function(e){r||(r=!0,o.reject(u,e))}))}},u.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var s,a=-1,c=new this(i);++a<n;)s=e[a],t.resolve(s).then((function(e){r||(r=!0,o.resolve(c,e))}),(function(e){r||(r=!0,o.reject(c,e))}));return c}},{1:1}],3:[function(e,n,r){(function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}();function o(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(i){if("TypeError"!==i.name)throw i;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var s=Promise;function a(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function c(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}function u(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function d(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var l=void 0,f={},h=Object.prototype.toString;function p(e){return"boolean"==typeof l?s.resolve(l):function(e){return new s((function(t){var n=e.transaction("local-forage-detect-blob-support","readwrite"),r=o([""]);n.objectStore("local-forage-detect-blob-support").put(r,"key"),n.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},n.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}(e).then((function(e){return l=e}))}function g(e){var t=f[e.name],n={};n.promise=new s((function(e,t){n.resolve=e,n.reject=t})),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then((function(){return n.promise})):t.dbReady=n.promise}function m(e){var t=f[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function v(e,t){var n=f[e.name].deferredOperations.pop();if(n)return n.reject(t),n.promise}function _(e,t){return new s((function(n,r){if(f[e.name]=f[e.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},e.db){if(!t)return n(e.db);g(e),e.db.close()}var o=[e.name];t&&o.push(e.version);var s=i.open.apply(i,o);t&&(s.onupgradeneeded=function(t){var n=s.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore("local-forage-detect-blob-support")}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),s.onerror=function(e){e.preventDefault(),r(s.error)},s.onsuccess=function(){n(s.result),m(e)}}))}function y(e){return _(e,!1)}function b(e){return _(e,!0)}function w(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,i=e.version>e.db.version;if(r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),i||n){if(n){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function S(e){return o([function(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),i=0;i<t;i++)r[i]=e.charCodeAt(i);return n}(atob(e.data))],{type:e.type})}function x(e){return e&&e.__local_forage_encoded_blob}function E(e){var t=this,n=t._initReady().then((function(){var e=f[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return c(n,e,e),n}function A(e,t,n,r){void 0===r&&(r=1);try{var i=e.db.transaction(e.storeName,t);n(null,i)}catch(i){if(r>0&&(!e.db||"InvalidStateError"===i.name||"NotFoundError"===i.name))return s.resolve().then((function(){if(!e.db||"NotFoundError"===i.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),b(e)})).then((function(){return function(e){g(e);for(var t=f[e.name],n=t.forages,r=0;r<n.length;r++){var i=n[r];i._dbInfo.db&&(i._dbInfo.db.close(),i._dbInfo.db=null)}return e.db=null,y(e).then((function(t){return e.db=t,w(e)?b(e):t})).then((function(r){e.db=t.db=r;for(var i=0;i<n.length;i++)n[i]._dbInfo.db=r})).catch((function(t){throw v(e,t),t}))}(e).then((function(){A(e,t,n,r-1)}))})).catch(n);n(i)}}var N={_driver:"asyncStorage",_initStorage:function(e){var t=this,n={db:null};if(e)for(var r in e)n[r]=e[r];var i=f[n.name];i||(i={forages:[],db:null,dbReady:null,deferredOperations:[]},f[n.name]=i),i.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=E);var o=[];function a(){return s.resolve()}for(var c=0;c<i.forages.length;c++){var u=i.forages[c];u!==t&&o.push(u._initReady().catch(a))}var d=i.forages.slice(0);return s.all(o).then((function(){return n.db=i.db,y(n)})).then((function(e){return n.db=e,w(n,t._defaultConfig.version)?b(n):e})).then((function(e){n.db=i.db=e,t._dbInfo=n;for(var r=0;r<d.length;r++){var o=d[r];o!==t&&(o._dbInfo.db=n.db,o._dbInfo.version=n.version)}}))},_support:function(){try{if(!i||!i.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),iterate:function(e,t){var n=this,r=new s((function(t,r){n.ready().then((function(){A(n._dbInfo,"readonly",(function(i,o){if(i)return r(i);try{var s=o.objectStore(n._dbInfo.storeName).openCursor(),a=1;s.onsuccess=function(){var n=s.result;if(n){var r=n.value;x(r)&&(r=S(r));var i=e(r,n.key,a++);void 0!==i?t(i):n.continue()}else t()},s.onerror=function(){r(s.error)}}catch(e){r(e)}}))})).catch(r)}));return a(r,t),r},getItem:function(e,t){var n=this;e=u(e);var r=new s((function(t,r){n.ready().then((function(){A(n._dbInfo,"readonly",(function(i,o){if(i)return r(i);try{var s=o.objectStore(n._dbInfo.storeName).get(e);s.onsuccess=function(){var e=s.result;void 0===e&&(e=null),x(e)&&(e=S(e)),t(e)},s.onerror=function(){r(s.error)}}catch(e){r(e)}}))})).catch(r)}));return a(r,t),r},setItem:function(e,t,n){var r=this;e=u(e);var i=new s((function(n,i){var o;r.ready().then((function(){return o=r._dbInfo,"[object Blob]"===h.call(t)?p(o.db).then((function(e){return e?t:(n=t,new s((function(e,t){var r=new FileReader;r.onerror=t,r.onloadend=function(t){var r=btoa(t.target.result||"");e({__local_forage_encoded_blob:!0,data:r,type:n.type})},r.readAsBinaryString(n)})));var n})):t})).then((function(t){A(r._dbInfo,"readwrite",(function(o,s){if(o)return i(o);try{var a=s.objectStore(r._dbInfo.storeName);null===t&&(t=void 0);var c=a.put(t,e);s.oncomplete=function(){void 0===t&&(t=null),n(t)},s.onabort=s.onerror=function(){var e=c.error?c.error:c.transaction.error;i(e)}}catch(e){i(e)}}))})).catch(i)}));return a(i,n),i},removeItem:function(e,t){var n=this;e=u(e);var r=new s((function(t,r){n.ready().then((function(){A(n._dbInfo,"readwrite",(function(i,o){if(i)return r(i);try{var s=o.objectStore(n._dbInfo.storeName).delete(e);o.oncomplete=function(){t()},o.onerror=function(){r(s.error)},o.onabort=function(){var e=s.error?s.error:s.transaction.error;r(e)}}catch(e){r(e)}}))})).catch(r)}));return a(r,t),r},clear:function(e){var t=this,n=new s((function(e,n){t.ready().then((function(){A(t._dbInfo,"readwrite",(function(r,i){if(r)return n(r);try{var o=i.objectStore(t._dbInfo.storeName).clear();i.oncomplete=function(){e()},i.onabort=i.onerror=function(){var e=o.error?o.error:o.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return a(n,e),n},length:function(e){var t=this,n=new s((function(e,n){t.ready().then((function(){A(t._dbInfo,"readonly",(function(r,i){if(r)return n(r);try{var o=i.objectStore(t._dbInfo.storeName).count();o.onsuccess=function(){e(o.result)},o.onerror=function(){n(o.error)}}catch(e){n(e)}}))})).catch(n)}));return a(n,e),n},key:function(e,t){var n=this,r=new s((function(t,r){e<0?t(null):n.ready().then((function(){A(n._dbInfo,"readonly",(function(i,o){if(i)return r(i);try{var s=o.objectStore(n._dbInfo.storeName),a=!1,c=s.openKeyCursor();c.onsuccess=function(){var n=c.result;n?0===e||a?t(n.key):(a=!0,n.advance(e)):t(null)},c.onerror=function(){r(c.error)}}catch(e){r(e)}}))})).catch(r)}));return a(r,t),r},keys:function(e){var t=this,n=new s((function(e,n){t.ready().then((function(){A(t._dbInfo,"readonly",(function(r,i){if(r)return n(r);try{var o=i.objectStore(t._dbInfo.storeName).openKeyCursor(),s=[];o.onsuccess=function(){var t=o.result;t?(s.push(t.key),t.continue()):e(s)},o.onerror=function(){n(o.error)}}catch(e){n(e)}}))})).catch(n)}));return a(n,e),n},dropInstance:function(e,t){t=d.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,o=this;if(e.name){var c=e.name===n.name&&o._dbInfo.db,u=c?s.resolve(o._dbInfo.db):y(e).then((function(t){var n=f[e.name],r=n.forages;n.db=t;for(var i=0;i<r.length;i++)r[i]._dbInfo.db=t;return t}));r=e.storeName?u.then((function(t){if(t.objectStoreNames.contains(e.storeName)){var n=t.version+1;g(e);var r=f[e.name],o=r.forages;t.close();for(var a=0;a<o.length;a++){var c=o[a];c._dbInfo.db=null,c._dbInfo.version=n}return new s((function(t,r){var o=i.open(e.name,n);o.onerror=function(e){o.result.close(),r(e)},o.onupgradeneeded=function(){o.result.deleteObjectStore(e.storeName)},o.onsuccess=function(){var e=o.result;e.close(),t(e)}})).then((function(e){r.db=e;for(var t=0;t<o.length;t++){var n=o[t];n._dbInfo.db=e,m(n._dbInfo)}})).catch((function(t){throw(v(e,t)||s.resolve()).catch((function(){})),t}))}})):u.then((function(t){g(e);var n=f[e.name],r=n.forages;t.close();for(var o=0;o<r.length;o++)r[o]._dbInfo.db=null;return new s((function(t,n){var r=i.deleteDatabase(e.name);r.onerror=r.onblocked=function(e){var t=r.result;t&&t.close(),n(e)},r.onsuccess=function(){var e=r.result;e&&e.close(),t(e)}})).then((function(e){n.db=e;for(var t=0;t<r.length;t++)m(r[t]._dbInfo)})).catch((function(t){throw(v(e,t)||s.resolve()).catch((function(){})),t}))}))}else r=s.reject("Invalid arguments");return a(r,t),r}},O="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",j=/^~~local_forage_type~([^~]+)~/,T="__lfsc__:".length,C=T+"arbf".length,I=Object.prototype.toString;function R(e){var t,n,r,i,o,s=.75*e.length,a=e.length,c=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var u=new ArrayBuffer(s),d=new Uint8Array(u);for(t=0;t<a;t+=4)n=O.indexOf(e[t]),r=O.indexOf(e[t+1]),i=O.indexOf(e[t+2]),o=O.indexOf(e[t+3]),d[c++]=n<<2|r>>4,d[c++]=(15&r)<<4|i>>2,d[c++]=(3&i)<<6|63&o;return u}function M(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=O[n[t]>>2],r+=O[(3&n[t])<<4|n[t+1]>>4],r+=O[(15&n[t+1])<<2|n[t+2]>>6],r+=O[63&n[t+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}var k={serialize:function(e,t){var n="";if(e&&(n=I.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===I.call(e.buffer))){var r,i="__lfsc__:";e instanceof ArrayBuffer?(r=e,i+="arbf"):(r=e.buffer,"[object Int8Array]"===n?i+="si08":"[object Uint8Array]"===n?i+="ui08":"[object Uint8ClampedArray]"===n?i+="uic8":"[object Int16Array]"===n?i+="si16":"[object Uint16Array]"===n?i+="ur16":"[object Int32Array]"===n?i+="si32":"[object Uint32Array]"===n?i+="ui32":"[object Float32Array]"===n?i+="fl32":"[object Float64Array]"===n?i+="fl64":t(new Error("Failed to get type for BinaryArray"))),t(i+M(r))}else if("[object Blob]"===n){var o=new FileReader;o.onload=function(){var n="~~local_forage_type~"+e.type+"~"+M(this.result);t("__lfsc__:blob"+n)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(n){console.error("Couldn't convert value into a JSON string: ",e),t(null,n)}},deserialize:function(e){if("__lfsc__:"!==e.substring(0,T))return JSON.parse(e);var t,n=e.substring(C),r=e.substring(T,C);if("blob"===r&&j.test(n)){var i=n.match(j);t=i[1],n=n.substring(i[0].length)}var s=R(n);switch(r){case"arbf":return s;case"blob":return o([s],{type:t});case"si08":return new Int8Array(s);case"ui08":return new Uint8Array(s);case"uic8":return new Uint8ClampedArray(s);case"si16":return new Int16Array(s);case"ur16":return new Uint16Array(s);case"si32":return new Int32Array(s);case"ui32":return new Uint32Array(s);case"fl32":return new Float32Array(s);case"fl64":return new Float64Array(s);default:throw new Error("Unkown type: "+r)}},stringToBuffer:R,bufferToString:M};function D(e,t,n,r){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function P(e,t,n,r,i,o){e.executeSql(n,r,i,(function(e,s){s.code===s.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,a){a.rows.length?o(e,s):D(e,t,(function(){e.executeSql(n,r,i,o)}),o)}),o):o(e,s)}),o)}function L(e,t,n,r){var i=this;e=u(e);var o=new s((function(o,s){i.ready().then((function(){void 0===t&&(t=null);var a=t,c=i._dbInfo;c.serializer.serialize(t,(function(t,u){u?s(u):c.db.transaction((function(n){P(n,c,"INSERT OR REPLACE INTO "+c.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){o(a)}),(function(e,t){s(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(r>0)return void o(L.apply(i,[e,a,n,r-1]));s(t)}}))}))})).catch(s)}));return a(o,n),o}function F(e){return new s((function(t,n){e.transaction((function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(n,r){for(var i=[],o=0;o<r.rows.length;o++)i.push(r.rows.item(o).name);t({db:e,storeNames:i})}),(function(e,t){n(t)}))}),(function(e){n(e)}))}))}var U={_driver:"webSQLStorage",_initStorage:function(e){var t=this,n={db:null};if(e)for(var r in e)n[r]="string"!=typeof e[r]?e[r].toString():e[r];var i=new s((function(e,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(e){return r(e)}n.db.transaction((function(i){D(i,n,(function(){t._dbInfo=n,e()}),(function(e,t){r(t)}))}),r)}));return n.serializer=k,i},_support:"function"==typeof openDatabase,iterate:function(e,t){var n=this,r=new s((function(t,r){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){P(n,i,"SELECT * FROM "+i.storeName,[],(function(n,r){for(var o=r.rows,s=o.length,a=0;a<s;a++){var c=o.item(a),u=c.value;if(u&&(u=i.serializer.deserialize(u)),void 0!==(u=e(u,c.key,a+1)))return void t(u)}t()}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,t),r},getItem:function(e,t){var n=this;e=u(e);var r=new s((function(t,r){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){P(n,i,"SELECT * FROM "+i.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=i.serializer.deserialize(r)),t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,t),r},setItem:function(e,t,n){return L.apply(this,[e,t,n,1])},removeItem:function(e,t){var n=this;e=u(e);var r=new s((function(t,r){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){P(n,i,"DELETE FROM "+i.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,t),r},clear:function(e){var t=this,n=new s((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){P(t,r,"DELETE FROM "+r.storeName,[],(function(){e()}),(function(e,t){n(t)}))}))})).catch(n)}));return a(n,e),n},length:function(e){var t=this,n=new s((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){P(t,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],(function(t,n){var r=n.rows.item(0).c;e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return a(n,e),n},key:function(e,t){var n=this,r=new s((function(t,r){n.ready().then((function(){var i=n._dbInfo;i.db.transaction((function(n){P(n,i,"SELECT key FROM "+i.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,n){var r=n.rows.length?n.rows.item(0).key:null;t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,t),r},keys:function(e){var t=this,n=new s((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){P(t,r,"SELECT key FROM "+r.storeName,[],(function(t,n){for(var r=[],i=0;i<n.rows.length;i++)r.push(n.rows.item(i).key);e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return a(n,e),n},dropInstance:function(e,t){t=d.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,i=this;return a(r=e.name?new s((function(t){var r;r=e.name===n.name?i._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:r,storeNames:[e.storeName]}):t(F(r))})).then((function(e){return new s((function(t,n){e.db.transaction((function(r){function i(e){return new s((function(t,n){r.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){n(t)}))}))}for(var o=[],a=0,c=e.storeNames.length;a<c;a++)o.push(i(e.storeNames[a]));s.all(o).then((function(){t()})).catch((function(e){n(e)}))}),(function(e){n(e)}))}))})):s.reject("Invalid arguments"),t),r}};function z(e,t){var n=e.name+"/";return e.storeName!==t.storeName&&(n+=e.storeName+"/"),n}function B(){return!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch(e){return!0}}()||localStorage.length>0}var H={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var n in e)t[n]=e[n];return t.keyPrefix=z(e,this._defaultConfig),B()?(this._dbInfo=t,t.serializer=k,s.resolve()):s.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}(),iterate:function(e,t){var n=this,r=n.ready().then((function(){for(var t=n._dbInfo,r=t.keyPrefix,i=r.length,o=localStorage.length,s=1,a=0;a<o;a++){var c=localStorage.key(a);if(0===c.indexOf(r)){var u=localStorage.getItem(c);if(u&&(u=t.serializer.deserialize(u)),void 0!==(u=e(u,c.substring(i),s++)))return u}}}));return a(r,t),r},getItem:function(e,t){var n=this;e=u(e);var r=n.ready().then((function(){var t=n._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r}));return a(r,t),r},setItem:function(e,t,n){var r=this;e=u(e);var i=r.ready().then((function(){void 0===t&&(t=null);var n=t;return new s((function(i,o){var s=r._dbInfo;s.serializer.serialize(t,(function(t,r){if(r)o(r);else try{localStorage.setItem(s.keyPrefix+e,t),i(n)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||o(e),o(e)}}))}))}));return a(i,n),i},removeItem:function(e,t){var n=this;e=u(e);var r=n.ready().then((function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return a(r,t),r},clear:function(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(e)&&localStorage.removeItem(r)}}));return a(n,e),n},length:function(e){var t=this.keys().then((function(e){return e.length}));return a(t,e),t},key:function(e,t){var n=this,r=n.ready().then((function(){var t,r=n._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t}));return a(r,t),r},keys:function(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo,n=localStorage.length,r=[],i=0;i<n;i++){var o=localStorage.key(i);0===o.indexOf(e.keyPrefix)&&r.push(o.substring(e.keyPrefix.length))}return r}));return a(n,e),n},dropInstance:function(e,t){if(t=d.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var n=this.config();e.name=e.name||n.name,e.storeName=e.storeName||n.storeName}var r,i=this;return a(r=e.name?new s((function(t){e.storeName?t(z(e,i._defaultConfig)):t(e.name+"/")})).then((function(e){for(var t=localStorage.length-1;t>=0;t--){var n=localStorage.key(t);0===n.indexOf(e)&&localStorage.removeItem(n)}})):s.reject("Invalid arguments"),t),r}},q=function(e,t){for(var n,r,i=e.length,o=0;o<i;){if((n=e[o])===(r=t)||"number"==typeof n&&"number"==typeof r&&isNaN(n)&&isNaN(r))return!0;o++}return!1},$=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},W={},J={},V={INDEXEDDB:N,WEBSQL:U,LOCALSTORAGE:H},G=[V.INDEXEDDB._driver,V.WEBSQL._driver,V.LOCALSTORAGE._driver],Y=["dropInstance"],X=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Y),Q={description:"",driver:G.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function K(e,t){e[t]=function(){var n=arguments;return e.ready().then((function(){return e[t].apply(e,n)}))}}function Z(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&($(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}var ee=new(function(){function e(t){for(var n in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),V)if(V.hasOwnProperty(n)){var r=V[n],i=r._driver;this[n]=i,W[i]||this.defineDriver(r)}this._defaultConfig=Z({},Q),this._config=Z({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":r(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,n){var r=new s((function(t,n){try{var r=e._driver,i=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void n(i);for(var o=X.concat("_initStorage"),c=0,u=o.length;c<u;c++){var d=o[c];if((!q(Y,d)||e[d])&&"function"!=typeof e[d])return void n(i)}!function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),n=s.reject(t);return a(n,arguments[arguments.length-1]),n}},n=0,r=Y.length;n<r;n++){var i=Y[n];e[i]||(e[i]=t(i))}}();var l=function(n){W[r]&&console.info("Redefining LocalForage driver: "+r),W[r]=e,J[r]=n,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(l,n):l(!!e._support):l(!0)}catch(e){n(e)}}));return c(r,t,n),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var r=W[e]?s.resolve(W[e]):s.reject(new Error("Driver not found."));return c(r,t,n),r},e.prototype.getSerializer=function(e){var t=s.resolve(k);return c(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return c(n,e,e),n},e.prototype.setDriver=function(e,t,n){var r=this;$(e)||(e=[e]);var i=this._getSupportedDrivers(e);function o(){r._config.driver=r.driver()}function a(e){return r._extend(e),o(),r._ready=r._initStorage(r._config),r._ready}var u=null!==this._driverSet?this._driverSet.catch((function(){return s.resolve()})):s.resolve();return this._driverSet=u.then((function(){var e=i[0];return r._dbInfo=null,r._ready=null,r.getDriver(e).then((function(e){r._driver=e._driver,o(),r._wrapLibraryMethodsWithReady(),r._initDriver=function(e){return function(){var t=0;return function n(){for(;t<e.length;){var i=e[t];return t++,r._dbInfo=null,r._ready=null,r.getDriver(i).then(a).catch(n)}o();var c=new Error("No available storage method found.");return r._driverSet=s.reject(c),r._driverSet}()}}(i)}))})).catch((function(){o();var e=new Error("No available storage method found.");return r._driverSet=s.reject(e),r._driverSet})),c(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!J[e]},e.prototype._extend=function(e){Z(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];this.supports(i)&&t.push(i)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=X.length;e<t;e++)K(this,X[e])},e.prototype.createInstance=function(t){return new e(t)},e}());t.exports=ee},{3:3}]},{},[4])(4)}).call(this,n(17))},function(e,t,n){var r=n(52),i=n(59);e.exports=function(e){return null!=e&&i(e.length)&&!r(e)}},function(e,t,n){var r=n(6),i=n(11),o=n(48),s=n(25),a=n(50),c=function(e,t,n){var u,d,l,f=e&c.F,h=e&c.G,p=e&c.S,g=e&c.P,m=e&c.B,v=e&c.W,_=h?i:i[t]||(i[t]={}),y=_.prototype,b=h?r:p?r[t]:(r[t]||{}).prototype;for(u in h&&(n=t),n)(d=!f&&b&&void 0!==b[u])&&a(_,u)||(l=d?b[u]:n[u],_[u]=h&&"function"!=typeof b[u]?n[u]:m&&d?o(l,r):v&&b[u]==l?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(l):g&&"function"==typeof l?o(Function.call,l):l,g&&((_.virtual||(_.virtual={}))[u]=l,e&c.R&&y&&!y[u]&&s(y,u,l)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,t,n){var r=n(32),i=n(128);e.exports=n(26)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){e.exports=!n(70)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(87),i=n(91),o=n(23);e.exports=function(e){return o(e)?r(e):i(e)}},function(e,t,n){var r=n(102),i=n(23),o=n(103),s=n(57),a=n(80),c=Math.max;e.exports=function(e,t,n,u){e=i(e)?e:a(e),n=n&&!u?s(n):0;var d=e.length;return n<0&&(n=c(d+n,0)),o(e)?n<=d&&e.indexOf(t,n)>-1:!!d&&r(e,t,n)>-1}},function(e,t){var n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&n.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t){e.exports=function(e){return e}},function(e,t,n){var r=n(38);e.exports=function(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},function(e,t,n){var r=n(20),i=n(279),o=n(280),s=Object.defineProperty;t.f=n(26)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){e.exports={}},function(e,t,n){e.exports=n(164)},function(e,t,n){e.exports=n(178)},,function(e,t,n){var r=n(18),i=n(15);e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==r(e)}},function(e,t,n){var r=n(5).Symbol;e.exports=r},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,n){var r=n(62),i=n(13);e.exports=function(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=r(e.prototype),o=e.apply(n,t);return i(o)?o:n}}},function(e,t){e.exports=function(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var s=e[n];s!==t&&"__lodash_placeholder__"!==s||(e[n]="__lodash_placeholder__",o[i++]=n)}return o}},function(e,t,n){var r=n(215),i=n(216),o=n(217),s=n(218),a=n(219);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=s,c.prototype.set=a,e.exports=c},function(e,t,n){var r=n(40);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},function(e,t,n){var r=n(19)(Object,"create");e.exports=r},function(e,t,n){var r=n(233);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},function(e,t,n){var r=n(9),i=n(69),o=n(256),s=n(259);e.exports=function(e,t){return r(e)?e:i(e,t)?[e]:o(s(e))}},function(e,t,n){var r=n(49);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var r=n(18),i=n(13);e.exports=function(e){if(!i(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t,n){"use strict";(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.a=n}).call(this,n(17))},function(e,t,n){(function(e,r){var i;
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(){var o="Expected a function",s="__lodash_placeholder__",a=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],c="[object Arguments]",u="[object Array]",d="[object Boolean]",l="[object Date]",f="[object Error]",h="[object Function]",p="[object GeneratorFunction]",g="[object Map]",m="[object Number]",v="[object Object]",_="[object RegExp]",y="[object Set]",b="[object String]",w="[object Symbol]",S="[object WeakMap]",x="[object ArrayBuffer]",E="[object DataView]",A="[object Float32Array]",N="[object Float64Array]",O="[object Int8Array]",j="[object Int16Array]",T="[object Int32Array]",C="[object Uint8Array]",I="[object Uint16Array]",R="[object Uint32Array]",M=/\b__p \+= '';/g,k=/\b(__p \+=) '' \+/g,D=/(__e\(.*?\)|\b__t\)) \+\n'';/g,P=/&(?:amp|lt|gt|quot|#39);/g,L=/[&<>"']/g,F=RegExp(P.source),U=RegExp(L.source),z=/<%-([\s\S]+?)%>/g,B=/<%([\s\S]+?)%>/g,H=/<%=([\s\S]+?)%>/g,q=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$=/^\w*$/,W=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,J=/[\\^$.*+?()[\]{}|]/g,V=RegExp(J.source),G=/^\s+|\s+$/g,Y=/^\s+/,X=/\s+$/,Q=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,K=/\{\n\/\* \[wrapped with (.+)\] \*/,Z=/,? & /,ee=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,te=/\\(\\)?/g,ne=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,re=/\w*$/,ie=/^[-+]0x[0-9a-f]+$/i,oe=/^0b[01]+$/i,se=/^\[object .+?Constructor\]$/,ae=/^0o[0-7]+$/i,ce=/^(?:0|[1-9]\d*)$/,ue=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,de=/($^)/,le=/['\n\r\u2028\u2029\\]/g,fe="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",he="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",pe="[\\ud800-\\udfff]",ge="["+he+"]",me="["+fe+"]",ve="\\d+",_e="[\\u2700-\\u27bf]",ye="[a-z\\xdf-\\xf6\\xf8-\\xff]",be="[^\\ud800-\\udfff"+he+ve+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",we="\\ud83c[\\udffb-\\udfff]",Se="[^\\ud800-\\udfff]",xe="(?:\\ud83c[\\udde6-\\uddff]){2}",Ee="[\\ud800-\\udbff][\\udc00-\\udfff]",Ae="[A-Z\\xc0-\\xd6\\xd8-\\xde]",Ne="(?:"+ye+"|"+be+")",Oe="(?:"+Ae+"|"+be+")",je="(?:"+me+"|"+we+")"+"?",Te="[\\ufe0e\\ufe0f]?"+je+("(?:\\u200d(?:"+[Se,xe,Ee].join("|")+")[\\ufe0e\\ufe0f]?"+je+")*"),Ce="(?:"+[_e,xe,Ee].join("|")+")"+Te,Ie="(?:"+[Se+me+"?",me,xe,Ee,pe].join("|")+")",Re=RegExp("['’]","g"),Me=RegExp(me,"g"),ke=RegExp(we+"(?="+we+")|"+Ie+Te,"g"),De=RegExp([Ae+"?"+ye+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[ge,Ae,"$"].join("|")+")",Oe+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[ge,Ae+Ne,"$"].join("|")+")",Ae+"?"+Ne+"+(?:['’](?:d|ll|m|re|s|t|ve))?",Ae+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ve,Ce].join("|"),"g"),Pe=RegExp("[\\u200d\\ud800-\\udfff"+fe+"\\ufe0e\\ufe0f]"),Le=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Fe=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ue=-1,ze={};ze[A]=ze[N]=ze[O]=ze[j]=ze[T]=ze[C]=ze["[object Uint8ClampedArray]"]=ze[I]=ze[R]=!0,ze[c]=ze[u]=ze[x]=ze[d]=ze[E]=ze[l]=ze[f]=ze[h]=ze[g]=ze[m]=ze[v]=ze[_]=ze[y]=ze[b]=ze[S]=!1;var Be={};Be[c]=Be[u]=Be[x]=Be[E]=Be[d]=Be[l]=Be[A]=Be[N]=Be[O]=Be[j]=Be[T]=Be[g]=Be[m]=Be[v]=Be[_]=Be[y]=Be[b]=Be[w]=Be[C]=Be["[object Uint8ClampedArray]"]=Be[I]=Be[R]=!0,Be[f]=Be[h]=Be[S]=!1;var He={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},qe=parseFloat,$e=parseInt,We="object"==typeof e&&e&&e.Object===Object&&e,Je="object"==typeof self&&self&&self.Object===Object&&self,Ve=We||Je||Function("return this")(),Ge=t&&!t.nodeType&&t,Ye=Ge&&"object"==typeof r&&r&&!r.nodeType&&r,Xe=Ye&&Ye.exports===Ge,Qe=Xe&&We.process,Ke=function(){try{var e=Ye&&Ye.require&&Ye.require("util").types;return e||Qe&&Qe.binding&&Qe.binding("util")}catch(e){}}(),Ze=Ke&&Ke.isArrayBuffer,et=Ke&&Ke.isDate,tt=Ke&&Ke.isMap,nt=Ke&&Ke.isRegExp,rt=Ke&&Ke.isSet,it=Ke&&Ke.isTypedArray;function ot(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function st(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var s=e[i];t(r,s,n(s),e)}return r}function at(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function ct(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function ut(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function dt(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s,n,e)&&(o[i++]=s)}return o}function lt(e,t){return!!(null==e?0:e.length)&&wt(e,t,0)>-1}function ft(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function ht(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function pt(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function gt(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function mt(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function vt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var _t=At("length");function yt(e,t,n){var r;return n(e,(function(e,n,i){if(t(e,n,i))return r=n,!1})),r}function bt(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function wt(e,t,n){return t==t?function(e,t,n){var r=n-1,i=e.length;for(;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):bt(e,xt,n)}function St(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}function xt(e){return e!=e}function Et(e,t){var n=null==e?0:e.length;return n?jt(e,t)/n:NaN}function At(e){return function(t){return null==t?void 0:t[e]}}function Nt(e){return function(t){return null==e?void 0:e[t]}}function Ot(e,t,n,r,i){return i(e,(function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)})),n}function jt(e,t){for(var n,r=-1,i=e.length;++r<i;){var o=t(e[r]);void 0!==o&&(n=void 0===n?o:n+o)}return n}function Tt(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Ct(e){return function(t){return e(t)}}function It(e,t){return ht(t,(function(t){return e[t]}))}function Rt(e,t){return e.has(t)}function Mt(e,t){for(var n=-1,r=e.length;++n<r&&wt(t,e[n],0)>-1;);return n}function kt(e,t){for(var n=e.length;n--&&wt(t,e[n],0)>-1;);return n}function Dt(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}var Pt=Nt({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),Lt=Nt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Ft(e){return"\\"+He[e]}function Ut(e){return Pe.test(e)}function zt(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function Bt(e,t){return function(n){return e(t(n))}}function Ht(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n];a!==t&&a!==s||(e[n]=s,o[i++]=n)}return o}function qt(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function $t(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}function Wt(e){return Ut(e)?function(e){var t=ke.lastIndex=0;for(;ke.test(e);)++t;return t}(e):_t(e)}function Jt(e){return Ut(e)?function(e){return e.match(ke)||[]}(e):function(e){return e.split("")}(e)}var Vt=Nt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var Gt=function e(t){var n,r=(t=null==t?Ve:Gt.defaults(Ve.Object(),t,Gt.pick(Ve,Fe))).Array,i=t.Date,fe=t.Error,he=t.Function,pe=t.Math,ge=t.Object,me=t.RegExp,ve=t.String,_e=t.TypeError,ye=r.prototype,be=he.prototype,we=ge.prototype,Se=t["__core-js_shared__"],xe=be.toString,Ee=we.hasOwnProperty,Ae=0,Ne=(n=/[^.]+$/.exec(Se&&Se.keys&&Se.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",Oe=we.toString,je=xe.call(ge),Te=Ve._,Ce=me("^"+xe.call(Ee).replace(J,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ie=Xe?t.Buffer:void 0,ke=t.Symbol,Pe=t.Uint8Array,He=Ie?Ie.allocUnsafe:void 0,We=Bt(ge.getPrototypeOf,ge),Je=ge.create,Ge=we.propertyIsEnumerable,Ye=ye.splice,Qe=ke?ke.isConcatSpreadable:void 0,Ke=ke?ke.iterator:void 0,_t=ke?ke.toStringTag:void 0,Nt=function(){try{var e=Zi(ge,"defineProperty");return e({},"",{}),e}catch(e){}}(),Yt=t.clearTimeout!==Ve.clearTimeout&&t.clearTimeout,Xt=i&&i.now!==Ve.Date.now&&i.now,Qt=t.setTimeout!==Ve.setTimeout&&t.setTimeout,Kt=pe.ceil,Zt=pe.floor,en=ge.getOwnPropertySymbols,tn=Ie?Ie.isBuffer:void 0,nn=t.isFinite,rn=ye.join,on=Bt(ge.keys,ge),sn=pe.max,an=pe.min,cn=i.now,un=t.parseInt,dn=pe.random,ln=ye.reverse,fn=Zi(t,"DataView"),hn=Zi(t,"Map"),pn=Zi(t,"Promise"),gn=Zi(t,"Set"),mn=Zi(t,"WeakMap"),vn=Zi(ge,"create"),_n=mn&&new mn,yn={},bn=Oo(fn),wn=Oo(hn),Sn=Oo(pn),xn=Oo(gn),En=Oo(mn),An=ke?ke.prototype:void 0,Nn=An?An.valueOf:void 0,On=An?An.toString:void 0;function jn(e){if($s(e)&&!Ms(e)&&!(e instanceof Rn)){if(e instanceof In)return e;if(Ee.call(e,"__wrapped__"))return jo(e)}return new In(e)}var Tn=function(){function e(){}return function(t){if(!qs(t))return{};if(Je)return Je(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function Cn(){}function In(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}function Rn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Mn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function kn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Dn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Pn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Dn;++t<n;)this.add(e[t])}function Ln(e){var t=this.__data__=new kn(e);this.size=t.size}function Fn(e,t){var n=Ms(e),r=!n&&Rs(e),i=!n&&!r&&Ls(e),o=!n&&!r&&!i&&Ks(e),s=n||r||i||o,a=s?Tt(e.length,ve):[],c=a.length;for(var u in e)!t&&!Ee.call(e,u)||s&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||so(u,c))||a.push(u);return a}function Un(e){var t=e.length;return t?e[Pr(0,t-1)]:void 0}function zn(e,t){return Eo(vi(e),Yn(t,0,e.length))}function Bn(e){return Eo(vi(e))}function Hn(e,t,n){(void 0!==n&&!Ts(e[t],n)||void 0===n&&!(t in e))&&Vn(e,t,n)}function qn(e,t,n){var r=e[t];Ee.call(e,t)&&Ts(r,n)&&(void 0!==n||t in e)||Vn(e,t,n)}function $n(e,t){for(var n=e.length;n--;)if(Ts(e[n][0],t))return n;return-1}function Wn(e,t,n,r){return er(e,(function(e,i,o){t(r,e,n(e),o)})),r}function Jn(e,t){return e&&_i(t,ba(t),e)}function Vn(e,t,n){"__proto__"==t&&Nt?Nt(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Gn(e,t){for(var n=-1,i=t.length,o=r(i),s=null==e;++n<i;)o[n]=s?void 0:ga(e,t[n]);return o}function Yn(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}function Xn(e,t,n,r,i,o){var s,a=1&t,u=2&t,f=4&t;if(n&&(s=i?n(e,r,i,o):n(e)),void 0!==s)return s;if(!qs(e))return e;var S=Ms(e);if(S){if(s=function(e){var t=e.length,n=new e.constructor(t);t&&"string"==typeof e[0]&&Ee.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!a)return vi(e,s)}else{var M=no(e),k=M==h||M==p;if(Ls(e))return li(e,a);if(M==v||M==c||k&&!i){if(s=u||k?{}:io(e),!a)return u?function(e,t){return _i(e,to(e),t)}(e,function(e,t){return e&&_i(t,wa(t),e)}(s,e)):function(e,t){return _i(e,eo(e),t)}(e,Jn(s,e))}else{if(!Be[M])return i?e:{};s=function(e,t,n){var r=e.constructor;switch(t){case x:return fi(e);case d:case l:return new r(+e);case E:return function(e,t){var n=t?fi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case A:case N:case O:case j:case T:case C:case"[object Uint8ClampedArray]":case I:case R:return hi(e,n);case g:return new r;case m:case b:return new r(e);case _:return function(e){var t=new e.constructor(e.source,re.exec(e));return t.lastIndex=e.lastIndex,t}(e);case y:return new r;case w:return i=e,Nn?ge(Nn.call(i)):{}}var i}(e,M,a)}}o||(o=new Ln);var D=o.get(e);if(D)return D;o.set(e,s),Ys(e)?e.forEach((function(r){s.add(Xn(r,t,n,r,e,o))})):Ws(e)&&e.forEach((function(r,i){s.set(i,Xn(r,t,n,i,e,o))}));var P=S?void 0:(f?u?Ji:Wi:u?wa:ba)(e);return at(P||e,(function(r,i){P&&(r=e[i=r]),qn(s,i,Xn(r,t,n,i,e,o))})),s}function Qn(e,t,n){var r=n.length;if(null==e)return!r;for(e=ge(e);r--;){var i=n[r],o=t[i],s=e[i];if(void 0===s&&!(i in e)||!o(s))return!1}return!0}function Kn(e,t,n){if("function"!=typeof e)throw new _e(o);return bo((function(){e.apply(void 0,n)}),t)}function Zn(e,t,n,r){var i=-1,o=lt,s=!0,a=e.length,c=[],u=t.length;if(!a)return c;n&&(t=ht(t,Ct(n))),r?(o=ft,s=!1):t.length>=200&&(o=Rt,s=!1,t=new Pn(t));e:for(;++i<a;){var d=e[i],l=null==n?d:n(d);if(d=r||0!==d?d:0,s&&l==l){for(var f=u;f--;)if(t[f]===l)continue e;c.push(d)}else o(t,l,r)||c.push(d)}return c}jn.templateSettings={escape:z,evaluate:B,interpolate:H,variable:"",imports:{_:jn}},jn.prototype=Cn.prototype,jn.prototype.constructor=jn,In.prototype=Tn(Cn.prototype),In.prototype.constructor=In,Rn.prototype=Tn(Cn.prototype),Rn.prototype.constructor=Rn,Mn.prototype.clear=function(){this.__data__=vn?vn(null):{},this.size=0},Mn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Mn.prototype.get=function(e){var t=this.__data__;if(vn){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return Ee.call(t,e)?t[e]:void 0},Mn.prototype.has=function(e){var t=this.__data__;return vn?void 0!==t[e]:Ee.call(t,e)},Mn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=vn&&void 0===t?"__lodash_hash_undefined__":t,this},kn.prototype.clear=function(){this.__data__=[],this.size=0},kn.prototype.delete=function(e){var t=this.__data__,n=$n(t,e);return!(n<0)&&(n==t.length-1?t.pop():Ye.call(t,n,1),--this.size,!0)},kn.prototype.get=function(e){var t=this.__data__,n=$n(t,e);return n<0?void 0:t[n][1]},kn.prototype.has=function(e){return $n(this.__data__,e)>-1},kn.prototype.set=function(e,t){var n=this.__data__,r=$n(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Dn.prototype.clear=function(){this.size=0,this.__data__={hash:new Mn,map:new(hn||kn),string:new Mn}},Dn.prototype.delete=function(e){var t=Qi(this,e).delete(e);return this.size-=t?1:0,t},Dn.prototype.get=function(e){return Qi(this,e).get(e)},Dn.prototype.has=function(e){return Qi(this,e).has(e)},Dn.prototype.set=function(e,t){var n=Qi(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Pn.prototype.add=Pn.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Pn.prototype.has=function(e){return this.__data__.has(e)},Ln.prototype.clear=function(){this.__data__=new kn,this.size=0},Ln.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Ln.prototype.get=function(e){return this.__data__.get(e)},Ln.prototype.has=function(e){return this.__data__.has(e)},Ln.prototype.set=function(e,t){var n=this.__data__;if(n instanceof kn){var r=n.__data__;if(!hn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Dn(r)}return n.set(e,t),this.size=n.size,this};var er=wi(cr),tr=wi(ur,!0);function nr(e,t){var n=!0;return er(e,(function(e,r,i){return n=!!t(e,r,i)})),n}function rr(e,t,n){for(var r=-1,i=e.length;++r<i;){var o=e[r],s=t(o);if(null!=s&&(void 0===a?s==s&&!Qs(s):n(s,a)))var a=s,c=o}return c}function ir(e,t){var n=[];return er(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n}function or(e,t,n,r,i){var o=-1,s=e.length;for(n||(n=oo),i||(i=[]);++o<s;){var a=e[o];t>0&&n(a)?t>1?or(a,t-1,n,r,i):pt(i,a):r||(i[i.length]=a)}return i}var sr=Si(),ar=Si(!0);function cr(e,t){return e&&sr(e,t,ba)}function ur(e,t){return e&&ar(e,t,ba)}function dr(e,t){return dt(t,(function(t){return zs(e[t])}))}function lr(e,t){for(var n=0,r=(t=ai(t,e)).length;null!=e&&n<r;)e=e[No(t[n++])];return n&&n==r?e:void 0}function fr(e,t,n){var r=t(e);return Ms(e)?r:pt(r,n(e))}function hr(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":_t&&_t in ge(e)?function(e){var t=Ee.call(e,_t),n=e[_t];try{e[_t]=void 0;var r=!0}catch(e){}var i=Oe.call(e);r&&(t?e[_t]=n:delete e[_t]);return i}(e):function(e){return Oe.call(e)}(e)}function pr(e,t){return e>t}function gr(e,t){return null!=e&&Ee.call(e,t)}function mr(e,t){return null!=e&&t in ge(e)}function vr(e,t,n){for(var i=n?ft:lt,o=e[0].length,s=e.length,a=s,c=r(s),u=1/0,d=[];a--;){var l=e[a];a&&t&&(l=ht(l,Ct(t))),u=an(l.length,u),c[a]=!n&&(t||o>=120&&l.length>=120)?new Pn(a&&l):void 0}l=e[0];var f=-1,h=c[0];e:for(;++f<o&&d.length<u;){var p=l[f],g=t?t(p):p;if(p=n||0!==p?p:0,!(h?Rt(h,g):i(d,g,n))){for(a=s;--a;){var m=c[a];if(!(m?Rt(m,g):i(e[a],g,n)))continue e}h&&h.push(g),d.push(p)}}return d}function _r(e,t,n){var r=null==(e=mo(e,t=ai(t,e)))?e:e[No(Uo(t))];return null==r?void 0:ot(r,e,n)}function yr(e){return $s(e)&&hr(e)==c}function br(e,t,n,r,i){return e===t||(null==e||null==t||!$s(e)&&!$s(t)?e!=e&&t!=t:function(e,t,n,r,i,o){var s=Ms(e),a=Ms(t),h=s?u:no(e),p=a?u:no(t),S=(h=h==c?v:h)==v,A=(p=p==c?v:p)==v,N=h==p;if(N&&Ls(e)){if(!Ls(t))return!1;s=!0,S=!1}if(N&&!S)return o||(o=new Ln),s||Ks(e)?qi(e,t,n,r,i,o):function(e,t,n,r,i,o,s){switch(n){case E:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case x:return!(e.byteLength!=t.byteLength||!o(new Pe(e),new Pe(t)));case d:case l:case m:return Ts(+e,+t);case f:return e.name==t.name&&e.message==t.message;case _:case b:return e==t+"";case g:var a=zt;case y:var c=1&r;if(a||(a=qt),e.size!=t.size&&!c)return!1;var u=s.get(e);if(u)return u==t;r|=2,s.set(e,t);var h=qi(a(e),a(t),r,i,o,s);return s.delete(e),h;case w:if(Nn)return Nn.call(e)==Nn.call(t)}return!1}(e,t,h,n,r,i,o);if(!(1&n)){var O=S&&Ee.call(e,"__wrapped__"),j=A&&Ee.call(t,"__wrapped__");if(O||j){var T=O?e.value():e,C=j?t.value():t;return o||(o=new Ln),i(T,C,n,r,o)}}if(!N)return!1;return o||(o=new Ln),function(e,t,n,r,i,o){var s=1&n,a=Wi(e),c=a.length,u=Wi(t).length;if(c!=u&&!s)return!1;var d=c;for(;d--;){var l=a[d];if(!(s?l in t:Ee.call(t,l)))return!1}var f=o.get(e),h=o.get(t);if(f&&h)return f==t&&h==e;var p=!0;o.set(e,t),o.set(t,e);var g=s;for(;++d<c;){l=a[d];var m=e[l],v=t[l];if(r)var _=s?r(v,m,l,t,e,o):r(m,v,l,e,t,o);if(!(void 0===_?m===v||i(m,v,n,r,o):_)){p=!1;break}g||(g="constructor"==l)}if(p&&!g){var y=e.constructor,b=t.constructor;y==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b||(p=!1)}return o.delete(e),o.delete(t),p}(e,t,n,r,i,o)}(e,t,n,r,br,i))}function wr(e,t,n,r){var i=n.length,o=i,s=!r;if(null==e)return!o;for(e=ge(e);i--;){var a=n[i];if(s&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++i<o;){var c=(a=n[i])[0],u=e[c],d=a[1];if(s&&a[2]){if(void 0===u&&!(c in e))return!1}else{var l=new Ln;if(r)var f=r(u,d,c,e,t,l);if(!(void 0===f?br(d,u,3,r,l):f))return!1}}return!0}function Sr(e){return!(!qs(e)||(t=e,Ne&&Ne in t))&&(zs(e)?Ce:se).test(Oo(e));var t}function xr(e){return"function"==typeof e?e:null==e?Ja:"object"==typeof e?Ms(e)?Tr(e[0],e[1]):jr(e):tc(e)}function Er(e){if(!fo(e))return on(e);var t=[];for(var n in ge(e))Ee.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Ar(e){if(!qs(e))return function(e){var t=[];if(null!=e)for(var n in ge(e))t.push(n);return t}(e);var t=fo(e),n=[];for(var r in e)("constructor"!=r||!t&&Ee.call(e,r))&&n.push(r);return n}function Nr(e,t){return e<t}function Or(e,t){var n=-1,i=Ds(e)?r(e.length):[];return er(e,(function(e,r,o){i[++n]=t(e,r,o)})),i}function jr(e){var t=Ki(e);return 1==t.length&&t[0][2]?po(t[0][0],t[0][1]):function(n){return n===e||wr(n,e,t)}}function Tr(e,t){return co(e)&&ho(t)?po(No(e),t):function(n){var r=ga(n,e);return void 0===r&&r===t?ma(n,e):br(t,r,3)}}function Cr(e,t,n,r,i){e!==t&&sr(t,(function(o,s){if(i||(i=new Ln),qs(o))!function(e,t,n,r,i,o,s){var a=_o(e,n),c=_o(t,n),u=s.get(c);if(u)return void Hn(e,n,u);var d=o?o(a,c,n+"",e,t,s):void 0,l=void 0===d;if(l){var f=Ms(c),h=!f&&Ls(c),p=!f&&!h&&Ks(c);d=c,f||h||p?Ms(a)?d=a:Ps(a)?d=vi(a):h?(l=!1,d=li(c,!0)):p?(l=!1,d=hi(c,!0)):d=[]:Vs(c)||Rs(c)?(d=a,Rs(a)?d=sa(a):qs(a)&&!zs(a)||(d=io(c))):l=!1}l&&(s.set(c,d),i(d,c,r,o,s),s.delete(c));Hn(e,n,d)}(e,t,s,n,Cr,r,i);else{var a=r?r(_o(e,s),o,s+"",e,t,i):void 0;void 0===a&&(a=o),Hn(e,s,a)}}),wa)}function Ir(e,t){var n=e.length;if(n)return so(t+=t<0?n:0,n)?e[t]:void 0}function Rr(e,t,n){t=t.length?ht(t,(function(e){return Ms(e)?function(t){return lr(t,1===e.length?e[0]:e)}:e})):[Ja];var r=-1;return t=ht(t,Ct(Xi())),function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(Or(e,(function(e,n,i){return{criteria:ht(t,(function(t){return t(e)})),index:++r,value:e}})),(function(e,t){return function(e,t,n){var r=-1,i=e.criteria,o=t.criteria,s=i.length,a=n.length;for(;++r<s;){var c=pi(i[r],o[r]);if(c){if(r>=a)return c;var u=n[r];return c*("desc"==u?-1:1)}}return e.index-t.index}(e,t,n)}))}function Mr(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var s=t[r],a=lr(e,s);n(a,s)&&Br(o,ai(s,e),a)}return o}function kr(e,t,n,r){var i=r?St:wt,o=-1,s=t.length,a=e;for(e===t&&(t=vi(t)),n&&(a=ht(e,Ct(n)));++o<s;)for(var c=0,u=t[o],d=n?n(u):u;(c=i(a,d,c,r))>-1;)a!==e&&Ye.call(a,c,1),Ye.call(e,c,1);return e}function Dr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;so(i)?Ye.call(e,i,1):Zr(e,i)}}return e}function Pr(e,t){return e+Zt(dn()*(t-e+1))}function Lr(e,t){var n="";if(!e||t<1||t>9007199254740991)return n;do{t%2&&(n+=e),(t=Zt(t/2))&&(e+=e)}while(t);return n}function Fr(e,t){return wo(go(e,t,Ja),e+"")}function Ur(e){return Un(Ta(e))}function zr(e,t){var n=Ta(e);return Eo(n,Yn(t,0,n.length))}function Br(e,t,n,r){if(!qs(e))return e;for(var i=-1,o=(t=ai(t,e)).length,s=o-1,a=e;null!=a&&++i<o;){var c=No(t[i]),u=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(i!=s){var d=a[c];void 0===(u=r?r(d,c,a):void 0)&&(u=qs(d)?d:so(t[i+1])?[]:{})}qn(a,c,u),a=a[c]}return e}var Hr=_n?function(e,t){return _n.set(e,t),e}:Ja,qr=Nt?function(e,t){return Nt(e,"toString",{configurable:!0,enumerable:!1,value:qa(t),writable:!0})}:Ja;function $r(e){return Eo(Ta(e))}function Wr(e,t,n){var i=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var s=r(o);++i<o;)s[i]=e[i+t];return s}function Jr(e,t){var n;return er(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}function Vr(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=2147483647){for(;r<i;){var o=r+i>>>1,s=e[o];null!==s&&!Qs(s)&&(n?s<=t:s<t)?r=o+1:i=o}return i}return Gr(e,t,Ja,n)}function Gr(e,t,n,r){var i=0,o=null==e?0:e.length;if(0===o)return 0;for(var s=(t=n(t))!=t,a=null===t,c=Qs(t),u=void 0===t;i<o;){var d=Zt((i+o)/2),l=n(e[d]),f=void 0!==l,h=null===l,p=l==l,g=Qs(l);if(s)var m=r||p;else m=u?p&&(r||f):a?p&&f&&(r||!h):c?p&&f&&!h&&(r||!g):!h&&!g&&(r?l<=t:l<t);m?i=d+1:o=d}return an(o,4294967294)}function Yr(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var s=e[n],a=t?t(s):s;if(!n||!Ts(a,c)){var c=a;o[i++]=0===s?0:s}}return o}function Xr(e){return"number"==typeof e?e:Qs(e)?NaN:+e}function Qr(e){if("string"==typeof e)return e;if(Ms(e))return ht(e,Qr)+"";if(Qs(e))return On?On.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Kr(e,t,n){var r=-1,i=lt,o=e.length,s=!0,a=[],c=a;if(n)s=!1,i=ft;else if(o>=200){var u=t?null:Li(e);if(u)return qt(u);s=!1,i=Rt,c=new Pn}else c=t?[]:a;e:for(;++r<o;){var d=e[r],l=t?t(d):d;if(d=n||0!==d?d:0,s&&l==l){for(var f=c.length;f--;)if(c[f]===l)continue e;t&&c.push(l),a.push(d)}else i(c,l,n)||(c!==a&&c.push(l),a.push(d))}return a}function Zr(e,t){return null==(e=mo(e,t=ai(t,e)))||delete e[No(Uo(t))]}function ei(e,t,n,r){return Br(e,t,n(lr(e,t)),r)}function ti(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?Wr(e,r?0:o,r?o+1:i):Wr(e,r?o+1:0,r?i:o)}function ni(e,t){var n=e;return n instanceof Rn&&(n=n.value()),gt(t,(function(e,t){return t.func.apply(t.thisArg,pt([e],t.args))}),n)}function ri(e,t,n){var i=e.length;if(i<2)return i?Kr(e[0]):[];for(var o=-1,s=r(i);++o<i;)for(var a=e[o],c=-1;++c<i;)c!=o&&(s[o]=Zn(s[o]||a,e[c],t,n));return Kr(or(s,1),t,n)}function ii(e,t,n){for(var r=-1,i=e.length,o=t.length,s={};++r<i;){var a=r<o?t[r]:void 0;n(s,e[r],a)}return s}function oi(e){return Ps(e)?e:[]}function si(e){return"function"==typeof e?e:Ja}function ai(e,t){return Ms(e)?e:co(e,t)?[e]:Ao(aa(e))}var ci=Fr;function ui(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:Wr(e,t,n)}var di=Yt||function(e){return Ve.clearTimeout(e)};function li(e,t){if(t)return e.slice();var n=e.length,r=He?He(n):new e.constructor(n);return e.copy(r),r}function fi(e){var t=new e.constructor(e.byteLength);return new Pe(t).set(new Pe(e)),t}function hi(e,t){var n=t?fi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function pi(e,t){if(e!==t){var n=void 0!==e,r=null===e,i=e==e,o=Qs(e),s=void 0!==t,a=null===t,c=t==t,u=Qs(t);if(!a&&!u&&!o&&e>t||o&&s&&c&&!a&&!u||r&&s&&c||!n&&c||!i)return 1;if(!r&&!o&&!u&&e<t||u&&n&&i&&!r&&!o||a&&n&&i||!s&&i||!c)return-1}return 0}function gi(e,t,n,i){for(var o=-1,s=e.length,a=n.length,c=-1,u=t.length,d=sn(s-a,0),l=r(u+d),f=!i;++c<u;)l[c]=t[c];for(;++o<a;)(f||o<s)&&(l[n[o]]=e[o]);for(;d--;)l[c++]=e[o++];return l}function mi(e,t,n,i){for(var o=-1,s=e.length,a=-1,c=n.length,u=-1,d=t.length,l=sn(s-c,0),f=r(l+d),h=!i;++o<l;)f[o]=e[o];for(var p=o;++u<d;)f[p+u]=t[u];for(;++a<c;)(h||o<s)&&(f[p+n[a]]=e[o++]);return f}function vi(e,t){var n=-1,i=e.length;for(t||(t=r(i));++n<i;)t[n]=e[n];return t}function _i(e,t,n,r){var i=!n;n||(n={});for(var o=-1,s=t.length;++o<s;){var a=t[o],c=r?r(n[a],e[a],a,n,e):void 0;void 0===c&&(c=e[a]),i?Vn(n,a,c):qn(n,a,c)}return n}function yi(e,t){return function(n,r){var i=Ms(n)?st:Wn,o=t?t():{};return i(n,e,Xi(r,2),o)}}function bi(e){return Fr((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,s=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,s&&ao(n[0],n[1],s)&&(o=i<3?void 0:o,i=1),t=ge(t);++r<i;){var a=n[r];a&&e(t,a,r,o)}return t}))}function wi(e,t){return function(n,r){if(null==n)return n;if(!Ds(n))return e(n,r);for(var i=n.length,o=t?i:-1,s=ge(n);(t?o--:++o<i)&&!1!==r(s[o],o,s););return n}}function Si(e){return function(t,n,r){for(var i=-1,o=ge(t),s=r(t),a=s.length;a--;){var c=s[e?a:++i];if(!1===n(o[c],c,o))break}return t}}function xi(e){return function(t){var n=Ut(t=aa(t))?Jt(t):void 0,r=n?n[0]:t.charAt(0),i=n?ui(n,1).join(""):t.slice(1);return r[e]()+i}}function Ei(e){return function(t){return gt(za(Ra(t).replace(Re,"")),e,"")}}function Ai(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Tn(e.prototype),r=e.apply(n,t);return qs(r)?r:n}}function Ni(e){return function(t,n,r){var i=ge(t);if(!Ds(t)){var o=Xi(n,3);t=ba(t),n=function(e){return o(i[e],e,i)}}var s=e(t,n,r);return s>-1?i[o?t[s]:s]:void 0}}function Oi(e){return $i((function(t){var n=t.length,r=n,i=In.prototype.thru;for(e&&t.reverse();r--;){var s=t[r];if("function"!=typeof s)throw new _e(o);if(i&&!a&&"wrapper"==Gi(s))var a=new In([],!0)}for(r=a?r:n;++r<n;){var c=Gi(s=t[r]),u="wrapper"==c?Vi(s):void 0;a=u&&uo(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?a[Gi(u[0])].apply(a,u[3]):1==s.length&&uo(s)?a[c]():a.thru(s)}return function(){var e=arguments,r=e[0];if(a&&1==e.length&&Ms(r))return a.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}}))}function ji(e,t,n,i,o,s,a,c,u,d){var l=128&t,f=1&t,h=2&t,p=24&t,g=512&t,m=h?void 0:Ai(e);return function v(){for(var _=arguments.length,y=r(_),b=_;b--;)y[b]=arguments[b];if(p)var w=Yi(v),S=Dt(y,w);if(i&&(y=gi(y,i,o,p)),s&&(y=mi(y,s,a,p)),_-=S,p&&_<d){var x=Ht(y,w);return Di(e,t,ji,v.placeholder,n,y,x,c,u,d-_)}var E=f?n:this,A=h?E[e]:e;return _=y.length,c?y=vo(y,c):g&&_>1&&y.reverse(),l&&u<_&&(y.length=u),this&&this!==Ve&&this instanceof v&&(A=m||Ai(A)),A.apply(E,y)}}function Ti(e,t){return function(n,r){return function(e,t,n,r){return cr(e,(function(e,i,o){t(r,n(e),i,o)})),r}(n,e,t(r),{})}}function Ci(e,t){return function(n,r){var i;if(void 0===n&&void 0===r)return t;if(void 0!==n&&(i=n),void 0!==r){if(void 0===i)return r;"string"==typeof n||"string"==typeof r?(n=Qr(n),r=Qr(r)):(n=Xr(n),r=Xr(r)),i=e(n,r)}return i}}function Ii(e){return $i((function(t){return t=ht(t,Ct(Xi())),Fr((function(n){var r=this;return e(t,(function(e){return ot(e,r,n)}))}))}))}function Ri(e,t){var n=(t=void 0===t?" ":Qr(t)).length;if(n<2)return n?Lr(t,e):t;var r=Lr(t,Kt(e/Wt(t)));return Ut(t)?ui(Jt(r),0,e).join(""):r.slice(0,e)}function Mi(e){return function(t,n,i){return i&&"number"!=typeof i&&ao(t,n,i)&&(n=i=void 0),t=na(t),void 0===n?(n=t,t=0):n=na(n),function(e,t,n,i){for(var o=-1,s=sn(Kt((t-e)/(n||1)),0),a=r(s);s--;)a[i?s:++o]=e,e+=n;return a}(t,n,i=void 0===i?t<n?1:-1:na(i),e)}}function ki(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=oa(t),n=oa(n)),e(t,n)}}function Di(e,t,n,r,i,o,s,a,c,u){var d=8&t;t|=d?32:64,4&(t&=~(d?64:32))||(t&=-4);var l=[e,t,i,d?o:void 0,d?s:void 0,d?void 0:o,d?void 0:s,a,c,u],f=n.apply(void 0,l);return uo(e)&&yo(f,l),f.placeholder=r,So(f,e,t)}function Pi(e){var t=pe[e];return function(e,n){if(e=oa(e),(n=null==n?0:an(ra(n),292))&&nn(e)){var r=(aa(e)+"e").split("e");return+((r=(aa(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Li=gn&&1/qt(new gn([,-0]))[1]==1/0?function(e){return new gn(e)}:Qa;function Fi(e){return function(t){var n=no(t);return n==g?zt(t):n==y?$t(t):function(e,t){return ht(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Ui(e,t,n,i,a,c,u,d){var l=2&t;if(!l&&"function"!=typeof e)throw new _e(o);var f=i?i.length:0;if(f||(t&=-97,i=a=void 0),u=void 0===u?u:sn(ra(u),0),d=void 0===d?d:ra(d),f-=a?a.length:0,64&t){var h=i,p=a;i=a=void 0}var g=l?void 0:Vi(e),m=[e,t,n,i,a,h,p,c,u,d];if(g&&function(e,t){var n=e[1],r=t[1],i=n|r,o=i<131,a=128==r&&8==n||128==r&&256==n&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!o&&!a)return e;1&r&&(e[2]=t[2],i|=1&n?0:4);var c=t[3];if(c){var u=e[3];e[3]=u?gi(u,c,t[4]):c,e[4]=u?Ht(e[3],s):t[4]}(c=t[5])&&(u=e[5],e[5]=u?mi(u,c,t[6]):c,e[6]=u?Ht(e[5],s):t[6]);(c=t[7])&&(e[7]=c);128&r&&(e[8]=null==e[8]?t[8]:an(e[8],t[8]));null==e[9]&&(e[9]=t[9]);e[0]=t[0],e[1]=i}(m,g),e=m[0],t=m[1],n=m[2],i=m[3],a=m[4],!(d=m[9]=void 0===m[9]?l?0:e.length:sn(m[9]-f,0))&&24&t&&(t&=-25),t&&1!=t)v=8==t||16==t?function(e,t,n){var i=Ai(e);return function o(){for(var s=arguments.length,a=r(s),c=s,u=Yi(o);c--;)a[c]=arguments[c];var d=s<3&&a[0]!==u&&a[s-1]!==u?[]:Ht(a,u);if((s-=d.length)<n)return Di(e,t,ji,o.placeholder,void 0,a,d,void 0,void 0,n-s);var l=this&&this!==Ve&&this instanceof o?i:e;return ot(l,this,a)}}(e,t,d):32!=t&&33!=t||a.length?ji.apply(void 0,m):function(e,t,n,i){var o=1&t,s=Ai(e);return function t(){for(var a=-1,c=arguments.length,u=-1,d=i.length,l=r(d+c),f=this&&this!==Ve&&this instanceof t?s:e;++u<d;)l[u]=i[u];for(;c--;)l[u++]=arguments[++a];return ot(f,o?n:this,l)}}(e,t,n,i);else var v=function(e,t,n){var r=1&t,i=Ai(e);return function t(){var o=this&&this!==Ve&&this instanceof t?i:e;return o.apply(r?n:this,arguments)}}(e,t,n);return So((g?Hr:yo)(v,m),e,t)}function zi(e,t,n,r){return void 0===e||Ts(e,we[n])&&!Ee.call(r,n)?t:e}function Bi(e,t,n,r,i,o){return qs(e)&&qs(t)&&(o.set(t,e),Cr(e,t,void 0,Bi,o),o.delete(t)),e}function Hi(e){return Vs(e)?void 0:e}function qi(e,t,n,r,i,o){var s=1&n,a=e.length,c=t.length;if(a!=c&&!(s&&c>a))return!1;var u=o.get(e),d=o.get(t);if(u&&d)return u==t&&d==e;var l=-1,f=!0,h=2&n?new Pn:void 0;for(o.set(e,t),o.set(t,e);++l<a;){var p=e[l],g=t[l];if(r)var m=s?r(g,p,l,t,e,o):r(p,g,l,e,t,o);if(void 0!==m){if(m)continue;f=!1;break}if(h){if(!vt(t,(function(e,t){if(!Rt(h,t)&&(p===e||i(p,e,n,r,o)))return h.push(t)}))){f=!1;break}}else if(p!==g&&!i(p,g,n,r,o)){f=!1;break}}return o.delete(e),o.delete(t),f}function $i(e){return wo(go(e,void 0,ko),e+"")}function Wi(e){return fr(e,ba,eo)}function Ji(e){return fr(e,wa,to)}var Vi=_n?function(e){return _n.get(e)}:Qa;function Gi(e){for(var t=e.name+"",n=yn[t],r=Ee.call(yn,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function Yi(e){return(Ee.call(jn,"placeholder")?jn:e).placeholder}function Xi(){var e=jn.iteratee||Va;return e=e===Va?xr:e,arguments.length?e(arguments[0],arguments[1]):e}function Qi(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function Ki(e){for(var t=ba(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,ho(i)]}return t}function Zi(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return Sr(n)?n:void 0}var eo=en?function(e){return null==e?[]:(e=ge(e),dt(en(e),(function(t){return Ge.call(e,t)})))}:ic,to=en?function(e){for(var t=[];e;)pt(t,eo(e)),e=We(e);return t}:ic,no=hr;function ro(e,t,n){for(var r=-1,i=(t=ai(t,e)).length,o=!1;++r<i;){var s=No(t[r]);if(!(o=null!=e&&n(e,s)))break;e=e[s]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&Hs(i)&&so(s,i)&&(Ms(e)||Rs(e))}function io(e){return"function"!=typeof e.constructor||fo(e)?{}:Tn(We(e))}function oo(e){return Ms(e)||Rs(e)||!!(Qe&&e&&e[Qe])}function so(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&ce.test(e))&&e>-1&&e%1==0&&e<t}function ao(e,t,n){if(!qs(n))return!1;var r=typeof t;return!!("number"==r?Ds(n)&&so(t,n.length):"string"==r&&t in n)&&Ts(n[t],e)}function co(e,t){if(Ms(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Qs(e))||($.test(e)||!q.test(e)||null!=t&&e in ge(t))}function uo(e){var t=Gi(e),n=jn[t];if("function"!=typeof n||!(t in Rn.prototype))return!1;if(e===n)return!0;var r=Vi(n);return!!r&&e===r[0]}(fn&&no(new fn(new ArrayBuffer(1)))!=E||hn&&no(new hn)!=g||pn&&"[object Promise]"!=no(pn.resolve())||gn&&no(new gn)!=y||mn&&no(new mn)!=S)&&(no=function(e){var t=hr(e),n=t==v?e.constructor:void 0,r=n?Oo(n):"";if(r)switch(r){case bn:return E;case wn:return g;case Sn:return"[object Promise]";case xn:return y;case En:return S}return t});var lo=Se?zs:oc;function fo(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||we)}function ho(e){return e==e&&!qs(e)}function po(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in ge(n)))}}function go(e,t,n){return t=sn(void 0===t?e.length-1:t,0),function(){for(var i=arguments,o=-1,s=sn(i.length-t,0),a=r(s);++o<s;)a[o]=i[t+o];o=-1;for(var c=r(t+1);++o<t;)c[o]=i[o];return c[t]=n(a),ot(e,this,c)}}function mo(e,t){return t.length<2?e:lr(e,Wr(t,0,-1))}function vo(e,t){for(var n=e.length,r=an(t.length,n),i=vi(e);r--;){var o=t[r];e[r]=so(o,n)?i[o]:void 0}return e}function _o(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var yo=xo(Hr),bo=Qt||function(e,t){return Ve.setTimeout(e,t)},wo=xo(qr);function So(e,t,n){var r=t+"";return wo(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(Q,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return at(a,(function(n){var r="_."+n[0];t&n[1]&&!lt(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(K);return t?t[1].split(Z):[]}(r),n)))}function xo(e){var t=0,n=0;return function(){var r=cn(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function Eo(e,t){var n=-1,r=e.length,i=r-1;for(t=void 0===t?r:t;++n<t;){var o=Pr(n,i),s=e[o];e[o]=e[n],e[n]=s}return e.length=t,e}var Ao=function(e){var t=xs(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(W,(function(e,n,r,i){t.push(r?i.replace(te,"$1"):n||e)})),t}));function No(e){if("string"==typeof e||Qs(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Oo(e){if(null!=e){try{return xe.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function jo(e){if(e instanceof Rn)return e.clone();var t=new In(e.__wrapped__,e.__chain__);return t.__actions__=vi(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var To=Fr((function(e,t){return Ps(e)?Zn(e,or(t,1,Ps,!0)):[]})),Co=Fr((function(e,t){var n=Uo(t);return Ps(n)&&(n=void 0),Ps(e)?Zn(e,or(t,1,Ps,!0),Xi(n,2)):[]})),Io=Fr((function(e,t){var n=Uo(t);return Ps(n)&&(n=void 0),Ps(e)?Zn(e,or(t,1,Ps,!0),void 0,n):[]}));function Ro(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:ra(n);return i<0&&(i=sn(r+i,0)),bt(e,Xi(t,3),i)}function Mo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r-1;return void 0!==n&&(i=ra(n),i=n<0?sn(r+i,0):an(i,r-1)),bt(e,Xi(t,3),i,!0)}function ko(e){return(null==e?0:e.length)?or(e,1):[]}function Do(e){return e&&e.length?e[0]:void 0}var Po=Fr((function(e){var t=ht(e,oi);return t.length&&t[0]===e[0]?vr(t):[]})),Lo=Fr((function(e){var t=Uo(e),n=ht(e,oi);return t===Uo(n)?t=void 0:n.pop(),n.length&&n[0]===e[0]?vr(n,Xi(t,2)):[]})),Fo=Fr((function(e){var t=Uo(e),n=ht(e,oi);return(t="function"==typeof t?t:void 0)&&n.pop(),n.length&&n[0]===e[0]?vr(n,void 0,t):[]}));function Uo(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var zo=Fr(Bo);function Bo(e,t){return e&&e.length&&t&&t.length?kr(e,t):e}var Ho=$i((function(e,t){var n=null==e?0:e.length,r=Gn(e,t);return Dr(e,ht(t,(function(e){return so(e,n)?+e:e})).sort(pi)),r}));function qo(e){return null==e?e:ln.call(e)}var $o=Fr((function(e){return Kr(or(e,1,Ps,!0))})),Wo=Fr((function(e){var t=Uo(e);return Ps(t)&&(t=void 0),Kr(or(e,1,Ps,!0),Xi(t,2))})),Jo=Fr((function(e){var t=Uo(e);return t="function"==typeof t?t:void 0,Kr(or(e,1,Ps,!0),void 0,t)}));function Vo(e){if(!e||!e.length)return[];var t=0;return e=dt(e,(function(e){if(Ps(e))return t=sn(e.length,t),!0})),Tt(t,(function(t){return ht(e,At(t))}))}function Go(e,t){if(!e||!e.length)return[];var n=Vo(e);return null==t?n:ht(n,(function(e){return ot(t,void 0,e)}))}var Yo=Fr((function(e,t){return Ps(e)?Zn(e,t):[]})),Xo=Fr((function(e){return ri(dt(e,Ps))})),Qo=Fr((function(e){var t=Uo(e);return Ps(t)&&(t=void 0),ri(dt(e,Ps),Xi(t,2))})),Ko=Fr((function(e){var t=Uo(e);return t="function"==typeof t?t:void 0,ri(dt(e,Ps),void 0,t)})),Zo=Fr(Vo);var es=Fr((function(e){var t=e.length,n=t>1?e[t-1]:void 0;return n="function"==typeof n?(e.pop(),n):void 0,Go(e,n)}));function ts(e){var t=jn(e);return t.__chain__=!0,t}function ns(e,t){return t(e)}var rs=$i((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,i=function(t){return Gn(t,e)};return!(t>1||this.__actions__.length)&&r instanceof Rn&&so(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:ns,args:[i],thisArg:void 0}),new In(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(void 0),e}))):this.thru(i)}));var is=yi((function(e,t,n){Ee.call(e,n)?++e[n]:Vn(e,n,1)}));var os=Ni(Ro),ss=Ni(Mo);function as(e,t){return(Ms(e)?at:er)(e,Xi(t,3))}function cs(e,t){return(Ms(e)?ct:tr)(e,Xi(t,3))}var us=yi((function(e,t,n){Ee.call(e,n)?e[n].push(t):Vn(e,n,[t])}));var ds=Fr((function(e,t,n){var i=-1,o="function"==typeof t,s=Ds(e)?r(e.length):[];return er(e,(function(e){s[++i]=o?ot(t,e,n):_r(e,t,n)})),s})),ls=yi((function(e,t,n){Vn(e,n,t)}));function fs(e,t){return(Ms(e)?ht:Or)(e,Xi(t,3))}var hs=yi((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));var ps=Fr((function(e,t){if(null==e)return[];var n=t.length;return n>1&&ao(e,t[0],t[1])?t=[]:n>2&&ao(t[0],t[1],t[2])&&(t=[t[0]]),Rr(e,or(t,1),[])})),gs=Xt||function(){return Ve.Date.now()};function ms(e,t,n){return t=n?void 0:t,Ui(e,128,void 0,void 0,void 0,void 0,t=e&&null==t?e.length:t)}function vs(e,t){var n;if("function"!=typeof t)throw new _e(o);return e=ra(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=void 0),n}}var _s=Fr((function(e,t,n){var r=1;if(n.length){var i=Ht(n,Yi(_s));r|=32}return Ui(e,r,t,n,i)})),ys=Fr((function(e,t,n){var r=3;if(n.length){var i=Ht(n,Yi(ys));r|=32}return Ui(t,r,e,n,i)}));function bs(e,t,n){var r,i,s,a,c,u,d=0,l=!1,f=!1,h=!0;if("function"!=typeof e)throw new _e(o);function p(t){var n=r,o=i;return r=i=void 0,d=t,a=e.apply(o,n)}function g(e){return d=e,c=bo(v,t),l?p(e):a}function m(e){var n=e-u;return void 0===u||n>=t||n<0||f&&e-d>=s}function v(){var e=gs();if(m(e))return _(e);c=bo(v,function(e){var n=t-(e-u);return f?an(n,s-(e-d)):n}(e))}function _(e){return c=void 0,h&&r?p(e):(r=i=void 0,a)}function y(){var e=gs(),n=m(e);if(r=arguments,i=this,u=e,n){if(void 0===c)return g(u);if(f)return di(c),c=bo(v,t),p(u)}return void 0===c&&(c=bo(v,t)),a}return t=oa(t)||0,qs(n)&&(l=!!n.leading,s=(f="maxWait"in n)?sn(oa(n.maxWait)||0,t):s,h="trailing"in n?!!n.trailing:h),y.cancel=function(){void 0!==c&&di(c),d=0,r=u=i=c=void 0},y.flush=function(){return void 0===c?a:_(gs())},y}var ws=Fr((function(e,t){return Kn(e,1,t)})),Ss=Fr((function(e,t,n){return Kn(e,oa(t)||0,n)}));function xs(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new _e(o);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(xs.Cache||Dn),n}function Es(e){if("function"!=typeof e)throw new _e(o);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}xs.Cache=Dn;var As=ci((function(e,t){var n=(t=1==t.length&&Ms(t[0])?ht(t[0],Ct(Xi())):ht(or(t,1),Ct(Xi()))).length;return Fr((function(r){for(var i=-1,o=an(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return ot(e,this,r)}))})),Ns=Fr((function(e,t){return Ui(e,32,void 0,t,Ht(t,Yi(Ns)))})),Os=Fr((function(e,t){return Ui(e,64,void 0,t,Ht(t,Yi(Os)))})),js=$i((function(e,t){return Ui(e,256,void 0,void 0,void 0,t)}));function Ts(e,t){return e===t||e!=e&&t!=t}var Cs=ki(pr),Is=ki((function(e,t){return e>=t})),Rs=yr(function(){return arguments}())?yr:function(e){return $s(e)&&Ee.call(e,"callee")&&!Ge.call(e,"callee")},Ms=r.isArray,ks=Ze?Ct(Ze):function(e){return $s(e)&&hr(e)==x};function Ds(e){return null!=e&&Hs(e.length)&&!zs(e)}function Ps(e){return $s(e)&&Ds(e)}var Ls=tn||oc,Fs=et?Ct(et):function(e){return $s(e)&&hr(e)==l};function Us(e){if(!$s(e))return!1;var t=hr(e);return t==f||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!Vs(e)}function zs(e){if(!qs(e))return!1;var t=hr(e);return t==h||t==p||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Bs(e){return"number"==typeof e&&e==ra(e)}function Hs(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function qs(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function $s(e){return null!=e&&"object"==typeof e}var Ws=tt?Ct(tt):function(e){return $s(e)&&no(e)==g};function Js(e){return"number"==typeof e||$s(e)&&hr(e)==m}function Vs(e){if(!$s(e)||hr(e)!=v)return!1;var t=We(e);if(null===t)return!0;var n=Ee.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&xe.call(n)==je}var Gs=nt?Ct(nt):function(e){return $s(e)&&hr(e)==_};var Ys=rt?Ct(rt):function(e){return $s(e)&&no(e)==y};function Xs(e){return"string"==typeof e||!Ms(e)&&$s(e)&&hr(e)==b}function Qs(e){return"symbol"==typeof e||$s(e)&&hr(e)==w}var Ks=it?Ct(it):function(e){return $s(e)&&Hs(e.length)&&!!ze[hr(e)]};var Zs=ki(Nr),ea=ki((function(e,t){return e<=t}));function ta(e){if(!e)return[];if(Ds(e))return Xs(e)?Jt(e):vi(e);if(Ke&&e[Ke])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Ke]());var t=no(e);return(t==g?zt:t==y?qt:Ta)(e)}function na(e){return e?(e=oa(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function ra(e){var t=na(e),n=t%1;return t==t?n?t-n:t:0}function ia(e){return e?Yn(ra(e),0,4294967295):0}function oa(e){if("number"==typeof e)return e;if(Qs(e))return NaN;if(qs(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=qs(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(G,"");var n=oe.test(e);return n||ae.test(e)?$e(e.slice(2),n?2:8):ie.test(e)?NaN:+e}function sa(e){return _i(e,wa(e))}function aa(e){return null==e?"":Qr(e)}var ca=bi((function(e,t){if(fo(t)||Ds(t))_i(t,ba(t),e);else for(var n in t)Ee.call(t,n)&&qn(e,n,t[n])})),ua=bi((function(e,t){_i(t,wa(t),e)})),da=bi((function(e,t,n,r){_i(t,wa(t),e,r)})),la=bi((function(e,t,n,r){_i(t,ba(t),e,r)})),fa=$i(Gn);var ha=Fr((function(e,t){e=ge(e);var n=-1,r=t.length,i=r>2?t[2]:void 0;for(i&&ao(t[0],t[1],i)&&(r=1);++n<r;)for(var o=t[n],s=wa(o),a=-1,c=s.length;++a<c;){var u=s[a],d=e[u];(void 0===d||Ts(d,we[u])&&!Ee.call(e,u))&&(e[u]=o[u])}return e})),pa=Fr((function(e){return e.push(void 0,Bi),ot(xa,void 0,e)}));function ga(e,t,n){var r=null==e?void 0:lr(e,t);return void 0===r?n:r}function ma(e,t){return null!=e&&ro(e,t,mr)}var va=Ti((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Oe.call(t)),e[t]=n}),qa(Ja)),_a=Ti((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Oe.call(t)),Ee.call(e,t)?e[t].push(n):e[t]=[n]}),Xi),ya=Fr(_r);function ba(e){return Ds(e)?Fn(e):Er(e)}function wa(e){return Ds(e)?Fn(e,!0):Ar(e)}var Sa=bi((function(e,t,n){Cr(e,t,n)})),xa=bi((function(e,t,n,r){Cr(e,t,n,r)})),Ea=$i((function(e,t){var n={};if(null==e)return n;var r=!1;t=ht(t,(function(t){return t=ai(t,e),r||(r=t.length>1),t})),_i(e,Ji(e),n),r&&(n=Xn(n,7,Hi));for(var i=t.length;i--;)Zr(n,t[i]);return n}));var Aa=$i((function(e,t){return null==e?{}:function(e,t){return Mr(e,t,(function(t,n){return ma(e,n)}))}(e,t)}));function Na(e,t){if(null==e)return{};var n=ht(Ji(e),(function(e){return[e]}));return t=Xi(t),Mr(e,n,(function(e,n){return t(e,n[0])}))}var Oa=Fi(ba),ja=Fi(wa);function Ta(e){return null==e?[]:It(e,ba(e))}var Ca=Ei((function(e,t,n){return t=t.toLowerCase(),e+(n?Ia(t):t)}));function Ia(e){return Ua(aa(e).toLowerCase())}function Ra(e){return(e=aa(e))&&e.replace(ue,Pt).replace(Me,"")}var Ma=Ei((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),ka=Ei((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Da=xi("toLowerCase");var Pa=Ei((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));var La=Ei((function(e,t,n){return e+(n?" ":"")+Ua(t)}));var Fa=Ei((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Ua=xi("toUpperCase");function za(e,t,n){return e=aa(e),void 0===(t=n?void 0:t)?function(e){return Le.test(e)}(e)?function(e){return e.match(De)||[]}(e):function(e){return e.match(ee)||[]}(e):e.match(t)||[]}var Ba=Fr((function(e,t){try{return ot(e,void 0,t)}catch(e){return Us(e)?e:new fe(e)}})),Ha=$i((function(e,t){return at(t,(function(t){t=No(t),Vn(e,t,_s(e[t],e))})),e}));function qa(e){return function(){return e}}var $a=Oi(),Wa=Oi(!0);function Ja(e){return e}function Va(e){return xr("function"==typeof e?e:Xn(e,1))}var Ga=Fr((function(e,t){return function(n){return _r(n,e,t)}})),Ya=Fr((function(e,t){return function(n){return _r(e,n,t)}}));function Xa(e,t,n){var r=ba(t),i=dr(t,r);null!=n||qs(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=dr(t,ba(t)));var o=!(qs(n)&&"chain"in n&&!n.chain),s=zs(e);return at(i,(function(n){var r=t[n];e[n]=r,s&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__),i=n.__actions__=vi(this.__actions__);return i.push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,pt([this.value()],arguments))})})),e}function Qa(){}var Ka=Ii(ht),Za=Ii(ut),ec=Ii(vt);function tc(e){return co(e)?At(No(e)):function(e){return function(t){return lr(t,e)}}(e)}var nc=Mi(),rc=Mi(!0);function ic(){return[]}function oc(){return!1}var sc=Ci((function(e,t){return e+t}),0),ac=Pi("ceil"),cc=Ci((function(e,t){return e/t}),1),uc=Pi("floor");var dc,lc=Ci((function(e,t){return e*t}),1),fc=Pi("round"),hc=Ci((function(e,t){return e-t}),0);return jn.after=function(e,t){if("function"!=typeof t)throw new _e(o);return e=ra(e),function(){if(--e<1)return t.apply(this,arguments)}},jn.ary=ms,jn.assign=ca,jn.assignIn=ua,jn.assignInWith=da,jn.assignWith=la,jn.at=fa,jn.before=vs,jn.bind=_s,jn.bindAll=Ha,jn.bindKey=ys,jn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Ms(e)?e:[e]},jn.chain=ts,jn.chunk=function(e,t,n){t=(n?ao(e,t,n):void 0===t)?1:sn(ra(t),0);var i=null==e?0:e.length;if(!i||t<1)return[];for(var o=0,s=0,a=r(Kt(i/t));o<i;)a[s++]=Wr(e,o,o+=t);return a},jn.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},jn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=r(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return pt(Ms(n)?vi(n):[n],or(t,1))},jn.cond=function(e){var t=null==e?0:e.length,n=Xi();return e=t?ht(e,(function(e){if("function"!=typeof e[1])throw new _e(o);return[n(e[0]),e[1]]})):[],Fr((function(n){for(var r=-1;++r<t;){var i=e[r];if(ot(i[0],this,n))return ot(i[1],this,n)}}))},jn.conforms=function(e){return function(e){var t=ba(e);return function(n){return Qn(n,e,t)}}(Xn(e,1))},jn.constant=qa,jn.countBy=is,jn.create=function(e,t){var n=Tn(e);return null==t?n:Jn(n,t)},jn.curry=function e(t,n,r){var i=Ui(t,8,void 0,void 0,void 0,void 0,void 0,n=r?void 0:n);return i.placeholder=e.placeholder,i},jn.curryRight=function e(t,n,r){var i=Ui(t,16,void 0,void 0,void 0,void 0,void 0,n=r?void 0:n);return i.placeholder=e.placeholder,i},jn.debounce=bs,jn.defaults=ha,jn.defaultsDeep=pa,jn.defer=ws,jn.delay=Ss,jn.difference=To,jn.differenceBy=Co,jn.differenceWith=Io,jn.drop=function(e,t,n){var r=null==e?0:e.length;return r?Wr(e,(t=n||void 0===t?1:ra(t))<0?0:t,r):[]},jn.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?Wr(e,0,(t=r-(t=n||void 0===t?1:ra(t)))<0?0:t):[]},jn.dropRightWhile=function(e,t){return e&&e.length?ti(e,Xi(t,3),!0,!0):[]},jn.dropWhile=function(e,t){return e&&e.length?ti(e,Xi(t,3),!0):[]},jn.fill=function(e,t,n,r){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&ao(e,t,n)&&(n=0,r=i),function(e,t,n,r){var i=e.length;for((n=ra(n))<0&&(n=-n>i?0:i+n),(r=void 0===r||r>i?i:ra(r))<0&&(r+=i),r=n>r?0:ia(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},jn.filter=function(e,t){return(Ms(e)?dt:ir)(e,Xi(t,3))},jn.flatMap=function(e,t){return or(fs(e,t),1)},jn.flatMapDeep=function(e,t){return or(fs(e,t),1/0)},jn.flatMapDepth=function(e,t,n){return n=void 0===n?1:ra(n),or(fs(e,t),n)},jn.flatten=ko,jn.flattenDeep=function(e){return(null==e?0:e.length)?or(e,1/0):[]},jn.flattenDepth=function(e,t){return(null==e?0:e.length)?or(e,t=void 0===t?1:ra(t)):[]},jn.flip=function(e){return Ui(e,512)},jn.flow=$a,jn.flowRight=Wa,jn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},jn.functions=function(e){return null==e?[]:dr(e,ba(e))},jn.functionsIn=function(e){return null==e?[]:dr(e,wa(e))},jn.groupBy=us,jn.initial=function(e){return(null==e?0:e.length)?Wr(e,0,-1):[]},jn.intersection=Po,jn.intersectionBy=Lo,jn.intersectionWith=Fo,jn.invert=va,jn.invertBy=_a,jn.invokeMap=ds,jn.iteratee=Va,jn.keyBy=ls,jn.keys=ba,jn.keysIn=wa,jn.map=fs,jn.mapKeys=function(e,t){var n={};return t=Xi(t,3),cr(e,(function(e,r,i){Vn(n,t(e,r,i),e)})),n},jn.mapValues=function(e,t){var n={};return t=Xi(t,3),cr(e,(function(e,r,i){Vn(n,r,t(e,r,i))})),n},jn.matches=function(e){return jr(Xn(e,1))},jn.matchesProperty=function(e,t){return Tr(e,Xn(t,1))},jn.memoize=xs,jn.merge=Sa,jn.mergeWith=xa,jn.method=Ga,jn.methodOf=Ya,jn.mixin=Xa,jn.negate=Es,jn.nthArg=function(e){return e=ra(e),Fr((function(t){return Ir(t,e)}))},jn.omit=Ea,jn.omitBy=function(e,t){return Na(e,Es(Xi(t)))},jn.once=function(e){return vs(2,e)},jn.orderBy=function(e,t,n,r){return null==e?[]:(Ms(t)||(t=null==t?[]:[t]),Ms(n=r?void 0:n)||(n=null==n?[]:[n]),Rr(e,t,n))},jn.over=Ka,jn.overArgs=As,jn.overEvery=Za,jn.overSome=ec,jn.partial=Ns,jn.partialRight=Os,jn.partition=hs,jn.pick=Aa,jn.pickBy=Na,jn.property=tc,jn.propertyOf=function(e){return function(t){return null==e?void 0:lr(e,t)}},jn.pull=zo,jn.pullAll=Bo,jn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?kr(e,t,Xi(n,2)):e},jn.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?kr(e,t,void 0,n):e},jn.pullAt=Ho,jn.range=nc,jn.rangeRight=rc,jn.rearg=js,jn.reject=function(e,t){return(Ms(e)?dt:ir)(e,Es(Xi(t,3)))},jn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=Xi(t,3);++r<o;){var s=e[r];t(s,r,e)&&(n.push(s),i.push(r))}return Dr(e,i),n},jn.rest=function(e,t){if("function"!=typeof e)throw new _e(o);return Fr(e,t=void 0===t?t:ra(t))},jn.reverse=qo,jn.sampleSize=function(e,t,n){return t=(n?ao(e,t,n):void 0===t)?1:ra(t),(Ms(e)?zn:zr)(e,t)},jn.set=function(e,t,n){return null==e?e:Br(e,t,n)},jn.setWith=function(e,t,n,r){return r="function"==typeof r?r:void 0,null==e?e:Br(e,t,n,r)},jn.shuffle=function(e){return(Ms(e)?Bn:$r)(e)},jn.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&ao(e,t,n)?(t=0,n=r):(t=null==t?0:ra(t),n=void 0===n?r:ra(n)),Wr(e,t,n)):[]},jn.sortBy=ps,jn.sortedUniq=function(e){return e&&e.length?Yr(e):[]},jn.sortedUniqBy=function(e,t){return e&&e.length?Yr(e,Xi(t,2)):[]},jn.split=function(e,t,n){return n&&"number"!=typeof n&&ao(e,t,n)&&(t=n=void 0),(n=void 0===n?4294967295:n>>>0)?(e=aa(e))&&("string"==typeof t||null!=t&&!Gs(t))&&!(t=Qr(t))&&Ut(e)?ui(Jt(e),0,n):e.split(t,n):[]},jn.spread=function(e,t){if("function"!=typeof e)throw new _e(o);return t=null==t?0:sn(ra(t),0),Fr((function(n){var r=n[t],i=ui(n,0,t);return r&&pt(i,r),ot(e,this,i)}))},jn.tail=function(e){var t=null==e?0:e.length;return t?Wr(e,1,t):[]},jn.take=function(e,t,n){return e&&e.length?Wr(e,0,(t=n||void 0===t?1:ra(t))<0?0:t):[]},jn.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?Wr(e,(t=r-(t=n||void 0===t?1:ra(t)))<0?0:t,r):[]},jn.takeRightWhile=function(e,t){return e&&e.length?ti(e,Xi(t,3),!1,!0):[]},jn.takeWhile=function(e,t){return e&&e.length?ti(e,Xi(t,3)):[]},jn.tap=function(e,t){return t(e),e},jn.throttle=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new _e(o);return qs(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),bs(e,t,{leading:r,maxWait:t,trailing:i})},jn.thru=ns,jn.toArray=ta,jn.toPairs=Oa,jn.toPairsIn=ja,jn.toPath=function(e){return Ms(e)?ht(e,No):Qs(e)?[e]:vi(Ao(aa(e)))},jn.toPlainObject=sa,jn.transform=function(e,t,n){var r=Ms(e),i=r||Ls(e)||Ks(e);if(t=Xi(t,4),null==n){var o=e&&e.constructor;n=i?r?new o:[]:qs(e)&&zs(o)?Tn(We(e)):{}}return(i?at:cr)(e,(function(e,r,i){return t(n,e,r,i)})),n},jn.unary=function(e){return ms(e,1)},jn.union=$o,jn.unionBy=Wo,jn.unionWith=Jo,jn.uniq=function(e){return e&&e.length?Kr(e):[]},jn.uniqBy=function(e,t){return e&&e.length?Kr(e,Xi(t,2)):[]},jn.uniqWith=function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?Kr(e,void 0,t):[]},jn.unset=function(e,t){return null==e||Zr(e,t)},jn.unzip=Vo,jn.unzipWith=Go,jn.update=function(e,t,n){return null==e?e:ei(e,t,si(n))},jn.updateWith=function(e,t,n,r){return r="function"==typeof r?r:void 0,null==e?e:ei(e,t,si(n),r)},jn.values=Ta,jn.valuesIn=function(e){return null==e?[]:It(e,wa(e))},jn.without=Yo,jn.words=za,jn.wrap=function(e,t){return Ns(si(t),e)},jn.xor=Xo,jn.xorBy=Qo,jn.xorWith=Ko,jn.zip=Zo,jn.zipObject=function(e,t){return ii(e||[],t||[],qn)},jn.zipObjectDeep=function(e,t){return ii(e||[],t||[],Br)},jn.zipWith=es,jn.entries=Oa,jn.entriesIn=ja,jn.extend=ua,jn.extendWith=da,Xa(jn,jn),jn.add=sc,jn.attempt=Ba,jn.camelCase=Ca,jn.capitalize=Ia,jn.ceil=ac,jn.clamp=function(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=oa(n))==n?n:0),void 0!==t&&(t=(t=oa(t))==t?t:0),Yn(oa(e),t,n)},jn.clone=function(e){return Xn(e,4)},jn.cloneDeep=function(e){return Xn(e,5)},jn.cloneDeepWith=function(e,t){return Xn(e,5,t="function"==typeof t?t:void 0)},jn.cloneWith=function(e,t){return Xn(e,4,t="function"==typeof t?t:void 0)},jn.conformsTo=function(e,t){return null==t||Qn(e,t,ba(t))},jn.deburr=Ra,jn.defaultTo=function(e,t){return null==e||e!=e?t:e},jn.divide=cc,jn.endsWith=function(e,t,n){e=aa(e),t=Qr(t);var r=e.length,i=n=void 0===n?r:Yn(ra(n),0,r);return(n-=t.length)>=0&&e.slice(n,i)==t},jn.eq=Ts,jn.escape=function(e){return(e=aa(e))&&U.test(e)?e.replace(L,Lt):e},jn.escapeRegExp=function(e){return(e=aa(e))&&V.test(e)?e.replace(J,"\\$&"):e},jn.every=function(e,t,n){var r=Ms(e)?ut:nr;return n&&ao(e,t,n)&&(t=void 0),r(e,Xi(t,3))},jn.find=os,jn.findIndex=Ro,jn.findKey=function(e,t){return yt(e,Xi(t,3),cr)},jn.findLast=ss,jn.findLastIndex=Mo,jn.findLastKey=function(e,t){return yt(e,Xi(t,3),ur)},jn.floor=uc,jn.forEach=as,jn.forEachRight=cs,jn.forIn=function(e,t){return null==e?e:sr(e,Xi(t,3),wa)},jn.forInRight=function(e,t){return null==e?e:ar(e,Xi(t,3),wa)},jn.forOwn=function(e,t){return e&&cr(e,Xi(t,3))},jn.forOwnRight=function(e,t){return e&&ur(e,Xi(t,3))},jn.get=ga,jn.gt=Cs,jn.gte=Is,jn.has=function(e,t){return null!=e&&ro(e,t,gr)},jn.hasIn=ma,jn.head=Do,jn.identity=Ja,jn.includes=function(e,t,n,r){e=Ds(e)?e:Ta(e),n=n&&!r?ra(n):0;var i=e.length;return n<0&&(n=sn(i+n,0)),Xs(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&wt(e,t,n)>-1},jn.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:ra(n);return i<0&&(i=sn(r+i,0)),wt(e,t,i)},jn.inRange=function(e,t,n){return t=na(t),void 0===n?(n=t,t=0):n=na(n),function(e,t,n){return e>=an(t,n)&&e<sn(t,n)}(e=oa(e),t,n)},jn.invoke=ya,jn.isArguments=Rs,jn.isArray=Ms,jn.isArrayBuffer=ks,jn.isArrayLike=Ds,jn.isArrayLikeObject=Ps,jn.isBoolean=function(e){return!0===e||!1===e||$s(e)&&hr(e)==d},jn.isBuffer=Ls,jn.isDate=Fs,jn.isElement=function(e){return $s(e)&&1===e.nodeType&&!Vs(e)},jn.isEmpty=function(e){if(null==e)return!0;if(Ds(e)&&(Ms(e)||"string"==typeof e||"function"==typeof e.splice||Ls(e)||Ks(e)||Rs(e)))return!e.length;var t=no(e);if(t==g||t==y)return!e.size;if(fo(e))return!Er(e).length;for(var n in e)if(Ee.call(e,n))return!1;return!0},jn.isEqual=function(e,t){return br(e,t)},jn.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:void 0)?n(e,t):void 0;return void 0===r?br(e,t,void 0,n):!!r},jn.isError=Us,jn.isFinite=function(e){return"number"==typeof e&&nn(e)},jn.isFunction=zs,jn.isInteger=Bs,jn.isLength=Hs,jn.isMap=Ws,jn.isMatch=function(e,t){return e===t||wr(e,t,Ki(t))},jn.isMatchWith=function(e,t,n){return n="function"==typeof n?n:void 0,wr(e,t,Ki(t),n)},jn.isNaN=function(e){return Js(e)&&e!=+e},jn.isNative=function(e){if(lo(e))throw new fe("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Sr(e)},jn.isNil=function(e){return null==e},jn.isNull=function(e){return null===e},jn.isNumber=Js,jn.isObject=qs,jn.isObjectLike=$s,jn.isPlainObject=Vs,jn.isRegExp=Gs,jn.isSafeInteger=function(e){return Bs(e)&&e>=-9007199254740991&&e<=9007199254740991},jn.isSet=Ys,jn.isString=Xs,jn.isSymbol=Qs,jn.isTypedArray=Ks,jn.isUndefined=function(e){return void 0===e},jn.isWeakMap=function(e){return $s(e)&&no(e)==S},jn.isWeakSet=function(e){return $s(e)&&"[object WeakSet]"==hr(e)},jn.join=function(e,t){return null==e?"":rn.call(e,t)},jn.kebabCase=Ma,jn.last=Uo,jn.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r;return void 0!==n&&(i=(i=ra(n))<0?sn(r+i,0):an(i,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,i):bt(e,xt,i,!0)},jn.lowerCase=ka,jn.lowerFirst=Da,jn.lt=Zs,jn.lte=ea,jn.max=function(e){return e&&e.length?rr(e,Ja,pr):void 0},jn.maxBy=function(e,t){return e&&e.length?rr(e,Xi(t,2),pr):void 0},jn.mean=function(e){return Et(e,Ja)},jn.meanBy=function(e,t){return Et(e,Xi(t,2))},jn.min=function(e){return e&&e.length?rr(e,Ja,Nr):void 0},jn.minBy=function(e,t){return e&&e.length?rr(e,Xi(t,2),Nr):void 0},jn.stubArray=ic,jn.stubFalse=oc,jn.stubObject=function(){return{}},jn.stubString=function(){return""},jn.stubTrue=function(){return!0},jn.multiply=lc,jn.nth=function(e,t){return e&&e.length?Ir(e,ra(t)):void 0},jn.noConflict=function(){return Ve._===this&&(Ve._=Te),this},jn.noop=Qa,jn.now=gs,jn.pad=function(e,t,n){e=aa(e);var r=(t=ra(t))?Wt(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return Ri(Zt(i),n)+e+Ri(Kt(i),n)},jn.padEnd=function(e,t,n){e=aa(e);var r=(t=ra(t))?Wt(e):0;return t&&r<t?e+Ri(t-r,n):e},jn.padStart=function(e,t,n){e=aa(e);var r=(t=ra(t))?Wt(e):0;return t&&r<t?Ri(t-r,n)+e:e},jn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),un(aa(e).replace(Y,""),t||0)},jn.random=function(e,t,n){if(n&&"boolean"!=typeof n&&ao(e,t,n)&&(t=n=void 0),void 0===n&&("boolean"==typeof t?(n=t,t=void 0):"boolean"==typeof e&&(n=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=na(e),void 0===t?(t=e,e=0):t=na(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var i=dn();return an(e+i*(t-e+qe("1e-"+((i+"").length-1))),t)}return Pr(e,t)},jn.reduce=function(e,t,n){var r=Ms(e)?gt:Ot,i=arguments.length<3;return r(e,Xi(t,4),n,i,er)},jn.reduceRight=function(e,t,n){var r=Ms(e)?mt:Ot,i=arguments.length<3;return r(e,Xi(t,4),n,i,tr)},jn.repeat=function(e,t,n){return t=(n?ao(e,t,n):void 0===t)?1:ra(t),Lr(aa(e),t)},jn.replace=function(){var e=arguments,t=aa(e[0]);return e.length<3?t:t.replace(e[1],e[2])},jn.result=function(e,t,n){var r=-1,i=(t=ai(t,e)).length;for(i||(i=1,e=void 0);++r<i;){var o=null==e?void 0:e[No(t[r])];void 0===o&&(r=i,o=n),e=zs(o)?o.call(e):o}return e},jn.round=fc,jn.runInContext=e,jn.sample=function(e){return(Ms(e)?Un:Ur)(e)},jn.size=function(e){if(null==e)return 0;if(Ds(e))return Xs(e)?Wt(e):e.length;var t=no(e);return t==g||t==y?e.size:Er(e).length},jn.snakeCase=Pa,jn.some=function(e,t,n){var r=Ms(e)?vt:Jr;return n&&ao(e,t,n)&&(t=void 0),r(e,Xi(t,3))},jn.sortedIndex=function(e,t){return Vr(e,t)},jn.sortedIndexBy=function(e,t,n){return Gr(e,t,Xi(n,2))},jn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=Vr(e,t);if(r<n&&Ts(e[r],t))return r}return-1},jn.sortedLastIndex=function(e,t){return Vr(e,t,!0)},jn.sortedLastIndexBy=function(e,t,n){return Gr(e,t,Xi(n,2),!0)},jn.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var n=Vr(e,t,!0)-1;if(Ts(e[n],t))return n}return-1},jn.startCase=La,jn.startsWith=function(e,t,n){return e=aa(e),n=null==n?0:Yn(ra(n),0,e.length),t=Qr(t),e.slice(n,n+t.length)==t},jn.subtract=hc,jn.sum=function(e){return e&&e.length?jt(e,Ja):0},jn.sumBy=function(e,t){return e&&e.length?jt(e,Xi(t,2)):0},jn.template=function(e,t,n){var r=jn.templateSettings;n&&ao(e,t,n)&&(t=void 0),e=aa(e),t=da({},t,r,zi);var i,o,s=da({},t.imports,r.imports,zi),a=ba(s),c=It(s,a),u=0,d=t.interpolate||de,l="__p += '",f=me((t.escape||de).source+"|"+d.source+"|"+(d===H?ne:de).source+"|"+(t.evaluate||de).source+"|$","g"),h="//# sourceURL="+(Ee.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ue+"]")+"\n";e.replace(f,(function(t,n,r,s,a,c){return r||(r=s),l+=e.slice(u,c).replace(le,Ft),n&&(i=!0,l+="' +\n__e("+n+") +\n'"),a&&(o=!0,l+="';\n"+a+";\n__p += '"),r&&(l+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=c+t.length,t})),l+="';\n";var p=Ee.call(t,"variable")&&t.variable;p||(l="with (obj) {\n"+l+"\n}\n"),l=(o?l.replace(M,""):l).replace(k,"$1").replace(D,"$1;"),l="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+l+"return __p\n}";var g=Ba((function(){return he(a,h+"return "+l).apply(void 0,c)}));if(g.source=l,Us(g))throw g;return g},jn.times=function(e,t){if((e=ra(e))<1||e>9007199254740991)return[];var n=4294967295,r=an(e,4294967295);e-=4294967295;for(var i=Tt(r,t=Xi(t));++n<e;)t(n);return i},jn.toFinite=na,jn.toInteger=ra,jn.toLength=ia,jn.toLower=function(e){return aa(e).toLowerCase()},jn.toNumber=oa,jn.toSafeInteger=function(e){return e?Yn(ra(e),-9007199254740991,9007199254740991):0===e?e:0},jn.toString=aa,jn.toUpper=function(e){return aa(e).toUpperCase()},jn.trim=function(e,t,n){if((e=aa(e))&&(n||void 0===t))return e.replace(G,"");if(!e||!(t=Qr(t)))return e;var r=Jt(e),i=Jt(t);return ui(r,Mt(r,i),kt(r,i)+1).join("")},jn.trimEnd=function(e,t,n){if((e=aa(e))&&(n||void 0===t))return e.replace(X,"");if(!e||!(t=Qr(t)))return e;var r=Jt(e);return ui(r,0,kt(r,Jt(t))+1).join("")},jn.trimStart=function(e,t,n){if((e=aa(e))&&(n||void 0===t))return e.replace(Y,"");if(!e||!(t=Qr(t)))return e;var r=Jt(e);return ui(r,Mt(r,Jt(t))).join("")},jn.truncate=function(e,t){var n=30,r="...";if(qs(t)){var i="separator"in t?t.separator:i;n="length"in t?ra(t.length):n,r="omission"in t?Qr(t.omission):r}var o=(e=aa(e)).length;if(Ut(e)){var s=Jt(e);o=s.length}if(n>=o)return e;var a=n-Wt(r);if(a<1)return r;var c=s?ui(s,0,a).join(""):e.slice(0,a);if(void 0===i)return c+r;if(s&&(a+=c.length-a),Gs(i)){if(e.slice(a).search(i)){var u,d=c;for(i.global||(i=me(i.source,aa(re.exec(i))+"g")),i.lastIndex=0;u=i.exec(d);)var l=u.index;c=c.slice(0,void 0===l?a:l)}}else if(e.indexOf(Qr(i),a)!=a){var f=c.lastIndexOf(i);f>-1&&(c=c.slice(0,f))}return c+r},jn.unescape=function(e){return(e=aa(e))&&F.test(e)?e.replace(P,Vt):e},jn.uniqueId=function(e){var t=++Ae;return aa(e)+t},jn.upperCase=Fa,jn.upperFirst=Ua,jn.each=as,jn.eachRight=cs,jn.first=Do,Xa(jn,(dc={},cr(jn,(function(e,t){Ee.call(jn.prototype,t)||(dc[t]=e)})),dc),{chain:!1}),jn.VERSION="4.17.20",at(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){jn[e].placeholder=jn})),at(["drop","take"],(function(e,t){Rn.prototype[e]=function(n){n=void 0===n?1:sn(ra(n),0);var r=this.__filtered__&&!t?new Rn(this):this.clone();return r.__filtered__?r.__takeCount__=an(n,r.__takeCount__):r.__views__.push({size:an(n,4294967295),type:e+(r.__dir__<0?"Right":"")}),r},Rn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),at(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;Rn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:Xi(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),at(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Rn.prototype[e]=function(){return this[n](1).value()[0]}})),at(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Rn.prototype[e]=function(){return this.__filtered__?new Rn(this):this[n](1)}})),Rn.prototype.compact=function(){return this.filter(Ja)},Rn.prototype.find=function(e){return this.filter(e).head()},Rn.prototype.findLast=function(e){return this.reverse().find(e)},Rn.prototype.invokeMap=Fr((function(e,t){return"function"==typeof e?new Rn(this):this.map((function(n){return _r(n,e,t)}))})),Rn.prototype.reject=function(e){return this.filter(Es(Xi(e)))},Rn.prototype.slice=function(e,t){e=ra(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Rn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),void 0!==t&&(n=(t=ra(t))<0?n.dropRight(-t):n.take(t-e)),n)},Rn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Rn.prototype.toArray=function(){return this.take(4294967295)},cr(Rn.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),i=jn[r?"take"+("last"==t?"Right":""):t],o=r||/^find/.test(t);i&&(jn.prototype[t]=function(){var t=this.__wrapped__,s=r?[1]:arguments,a=t instanceof Rn,c=s[0],u=a||Ms(t),d=function(e){var t=i.apply(jn,pt([e],s));return r&&l?t[0]:t};u&&n&&"function"==typeof c&&1!=c.length&&(a=u=!1);var l=this.__chain__,f=!!this.__actions__.length,h=o&&!l,p=a&&!f;if(!o&&u){t=p?t:new Rn(this);var g=e.apply(t,s);return g.__actions__.push({func:ns,args:[d],thisArg:void 0}),new In(g,l)}return h&&p?e.apply(this,s):(g=this.thru(d),h?r?g.value()[0]:g.value():g)})})),at(["pop","push","shift","sort","splice","unshift"],(function(e){var t=ye[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);jn.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(Ms(i)?i:[],e)}return this[n]((function(n){return t.apply(Ms(n)?n:[],e)}))}})),cr(Rn.prototype,(function(e,t){var n=jn[t];if(n){var r=n.name+"";Ee.call(yn,r)||(yn[r]=[]),yn[r].push({name:t,func:n})}})),yn[ji(void 0,2).name]=[{name:"wrapper",func:void 0}],Rn.prototype.clone=function(){var e=new Rn(this.__wrapped__);return e.__actions__=vi(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=vi(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=vi(this.__views__),e},Rn.prototype.reverse=function(){if(this.__filtered__){var e=new Rn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Rn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Ms(e),r=t<0,i=n?e.length:0,o=function(e,t,n){var r=-1,i=n.length;for(;++r<i;){var o=n[r],s=o.size;switch(o.type){case"drop":e+=s;break;case"dropRight":t-=s;break;case"take":t=an(t,e+s);break;case"takeRight":e=sn(e,t-s)}}return{start:e,end:t}}(0,i,this.__views__),s=o.start,a=o.end,c=a-s,u=r?a:s-1,d=this.__iteratees__,l=d.length,f=0,h=an(c,this.__takeCount__);if(!n||!r&&i==c&&h==c)return ni(e,this.__actions__);var p=[];e:for(;c--&&f<h;){for(var g=-1,m=e[u+=t];++g<l;){var v=d[g],_=v.iteratee,y=v.type,b=_(m);if(2==y)m=b;else if(!b){if(1==y)continue e;break e}}p[f++]=m}return p},jn.prototype.at=rs,jn.prototype.chain=function(){return ts(this)},jn.prototype.commit=function(){return new In(this.value(),this.__chain__)},jn.prototype.next=function(){void 0===this.__values__&&(this.__values__=ta(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?void 0:this.__values__[this.__index__++]}},jn.prototype.plant=function(e){for(var t,n=this;n instanceof Cn;){var r=jo(n);r.__index__=0,r.__values__=void 0,t?i.__wrapped__=r:t=r;var i=r;n=n.__wrapped__}return i.__wrapped__=e,t},jn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Rn){var t=e;return this.__actions__.length&&(t=new Rn(this)),(t=t.reverse()).__actions__.push({func:ns,args:[qo],thisArg:void 0}),new In(t,this.__chain__)}return this.thru(qo)},jn.prototype.toJSON=jn.prototype.valueOf=jn.prototype.value=function(){return ni(this.__wrapped__,this.__actions__)},jn.prototype.first=jn.prototype.head,Ke&&(jn.prototype[Ke]=function(){return this}),jn}();Ve._=Gt,void 0===(i=function(){return Gt}.call(t,n,t,r))||(r.exports=i)}).call(this)}).call(this,n(17),n(58)(e))},function(e,t,n){"use strict";var r=n(8),i=n(0);i.e.Websocket=class{constructor(e){this._conn=e,this.strip="wrapper";const t=e.service;if(0!==t.indexOf("ws:")&&0!==t.indexOf("wss:")){let n="";"ws"===e.options.protocol&&"https:"!==window.location.protocol?n+="ws":n+="wss",n+="://"+window.location.host,0!==t.indexOf("/")?n+=window.location.pathname+t:n+=t,e.service=n}}_buildStream(){return Object(i.a)("open",{xmlns:i.e.NS.FRAMING,to:this._conn.domain,version:"1.0"})}_checkStreamError(e,t){let n;if(n=e.getElementsByTagNameNS?e.getElementsByTagNameNS(i.e.NS.STREAM,"error"):e.getElementsByTagName("stream:error"),0===n.length)return!1;const r=n[0];let o="",s="";for(let e=0;e<r.childNodes.length;e++){const t=r.childNodes[e];if("urn:ietf:params:xml:ns:xmpp-streams"!==t.getAttribute("xmlns"))break;"text"===t.nodeName?s=t.textContent:o=t.nodeName}let a="WebSocket stream error: ";return a+=o||"unknown",s&&(a+=" - "+s),i.e.error(a),this._conn._changeConnectStatus(t,o),this._conn._doDisconnect(),!0}_reset(){}_connect(){this._closeSocket(),this.socket=new WebSocket(this._conn.service,"xmpp"),this.socket.onopen=()=>this._onOpen(),this.socket.onerror=e=>this._onError(e),this.socket.onclose=e=>this._onClose(e),this.socket.onmessage=e=>this._onInitialMessage(e)}_connect_cb(e){if(this._checkStreamError(e,i.e.Status.CONNFAIL))return i.e.Status.CONNFAIL}_handleStreamStart(e){let t=!1;const n=e.getAttribute("xmlns");"string"!=typeof n?t="Missing xmlns in <open />":n!==i.e.NS.FRAMING&&(t="Wrong xmlns in <open />: "+n);const r=e.getAttribute("version");return"string"!=typeof r?t="Missing version in <open />":"1.0"!==r&&(t="Wrong version in <open />: "+r),!t||(this._conn._changeConnectStatus(i.e.Status.CONNFAIL,t),this._conn._doDisconnect(),!1)}_onInitialMessage(e){if(0===e.data.indexOf("<open ")||0===e.data.indexOf("<?xml")){const t=e.data.replace(/^(<\?.*?\?>\s*)*/,"");if(""===t)return;const n=(new r.a).parseFromString(t,"text/xml").documentElement;this._conn.xmlInput(n),this._conn.rawInput(e.data),this._handleStreamStart(n)&&this._connect_cb(n)}else if(0===e.data.indexOf("<close ")){const t=(new r.a).parseFromString(e.data,"text/xml").documentElement;this._conn.xmlInput(t),this._conn.rawInput(e.data);const n=t.getAttribute("see-other-uri");if(n){const e=this._conn.service;(e.indexOf("wss:")>=0&&n.indexOf("wss:")>=0||e.indexOf("ws:")>=0)&&(this._conn._changeConnectStatus(i.e.Status.REDIRECT,"Received see-other-uri, resetting connection"),this._conn.reset(),this._conn.service=n,this._connect())}else this._conn._changeConnectStatus(i.e.Status.CONNFAIL,"Received closing stream"),this._conn._doDisconnect()}else{this._replaceMessageHandler();const t=this._streamWrap(e.data),n=(new r.a).parseFromString(t,"text/xml").documentElement;this._conn._connect_cb(n,null,e.data)}}_replaceMessageHandler(){this.socket.onmessage=e=>this._onMessage(e)}_disconnect(e){if(this.socket&&this.socket.readyState!==WebSocket.CLOSED){e&&this._conn.send(e);const t=Object(i.a)("close",{xmlns:i.e.NS.FRAMING});this._conn.xmlOutput(t.tree());const n=i.e.serialize(t);this._conn.rawOutput(n);try{this.socket.send(n)}catch(e){i.e.warn("Couldn't send <close /> tag.")}}this._conn._doDisconnect()}_doDisconnect(){i.e.debug("WebSockets _doDisconnect was called"),this._closeSocket()}_streamWrap(e){return"<wrapper>"+e+"</wrapper>"}_closeSocket(){if(this.socket)try{this.socket.onclose=null,this.socket.onerror=null,this.socket.onmessage=null,this.socket.close()}catch(e){i.e.debug(e.message)}this.socket=null}_emptyQueue(){return!0}_onClose(e){this._conn.connected&&!this._conn.disconnecting?(i.e.error("Websocket closed unexpectedly"),this._conn._doDisconnect()):e&&1006===e.code&&!this._conn.connected&&this.socket?(i.e.error("Websocket closed unexcectedly"),this._conn._changeConnectStatus(i.e.Status.CONNFAIL,"The WebSocket connection could not be established or was disconnected."),this._conn._doDisconnect()):i.e.debug("Websocket closed")}_no_auth_received(e){i.e.error("Server did not offer a supported authentication mechanism"),this._conn._changeConnectStatus(i.e.Status.CONNFAIL,i.e.ErrorCondition.NO_AUTH_MECH),e&&e.call(this._conn),this._conn._doDisconnect()}_onDisconnectTimeout(){}_abortAllRequests(){}_onError(e){i.e.error("Websocket error "+e),this._conn._changeConnectStatus(i.e.Status.CONNFAIL,"The WebSocket connection could not be established or was disconnected."),this._disconnect()}_onIdle(){const e=this._conn._data;if(e.length>0&&!this._conn.paused){for(let t=0;t<e.length;t++)if(null!==e[t]){let n;n="restart"===e[t]?this._buildStream().tree():e[t];const r=i.e.serialize(n);this._conn.xmlOutput(n),this._conn.rawOutput(r),this.socket.send(r)}this._conn._data=[]}}_onMessage(e){let t;const n='<close xmlns="urn:ietf:params:xml:ns:xmpp-framing" />';if(e.data===n)return this._conn.rawInput(n),this._conn.xmlInput(e),void(this._conn.disconnecting||this._conn._doDisconnect());if(0===e.data.search("<open ")){if(t=(new r.a).parseFromString(e.data,"text/xml").documentElement,!this._handleStreamStart(t))return}else{const n=this._streamWrap(e.data);t=(new r.a).parseFromString(n,"text/xml").documentElement}return this._checkStreamError(t,i.e.Status.ERROR)?void 0:this._conn.disconnecting&&"presence"===t.firstChild.nodeName&&"unavailable"===t.firstChild.getAttribute("type")?(this._conn.xmlInput(t),void this._conn.rawInput(i.e.serialize(t))):void this._conn._dataRecv(t,e.data)}_onOpen(){i.e.debug("Websocket open");const e=this._buildStream();this._conn.xmlOutput(e.tree());const t=i.e.serialize(e);this._conn.rawOutput(t),this.socket.send(t)}_reqToData(e){return e}_send(){this._conn.flush()}_sendRestart(){clearTimeout(this._conn._idleTimeout),this._conn._onIdle.bind(this._conn)()}}},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,n){var r=n(160);e.exports=function(e){var t=r(e),n=t%1;return t==t?n?t-n:t:0}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},function(e,t){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}},function(e,t,n){var r=n(13),i=Object.create,o=function(){function e(){}return function(t){if(!r(t))return{};if(i)return i(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=o},function(e,t,n){var r=n(62),i=n(64);function o(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}o.prototype=r(i.prototype),o.prototype.constructor=o,e.exports=o},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e){return e.placeholder}},function(e,t,n){var r=n(19)(n(5),"Map");e.exports=r},function(e,t,n){var r=n(225),i=n(232),o=n(234),s=n(235),a=n(236);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=s,c.prototype.set=a,e.exports=c},function(e,t,n){var r=n(47),i=n(31);e.exports=function(e,t){for(var n=0,o=(t=r(t,e)).length;null!=e&&n<o;)e=e[i(t[n++])];return n&&n==o?e:void 0}},function(e,t,n){var r=n(9),i=n(38),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!i(e))||(s.test(e)||!o.test(e)||null!=t&&e in Object(t))}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var r=n(33),i=n(6).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var r=n(285),i=n(72);e.exports=function(e){return r(i(e))}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(132)("keys"),i=n(133);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t){e.exports=!0},function(e,t,n){e.exports={default:n(293),__esModule:!0}},function(e,t,n){var r=n(32).f,i=n(50),o=n(10)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},function(e,t,n){"use strict";var r=n(49);function i(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)}e.exports.f=function(e){return new i(e)}},function(e,t,n){var r=n(194),i=n(27);e.exports=function(e){return null==e?[]:r(e,i(e))}},function(e,t,n){var r=n(98),i=n(195),o=n(65),s=n(42),a=r((function(e,t){var n=s(t,o(a));return i(e,32,void 0,t,n)}));a.placeholder={},e.exports=a},function(e,t,n){var r;!function(){"use strict";var i={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function o(e){return a(u(e),arguments)}function s(e,t){return o.apply(null,[e].concat(t||[]))}function a(e,t){var n,r,s,a,c,u,d,l,f,h=1,p=e.length,g="";for(r=0;r<p;r++)if("string"==typeof e[r])g+=e[r];else if("object"==typeof e[r]){if((a=e[r]).keys)for(n=t[h],s=0;s<a.keys.length;s++){if(null==n)throw new Error(o('[sprintf] Cannot access property "%s" of undefined value "%s"',a.keys[s],a.keys[s-1]));n=n[a.keys[s]]}else n=a.param_no?t[a.param_no]:t[h++];if(i.not_type.test(a.type)&&i.not_primitive.test(a.type)&&n instanceof Function&&(n=n()),i.numeric_arg.test(a.type)&&"number"!=typeof n&&isNaN(n))throw new TypeError(o("[sprintf] expecting number but found %T",n));switch(i.number.test(a.type)&&(l=n>=0),a.type){case"b":n=parseInt(n,10).toString(2);break;case"c":n=String.fromCharCode(parseInt(n,10));break;case"d":case"i":n=parseInt(n,10);break;case"j":n=JSON.stringify(n,null,a.width?parseInt(a.width):0);break;case"e":n=a.precision?parseFloat(n).toExponential(a.precision):parseFloat(n).toExponential();break;case"f":n=a.precision?parseFloat(n).toFixed(a.precision):parseFloat(n);break;case"g":n=a.precision?String(Number(n.toPrecision(a.precision))):parseFloat(n);break;case"o":n=(parseInt(n,10)>>>0).toString(8);break;case"s":n=String(n),n=a.precision?n.substring(0,a.precision):n;break;case"t":n=String(!!n),n=a.precision?n.substring(0,a.precision):n;break;case"T":n=Object.prototype.toString.call(n).slice(8,-1).toLowerCase(),n=a.precision?n.substring(0,a.precision):n;break;case"u":n=parseInt(n,10)>>>0;break;case"v":n=n.valueOf(),n=a.precision?n.substring(0,a.precision):n;break;case"x":n=(parseInt(n,10)>>>0).toString(16);break;case"X":n=(parseInt(n,10)>>>0).toString(16).toUpperCase()}i.json.test(a.type)?g+=n:(!i.number.test(a.type)||l&&!a.sign?f="":(f=l?"+":"-",n=n.toString().replace(i.sign,"")),u=a.pad_char?"0"===a.pad_char?"0":a.pad_char.charAt(1):" ",d=a.width-(f+n).length,c=a.width&&d>0?u.repeat(d):"",g+=a.align?f+n+c:"0"===u?f+c+n:c+f+n)}return g}var c=Object.create(null);function u(e){if(c[e])return c[e];for(var t,n=e,r=[],o=0;n;){if(null!==(t=i.text.exec(n)))r.push(t[0]);else if(null!==(t=i.modulo.exec(n)))r.push("%");else{if(null===(t=i.placeholder.exec(n)))throw new SyntaxError("[sprintf] unexpected placeholder");if(t[2]){o|=1;var s=[],a=t[2],u=[];if(null===(u=i.key.exec(a)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(s.push(u[1]);""!==(a=a.substring(u[0].length));)if(null!==(u=i.key_access.exec(a)))s.push(u[1]);else{if(null===(u=i.index_access.exec(a)))throw new SyntaxError("[sprintf] failed to parse named argument key");s.push(u[1])}t[2]=s}else o|=2;if(3===o)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");r.push({placeholder:t[0],param_no:t[1],keys:t[2],sign:t[3],pad_char:t[4],align:t[5],width:t[6],precision:t[7],type:t[8]})}n=n.substring(t[0].length)}return c[e]=r}t.sprintf=o,t.vsprintf=s,"undefined"!=typeof window&&(window.sprintf=o,window.vsprintf=s,void 0===(r=function(){return{sprintf:o,vsprintf:s}}.call(t,n,t,e))||(e.exports=r))}()},function(e,t,n){function r(e){this.options=e||{locator:{}}}function i(){this.cdata=!1}function o(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function s(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function a(e,t,n){return"string"==typeof e?e.substr(t,n):e.length>=t+n||t?new java.lang.String(e,t,n)+"":e}function c(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}r.prototype.parseFromString=function(e,t){var n=this.options,r=new u,o=n.domBuilder||new i,a=n.errorHandler,c=n.locator,d=n.xmlns||{},l={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return c&&o.setDocumentLocator(c),r.errorHandler=function(e,t,n){if(!e){if(t instanceof i)return t;e=t}var r={},o=e instanceof Function;function a(t){var i=e[t];!i&&o&&(i=2==e.length?function(n){e(t,n)}:e),r[t]=i&&function(e){i("[xmldom "+t+"]\t"+e+s(n))}||function(){}}return n=n||{},a("warning"),a("error"),a("fatalError"),r}(a,o,c),r.domBuilder=n.domBuilder||o,/\/x?html?$/.test(t)&&(l.nbsp=" ",l.copy="©",d[""]="http://www.w3.org/1999/xhtml"),d.xml=d.xml||"http://www.w3.org/XML/1998/namespace",e?r.parse(e,d,l):r.errorHandler.error("invalid doc source"),o.doc},i.prototype={startDocument:function(){this.doc=(new d).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,n,r){var i=this.doc,s=i.createElementNS(e,n||t),a=r.length;c(this,s),this.currentElement=s,this.locator&&o(this.locator,s);for(var u=0;u<a;u++){e=r.getURI(u);var d=r.getValue(u),l=(n=r.getQName(u),i.createAttributeNS(e,n));this.locator&&o(r.getLocator(u),l),l.value=l.nodeValue=d,s.setAttributeNode(l)}},endElement:function(e,t,n){var r=this.currentElement;r.tagName;this.currentElement=r.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var n=this.doc.createProcessingInstruction(e,t);this.locator&&o(this.locator,n),c(this,n)},ignorableWhitespace:function(e,t,n){},characters:function(e,t,n){if(e=a.apply(this,arguments)){if(this.cdata)var r=this.doc.createCDATASection(e);else r=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(e)&&this.doc.appendChild(r),this.locator&&o(this.locator,r)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,n){e=a.apply(this,arguments);var r=this.doc.createComment(e);this.locator&&o(this.locator,r),c(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,n){var r=this.doc.implementation;if(r&&r.createDocumentType){var i=r.createDocumentType(e,t,n);this.locator&&o(this.locator,i),c(this,i)}},warning:function(e){console.warn("[xmldom warning]\t"+e,s(this.locator))},error:function(e){console.error("[xmldom error]\t"+e,s(this.locator))},fatalError:function(e){throw console.error("[xmldom fatalError]\t"+e,s(this.locator)),e}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,(function(e){i.prototype[e]=function(){return null}}));var u=n(156).XMLReader,d=t.DOMImplementation=n(84).DOMImplementation;t.XMLSerializer=n(84).XMLSerializer,t.DOMParser=r},function(e,t){function n(e,t){for(var n in e)t[n]=e[n]}function r(e,t){var r=e.prototype;if(Object.create){var i=Object.create(t.prototype);r.__proto__=i}if(!(r instanceof t)){function o(){}o.prototype=t.prototype,n(r,o=new o),e.prototype=r=o}r.constructor!=e&&("function"!=typeof e&&console.error("unknow Class:"+e),r.constructor=e)}var i={},o=i.ELEMENT_NODE=1,s=i.ATTRIBUTE_NODE=2,a=i.TEXT_NODE=3,c=i.CDATA_SECTION_NODE=4,u=i.ENTITY_REFERENCE_NODE=5,d=i.ENTITY_NODE=6,l=i.PROCESSING_INSTRUCTION_NODE=7,f=i.COMMENT_NODE=8,h=i.DOCUMENT_NODE=9,p=i.DOCUMENT_TYPE_NODE=10,g=i.DOCUMENT_FRAGMENT_NODE=11,m=i.NOTATION_NODE=12,v={},_={},y=(v.INDEX_SIZE_ERR=(_[1]="Index size error",1),v.DOMSTRING_SIZE_ERR=(_[2]="DOMString size error",2),v.HIERARCHY_REQUEST_ERR=(_[3]="Hierarchy request error",3)),b=(v.WRONG_DOCUMENT_ERR=(_[4]="Wrong document",4),v.INVALID_CHARACTER_ERR=(_[5]="Invalid character",5),v.NO_DATA_ALLOWED_ERR=(_[6]="No data allowed",6),v.NO_MODIFICATION_ALLOWED_ERR=(_[7]="No modification allowed",7),v.NOT_FOUND_ERR=(_[8]="Not found",8)),w=(v.NOT_SUPPORTED_ERR=(_[9]="Not supported",9),v.INUSE_ATTRIBUTE_ERR=(_[10]="Attribute in use",10));v.INVALID_STATE_ERR=(_[11]="Invalid state",11),v.SYNTAX_ERR=(_[12]="Syntax error",12),v.INVALID_MODIFICATION_ERR=(_[13]="Invalid modification",13),v.NAMESPACE_ERR=(_[14]="Invalid namespace",14),v.INVALID_ACCESS_ERR=(_[15]="Invalid access",15);function S(e,t){if(t instanceof Error)var n=t;else n=this,Error.call(this,_[e]),this.message=_[e],Error.captureStackTrace&&Error.captureStackTrace(this,S);return n.code=e,t&&(this.message=this.message+": "+t),n}function x(){}function E(e,t){this._node=e,this._refresh=t,A(this)}function A(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var r=e._refresh(e._node);te(e,"length",r.length),n(r,e),e._inc=t}}function N(){}function O(e,t){for(var n=e.length;n--;)if(e[n]===t)return n}function j(e,t,n,r){if(r?t[O(t,r)]=n:t[t.length++]=n,e){n.ownerElement=e;var i=e.ownerDocument;i&&(r&&D(i,e,r),function(e,t,n){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&(t._nsMap[n.prefix?n.localName:""]=n.value)}(i,e,n))}}function T(e,t,n){var r=O(t,n);if(!(r>=0))throw S(b,new Error(e.tagName+"@"+n));for(var i=t.length-1;r<i;)t[r]=t[++r];if(t.length=i,e){var o=e.ownerDocument;o&&(D(o,e,n),n.ownerElement=null)}}function C(e){if(this._features={},e)for(var t in e)this._features=e[t]}function I(){}function R(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function M(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(M(e,t))return!0}while(e=e.nextSibling)}function k(){}function D(e,t,n,r){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&delete t._nsMap[n.prefix?n.localName:""]}function P(e,t,n){if(e&&e._inc){e._inc++;var r=t.childNodes;if(n)r[r.length++]=n;else{for(var i=t.firstChild,o=0;i;)r[o++]=i,i=i.nextSibling;r.length=o}}}function L(e,t){var n=t.previousSibling,r=t.nextSibling;return n?n.nextSibling=r:e.firstChild=r,r?r.previousSibling=n:e.lastChild=n,P(e.ownerDocument,e),t}function F(e,t,n){var r=t.parentNode;if(r&&r.removeChild(t),t.nodeType===g){var i=t.firstChild;if(null==i)return t;var o=t.lastChild}else i=o=t;var s=n?n.previousSibling:e.lastChild;i.previousSibling=s,o.nextSibling=n,s?s.nextSibling=i:e.firstChild=i,null==n?e.lastChild=o:n.previousSibling=o;do{i.parentNode=e}while(i!==o&&(i=i.nextSibling));return P(e.ownerDocument||e,e),t.nodeType==g&&(t.firstChild=t.lastChild=null),t}function U(){this._nsMap={}}function z(){}function B(){}function H(){}function q(){}function $(){}function W(){}function J(){}function V(){}function G(){}function Y(){}function X(){}function Q(){}function K(e,t){var n=[],r=9==this.nodeType?this.documentElement:this,i=r.prefix,o=r.namespaceURI;if(o&&null==i&&null==(i=r.lookupPrefix(o)))var s=[{namespace:o,prefix:null}];return ee(this,n,e,t,s),n.join("")}function Z(e,t,n){var r=e.prefix||"",i=e.namespaceURI;if(!r&&!i)return!1;if("xml"===r&&"http://www.w3.org/XML/1998/namespace"===i||"http://www.w3.org/2000/xmlns/"==i)return!1;for(var o=n.length;o--;){var s=n[o];if(s.prefix==r)return s.namespace!=i}return!0}function ee(e,t,n,r,i){if(r){if(!(e=r(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case o:i||(i=[]);i.length;var d=e.attributes,m=d.length,v=e.firstChild,_=e.tagName;n="http://www.w3.org/1999/xhtml"===e.namespaceURI||n,t.push("<",_);for(var y=0;y<m;y++){"xmlns"==(b=d.item(y)).prefix?i.push({prefix:b.localName,namespace:b.value}):"xmlns"==b.nodeName&&i.push({prefix:"",namespace:b.value})}for(y=0;y<m;y++){var b;if(Z(b=d.item(y),0,i)){var w=b.prefix||"",S=b.namespaceURI,x=w?" xmlns:"+w:" xmlns";t.push(x,'="',S,'"'),i.push({prefix:w,namespace:S})}ee(b,t,n,r,i)}if(Z(e,0,i)){w=e.prefix||"",S=e.namespaceURI,x=w?" xmlns:"+w:" xmlns";t.push(x,'="',S,'"'),i.push({prefix:w,namespace:S})}if(v||n&&!/^(?:meta|link|img|br|hr|input)$/i.test(_)){if(t.push(">"),n&&/^script$/i.test(_))for(;v;)v.data?t.push(v.data):ee(v,t,n,r,i),v=v.nextSibling;else for(;v;)ee(v,t,n,r,i),v=v.nextSibling;t.push("</",_,">")}else t.push("/>");return;case h:case g:for(v=e.firstChild;v;)ee(v,t,n,r,i),v=v.nextSibling;return;case s:return t.push(" ",e.name,'="',e.value.replace(/[<&"]/g,R),'"');case a:return t.push(e.data.replace(/[<&]/g,R));case c:return t.push("<![CDATA[",e.data,"]]>");case f:return t.push("\x3c!--",e.data,"--\x3e");case p:var E=e.publicId,A=e.systemId;if(t.push("<!DOCTYPE ",e.name),E)t.push(' PUBLIC "',E),A&&"."!=A&&t.push('" "',A),t.push('">');else if(A&&"."!=A)t.push(' SYSTEM "',A,'">');else{var N=e.internalSubset;N&&t.push(" [",N,"]"),t.push(">")}return;case l:return t.push("<?",e.target," ",e.data,"?>");case u:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function te(e,t,n){e[t]=n}S.prototype=Error.prototype,n(v,S),x.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var n=[],r=0;r<this.length;r++)ee(this[r],n,e,t);return n.join("")}},E.prototype.item=function(e){return A(this),this[e]},r(E,x),N.prototype={length:0,item:x.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var n=this[t];if(n.nodeName==e)return n}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new S(w);var n=this.getNamedItem(e.nodeName);return j(this._ownerElement,this,e,n),n},setNamedItemNS:function(e){var t,n=e.ownerElement;if(n&&n!=this._ownerElement)throw new S(w);return t=this.getNamedItemNS(e.namespaceURI,e.localName),j(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return T(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var n=this.getNamedItemNS(e,t);return T(this._ownerElement,this,n),n},getNamedItemNS:function(e,t){for(var n=this.length;n--;){var r=this[n];if(r.localName==t&&r.namespaceURI==e)return r}return null}},C.prototype={hasFeature:function(e,t){var n=this._features[e.toLowerCase()];return!(!n||t&&!(t in n))},createDocument:function(e,t,n){var r=new k;if(r.implementation=this,r.childNodes=new x,r.doctype=n,n&&r.appendChild(n),t){var i=r.createElementNS(e,t);r.appendChild(i)}return r},createDocumentType:function(e,t,n){var r=new W;return r.name=e,r.nodeName=e,r.publicId=t,r.systemId=n,r}},I.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return F(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t),t&&this.removeChild(t)},removeChild:function(e){return L(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return function e(t,n,r){var i=new n.constructor;for(var a in n){var c=n[a];"object"!=typeof c&&c!=i[a]&&(i[a]=c)}n.childNodes&&(i.childNodes=new x);switch(i.ownerDocument=t,i.nodeType){case o:var u=n.attributes,d=i.attributes=new N,l=u.length;d._ownerElement=i;for(var f=0;f<l;f++)i.setAttributeNode(e(t,u.item(f),!0));break;case s:r=!0}if(r)for(var h=n.firstChild;h;)i.appendChild(e(t,h,r)),h=h.nextSibling;return i}(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==a&&e.nodeType==a?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var t=this;t;){var n=t._nsMap;if(n)for(var r in n)if(n[r]==e)return r;t=t.nodeType==s?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var n=t._nsMap;if(n&&e in n)return n[e];t=t.nodeType==s?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},n(i,I),n(i,I.prototype),k.prototype={nodeName:"#document",nodeType:h,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==g){for(var n=e.firstChild;n;){var r=n.nextSibling;this.insertBefore(n,t),n=r}return e}return null==this.documentElement&&e.nodeType==o&&(this.documentElement=e),F(this,e,t),e.ownerDocument=this,e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),L(this,e)},importNode:function(e,t){return function e(t,n,r){var i;switch(n.nodeType){case o:(i=n.cloneNode(!1)).ownerDocument=t;case g:break;case s:r=!0}i||(i=n.cloneNode(!1));if(i.ownerDocument=t,i.parentNode=null,r)for(var a=n.firstChild;a;)i.appendChild(e(t,a,r)),a=a.nextSibling;return i}(this,e,t)},getElementById:function(e){var t=null;return M(this.documentElement,(function(n){if(n.nodeType==o&&n.getAttribute("id")==e)return t=n,!0})),t},createElement:function(e){var t=new U;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.childNodes=new x,(t.attributes=new N)._ownerElement=t,t},createDocumentFragment:function(){var e=new Y;return e.ownerDocument=this,e.childNodes=new x,e},createTextNode:function(e){var t=new H;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new q;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new $;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var n=new X;return n.ownerDocument=this,n.tagName=n.target=e,n.nodeValue=n.data=t,n},createAttribute:function(e){var t=new z;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new G;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var n=new U,r=t.split(":"),i=n.attributes=new N;return n.childNodes=new x,n.ownerDocument=this,n.nodeName=t,n.tagName=t,n.namespaceURI=e,2==r.length?(n.prefix=r[0],n.localName=r[1]):n.localName=t,i._ownerElement=n,n},createAttributeNS:function(e,t){var n=new z,r=t.split(":");return n.ownerDocument=this,n.nodeName=t,n.name=t,n.namespaceURI=e,n.specified=!0,2==r.length?(n.prefix=r[0],n.localName=r[1]):n.localName=t,n}},r(k,I),U.prototype={nodeType:o,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var n=this.ownerDocument.createAttribute(e);n.value=n.nodeValue=""+t,this.setAttributeNode(n)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===g?this.insertBefore(e,null):function(e,t){var n=t.parentNode;if(n){var r=e.lastChild;n.removeChild(t);r=e.lastChild}return r=e.lastChild,t.parentNode=e,t.previousSibling=r,t.nextSibling=null,r?r.nextSibling=t:e.firstChild=t,e.lastChild=t,P(e.ownerDocument,e,t),t}(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);n&&this.removeAttributeNode(n)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);return n&&n.value||""},setAttributeNS:function(e,t,n){var r=this.ownerDocument.createAttributeNS(e,t);r.value=r.nodeValue=""+n,this.setAttributeNode(r)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new E(this,(function(t){var n=[];return M(t,(function(r){r===t||r.nodeType!=o||"*"!==e&&r.tagName!=e||n.push(r)})),n}))},getElementsByTagNameNS:function(e,t){return new E(this,(function(n){var r=[];return M(n,(function(i){i===n||i.nodeType!==o||"*"!==e&&i.namespaceURI!==e||"*"!==t&&i.localName!=t||r.push(i)})),r}))}},k.prototype.getElementsByTagName=U.prototype.getElementsByTagName,k.prototype.getElementsByTagNameNS=U.prototype.getElementsByTagNameNS,r(U,I),z.prototype.nodeType=s,r(z,I),B.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(_[y])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,n){n=this.data.substring(0,e)+n+this.data.substring(e+t),this.nodeValue=this.data=n,this.length=n.length}},r(B,I),H.prototype={nodeName:"#text",nodeType:a,splitText:function(e){var t=this.data,n=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var r=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(r,this.nextSibling),r}},r(H,B),q.prototype={nodeName:"#comment",nodeType:f},r(q,B),$.prototype={nodeName:"#cdata-section",nodeType:c},r($,B),W.prototype.nodeType=p,r(W,I),J.prototype.nodeType=m,r(J,I),V.prototype.nodeType=d,r(V,I),G.prototype.nodeType=u,r(G,I),Y.prototype.nodeName="#document-fragment",Y.prototype.nodeType=g,r(Y,I),X.prototype.nodeType=l,r(X,I),Q.prototype.serializeToString=function(e,t,n){return K.call(e,t,n)},I.prototype.toString=K;try{if(Object.defineProperty){Object.defineProperty(E.prototype,"length",{get:function(){return A(this),this.$$length}}),Object.defineProperty(I.prototype,"textContent",{get:function(){return function e(t){switch(t.nodeType){case o:case g:var n=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&n.push(e(t)),t=t.nextSibling;return n.join("");default:return t.nodeValue}}(this)},set:function(e){switch(this.nodeType){case o:case g:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),te=function(e,t,n){e["$$"+t]=n}}}catch(e){}t.DOMImplementation=C,t.XMLSerializer=Q},function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n(17))},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}},function(e,t,n){var r=n(169),i=n(88),o=n(9),s=n(89),a=n(29),c=n(90),u=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=o(e),d=!n&&i(e),l=!n&&!d&&s(e),f=!n&&!d&&!l&&c(e),h=n||d||l||f,p=h?r(e.length,String):[],g=p.length;for(var m in e)!t&&!u.call(e,m)||h&&("length"==m||l&&("offset"==m||"parent"==m)||f&&("buffer"==m||"byteLength"==m||"byteOffset"==m)||a(m,g))||p.push(m);return p}},function(e,t,n){var r=n(170),i=n(15),o=Object.prototype,s=o.hasOwnProperty,a=o.propertyIsEnumerable,c=r(function(){return arguments}())?r:function(e){return i(e)&&s.call(e,"callee")&&!a.call(e,"callee")};e.exports=c},function(e,t,n){(function(e){var r=n(5),i=n(171),o=t&&!t.nodeType&&t,s=o&&"object"==typeof e&&e&&!e.nodeType&&e,a=s&&s.exports===o?r.Buffer:void 0,c=(a?a.isBuffer:void 0)||i;e.exports=c}).call(this,n(58)(e))},function(e,t,n){var r=n(172),i=n(173),o=n(174),s=o&&o.isTypedArray,a=s?i(s):r;e.exports=a},function(e,t,n){var r=n(92),i=n(175),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=[];for(var n in Object(e))o.call(e,n)&&"constructor"!=n&&t.push(n);return t}},function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},function(e,t){e.exports=function(e,t){return function(n){return e(t(n))}}},function(e,t,n){var r=n(95),i=n(40),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var s=e[t];o.call(e,t)&&i(s,n)&&(void 0!==n||t in e)||r(e,t,n)}},function(e,t,n){var r=n(96);e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},function(e,t,n){var r=n(19),i=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=i},function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t,n){var r=n(30),i=n(185),o=n(99);e.exports=function(e,t){return o(i(e,t,r),e+"")}},function(e,t,n){var r=n(186),i=n(100)(r);e.exports=i},function(e,t){var n=Date.now;e.exports=function(e){var t=0,r=0;return function(){var i=n(),o=16-(i-r);if(r=i,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},function(e,t,n){var r=n(87),i=n(189),o=n(23);e.exports=function(e){return o(e)?r(e,!0):i(e)}},function(e,t,n){var r=n(191),i=n(192),o=n(193);e.exports=function(e,t,n){return t==t?o(e,t,n):r(e,i,n)}},function(e,t,n){var r=n(18),i=n(9),o=n(15);e.exports=function(e){return"string"==typeof e||!i(e)&&o(e)&&"[object String]"==r(e)}},function(e,t,n){var r=n(30),i=n(105),o=i?function(e,t){return i.set(e,t),e}:r;e.exports=o},function(e,t,n){var r=n(106),i=r&&new r;e.exports=i},function(e,t,n){var r=n(19)(n(5),"WeakMap");e.exports=r},function(e,t,n){var r=n(108),i=n(109),o=n(198),s=n(41),a=n(110),c=n(65),u=n(209),d=n(42),l=n(5);e.exports=function e(t,n,f,h,p,g,m,v,_,y){var b=128&n,w=1&n,S=2&n,x=24&n,E=512&n,A=S?void 0:s(t);return function N(){for(var O=arguments.length,j=Array(O),T=O;T--;)j[T]=arguments[T];if(x)var C=c(N),I=o(j,C);if(h&&(j=r(j,h,p,x)),g&&(j=i(j,g,m,x)),O-=I,x&&O<y){var R=d(j,C);return a(t,n,e,N.placeholder,f,j,R,v,_,y-O)}var M=w?f:this,k=S?M[t]:t;return O=j.length,v?j=u(j,v):E&&O>1&&j.reverse(),b&&_<O&&(j.length=_),this&&this!==l&&this instanceof N&&(k=A||s(k)),k.apply(M,j)}}},function(e,t){var n=Math.max;e.exports=function(e,t,r,i){for(var o=-1,s=e.length,a=r.length,c=-1,u=t.length,d=n(s-a,0),l=Array(u+d),f=!i;++c<u;)l[c]=t[c];for(;++o<a;)(f||o<s)&&(l[r[o]]=e[o]);for(;d--;)l[c++]=e[o++];return l}},function(e,t){var n=Math.max;e.exports=function(e,t,r,i){for(var o=-1,s=e.length,a=-1,c=r.length,u=-1,d=t.length,l=n(s-c,0),f=Array(l+d),h=!i;++o<l;)f[o]=e[o];for(var p=o;++u<d;)f[p+u]=t[u];for(;++a<c;)(h||o<s)&&(f[p+r[a]]=e[o++]);return f}},function(e,t,n){var r=n(199),i=n(114),o=n(115);e.exports=function(e,t,n,s,a,c,u,d,l,f){var h=8&t;t|=h?32:64,4&(t&=~(h?64:32))||(t&=-4);var p=[e,t,a,h?c:void 0,h?u:void 0,h?void 0:c,h?void 0:u,d,l,f],g=n.apply(void 0,p);return r(e)&&i(g,p),g.placeholder=s,o(g,e,t)}},function(e,t,n){var r=n(105),i=n(200),o=r?function(e){return r.get(e)}:i;e.exports=o},function(e,t,n){var r=n(62),i=n(64);function o(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}o.prototype=r(i.prototype),o.prototype.constructor=o,e.exports=o},function(e,t){e.exports=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},function(e,t,n){var r=n(104),i=n(100)(r);e.exports=i},function(e,t,n){var r=n(205),i=n(206),o=n(99),s=n(207);e.exports=function(e,t,n){var a=t+"";return o(e,i(a,s(r(a),n)))}},function(e,t,n){var r=n(43),i=n(220),o=n(221),s=n(222),a=n(223),c=n(224);function u(e){var t=this.__data__=new r(e);this.size=t.size}u.prototype.clear=i,u.prototype.delete=o,u.prototype.get=s,u.prototype.has=a,u.prototype.set=c,e.exports=u},function(e,t,n){var r=n(237),i=n(15);e.exports=function e(t,n,o,s,a){return t===n||(null==t||null==n||!i(t)&&!i(n)?t!=t&&n!=n:r(t,n,o,s,e,a))}},function(e,t,n){var r=n(238),i=n(241),o=n(242);e.exports=function(e,t,n,s,a,c){var u=1&n,d=e.length,l=t.length;if(d!=l&&!(u&&l>d))return!1;var f=c.get(e),h=c.get(t);if(f&&h)return f==t&&h==e;var p=-1,g=!0,m=2&n?new r:void 0;for(c.set(e,t),c.set(t,e);++p<d;){var v=e[p],_=t[p];if(s)var y=u?s(_,v,p,t,e,c):s(v,_,p,e,t,c);if(void 0!==y){if(y)continue;g=!1;break}if(m){if(!i(t,(function(e,t){if(!o(m,t)&&(v===e||a(v,e,n,s,c)))return m.push(t)}))){g=!1;break}}else if(v!==_&&!a(v,_,n,s,c)){g=!1;break}}return c.delete(e),c.delete(t),g}},function(e,t,n){var r=n(120),i=n(9);e.exports=function(e,t,n){var o=t(e);return i(e)?o:r(o,n(e))}},function(e,t){e.exports=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}},function(e,t,n){var r=n(249),i=n(122),o=Object.prototype.propertyIsEnumerable,s=Object.getOwnPropertySymbols,a=s?function(e){return null==e?[]:(e=Object(e),r(s(e),(function(t){return o.call(e,t)})))}:i;e.exports=a},function(e,t){e.exports=function(){return[]}},function(e,t,n){var r=n(250),i=n(66),o=n(251),s=n(252),a=n(106),c=n(18),u=n(97),d=u(r),l=u(i),f=u(o),h=u(s),p=u(a),g=c;(r&&"[object DataView]"!=g(new r(new ArrayBuffer(1)))||i&&"[object Map]"!=g(new i)||o&&"[object Promise]"!=g(o.resolve())||s&&"[object Set]"!=g(new s)||a&&"[object WeakMap]"!=g(new a))&&(g=function(e){var t=c(e),n="[object Object]"==t?e.constructor:void 0,r=n?u(n):"";if(r)switch(r){case d:return"[object DataView]";case l:return"[object Map]";case f:return"[object Promise]";case h:return"[object Set]";case p:return"[object WeakMap]"}return t}),e.exports=g},function(e,t,n){var r=n(13);e.exports=function(e){return e==e&&!r(e)}},function(e,t){e.exports=function(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}},function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(275)),i=u(n(281)),o=u(n(289)),s=u(n(292)),a=u(n(77));t.default=function(e,t){var n=(0,c.getStorage)(),u=!(!n||!n[t]),d=u?n[t]:{clear:function(){},get:function(){},remove:function(){},set:function(){}},l=d.clear.bind(d),f=d.get.bind(d),h=d.remove.bind(d),p=d.set.bind(d);return{_driver:e,_support:u,_initStorage:function(){return a.default.resolve()},clear:function(e){var t=this;return(0,s.default)(o.default.mark((function n(){return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l(),e&&e();case 2:case"end":return t.stop()}}),n,t)})))()},iterate:function(e,t){var n=this;return(0,s.default)(o.default.mark((function r(){var s;return o.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,c.usePromise)(f,null);case 2:s=n.sent,(0,i.default)(s).forEach((function(t,n){return e(s[t],t,n)})),t&&t();case 6:case"end":return n.stop()}}),r,n)})))()},getItem:function(e,t){var n=this;return(0,s.default)(o.default.mark((function r(){var i;return o.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,c.usePromise)(f,e);case 3:return i=n.sent,i=void 0===(i="string"==typeof e?i[e]:i)?null:i,t&&t(null,i),n.abrupt("return",i);case 10:throw n.prev=10,n.t0=n.catch(0),t&&t(n.t0),n.t0;case 14:case"end":return n.stop()}}),r,n,[[0,10]])})))()},key:function(e,t){var n=this;return(0,s.default)(o.default.mark((function r(){var s,a;return o.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,c.usePromise)(f,null);case 2:return s=n.sent,a=(0,i.default)(s)[e],t&&t(a),n.abrupt("return",a);case 6:case"end":return n.stop()}}),r,n)})))()},keys:function(e){var t=this;return(0,s.default)(o.default.mark((function n(){var r,s;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,c.usePromise)(f,null);case 2:return r=t.sent,s=(0,i.default)(r),e&&e(s),t.abrupt("return",s);case 6:case"end":return t.stop()}}),n,t)})))()},length:function(e){var t=this;return(0,s.default)(o.default.mark((function n(){var r,s;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,c.usePromise)(f,null);case 2:return r=t.sent,s=(0,i.default)(r).length,e&&e(s),t.abrupt("return",s);case 6:case"end":return t.stop()}}),n,t)})))()},removeItem:function(e,t){var n=this;return(0,s.default)(o.default.mark((function r(){return o.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,c.usePromise)(h,e);case 2:t&&t();case 3:case"end":return n.stop()}}),r,n)})))()},setItem:function(e,t,n){var i=this;return(0,s.default)(o.default.mark((function s(){return o.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,c.usePromise)(p,(0,r.default)({},e,t));case 2:n&&n();case 3:case"end":return i.stop()}}),s,i)})))()}}};var c=n(320);function u(e){return e&&e.__esModule?e:{default:e}}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var r=n(72);e.exports=function(e){return Object(r(e))}},function(e,t,n){var r=n(284),i=n(134);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){var r=n(74),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t,n){var r=n(11),i=n(6),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(76)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){"use strict";var r=n(76),i=n(24),o=n(297),s=n(25),a=n(34),c=n(298),u=n(78),d=n(301),l=n(10)("iterator"),f=!([].keys&&"next"in[].keys()),h=function(){return this};e.exports=function(e,t,n,p,g,m,v){c(n,t,p);var _,y,b,w=function(e){if(!f&&e in A)return A[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},S=t+" Iterator",x="values"==g,E=!1,A=e.prototype,N=A[l]||A["@@iterator"]||g&&A[g],O=N||w(g),j=g?x?w("entries"):O:void 0,T="Array"==t&&A.entries||N;if(T&&(b=d(T.call(new e)))!==Object.prototype&&b.next&&(u(b,S,!0),r||"function"==typeof b[l]||s(b,l,h)),x&&N&&"values"!==N.name&&(E=!0,O=function(){return N.call(this)}),r&&!v||!f&&!E&&A[l]||s(A,l,O),a[t]=O,a[S]=h,g)if(_={values:x?O:w("values"),keys:m?O:w("keys"),entries:j},v)for(y in _)y in A||o(A,y,_[y]);else i(i.P+i.F*(f||E),t,_);return _}},function(e,t,n){var r=n(6).document;e.exports=r&&r.documentElement},function(e,t,n){var r=n(51),i=n(10)("toStringTag"),o="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?n:o?r(t):"Object"==(s=r(t))&&"function"==typeof t.callee?"Arguments":s}},function(e,t,n){var r=n(20),i=n(49),o=n(10)("species");e.exports=function(e,t){var n,s=r(e).constructor;return void 0===s||null==(n=r(s)[o])?t:i(n)}},function(e,t,n){var r,i,o,s=n(48),a=n(312),c=n(136),u=n(71),d=n(6),l=d.process,f=d.setImmediate,h=d.clearImmediate,p=d.MessageChannel,g=d.Dispatch,m=0,v={},_=function(){var e=+this;if(v.hasOwnProperty(e)){var t=v[e];delete v[e],t()}},y=function(e){_.call(e.data)};f&&h||(f=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return v[++m]=function(){a("function"==typeof e?e:Function(e),t)},r(m),m},h=function(e){delete v[e]},"process"==n(51)(l)?r=function(e){l.nextTick(s(_,e,1))}:g&&g.now?r=function(e){g.now(s(_,e,1))}:p?(o=(i=new p).port2,i.port1.onmessage=y,r=s(o.postMessage,o,1)):d.addEventListener&&"function"==typeof postMessage&&!d.importScripts?(r=function(e){d.postMessage(e+"","*")},d.addEventListener("message",y,!1)):r="onreadystatechange"in u("script")?function(e){c.appendChild(u("script")).onreadystatechange=function(){c.removeChild(this),_.call(e)}}:function(e){setTimeout(s(_,e,1),0)}),e.exports={set:f,clear:h}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){var r=n(20),i=n(33),o=n(79);e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){"use strict";var r=n(8),i=n(0);i.e.Request=class{constructor(e,t,n,r){this.id=++i.e._requestId,this.xmlData=e,this.data=i.e.serialize(e),this.origFunc=t,this.func=t,this.rid=n,this.date=NaN,this.sends=r||0,this.abort=!1,this.dead=null,this.age=function(){if(!this.date)return 0;return(new Date-this.date)/1e3},this.timeDead=function(){if(!this.dead)return 0;return(new Date-this.dead)/1e3},this.xhr=this._newXHR()}getResponse(){let e=null;if(this.xhr.responseXML&&this.xhr.responseXML.documentElement){if(e=this.xhr.responseXML.documentElement,"parsererror"===e.tagName)throw i.e.error("invalid response received"),i.e.error("responseText: "+this.xhr.responseText),i.e.error("responseXML: "+i.e.serialize(this.xhr.responseXML)),new Error("parsererror")}else if(this.xhr.responseText){if(i.e.debug("Got responseText but no responseXML; attempting to parse it with DOMParser..."),e=(new r.a).parseFromString(this.xhr.responseText,"application/xml").documentElement,!e)throw new Error("Parsing produced null node");if(e.querySelector("parsererror")){i.e.error("invalid response received: "+e.querySelector("parsererror").textContent),i.e.error("responseText: "+this.xhr.responseText);const t=new Error;throw t.name=i.e.ErrorCondition.BAD_FORMAT,t}}return e}_newXHR(){let e=null;return window.XMLHttpRequest?(e=new XMLHttpRequest,e.overrideMimeType&&e.overrideMimeType("text/xml; charset=utf-8")):window.ActiveXObject&&(e=new ActiveXObject("Microsoft.XMLHTTP")),e.onreadystatechange=this.func.bind(null,this),e}},i.e.Bosh=class e{constructor(e){this._conn=e,this.rid=Math.floor(4294967295*Math.random()),this.sid=null,this.hold=1,this.wait=60,this.window=5,this.errors=0,this.inactivity=null,this.lastResponseHeaders=null,this._requests=[]}_buildBody(){const e=Object(i.a)("body",{rid:this.rid++,xmlns:i.e.NS.HTTPBIND});return null!==this.sid&&e.attrs({sid:this.sid}),this._conn.options.keepalive&&this._conn._sessionCachingSupported()&&this._cacheSession(),e}_reset(){this.rid=Math.floor(4294967295*Math.random()),this.sid=null,this.errors=0,this._conn._sessionCachingSupported()&&window.sessionStorage.removeItem("strophe-bosh-session"),this._conn.nextValidRid(this.rid)}_connect(e,t,n){this.wait=e||this.wait,this.hold=t||this.hold,this.errors=0;const r=this._buildBody().attrs({to:this._conn.domain,"xml:lang":"en",wait:this.wait,hold:this.hold,content:"text/xml; charset=utf-8",ver:"1.6","xmpp:version":"1.0","xmlns:xmpp":i.e.NS.BOSH});n&&r.attrs({route:n});const o=this._conn._connect_cb;this._requests.push(new i.e.Request(r.tree(),this._onRequestStateChange.bind(this,o.bind(this._conn)),r.tree().getAttribute("rid"))),this._throttledRequestHandler()}_attach(e,t,n,r,o,s,a){this._conn.jid=e,this.sid=t,this.rid=n,this._conn.connect_callback=r,this._conn.domain=i.e.getDomainFromJid(this._conn.jid),this._conn.authenticated=!0,this._conn.connected=!0,this.wait=o||this.wait,this.hold=s||this.hold,this.window=a||this.window,this._conn._changeConnectStatus(i.e.Status.ATTACHED,null)}_restore(e,t,n,r,o){const s=JSON.parse(window.sessionStorage.getItem("strophe-bosh-session"));if(!(null!=s&&s.rid&&s.sid&&s.jid&&(null==e||i.e.getBareJidFromJid(s.jid)===i.e.getBareJidFromJid(e)||null===i.e.getNodeFromJid(e)&&i.e.getDomainFromJid(s.jid)===e))){const e=new Error("_restore: no restoreable session.");throw e.name="StropheSessionError",e}this._conn.restored=!0,this._attach(s.jid,s.sid,s.rid,t,n,r,o)}_cacheSession(){this._conn.authenticated?this._conn.jid&&this.rid&&this.sid&&window.sessionStorage.setItem("strophe-bosh-session",JSON.stringify({jid:this._conn.jid,rid:this.rid,sid:this.sid})):window.sessionStorage.removeItem("strophe-bosh-session")}_connect_cb(e){const t=e.getAttribute("type");if(null!==t&&"terminate"===t){let t=e.getAttribute("condition");i.e.error("BOSH-Connection failed: "+t);const n=e.getElementsByTagName("conflict");return null!==t?("remote-stream-error"===t&&n.length>0&&(t="conflict"),this._conn._changeConnectStatus(i.e.Status.CONNFAIL,t)):this._conn._changeConnectStatus(i.e.Status.CONNFAIL,"unknown"),this._conn._doDisconnect(t),i.e.Status.CONNFAIL}this.sid||(this.sid=e.getAttribute("sid"));const n=e.getAttribute("requests");n&&(this.window=parseInt(n,10));const r=e.getAttribute("hold");r&&(this.hold=parseInt(r,10));const o=e.getAttribute("wait");o&&(this.wait=parseInt(o,10));const s=e.getAttribute("inactivity");s&&(this.inactivity=parseInt(s,10))}_disconnect(e){this._sendTerminate(e)}_doDisconnect(){this.sid=null,this.rid=Math.floor(4294967295*Math.random()),this._conn._sessionCachingSupported()&&window.sessionStorage.removeItem("strophe-bosh-session"),this._conn.nextValidRid(this.rid)}_emptyQueue(){return 0===this._requests.length}_callProtocolErrorHandlers(t){const n=e._getRequestStatus(t),r=this._conn.protocolErrorHandlers.HTTP[n];r&&r.call(this,n)}_hitError(e){this.errors++,i.e.warn("request errored, status: "+e+", number of errors: "+this.errors),this.errors>4&&this._conn._onDisconnectTimeout()}_no_auth_received(e){i.e.warn("Server did not yet offer a supported authentication mechanism. Sending a blank poll request."),e=e?e.bind(this._conn):this._conn._connect_cb.bind(this._conn);const t=this._buildBody();this._requests.push(new i.e.Request(t.tree(),this._onRequestStateChange.bind(this,e),t.tree().getAttribute("rid"))),this._throttledRequestHandler()}_onDisconnectTimeout(){this._abortAllRequests()}_abortAllRequests(){for(;this._requests.length>0;){const e=this._requests.pop();e.abort=!0,e.xhr.abort(),e.xhr.onreadystatechange=function(){}}}_onIdle(){const e=this._conn._data;if(this._conn.authenticated&&0===this._requests.length&&0===e.length&&!this._conn.disconnecting&&(i.e.debug("no requests during idle cycle, sending blank request"),e.push(null)),!this._conn.paused){if(this._requests.length<2&&e.length>0){const t=this._buildBody();for(let n=0;n<e.length;n++)null!==e[n]&&("restart"===e[n]?t.attrs({to:this._conn.domain,"xml:lang":"en","xmpp:restart":"true","xmlns:xmpp":i.e.NS.BOSH}):t.cnode(e[n]).up());delete this._conn._data,this._conn._data=[],this._requests.push(new i.e.Request(t.tree(),this._onRequestStateChange.bind(this,this._conn._dataRecv.bind(this._conn)),t.tree().getAttribute("rid"))),this._throttledRequestHandler()}if(this._requests.length>0){const e=this._requests[0].age();null!==this._requests[0].dead&&this._requests[0].timeDead()>Math.floor(i.e.SECONDARY_TIMEOUT*this.wait)&&this._throttledRequestHandler(),e>Math.floor(i.e.TIMEOUT*this.wait)&&(i.e.warn("Request "+this._requests[0].id+" timed out, over "+Math.floor(i.e.TIMEOUT*this.wait)+" seconds since last activity"),this._throttledRequestHandler())}}}static _getRequestStatus(e,t){let n;if(4===e.xhr.readyState)try{n=e.xhr.status}catch(e){i.e.error("Caught an error while retrieving a request's status, reqStatus: "+n)}return void 0===n&&(n="number"==typeof t?t:0),n}_onRequestStateChange(t,n){if(i.e.debug("request id "+n.id+"."+n.sends+" state changed to "+n.xhr.readyState),n.abort)return void(n.abort=!1);if(4!==n.xhr.readyState)return;const r=e._getRequestStatus(n);if(this.lastResponseHeaders=n.xhr.getAllResponseHeaders(),this._conn.disconnecting&&r>=400)return this._hitError(r),void this._callProtocolErrorHandlers(n);const o=r>0&&r<500,s=n.sends>this._conn.maxRetries;if((o||s)&&(this._removeRequest(n),i.e.debug("request id "+n.id+" should now be removed")),200===r){const e=this._requests[0]===n;(this._requests[1]===n||e&&this._requests.length>0&&this._requests[0].age()>Math.floor(i.e.SECONDARY_TIMEOUT*this.wait))&&this._restartRequest(0),this._conn.nextValidRid(Number(n.rid)+1),i.e.debug("request id "+n.id+"."+n.sends+" got 200"),t(n),this.errors=0}else 0===r||r>=400&&r<600||r>=12e3?(i.e.error("request id "+n.id+"."+n.sends+" error "+r+" happened"),this._hitError(r),this._callProtocolErrorHandlers(n),r>=400&&r<500&&(this._conn._changeConnectStatus(i.e.Status.DISCONNECTING,null),this._conn._doDisconnect())):i.e.error("request id "+n.id+"."+n.sends+" error "+r+" happened");o||s?s&&!this._conn.connected&&this._conn._changeConnectStatus(i.e.Status.CONNFAIL,"giving-up"):this._throttledRequestHandler()}_processRequest(t){let n=this._requests[t];const r=e._getRequestStatus(n,-1);if(n.sends>this._conn.maxRetries)return void this._conn._onDisconnectTimeout();const o=n.age(),s=!isNaN(o)&&o>Math.floor(i.e.TIMEOUT*this.wait),a=null!==n.dead&&n.timeDead()>Math.floor(i.e.SECONDARY_TIMEOUT*this.wait),c=4===n.xhr.readyState&&(r<1||r>=500);if((s||a||c)&&(a&&i.e.error("Request ".concat(this._requests[t].id," timed out (secondary), restarting")),n.abort=!0,n.xhr.abort(),n.xhr.onreadystatechange=function(){},this._requests[t]=new i.e.Request(n.xmlData,n.origFunc,n.rid,n.sends),n=this._requests[t]),0===n.xhr.readyState){i.e.debug("request id "+n.id+"."+n.sends+" posting");try{const e=this._conn.options.contentType||"text/xml; charset=utf-8";n.xhr.open("POST",this._conn.service,!this._conn.options.sync),void 0!==n.xhr.setRequestHeader&&n.xhr.setRequestHeader("Content-Type",e),this._conn.options.withCredentials&&(n.xhr.withCredentials=!0)}catch(e){return i.e.error("XHR open failed: "+e.toString()),this._conn.connected||this._conn._changeConnectStatus(i.e.Status.CONNFAIL,"bad-service"),void this._conn.disconnect()}const e=()=>{if(n.date=new Date,this._conn.options.customHeaders){const e=this._conn.options.customHeaders;for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.xhr.setRequestHeader(t,e[t])}n.xhr.send(n.data)};if(n.sends>1){const t=1e3*Math.min(Math.floor(i.e.TIMEOUT*this.wait),Math.pow(n.sends,3));setTimeout((function(){e()}),t)}else e();n.sends++,this._conn.xmlOutput!==i.e.Connection.prototype.xmlOutput&&(n.xmlData.nodeName===this.strip&&n.xmlData.childNodes.length?this._conn.xmlOutput(n.xmlData.childNodes[0]):this._conn.xmlOutput(n.xmlData)),this._conn.rawOutput!==i.e.Connection.prototype.rawOutput&&this._conn.rawOutput(n.data)}else i.e.debug("_processRequest: "+(0===t?"first":"second")+" request has readyState of "+n.xhr.readyState)}_removeRequest(e){i.e.debug("removing request");for(let t=this._requests.length-1;t>=0;t--)e===this._requests[t]&&this._requests.splice(t,1);e.xhr.onreadystatechange=function(){},this._throttledRequestHandler()}_restartRequest(e){const t=this._requests[e];null===t.dead&&(t.dead=new Date),this._processRequest(e)}_reqToData(e){try{return e.getResponse()}catch(e){if("parsererror"!==e.message)throw e;this._conn.disconnect("strophe-parsererror")}}_sendTerminate(e){i.e.debug("_sendTerminate was called");const t=this._buildBody().attrs({type:"terminate"});e&&t.cnode(e.tree());const n=new i.e.Request(t.tree(),this._onRequestStateChange.bind(this,this._conn._dataRecv.bind(this._conn)),t.tree().getAttribute("rid"));this._requests.push(n),this._throttledRequestHandler()}_send(){clearTimeout(this._conn._idleTimeout),this._throttledRequestHandler(),this._conn._idleTimeout=setTimeout(()=>this._conn._onIdle(),100)}_sendRestart(){this._throttledRequestHandler(),clearTimeout(this._conn._idleTimeout)}_throttledRequestHandler(){this._requests?i.e.debug("_throttledRequestHandler called with "+this._requests.length+" requests"):i.e.debug("_throttledRequestHandler called with undefined requests"),this._requests&&0!==this._requests.length&&(this._requests.length>0&&this._processRequest(0),this._requests.length>1&&Math.abs(this._requests[0].rid-this._requests[1].rid)<this.window&&this._processRequest(1))}},i.e.Bosh.prototype.strip=null},function(e,t,n){"use strict";t.a=function(){return!1}},function(e,t,n){"use strict";(function(e){var r=n(3),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=o&&o.exports===i?r.a.Buffer:void 0,a=s?s.allocUnsafe:void 0;t.a=function(e,t){if(t)return e.slice();var n=e.length,r=a?a(n):new e.constructor(n);return e.copy(r),r}}).call(this,n(56)(e))},function(e,t,n){e.exports=function(){"use strict";return function(e,t,n){var r=t.prototype,i=r.format;n.en.ordinal=function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"},r.format=function(e){var t=this,n=this.$locale(),r=this.$utils(),o=(e||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|gggg|Do|X|x|k{1,2}|S/g,(function(e){switch(e){case"Q":return Math.ceil((t.$M+1)/3);case"Do":return n.ordinal(t.$D);case"gggg":return t.weekYear();case"wo":return n.ordinal(t.week(),"W");case"w":case"ww":return r.s(t.week(),"w"===e?1:2,"0");case"k":case"kk":return r.s(String(0===t.$H?24:t.$H),"k"===e?1:2,"0");case"X":return Math.floor(t.$d.getTime()/1e3);case"x":return t.$d.getTime();default:return e}}));return i.bind(this)(o)}}}()},function(e,t,n){var r=n(159),i=n(57);e.exports=function(e,t,n){var o=null==e?0:e.length;return o?(t=n||void 0===t?1:i(t),r(e,t<0?0:t,o)):[]}},function(e,t,n){var r=n(18),i=n(15);e.exports=function(e){return!0===e||!1===e||i(e)&&"[object Boolean]"==r(e)}},function(e,t){e.exports=function(e){return null==e}},function(e,t,n){var r=n(61),i=n(212),o=n(266),s=n(268);e.exports=function(e,t){if(null==e)return{};var n=r(s(e),(function(e){return[e]}));return t=i(t),o(e,n,(function(e,n){return t(e,n[0])}))}},function(e,t,n){var r=n(91),i=n(123),o=n(23),s=n(103),a=n(271);e.exports=function(e){if(null==e)return 0;if(o(e))return s(e)?a(e):e.length;var t=i(e);return"[object Map]"==t||"[object Set]"==t?e.size:r(e).length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(127),o=(r=i)&&r.__esModule?r:{default:r};t.default=(0,o.default)("webExtensionSyncStorage","sync")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(127),o=(r=i)&&r.__esModule?r:{default:r};t.default=(0,o.default)("webExtensionLocalStorage","local")},function(e,t,n){"use strict";(function(t){!function(t){var n=/^(b|B)$/,r={iec:{bits:["b","Kib","Mib","Gib","Tib","Pib","Eib","Zib","Yib"],bytes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},jedec:{bits:["b","Kb","Mb","Gb","Tb","Pb","Eb","Zb","Yb"],bytes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}},i={iec:["","kibi","mebi","gibi","tebi","pebi","exbi","zebi","yobi"],jedec:["","kilo","mega","giga","tera","peta","exa","zetta","yotta"]};function o(e){var t,o,s,a,c,u,d,l,f,h,p,g,m,v,_,y=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},b=[],w=0,S=void 0,x=void 0;if(isNaN(e))throw new TypeError("Invalid number");return o=!0===y.bits,p=!0===y.unix,t=y.base||2,h=void 0!==y.round?y.round:p?1:2,u=void 0!==y.locale?y.locale:"",d=y.localeOptions||{},g=void 0!==y.separator?y.separator:"",m=void 0!==y.spacer?y.spacer:p?"":" ",_=y.symbols||{},v=2===t&&y.standard||"jedec",f=y.output||"string",a=!0===y.fullform,c=y.fullforms instanceof Array?y.fullforms:[],S=void 0!==y.exponent?y.exponent:-1,s=2<t?1e3:1024,(l=(x=Number(e))<0)&&(x=-x),(-1===S||isNaN(S))&&(S=Math.floor(Math.log(x)/Math.log(s)))<0&&(S=0),8<S&&(S=8),"exponent"===f?S:(0===x?(b[0]=0,b[1]=p?"":r[v][o?"bits":"bytes"][S]):(w=x/(2===t?Math.pow(2,10*S):Math.pow(1e3,S)),o&&s<=(w*=8)&&S<8&&(w/=s,S++),b[0]=Number(w.toFixed(0<S?h:0)),b[0]===s&&S<8&&void 0===y.exponent&&(b[0]=1,S++),b[1]=10===t&&1===S?o?"kb":"kB":r[v][o?"bits":"bytes"][S],p&&(b[1]="jedec"===v?b[1].charAt(0):0<S?b[1].replace(/B$/,""):b[1],n.test(b[1])&&(b[0]=Math.floor(b[0]),b[1]=""))),l&&(b[0]=-b[0]),b[1]=_[b[1]]||b[1],!0===u?b[0]=b[0].toLocaleString():0<u.length?b[0]=b[0].toLocaleString(u,d):0<g.length&&(b[0]=b[0].toString().replace(".",g)),"array"===f?b:(a&&(b[1]=c[S]?c[S]:i[v][S]+(o?"bit":"byte")+(1===b[0]?"":"s")),"object"===f?{value:b[0],symbol:b[1],exponent:S}:b.join(m)))}o.partial=function(e){return function(t){return o(t,e)}},e.exports=o}("undefined"!=typeof window&&window)}).call(this,n(17))},function(e,t){function n(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}"function"!=typeof window.CustomEvent&&(n.prototype=window.Event.prototype,window.CustomEvent=n),String.prototype.includes||(String.prototype.includes=function(e,t){"use strict";return"number"!=typeof t&&(t=0),!(t+e.length>this.length)&&-1!==this.indexOf(e,t)}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){const n=this.toString();(void 0===t||t>n.length)&&(t=n.length),t-=e.length;const r=n.indexOf(e,t);return-1!==r&&r===t}),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e}),String.prototype.splitOnce||(String.prototype.splitOnce=function(e){const t=this.split(e);return[t.shift(),t.join(e)]}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")})},function(e,t,n){"use strict";e.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},function(e,t){var n=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,r=new RegExp("[\\-\\.0-9"+n.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),i=new RegExp("^"+n.source+r.source+"*(?::"+n.source+r.source+"*)?$");function o(){}function s(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function a(e,t,n,r,i,o){for(var s,a=++t,c=0;;){var u=e.charAt(a);switch(u){case"=":if(1===c)s=e.slice(t,a),c=3;else{if(2!==c)throw new Error("attribute equal must after attrName");c=3}break;case"'":case'"':if(3===c||1===c){if(1===c&&(o.warning('attribute value must after "="'),s=e.slice(t,a)),t=a+1,!((a=e.indexOf(u,t))>0))throw new Error("attribute value no end '"+u+"' match");d=e.slice(t,a).replace(/&#?\w+;/g,i),n.add(s,d,t-1),c=5}else{if(4!=c)throw new Error('attribute value must after "="');d=e.slice(t,a).replace(/&#?\w+;/g,i),n.add(s,d,t),o.warning('attribute "'+s+'" missed start quot('+u+")!!"),t=a+1,c=5}break;case"/":switch(c){case 0:n.setTagName(e.slice(t,a));case 5:case 6:case 7:c=7,n.closed=!0;case 4:case 1:case 2:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return o.error("unexpected end of input"),0==c&&n.setTagName(e.slice(t,a)),a;case">":switch(c){case 0:n.setTagName(e.slice(t,a));case 5:case 6:case 7:break;case 4:case 1:"/"===(d=e.slice(t,a)).slice(-1)&&(n.closed=!0,d=d.slice(0,-1));case 2:2===c&&(d=s),4==c?(o.warning('attribute "'+d+'" missed quot(")!!'),n.add(s,d.replace(/&#?\w+;/g,i),t)):("http://www.w3.org/1999/xhtml"===r[""]&&d.match(/^(?:disabled|checked|selected)$/i)||o.warning('attribute "'+d+'" missed value!! "'+d+'" instead!!'),n.add(d,d,t));break;case 3:throw new Error("attribute value missed!!")}return a;case"":u=" ";default:if(u<=" ")switch(c){case 0:n.setTagName(e.slice(t,a)),c=6;break;case 1:s=e.slice(t,a),c=2;break;case 4:var d=e.slice(t,a).replace(/&#?\w+;/g,i);o.warning('attribute "'+d+'" missed quot(")!!'),n.add(s,d,t);case 5:c=6}else switch(c){case 2:n.tagName;"http://www.w3.org/1999/xhtml"===r[""]&&s.match(/^(?:disabled|checked|selected)$/i)||o.warning('attribute "'+s+'" missed value!! "'+s+'" instead2!!'),n.add(s,s,t),t=a,c=1;break;case 5:o.warning('attribute space is required"'+s+'"!!');case 6:c=1,t=a;break;case 3:c=4,t=a;break;case 7:throw new Error("elements closed character '/' and '>' must be connected to")}}a++}}function c(e,t,n){for(var r=e.tagName,i=null,o=e.length;o--;){var s=e[o],a=s.qName,c=s.value;if((h=a.indexOf(":"))>0)var u=s.prefix=a.slice(0,h),d=a.slice(h+1),f="xmlns"===u&&d;else d=a,u=null,f="xmlns"===a&&"";s.localName=d,!1!==f&&(null==i&&(i={},l(n,n={})),n[f]=i[f]=c,s.uri="http://www.w3.org/2000/xmlns/",t.startPrefixMapping(f,c))}for(o=e.length;o--;){(u=(s=e[o]).prefix)&&("xml"===u&&(s.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==u&&(s.uri=n[u||""]))}var h;(h=r.indexOf(":"))>0?(u=e.prefix=r.slice(0,h),d=e.localName=r.slice(h+1)):(u=null,d=e.localName=r);var p=e.uri=n[u||""];if(t.startElement(p,d,r,e),!e.closed)return e.currentNSMap=n,e.localNSMap=i,!0;if(t.endElement(p,d,r),i)for(u in i)t.endPrefixMapping(u)}function u(e,t,n,r,i){if(/^(?:script|textarea)$/i.test(n)){var o=e.indexOf("</"+n+">",t),s=e.substring(t+1,o);if(/[&<]/.test(s))return/^script$/i.test(n)?(i.characters(s,0,s.length),o):(s=s.replace(/&#?\w+;/g,r),i.characters(s,0,s.length),o)}return t+1}function d(e,t,n,r){var i=r[n];return null==i&&((i=e.lastIndexOf("</"+n+">"))<t&&(i=e.lastIndexOf("</"+n)),r[n]=i),i<t}function l(e,t){for(var n in e)t[n]=e[n]}function f(e,t,n,r){switch(e.charAt(t+2)){case"-":return"-"===e.charAt(t+3)?(i=e.indexOf("--\x3e",t+4))>t?(n.comment(e,t+4,i-t-4),i+3):(r.error("Unclosed comment"),-1):-1;default:if("CDATA["==e.substr(t+3,6)){var i=e.indexOf("]]>",t+9);return n.startCDATA(),n.characters(e,t+9,i-t-9),n.endCDATA(),i+3}var o=function(e,t){var n,r=[],i=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;i.lastIndex=t,i.exec(e);for(;n=i.exec(e);)if(r.push(n),n[1])return r}(e,t),s=o.length;if(s>1&&/!doctype/i.test(o[0][0])){var a=o[1][0],c=s>3&&/^public$/i.test(o[2][0])&&o[3][0],u=s>4&&o[4][0],d=o[s-1];return n.startDTD(a,c&&c.replace(/^(['"])(.*?)\1$/,"$2"),u&&u.replace(/^(['"])(.*?)\1$/,"$2")),n.endDTD(),d.index+d[0].length}}return-1}function h(e,t,n){var r=e.indexOf("?>",t);if(r){var i=e.substring(t,r).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(i){i[0].length;return n.processingInstruction(i[1],i[2]),r+2}return-1}return-1}function p(e){}function g(e,t){return e.__proto__=t,e}o.prototype={parse:function(e,t,n){var r=this.domBuilder;r.startDocument(),l(t,t={}),function(e,t,n,r,i){function o(e){var t=e.slice(1,-1);return t in n?n[t]:"#"===t.charAt(0)?function(e){if(e>65535){var t=55296+((e-=65536)>>10),n=56320+(1023&e);return String.fromCharCode(t,n)}return String.fromCharCode(e)}(parseInt(t.substr(1).replace("x","0x"))):(i.error("entity not found:"+e),e)}function l(t){if(t>S){var n=e.substring(S,t).replace(/&#?\w+;/g,o);y&&g(S),r.characters(n,0,t-S),S=t}}function g(t,n){for(;t>=v&&(n=_.exec(e));)m=n.index,v=m+n[0].length,y.lineNumber++;y.columnNumber=t-m+1}var m=0,v=0,_=/.*(?:\r\n?|\n)|.*$/g,y=r.locator,b=[{currentNSMap:t}],w={},S=0;for(;;){try{var x=e.indexOf("<",S);if(x<0){if(!e.substr(S).match(/^\s*$/)){var E=r.doc,A=E.createTextNode(e.substr(S));E.appendChild(A),r.currentElement=A}return}switch(x>S&&l(x),e.charAt(x+1)){case"/":var N=e.indexOf(">",x+3),O=e.substring(x+2,N),j=b.pop();N<0?(O=e.substring(x+2).replace(/[\s<].*/,""),i.error("end tag name: "+O+" is not complete:"+j.tagName),N=x+1+O.length):O.match(/\s</)&&(O=O.replace(/[\s<].*/,""),i.error("end tag name: "+O+" maybe not complete"),N=x+1+O.length);var T=j.localNSMap,C=j.tagName==O;if(C||j.tagName&&j.tagName.toLowerCase()==O.toLowerCase()){if(r.endElement(j.uri,j.localName,O),T)for(var I in T)r.endPrefixMapping(I);C||i.fatalError("end tag name: "+O+" is not match the current start tagName:"+j.tagName)}else b.push(j);N++;break;case"?":y&&g(x),N=h(e,x,r);break;case"!":y&&g(x),N=f(e,x,r,i);break;default:y&&g(x);var R=new p,M=b[b.length-1].currentNSMap,k=(N=a(e,x,R,M,o,i),R.length);if(!R.closed&&d(e,N,R.tagName,w)&&(R.closed=!0,n.nbsp||i.warning("unclosed xml attribute")),y&&k){for(var D=s(y,{}),P=0;P<k;P++){var L=R[P];g(L.offset),L.locator=s(y,{})}r.locator=D,c(R,r,M)&&b.push(R),r.locator=y}else c(R,r,M)&&b.push(R);"http://www.w3.org/1999/xhtml"!==R.uri||R.closed?N++:N=u(e,N,R.tagName,o,r)}}catch(e){i.error("element parse error: "+e),N=-1}N>S?S=N:l(Math.max(x,S)+1)}}(e,t,n,r,this.errorHandler),r.endDocument()}},p.prototype={setTagName:function(e){if(!i.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},add:function(e,t,n){if(!i.test(e))throw new Error("invalid attribute:"+e);this[this.length++]={qName:e,value:t,offset:n}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},g({},g.prototype)instanceof g||(g=function(e,t){function n(){}for(t in n.prototype=t,n=new n,e)n[t]=e[t];return n}),t.XMLReader=o},function(e,t,n){"use strict";function r(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(e);return t<0?void 0:t}e.exports=function(e){if((e=(e=""+e).replace(/[ \t\n\f\r]/g,"")).length%4==0&&(e=e.replace(/==?$/,"")),e.length%4==1||/[^+/0-9A-Za-z]/.test(e))return null;let t="",n=0,i=0;for(let o=0;o<e.length;o++)n<<=6,n|=r(e[o]),i+=6,24===i&&(t+=String.fromCharCode((16711680&n)>>16),t+=String.fromCharCode((65280&n)>>8),t+=String.fromCharCode(255&n),n=i=0);return 12===i?(n>>=4,t+=String.fromCharCode(n)):18===i&&(n>>=2,t+=String.fromCharCode((65280&n)>>8),t+=String.fromCharCode(255&n)),t}},function(e,t,n){"use strict";function r(e){if(e>=0&&e<64)return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e]}e.exports=function(e){let t;for(e=""+e,t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return null;let n="";for(t=0;t<e.length;t+=3){const i=[void 0,void 0,void 0,void 0];i[0]=e.charCodeAt(t)>>2,i[1]=(3&e.charCodeAt(t))<<4,e.length>t+1&&(i[1]|=e.charCodeAt(t+1)>>4,i[2]=(15&e.charCodeAt(t+1))<<2),e.length>t+2&&(i[2]|=e.charCodeAt(t+2)>>6,i[3]=63&e.charCodeAt(t+2));for(let e=0;e<i.length;e++)void 0===i[e]?n+="=":n+=r(i[e])}return n}},function(e,t){e.exports=function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o}},function(e,t,n){var r=n(161);e.exports=function(e){return e?(e=r(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},function(e,t,n){var r=n(13),i=n(38),o=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,c=/^0o[0-7]+$/i,u=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(i(e))return NaN;if(r(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=r(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(o,"");var n=a.test(e);return n||c.test(e)?u(e.slice(2),n?2:8):s.test(e)?NaN:+e}},function(e,t,n){var r=n(39),i=Object.prototype,o=i.hasOwnProperty,s=i.toString,a=r?r.toStringTag:void 0;e.exports=function(e){var t=o.call(e,a),n=e[a];try{e[a]=void 0;var r=!0}catch(e){}var i=s.call(e);return r&&(t?e[a]=n:delete e[a]),i}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t,n){var r=n(86),i=n(165),o=n(177),s=n(9);e.exports=function(e,t){return(s(e)?r:i)(e,o(t))}},function(e,t,n){var r=n(166),i=n(176)(r);e.exports=i},function(e,t,n){var r=n(167),i=n(27);e.exports=function(e,t){return e&&r(e,t,i)}},function(e,t,n){var r=n(168)();e.exports=r},function(e,t){e.exports=function(e){return function(t,n,r){for(var i=-1,o=Object(t),s=r(t),a=s.length;a--;){var c=s[e?a:++i];if(!1===n(o[c],c,o))break}return t}}},function(e,t){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},function(e,t,n){var r=n(18),i=n(15);e.exports=function(e){return i(e)&&"[object Arguments]"==r(e)}},function(e,t){e.exports=function(){return!1}},function(e,t,n){var r=n(18),i=n(59),o=n(15),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.exports=function(e){return o(e)&&i(e.length)&&!!s[r(e)]}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t,n){(function(e){var r=n(85),i=t&&!t.nodeType&&t,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=o&&o.exports===i&&r.process,a=function(){try{var e=o&&o.require&&o.require("util").types;return e||s&&s.binding&&s.binding("util")}catch(e){}}();e.exports=a}).call(this,n(58)(e))},function(e,t,n){var r=n(93)(Object.keys,Object);e.exports=r},function(e,t,n){var r=n(23);e.exports=function(e,t){return function(n,i){if(null==n)return n;if(!r(n))return e(n,i);for(var o=n.length,s=t?o:-1,a=Object(n);(t?s--:++s<o)&&!1!==i(a[s],s,a););return n}}},function(e,t,n){var r=n(30);e.exports=function(e){return"function"==typeof e?e:r}},function(e,t,n){var r=n(179),i=n(184),o=n(101),s=i((function(e,t){r(t,o(t),e)}));e.exports=s},function(e,t,n){var r=n(94),i=n(95);e.exports=function(e,t,n,o){var s=!n;n||(n={});for(var a=-1,c=t.length;++a<c;){var u=t[a],d=o?o(n[u],e[u],u,n,e):void 0;void 0===d&&(d=e[u]),s?i(n,u,d):r(n,u,d)}return n}},function(e,t,n){var r=n(52),i=n(181),o=n(13),s=n(97),a=/^\[object .+?Constructor\]$/,c=Function.prototype,u=Object.prototype,d=c.toString,l=u.hasOwnProperty,f=RegExp("^"+d.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!o(e)||i(e))&&(r(e)?f:a).test(s(e))}},function(e,t,n){var r,i=n(182),o=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!o&&o in e}},function(e,t,n){var r=n(5)["__core-js_shared__"];e.exports=r},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t,n){var r=n(98),i=n(188);e.exports=function(e){return r((function(t,n){var r=-1,o=n.length,s=o>1?n[o-1]:void 0,a=o>2?n[2]:void 0;for(s=e.length>3&&"function"==typeof s?(o--,s):void 0,a&&i(n[0],n[1],a)&&(s=o<3?void 0:s,o=1),t=Object(t);++r<o;){var c=n[r];c&&e(t,c,r,s)}return t}))}},function(e,t,n){var r=n(60),i=Math.max;e.exports=function(e,t,n){return t=i(void 0===t?e.length-1:t,0),function(){for(var o=arguments,s=-1,a=i(o.length-t,0),c=Array(a);++s<a;)c[s]=o[t+s];s=-1;for(var u=Array(t+1);++s<t;)u[s]=o[s];return u[t]=n(c),r(e,this,u)}}},function(e,t,n){var r=n(187),i=n(96),o=n(30),s=i?function(e,t){return i(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:o;e.exports=s},function(e,t){e.exports=function(e){return function(){return e}}},function(e,t,n){var r=n(40),i=n(23),o=n(29),s=n(13);e.exports=function(e,t,n){if(!s(n))return!1;var a=typeof t;return!!("number"==a?i(n)&&o(t,n.length):"string"==a&&t in n)&&r(n[t],e)}},function(e,t,n){var r=n(13),i=n(92),o=n(190),s=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return o(e);var t=i(e),n=[];for(var a in e)("constructor"!=a||!t&&s.call(e,a))&&n.push(a);return n}},function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},function(e,t){e.exports=function(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}},function(e,t){e.exports=function(e){return e!=e}},function(e,t){e.exports=function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}},function(e,t,n){var r=n(61);e.exports=function(e,t){return r(t,(function(t){return e[t]}))}},function(e,t,n){var r=n(104),i=n(196),o=n(197),s=n(107),a=n(210),c=n(111),u=n(211),d=n(114),l=n(115),f=n(57),h=Math.max;e.exports=function(e,t,n,p,g,m,v,_){var y=2&t;if(!y&&"function"!=typeof e)throw new TypeError("Expected a function");var b=p?p.length:0;if(b||(t&=-97,p=g=void 0),v=void 0===v?v:h(f(v),0),_=void 0===_?_:f(_),b-=g?g.length:0,64&t){var w=p,S=g;p=g=void 0}var x=y?void 0:c(e),E=[e,t,n,p,g,w,S,m,v,_];if(x&&u(E,x),e=E[0],t=E[1],n=E[2],p=E[3],g=E[4],!(_=E[9]=void 0===E[9]?y?0:e.length:h(E[9]-b,0))&&24&t&&(t&=-25),t&&1!=t)A=8==t||16==t?o(e,t,_):32!=t&&33!=t||g.length?s.apply(void 0,E):a(e,t,n,p);else var A=i(e,t,n);return l((x?r:d)(A,E),e,t)}},function(e,t,n){var r=n(41),i=n(5);e.exports=function(e,t,n){var o=1&t,s=r(e);return function t(){var r=this&&this!==i&&this instanceof t?s:e;return r.apply(o?n:this,arguments)}}},function(e,t,n){var r=n(60),i=n(41),o=n(107),s=n(110),a=n(65),c=n(42),u=n(5);e.exports=function(e,t,n){var d=i(e);return function i(){for(var l=arguments.length,f=Array(l),h=l,p=a(i);h--;)f[h]=arguments[h];var g=l<3&&f[0]!==p&&f[l-1]!==p?[]:c(f,p);if((l-=g.length)<n)return s(e,t,o,i.placeholder,void 0,f,g,void 0,void 0,n-l);var m=this&&this!==u&&this instanceof i?d:e;return r(m,this,f)}}},function(e,t){e.exports=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}},function(e,t,n){var r=n(63),i=n(111),o=n(201),s=n(203);e.exports=function(e){var t=o(e),n=s[t];if("function"!=typeof n||!(t in r.prototype))return!1;if(e===n)return!0;var a=i(n);return!!a&&e===a[0]}},function(e,t){e.exports=function(){}},function(e,t,n){var r=n(202),i=Object.prototype.hasOwnProperty;e.exports=function(e){for(var t=e.name+"",n=r[t],o=i.call(r,t)?n.length:0;o--;){var s=n[o],a=s.func;if(null==a||a==e)return s.name}return t}},function(e,t){e.exports={}},function(e,t,n){var r=n(63),i=n(112),o=n(64),s=n(9),a=n(15),c=n(204),u=Object.prototype.hasOwnProperty;function d(e){if(a(e)&&!s(e)&&!(e instanceof r)){if(e instanceof i)return e;if(u.call(e,"__wrapped__"))return c(e)}return new i(e)}d.prototype=o.prototype,d.prototype.constructor=d,e.exports=d},function(e,t,n){var r=n(63),i=n(112),o=n(113);e.exports=function(e){if(e instanceof r)return e.clone();var t=new i(e.__wrapped__,e.__chain__);return t.__actions__=o(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}},function(e,t){var n=/\{\n\/\* \[wrapped with (.+)\] \*/,r=/,? & /;e.exports=function(e){var t=e.match(n);return t?t[1].split(r):[]}},function(e,t){var n=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;e.exports=function(e,t){var r=t.length;if(!r)return e;var i=r-1;return t[i]=(r>1?"& ":"")+t[i],t=t.join(r>2?", ":" "),e.replace(n,"{\n/* [wrapped with "+t+"] */\n")}},function(e,t,n){var r=n(86),i=n(208),o=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];e.exports=function(e,t){return r(o,(function(n){var r="_."+n[0];t&n[1]&&!i(e,r)&&e.push(r)})),e.sort()}},function(e,t,n){var r=n(102);e.exports=function(e,t){return!!(null==e?0:e.length)&&r(e,t,0)>-1}},function(e,t,n){var r=n(113),i=n(29),o=Math.min;e.exports=function(e,t){for(var n=e.length,s=o(t.length,n),a=r(e);s--;){var c=t[s];e[s]=i(c,n)?a[c]:void 0}return e}},function(e,t,n){var r=n(60),i=n(41),o=n(5);e.exports=function(e,t,n,s){var a=1&t,c=i(e);return function t(){for(var i=-1,u=arguments.length,d=-1,l=s.length,f=Array(l+u),h=this&&this!==o&&this instanceof t?c:e;++d<l;)f[d]=s[d];for(;u--;)f[d++]=arguments[++i];return r(h,a?n:this,f)}}},function(e,t,n){var r=n(108),i=n(109),o=n(42),s=Math.min;e.exports=function(e,t){var n=e[1],a=t[1],c=n|a,u=c<131,d=128==a&&8==n||128==a&&256==n&&e[7].length<=t[8]||384==a&&t[7].length<=t[8]&&8==n;if(!u&&!d)return e;1&a&&(e[2]=t[2],c|=1&n?0:4);var l=t[3];if(l){var f=e[3];e[3]=f?r(f,l,t[4]):l,e[4]=f?o(e[3],"__lodash_placeholder__"):t[4]}return(l=t[5])&&(f=e[5],e[5]=f?i(f,l,t[6]):l,e[6]=f?o(e[5],"__lodash_placeholder__"):t[6]),(l=t[7])&&(e[7]=l),128&a&&(e[8]=null==e[8]?t[8]:s(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=c,e}},function(e,t,n){var r=n(213),i=n(254),o=n(30),s=n(9),a=n(264);e.exports=function(e){return"function"==typeof e?e:null==e?o:"object"==typeof e?s(e)?i(e[0],e[1]):r(e):a(e)}},function(e,t,n){var r=n(214),i=n(253),o=n(125);e.exports=function(e){var t=i(e);return 1==t.length&&t[0][2]?o(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t)}}},function(e,t,n){var r=n(116),i=n(117);e.exports=function(e,t,n,o){var s=n.length,a=s,c=!o;if(null==e)return!a;for(e=Object(e);s--;){var u=n[s];if(c&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++s<a;){var d=(u=n[s])[0],l=e[d],f=u[1];if(c&&u[2]){if(void 0===l&&!(d in e))return!1}else{var h=new r;if(o)var p=o(l,f,d,e,t,h);if(!(void 0===p?i(f,l,3,o,h):p))return!1}}return!0}},function(e,t){e.exports=function(){this.__data__=[],this.size=0}},function(e,t,n){var r=n(44),i=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0)&&(n==t.length-1?t.pop():i.call(t,n,1),--this.size,!0)}},function(e,t,n){var r=n(44);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},function(e,t,n){var r=n(44);e.exports=function(e){return r(this.__data__,e)>-1}},function(e,t,n){var r=n(44);e.exports=function(e,t){var n=this.__data__,i=r(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}},function(e,t,n){var r=n(43);e.exports=function(){this.__data__=new r,this.size=0}},function(e,t){e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},function(e,t){e.exports=function(e){return this.__data__.get(e)}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t,n){var r=n(43),i=n(66),o=n(67);e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var s=n.__data__;if(!i||s.length<199)return s.push([e,t]),this.size=++n.size,this;n=this.__data__=new o(s)}return n.set(e,t),this.size=n.size,this}},function(e,t,n){var r=n(226),i=n(43),o=n(66);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(o||i),string:new r}}},function(e,t,n){var r=n(227),i=n(228),o=n(229),s=n(230),a=n(231);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=s,c.prototype.set=a,e.exports=c},function(e,t,n){var r=n(45);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},function(e,t,n){var r=n(45),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(t,e)?t[e]:void 0}},function(e,t,n){var r=n(45),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:i.call(t,e)}},function(e,t,n){var r=n(45);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},function(e,t,n){var r=n(46);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},function(e,t,n){var r=n(46);e.exports=function(e){return r(this,e).get(e)}},function(e,t,n){var r=n(46);e.exports=function(e){return r(this,e).has(e)}},function(e,t,n){var r=n(46);e.exports=function(e,t){var n=r(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}},function(e,t,n){var r=n(116),i=n(118),o=n(243),s=n(247),a=n(123),c=n(9),u=n(89),d=n(90),l="[object Object]",f=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,h,p,g){var m=c(e),v=c(t),_=m?"[object Array]":a(e),y=v?"[object Array]":a(t),b=(_="[object Arguments]"==_?l:_)==l,w=(y="[object Arguments]"==y?l:y)==l,S=_==y;if(S&&u(e)){if(!u(t))return!1;m=!0,b=!1}if(S&&!b)return g||(g=new r),m||d(e)?i(e,t,n,h,p,g):o(e,t,_,n,h,p,g);if(!(1&n)){var x=b&&f.call(e,"__wrapped__"),E=w&&f.call(t,"__wrapped__");if(x||E){var A=x?e.value():e,N=E?t.value():t;return g||(g=new r),p(A,N,n,h,g)}}return!!S&&(g||(g=new r),s(e,t,n,h,p,g))}},function(e,t,n){var r=n(67),i=n(239),o=n(240);function s(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}s.prototype.add=s.prototype.push=i,s.prototype.has=o,e.exports=s},function(e,t){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},function(e,t){e.exports=function(e,t){return e.has(t)}},function(e,t,n){var r=n(39),i=n(244),o=n(40),s=n(118),a=n(245),c=n(246),u=r?r.prototype:void 0,d=u?u.valueOf:void 0;e.exports=function(e,t,n,r,u,l,f){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!l(new i(e),new i(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var h=a;case"[object Set]":var p=1&r;if(h||(h=c),e.size!=t.size&&!p)return!1;var g=f.get(e);if(g)return g==t;r|=2,f.set(e,t);var m=s(h(e),h(t),r,u,l,f);return f.delete(e),m;case"[object Symbol]":if(d)return d.call(e)==d.call(t)}return!1}},function(e,t,n){var r=n(5).Uint8Array;e.exports=r},function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}},function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}},function(e,t,n){var r=n(248),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,o,s,a){var c=1&n,u=r(e),d=u.length;if(d!=r(t).length&&!c)return!1;for(var l=d;l--;){var f=u[l];if(!(c?f in t:i.call(t,f)))return!1}var h=a.get(e),p=a.get(t);if(h&&p)return h==t&&p==e;var g=!0;a.set(e,t),a.set(t,e);for(var m=c;++l<d;){var v=e[f=u[l]],_=t[f];if(o)var y=c?o(_,v,f,t,e,a):o(v,_,f,e,t,a);if(!(void 0===y?v===_||s(v,_,n,o,a):y)){g=!1;break}m||(m="constructor"==f)}if(g&&!m){var b=e.constructor,w=t.constructor;b==w||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w||(g=!1)}return a.delete(e),a.delete(t),g}},function(e,t,n){var r=n(119),i=n(121),o=n(27);e.exports=function(e){return r(e,o,i)}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s,n,e)&&(o[i++]=s)}return o}},function(e,t,n){var r=n(19)(n(5),"DataView");e.exports=r},function(e,t,n){var r=n(19)(n(5),"Promise");e.exports=r},function(e,t,n){var r=n(19)(n(5),"Set");e.exports=r},function(e,t,n){var r=n(124),i=n(27);e.exports=function(e){for(var t=i(e),n=t.length;n--;){var o=t[n],s=e[o];t[n]=[o,s,r(s)]}return t}},function(e,t,n){var r=n(117),i=n(255),o=n(261),s=n(69),a=n(124),c=n(125),u=n(31);e.exports=function(e,t){return s(e)&&a(t)?c(u(e),t):function(n){var s=i(n,e);return void 0===s&&s===t?o(n,e):r(t,s,3)}}},function(e,t,n){var r=n(68);e.exports=function(e,t,n){var i=null==e?void 0:r(e,t);return void 0===i?n:i}},function(e,t,n){var r=n(257),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,s=r((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(i,(function(e,n,r,i){t.push(r?i.replace(o,"$1"):n||e)})),t}));e.exports=s},function(e,t,n){var r=n(258);e.exports=function(e){var t=r(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}},function(e,t,n){var r=n(67);function i(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(i.Cache||r),n}i.Cache=r,e.exports=i},function(e,t,n){var r=n(260);e.exports=function(e){return null==e?"":r(e)}},function(e,t,n){var r=n(39),i=n(61),o=n(9),s=n(38),a=r?r.prototype:void 0,c=a?a.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(o(t))return i(t,e)+"";if(s(t))return c?c.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}},function(e,t,n){var r=n(262),i=n(263);e.exports=function(e,t){return null!=e&&i(e,t,r)}},function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},function(e,t,n){var r=n(47),i=n(88),o=n(9),s=n(29),a=n(59),c=n(31);e.exports=function(e,t,n){for(var u=-1,d=(t=r(t,e)).length,l=!1;++u<d;){var f=c(t[u]);if(!(l=null!=e&&n(e,f)))break;e=e[f]}return l||++u!=d?l:!!(d=null==e?0:e.length)&&a(d)&&s(f,d)&&(o(e)||i(e))}},function(e,t,n){var r=n(126),i=n(265),o=n(69),s=n(31);e.exports=function(e){return o(e)?r(s(e)):i(e)}},function(e,t,n){var r=n(68);e.exports=function(e){return function(t){return r(t,e)}}},function(e,t,n){var r=n(68),i=n(267),o=n(47);e.exports=function(e,t,n){for(var s=-1,a=t.length,c={};++s<a;){var u=t[s],d=r(e,u);n(d,u)&&i(c,o(u,e),d)}return c}},function(e,t,n){var r=n(94),i=n(47),o=n(29),s=n(13),a=n(31);e.exports=function(e,t,n,c){if(!s(e))return e;for(var u=-1,d=(t=i(t,e)).length,l=d-1,f=e;null!=f&&++u<d;){var h=a(t[u]),p=n;if("__proto__"===h||"constructor"===h||"prototype"===h)return e;if(u!=l){var g=f[h];void 0===(p=c?c(g,h,f):void 0)&&(p=s(g)?g:o(t[u+1])?[]:{})}r(f,h,p),f=f[h]}return e}},function(e,t,n){var r=n(119),i=n(269),o=n(101);e.exports=function(e){return r(e,o,i)}},function(e,t,n){var r=n(120),i=n(270),o=n(121),s=n(122),a=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)r(t,o(e)),e=i(e);return t}:s;e.exports=a},function(e,t,n){var r=n(93)(Object.getPrototypeOf,Object);e.exports=r},function(e,t,n){var r=n(272),i=n(273),o=n(274);e.exports=function(e){return i(e)?o(e):r(e)}},function(e,t,n){var r=n(126)("length");e.exports=r},function(e,t){var n=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return n.test(e)}},function(e,t){var n="[\\ud800-\\udfff]",r="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",i="\\ud83c[\\udffb-\\udfff]",o="[^\\ud800-\\udfff]",s="(?:\\ud83c[\\udde6-\\uddff]){2}",a="[\\ud800-\\udbff][\\udc00-\\udfff]",c="(?:"+r+"|"+i+")"+"?",u="[\\ufe0e\\ufe0f]?"+c+("(?:\\u200d(?:"+[o,s,a].join("|")+")[\\ufe0e\\ufe0f]?"+c+")*"),d="(?:"+[o+r+"?",r,s,a,n].join("|")+")",l=RegExp(i+"(?="+i+")|"+d+u,"g");e.exports=function(e){for(var t=l.lastIndex=0;l.test(e);)++t;return t}},function(e,t,n){"use strict";t.__esModule=!0;var r,i=n(276),o=(r=i)&&r.__esModule?r:{default:r};t.default=function(e,t,n){return t in e?(0,o.default)(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t,n){e.exports={default:n(277),__esModule:!0}},function(e,t,n){n(278);var r=n(11).Object;e.exports=function(e,t,n){return r.defineProperty(e,t,n)}},function(e,t,n){var r=n(24);r(r.S+r.F*!n(26),"Object",{defineProperty:n(32).f})},function(e,t,n){e.exports=!n(26)&&!n(70)((function(){return 7!=Object.defineProperty(n(71)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(33);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){e.exports={default:n(282),__esModule:!0}},function(e,t,n){n(283),e.exports=n(11).Object.keys},function(e,t,n){var r=n(129),i=n(130);n(288)("keys",(function(){return function(e){return i(r(e))}}))},function(e,t,n){var r=n(50),i=n(73),o=n(286)(!1),s=n(75)("IE_PROTO");e.exports=function(e,t){var n,a=i(e),c=0,u=[];for(n in a)n!=s&&r(a,n)&&u.push(n);for(;t.length>c;)r(a,n=t[c++])&&(~o(u,n)||u.push(n));return u}},function(e,t,n){var r=n(51);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){var r=n(73),i=n(131),o=n(287);e.exports=function(e){return function(t,n,s){var a,c=r(t),u=i(c.length),d=o(s,u);if(e&&n!=n){for(;u>d;)if((a=c[d++])!=a)return!0}else for(;u>d;d++)if((e||d in c)&&c[d]===n)return e||d||0;return!e&&-1}}},function(e,t,n){var r=n(74),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=r(e))<0?i(e+t,0):o(e,t)}},function(e,t,n){var r=n(24),i=n(11),o=n(70);e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],s={};s[e]=t(n),r(r.S+r.F*o((function(){n(1)})),"Object",s)}},function(e,t,n){e.exports=n(290)},function(e,t,n){var r=function(){return this}()||Function("return this")(),i=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0,o=i&&r.regeneratorRuntime;if(r.regeneratorRuntime=void 0,e.exports=n(291),i)r.regeneratorRuntime=o;else try{delete r.regeneratorRuntime}catch(e){r.regeneratorRuntime=void 0}},function(e,t){!function(t){"use strict";var n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag",c="object"==typeof e,u=t.regeneratorRuntime;if(u)c&&(e.exports=u);else{(u=t.regeneratorRuntime=c?e.exports:{}).wrap=g;var d={},l={};l[o]=function(){return this};var f=Object.getPrototypeOf,h=f&&f(f(N([])));h&&h!==n&&r.call(h,o)&&(l=h);var p=y.prototype=v.prototype=Object.create(l);_.prototype=p.constructor=y,y.constructor=_,y[a]=_.displayName="GeneratorFunction",u.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},u.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,a in e||(e[a]="GeneratorFunction")),e.prototype=Object.create(p),e},u.awrap=function(e){return{__await:e}},b(w.prototype),w.prototype[s]=function(){return this},u.AsyncIterator=w,u.async=function(e,t,n,r){var i=new w(g(e,t,n,r));return u.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},b(p),p[a]="Generator",p[o]=function(){return this},p.toString=function(){return"[object Generator]"},u.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},u.values=N,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return s.type="throw",s.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:N(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}}}function g(e,t,n,r){var i=t&&t.prototype instanceof v?t:v,o=Object.create(i.prototype),s=new A(r||[]);return o._invoke=function(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=S(s,n);if(a){if(a===d)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=m(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(e,n,s),o}function m(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function v(){}function _(){}function y(){}function b(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function w(e){var t;this._invoke=function(n,i){function o(){return new Promise((function(t,o){!function t(n,i,o,s){var a=m(e[n],e,i);if("throw"!==a.type){var c=a.arg,u=c.value;return u&&"object"==typeof u&&r.call(u,"__await")?Promise.resolve(u.__await).then((function(e){t("next",e,o,s)}),(function(e){t("throw",e,o,s)})):Promise.resolve(u).then((function(e){c.value=e,o(c)}),s)}s(a.arg)}(n,i,t,o)}))}return t=t?t.then(o,o):o()}}function S(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var r=m(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,d;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function N(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}}(function(){return this}()||Function("return this")())},function(e,t,n){"use strict";t.__esModule=!0;var r,i=n(77),o=(r=i)&&r.__esModule?r:{default:r};t.default=function(e){return function(){var t=e.apply(this,arguments);return new o.default((function(e,n){return function r(i,s){try{var a=t[i](s),c=a.value}catch(e){return void n(e)}if(!a.done)return o.default.resolve(c).then((function(e){r("next",e)}),(function(e){r("throw",e)}));e(c)}("next")}))}}},function(e,t,n){n(294),n(295),n(302),n(306),n(318),n(319),e.exports=n(11).Promise},function(e,t){},function(e,t,n){"use strict";var r=n(296)(!0);n(135)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})}))},function(e,t,n){var r=n(74),i=n(72);e.exports=function(e){return function(t,n){var o,s,a=String(i(t)),c=r(n),u=a.length;return c<0||c>=u?e?"":void 0:(o=a.charCodeAt(c))<55296||o>56319||c+1===u||(s=a.charCodeAt(c+1))<56320||s>57343?e?a.charAt(c):o:e?a.slice(c,c+2):s-56320+(o-55296<<10)+65536}}},function(e,t,n){e.exports=n(25)},function(e,t,n){"use strict";var r=n(299),i=n(128),o=n(78),s={};n(25)(s,n(10)("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=r(s,{next:i(1,n)}),o(e,t+" Iterator")}},function(e,t,n){var r=n(20),i=n(300),o=n(134),s=n(75)("IE_PROTO"),a=function(){},c=function(){var e,t=n(71)("iframe"),r=o.length;for(t.style.display="none",n(136).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),c=e.F;r--;)delete c.prototype[o[r]];return c()};e.exports=Object.create||function(e,t){var n;return null!==e?(a.prototype=r(e),n=new a,a.prototype=null,n[s]=e):n=c(),void 0===t?n:i(n,t)}},function(e,t,n){var r=n(32),i=n(20),o=n(130);e.exports=n(26)?Object.defineProperties:function(e,t){i(e);for(var n,s=o(t),a=s.length,c=0;a>c;)r.f(e,n=s[c++],t[n]);return e}},function(e,t,n){var r=n(50),i=n(129),o=n(75)("IE_PROTO"),s=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?s:null}},function(e,t,n){n(303);for(var r=n(6),i=n(25),o=n(34),s=n(10)("toStringTag"),a="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),c=0;c<a.length;c++){var u=a[c],d=r[u],l=d&&d.prototype;l&&!l[s]&&i(l,s,u),o[u]=o.Array}},function(e,t,n){"use strict";var r=n(304),i=n(305),o=n(34),s=n(73);e.exports=n(135)(Array,"Array",(function(e,t){this._t=s(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){"use strict";var r,i,o,s,a=n(76),c=n(6),u=n(48),d=n(137),l=n(24),f=n(33),h=n(49),p=n(307),g=n(308),m=n(138),v=n(139).set,_=n(313)(),y=n(79),b=n(140),w=n(314),S=n(141),x=c.TypeError,E=c.process,A=E&&E.versions,N=A&&A.v8||"",O=c.Promise,j="process"==d(E),T=function(){},C=i=y.f,I=!!function(){try{var e=O.resolve(1),t=(e.constructor={})[n(10)("species")]=function(e){e(T,T)};return(j||"function"==typeof PromiseRejectionEvent)&&e.then(T)instanceof t&&0!==N.indexOf("6.6")&&-1===w.indexOf("Chrome/66")}catch(e){}}(),R=function(e){var t;return!(!f(e)||"function"!=typeof(t=e.then))&&t},M=function(e,t){if(!e._n){e._n=!0;var n=e._c;_((function(){for(var r=e._v,i=1==e._s,o=0,s=function(t){var n,o,s,a=i?t.ok:t.fail,c=t.resolve,u=t.reject,d=t.domain;try{a?(i||(2==e._h&&P(e),e._h=1),!0===a?n=r:(d&&d.enter(),n=a(r),d&&(d.exit(),s=!0)),n===t.promise?u(x("Promise-chain cycle")):(o=R(n))?o.call(n,c,u):c(n)):u(r)}catch(e){d&&!s&&d.exit(),u(e)}};n.length>o;)s(n[o++]);e._c=[],e._n=!1,t&&!e._h&&k(e)}))}},k=function(e){v.call(c,(function(){var t,n,r,i=e._v,o=D(e);if(o&&(t=b((function(){j?E.emit("unhandledRejection",i,e):(n=c.onunhandledrejection)?n({promise:e,reason:i}):(r=c.console)&&r.error&&r.error("Unhandled promise rejection",i)})),e._h=j||D(e)?2:1),e._a=void 0,o&&t.e)throw t.v}))},D=function(e){return 1!==e._h&&0===(e._a||e._c).length},P=function(e){v.call(c,(function(){var t;j?E.emit("rejectionHandled",e):(t=c.onrejectionhandled)&&t({promise:e,reason:e._v})}))},L=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),M(t,!0))},F=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw x("Promise can't be resolved itself");(t=R(e))?_((function(){var r={_w:n,_d:!1};try{t.call(e,u(F,r,1),u(L,r,1))}catch(e){L.call(r,e)}})):(n._v=e,n._s=1,M(n,!1))}catch(e){L.call({_w:n,_d:!1},e)}}};I||(O=function(e){p(this,O,"Promise","_h"),h(e),r.call(this);try{e(u(F,this,1),u(L,this,1))}catch(e){L.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(315)(O.prototype,{then:function(e,t){var n=C(m(this,O));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=j?E.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&M(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new r;this.promise=e,this.resolve=u(F,e,1),this.reject=u(L,e,1)},y.f=C=function(e){return e===O||e===s?new o(e):i(e)}),l(l.G+l.W+l.F*!I,{Promise:O}),n(78)(O,"Promise"),n(316)("Promise"),s=n(11).Promise,l(l.S+l.F*!I,"Promise",{reject:function(e){var t=C(this);return(0,t.reject)(e),t.promise}}),l(l.S+l.F*(a||!I),"Promise",{resolve:function(e){return S(a&&this===s?O:this,e)}}),l(l.S+l.F*!(I&&n(317)((function(e){O.all(e).catch(T)}))),"Promise",{all:function(e){var t=this,n=C(t),r=n.resolve,i=n.reject,o=b((function(){var n=[],o=0,s=1;g(e,!1,(function(e){var a=o++,c=!1;n.push(void 0),s++,t.resolve(e).then((function(e){c||(c=!0,n[a]=e,--s||r(n))}),i)})),--s||r(n)}));return o.e&&i(o.v),n.promise},race:function(e){var t=this,n=C(t),r=n.reject,i=b((function(){g(e,!1,(function(e){t.resolve(e).then(n.resolve,r)}))}));return i.e&&r(i.v),n.promise}})},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(48),i=n(309),o=n(310),s=n(20),a=n(131),c=n(311),u={},d={};(t=e.exports=function(e,t,n,l,f){var h,p,g,m,v=f?function(){return e}:c(e),_=r(n,l,t?2:1),y=0;if("function"!=typeof v)throw TypeError(e+" is not iterable!");if(o(v)){for(h=a(e.length);h>y;y++)if((m=t?_(s(p=e[y])[0],p[1]):_(e[y]))===u||m===d)return m}else for(g=v.call(e);!(p=g.next()).done;)if((m=i(g,_,p.value,t))===u||m===d)return m}).BREAK=u,t.RETURN=d},function(e,t,n){var r=n(20);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&r(o.call(e)),t}}},function(e,t,n){var r=n(34),i=n(10)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||o[i]===e)}},function(e,t,n){var r=n(137),i=n(10)("iterator"),o=n(34);e.exports=n(11).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[r(e)]}},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(6),i=n(139).set,o=r.MutationObserver||r.WebKitMutationObserver,s=r.process,a=r.Promise,c="process"==n(51)(s);e.exports=function(){var e,t,n,u=function(){var r,i;for(c&&(r=s.domain)&&r.exit();e;){i=e.fn,e=e.next;try{i()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(c)n=function(){s.nextTick(u)};else if(!o||r.navigator&&r.navigator.standalone)if(a&&a.resolve){var d=a.resolve(void 0);n=function(){d.then(u)}}else n=function(){i.call(r,u)};else{var l=!0,f=document.createTextNode("");new o(u).observe(f,{characterData:!0}),n=function(){f.data=l=!l}}return function(r){var i={fn:r,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}}},function(e,t,n){var r=n(6).navigator;e.exports=r&&r.userAgent||""},function(e,t,n){var r=n(25);e.exports=function(e,t,n){for(var i in t)n&&e[i]?e[i]=t[i]:r(e,i,t[i]);return e}},function(e,t,n){"use strict";var r=n(6),i=n(11),o=n(32),s=n(26),a=n(10)("species");e.exports=function(e){var t="function"==typeof i[e]?i[e]:r[e];s&&t&&!t[a]&&o.f(t,a,{configurable:!0,get:function(){return this}})}},function(e,t,n){var r=n(10)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o=[7],s=o[r]();s.next=function(){return{done:n=!0}},o[r]=function(){return s},e(o)}catch(e){}return n}},function(e,t,n){"use strict";var r=n(24),i=n(11),o=n(6),s=n(138),a=n(141);r(r.P+r.R,"Promise",{finally:function(e){var t=s(this,i.Promise||o.Promise),n="function"==typeof e;return this.then(n?function(n){return a(t,e()).then((function(){return n}))}:e,n?function(n){return a(t,e()).then((function(){throw n}))}:e)}})},function(e,t,n){"use strict";var r=n(24),i=n(79),o=n(140);r(r.S,"Promise",{try:function(e){var t=i.f(this),n=o(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(77),o=(r=i)&&r.__esModule?r:{default:r};function s(){return window.browser&&browser.storage||window.chrome&&chrome.storage}t.getStorage=s,t.usePromise=function(e,t){if(function(){var e=s();try{return e&&e.local.get&&e.local.get()&&"function"==typeof e.local.get().then}catch(e){return!1}}())return e(t);return new o.default((function(n){e(t,(function(){n.apply(void 0,arguments)}))}))}},function(e,t,n){"use strict";n(55);var r=n(0);const i={};i.debug=r.e.LogLevel.DEBUG,i.info=r.e.LogLevel.INFO,i.warn=r.e.LogLevel.WARN,i.error=r.e.LogLevel.ERROR,i.fatal=r.e.LogLevel.FATAL,r.e.WorkerWebsocket=class extends r.e.Websocket{constructor(e){super(e),this._conn=e,this.worker=new SharedWorker(this._conn.options.worker,"Strophe XMPP Connection"),this.worker.onerror=e=>{var t;null===(t=console)||void 0===t||t.error(e),r.e.log(r.e.LogLevel.ERROR,"Shared Worker Error: ".concat(e))}}get socket(){return{send:e=>this.worker.port.postMessage(["send",e])}}_connect(){this._messageHandler=e=>this._onInitialMessage(e),this.worker.port.start(),this.worker.port.onmessage=e=>this._onWorkerMessage(e),this.worker.port.postMessage(["_connect",this._conn.service,this._conn.jid])}_attach(e){this._messageHandler=e=>this._onMessage(e),this._conn.connect_callback=e,this.worker.port.start(),this.worker.port.onmessage=e=>this._onWorkerMessage(e),this.worker.port.postMessage(["_attach",this._conn.service])}_attachCallback(e,t){e===r.e.Status.ATTACHED?(this._conn.jid=t,this._conn.authenticated=!0,this._conn.connected=!0,this._conn.restored=!0,this._conn._changeConnectStatus(r.e.Status.ATTACHED)):e===r.e.Status.ATTACHFAIL&&(this._conn.authenticated=!1,this._conn.connected=!1,this._conn.restored=!1,this._conn._changeConnectStatus(r.e.Status.ATTACHFAIL))}_disconnect(e,t){t&&this._conn.send(t);const n=Object(r.a)("close",{xmlns:r.e.NS.FRAMING});this._conn.xmlOutput(n.tree());const i=r.e.serialize(n);this._conn.rawOutput(i),this.worker.port.postMessage(["send",i]),this._conn._doDisconnect()}_onClose(e){this._conn.connected&&!this._conn.disconnecting?(r.e.error("Websocket closed unexpectedly"),this._conn._doDisconnect()):e&&1006===e.code&&!this._conn.connected?(r.e.error("Websocket closed unexcectedly"),this._conn._changeConnectStatus(r.e.Status.CONNFAIL,"The WebSocket connection could not be established or was disconnected."),this._conn._doDisconnect()):r.e.debug("Websocket closed")}_closeSocket(){this.worker.port.postMessage(["_closeSocket"])}_replaceMessageHandler(){this._messageHandler=e=>this._onMessage(e)}_onWorkerMessage(e){const{data:t}=e,n=t[0];if("_onMessage"===n)this._messageHandler(t[1]);else if(n in this)try{this[n].apply(this,e.data.slice(1))}catch(e){r.e.log(r.e.LogLevel.ERROR,e)}else if("log"===n){const e=t[1],n=t[2];r.e.log(i[e],n)}else r.e.log(r.e.LogLevel.ERROR,"Found unhandled service worker message: ".concat(t))}}},function(e,t,n){"use strict";n.r(t);n(154),n(55);var r=n(22);var i=function(){this.__data__=[],this.size=0};var o=function(e,t){return e===t||e!=e&&t!=t};var s=function(e,t){for(var n=e.length;n--;)if(o(e[n][0],t))return n;return-1},a=Array.prototype.splice;var c=function(e){var t=this.__data__,n=s(t,e);return!(n<0)&&(n==t.length-1?t.pop():a.call(t,n,1),--this.size,!0)};var u=function(e){var t=this.__data__,n=s(t,e);return n<0?void 0:t[n][1]};var d=function(e){return s(this.__data__,e)>-1};var l=function(e,t){var n=this.__data__,r=s(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};function f(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}f.prototype.clear=i,f.prototype.delete=c,f.prototype.get=u,f.prototype.has=d,f.prototype.set=l;var h=f;var p=function(){this.__data__=new h,this.size=0};var g=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n};var m=function(e){return this.__data__.get(e)};var v=function(e){return this.__data__.has(e)},_=n(3),y=_.a.Symbol,b=Object.prototype,w=b.hasOwnProperty,S=b.toString,x=y?y.toStringTag:void 0;var E=function(e){var t=w.call(e,x),n=e[x];try{e[x]=void 0;var r=!0}catch(e){}var i=S.call(e);return r&&(t?e[x]=n:delete e[x]),i},A=Object.prototype.toString;var N=function(e){return A.call(e)},O=y?y.toStringTag:void 0;var j=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":O&&O in Object(e)?E(e):N(e)};var T=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};var C,I=function(e){if(!T(e))return!1;var t=j(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},R=_.a["__core-js_shared__"],M=(C=/[^.]+$/.exec(R&&R.keys&&R.keys.IE_PROTO||""))?"Symbol(src)_1."+C:"";var k=function(e){return!!M&&M in e},D=Function.prototype.toString;var P=function(e){if(null!=e){try{return D.call(e)}catch(e){}try{return e+""}catch(e){}}return""},L=/^\[object .+?Constructor\]$/,F=Function.prototype,U=Object.prototype,z=F.toString,B=U.hasOwnProperty,H=RegExp("^"+z.call(B).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var q=function(e){return!(!T(e)||k(e))&&(I(e)?H:L).test(P(e))};var $=function(e,t){return null==e?void 0:e[t]};var W=function(e,t){var n=$(e,t);return q(n)?n:void 0},J=W(_.a,"Map"),V=W(Object,"create");var G=function(){this.__data__=V?V(null):{},this.size=0};var Y=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},X=Object.prototype.hasOwnProperty;var Q=function(e){var t=this.__data__;if(V){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return X.call(t,e)?t[e]:void 0},K=Object.prototype.hasOwnProperty;var Z=function(e){var t=this.__data__;return V?void 0!==t[e]:K.call(t,e)};var ee=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=V&&void 0===t?"__lodash_hash_undefined__":t,this};function te(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}te.prototype.clear=G,te.prototype.delete=Y,te.prototype.get=Q,te.prototype.has=Z,te.prototype.set=ee;var ne=te;var re=function(){this.size=0,this.__data__={hash:new ne,map:new(J||h),string:new ne}};var ie=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var oe=function(e,t){var n=e.__data__;return ie(t)?n["string"==typeof t?"string":"hash"]:n.map};var se=function(e){var t=oe(this,e).delete(e);return this.size-=t?1:0,t};var ae=function(e){return oe(this,e).get(e)};var ce=function(e){return oe(this,e).has(e)};var ue=function(e,t){var n=oe(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function de(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}de.prototype.clear=re,de.prototype.delete=se,de.prototype.get=ae,de.prototype.has=ce,de.prototype.set=ue;var le=de;var fe=function(e,t){var n=this.__data__;if(n instanceof h){var r=n.__data__;if(!J||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new le(r)}return n.set(e,t),this.size=n.size,this};function he(e){var t=this.__data__=new h(e);this.size=t.size}he.prototype.clear=p,he.prototype.delete=g,he.prototype.get=m,he.prototype.has=v,he.prototype.set=fe;var pe=he;var ge=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e},me=function(){try{var e=W(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var ve=function(e,t,n){"__proto__"==t&&me?me(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},_e=Object.prototype.hasOwnProperty;var ye=function(e,t,n){var r=e[t];_e.call(e,t)&&o(r,n)&&(void 0!==n||t in e)||ve(e,t,n)};var be=function(e,t,n,r){var i=!n;n||(n={});for(var o=-1,s=t.length;++o<s;){var a=t[o],c=r?r(n[a],e[a],a,n,e):void 0;void 0===c&&(c=e[a]),i?ve(n,a,c):ye(n,a,c)}return n};var we=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r};var Se=function(e){return null!=e&&"object"==typeof e};var xe=function(e){return Se(e)&&"[object Arguments]"==j(e)},Ee=Object.prototype,Ae=Ee.hasOwnProperty,Ne=Ee.propertyIsEnumerable,Oe=xe(function(){return arguments}())?xe:function(e){return Se(e)&&Ae.call(e,"callee")&&!Ne.call(e,"callee")},je=Array.isArray,Te=n(14),Ce=/^(?:0|[1-9]\d*)$/;var Ie=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&Ce.test(e))&&e>-1&&e%1==0&&e<t};var Re=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},Me={};Me["[object Float32Array]"]=Me["[object Float64Array]"]=Me["[object Int8Array]"]=Me["[object Int16Array]"]=Me["[object Int32Array]"]=Me["[object Uint8Array]"]=Me["[object Uint8ClampedArray]"]=Me["[object Uint16Array]"]=Me["[object Uint32Array]"]=!0,Me["[object Arguments]"]=Me["[object Array]"]=Me["[object ArrayBuffer]"]=Me["[object Boolean]"]=Me["[object DataView]"]=Me["[object Date]"]=Me["[object Error]"]=Me["[object Function]"]=Me["[object Map]"]=Me["[object Number]"]=Me["[object Object]"]=Me["[object RegExp]"]=Me["[object Set]"]=Me["[object String]"]=Me["[object WeakMap]"]=!1;var ke=function(e){return Se(e)&&Re(e.length)&&!!Me[j(e)]};var De=function(e){return function(t){return e(t)}},Pe=n(7),Le=Pe.a&&Pe.a.isTypedArray,Fe=Le?De(Le):ke,Ue=Object.prototype.hasOwnProperty;var ze=function(e,t){var n=je(e),r=!n&&Oe(e),i=!n&&!r&&Object(Te.a)(e),o=!n&&!r&&!i&&Fe(e),s=n||r||i||o,a=s?we(e.length,String):[],c=a.length;for(var u in e)!t&&!Ue.call(e,u)||s&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Ie(u,c))||a.push(u);return a},Be=Object.prototype;var He=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Be)};var qe=function(e,t){return function(n){return e(t(n))}},$e=qe(Object.keys,Object),We=Object.prototype.hasOwnProperty;var Je=function(e){if(!He(e))return $e(e);var t=[];for(var n in Object(e))We.call(e,n)&&"constructor"!=n&&t.push(n);return t};var Ve=function(e){return null!=e&&Re(e.length)&&!I(e)};var Ge=function(e){return Ve(e)?ze(e):Je(e)};var Ye=function(e,t){return e&&be(t,Ge(t),e)};var Xe=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t},Qe=Object.prototype.hasOwnProperty;var Ke=function(e){if(!T(e))return Xe(e);var t=He(e),n=[];for(var r in e)("constructor"!=r||!t&&Qe.call(e,r))&&n.push(r);return n};var Ze=function(e){return Ve(e)?ze(e,!0):Ke(e)};var et=function(e,t){return e&&be(t,Ze(t),e)},tt=n(144);var nt=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t};var rt=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s,n,e)&&(o[i++]=s)}return o};var it=function(){return[]},ot=Object.prototype.propertyIsEnumerable,st=Object.getOwnPropertySymbols,at=st?function(e){return null==e?[]:(e=Object(e),rt(st(e),(function(t){return ot.call(e,t)})))}:it;var ct=function(e,t){return be(e,at(e),t)};var ut=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e},dt=qe(Object.getPrototypeOf,Object),lt=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)ut(t,at(e)),e=dt(e);return t}:it;var ft=function(e,t){return be(e,lt(e),t)};var ht=function(e,t,n){var r=t(e);return je(e)?r:ut(r,n(e))};var pt=function(e){return ht(e,Ge,at)};var gt=function(e){return ht(e,Ze,lt)},mt=W(_.a,"DataView"),vt=W(_.a,"Promise"),_t=W(_.a,"Set"),yt=W(_.a,"WeakMap"),bt=P(mt),wt=P(J),St=P(vt),xt=P(_t),Et=P(yt),At=j;(mt&&"[object DataView]"!=At(new mt(new ArrayBuffer(1)))||J&&"[object Map]"!=At(new J)||vt&&"[object Promise]"!=At(vt.resolve())||_t&&"[object Set]"!=At(new _t)||yt&&"[object WeakMap]"!=At(new yt))&&(At=function(e){var t=j(e),n="[object Object]"==t?e.constructor:void 0,r=n?P(n):"";if(r)switch(r){case bt:return"[object DataView]";case wt:return"[object Map]";case St:return"[object Promise]";case xt:return"[object Set]";case Et:return"[object WeakMap]"}return t});var Nt=At,Ot=Object.prototype.hasOwnProperty;var jt=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Ot.call(e,"index")&&(n.index=e.index,n.input=e.input),n},Tt=_.a.Uint8Array;var Ct=function(e){var t=new e.constructor(e.byteLength);return new Tt(t).set(new Tt(e)),t};var It=function(e,t){var n=t?Ct(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)},Rt=/\w*$/;var Mt=function(e){var t=new e.constructor(e.source,Rt.exec(e));return t.lastIndex=e.lastIndex,t},kt=y?y.prototype:void 0,Dt=kt?kt.valueOf:void 0;var Pt=function(e){return Dt?Object(Dt.call(e)):{}};var Lt=function(e,t){var n=t?Ct(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)};var Ft=function(e,t,n){var r=e.constructor;switch(t){case"[object ArrayBuffer]":return Ct(e);case"[object Boolean]":case"[object Date]":return new r(+e);case"[object DataView]":return It(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Lt(e,n);case"[object Map]":return new r;case"[object Number]":case"[object String]":return new r(e);case"[object RegExp]":return Mt(e);case"[object Set]":return new r;case"[object Symbol]":return Pt(e)}},Ut=Object.create,zt=function(){function e(){}return function(t){if(!T(t))return{};if(Ut)return Ut(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();var Bt=function(e){return"function"!=typeof e.constructor||He(e)?{}:zt(dt(e))};var Ht=function(e){return Se(e)&&"[object Map]"==Nt(e)},qt=Pe.a&&Pe.a.isMap,$t=qt?De(qt):Ht;var Wt=function(e){return Se(e)&&"[object Set]"==Nt(e)},Jt=Pe.a&&Pe.a.isSet,Vt=Jt?De(Jt):Wt,Gt={};Gt["[object Arguments]"]=Gt["[object Array]"]=Gt["[object ArrayBuffer]"]=Gt["[object DataView]"]=Gt["[object Boolean]"]=Gt["[object Date]"]=Gt["[object Float32Array]"]=Gt["[object Float64Array]"]=Gt["[object Int8Array]"]=Gt["[object Int16Array]"]=Gt["[object Int32Array]"]=Gt["[object Map]"]=Gt["[object Number]"]=Gt["[object Object]"]=Gt["[object RegExp]"]=Gt["[object Set]"]=Gt["[object String]"]=Gt["[object Symbol]"]=Gt["[object Uint8Array]"]=Gt["[object Uint8ClampedArray]"]=Gt["[object Uint16Array]"]=Gt["[object Uint32Array]"]=!0,Gt["[object Error]"]=Gt["[object Function]"]=Gt["[object WeakMap]"]=!1;var Yt=function e(t,n,r,i,o,s){var a,c=1&n,u=2&n,d=4&n;if(r&&(a=o?r(t,i,o,s):r(t)),void 0!==a)return a;if(!T(t))return t;var l=je(t);if(l){if(a=jt(t),!c)return nt(t,a)}else{var f=Nt(t),h="[object Function]"==f||"[object GeneratorFunction]"==f;if(Object(Te.a)(t))return Object(tt.a)(t,c);if("[object Object]"==f||"[object Arguments]"==f||h&&!o){if(a=u||h?{}:Bt(t),!c)return u?ft(t,et(a,t)):ct(t,Ye(a,t))}else{if(!Gt[f])return o?t:{};a=Ft(t,f,c)}}s||(s=new pe);var p=s.get(t);if(p)return p;s.set(t,a),Vt(t)?t.forEach((function(i){a.add(e(i,n,r,i,t,s))})):$t(t)&&t.forEach((function(i,o){a.set(o,e(i,n,r,o,t,s))}));var g=l?void 0:(d?u?gt:pt:u?Ze:Ge)(t);return ge(g||t,(function(i,o){g&&(i=t[o=i]),ye(a,o,e(i,n,r,o,t,s))})),a};var Xt=function(e){return Yt(e,5)};var Qt=function(e){return"string"==typeof e||!je(e)&&Se(e)&&"[object String]"==j(e)};var Kt=function(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))};function Zt(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}function en(e){return"string"!=typeof e&&(console.warn("".concat(e," used as a key, but it is not a string.")),e=String(e)),e}var tn=function(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(i){if("TypeError"!==i.name)throw i;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}},nn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",rn=/^~~local_forage_type~([^~]+)~/,on="__lfsc__:".length,sn=on+"arbf".length,an=Object.prototype.toString;function cn(e){var t,n,r,i,o,s=.75*e.length,a=e.length,c=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var u=new ArrayBuffer(s),d=new Uint8Array(u);for(t=0;t<a;t+=4)n=nn.indexOf(e[t]),r=nn.indexOf(e[t+1]),i=nn.indexOf(e[t+2]),o=nn.indexOf(e[t+3]),d[c++]=n<<2|r>>4,d[c++]=(15&r)<<4|i>>2,d[c++]=(3&i)<<6|63&o;return u}function un(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=nn[n[t]>>2],r+=nn[(3&n[t])<<4|n[t+1]>>4],r+=nn[(15&n[t+1])<<2|n[t+2]>>6],r+=nn[63&n[t+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}var dn={serialize:function(e,t){var n="";if(e&&(n=an.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===an.call(e.buffer))){var r,i="__lfsc__:";e instanceof ArrayBuffer?(r=e,i+="arbf"):(r=e.buffer,"[object Int8Array]"===n?i+="si08":"[object Uint8Array]"===n?i+="ui08":"[object Uint8ClampedArray]"===n?i+="uic8":"[object Int16Array]"===n?i+="si16":"[object Uint16Array]"===n?i+="ur16":"[object Int32Array]"===n?i+="si32":"[object Uint32Array]"===n?i+="ui32":"[object Float32Array]"===n?i+="fl32":"[object Float64Array]"===n?i+="fl64":t(new Error("Failed to get type for BinaryArray"))),t(i+un(r))}else if("[object Blob]"===n){var o=new FileReader;o.onload=function(){var n="~~local_forage_type~"+e.type+"~"+un(this.result);t("__lfsc__:blob"+n)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(n){console.error("Couldn't convert value into a JSON string: ",e),t(null,n)}},deserialize:function(e){if("__lfsc__:"!==e.substring(0,on))return JSON.parse(e);var t,n=e.substring(sn),r=e.substring(on,sn);if("blob"===r&&rn.test(n)){var i=n.match(rn);t=i[1],n=n.substring(i[0].length)}var o=cn(n);switch(r){case"arbf":return o;case"blob":return tn([o],{type:t});case"si08":return new Int8Array(o);case"ui08":return new Uint8Array(o);case"uic8":return new Uint8ClampedArray(o);case"si16":return new Int16Array(o);case"ur16":return new Uint16Array(o);case"si32":return new Int32Array(o);case"ui32":return new Uint32Array(o);case"fl32":return new Float32Array(o);case"fl64":return new Float64Array(o);default:throw new Error("Unkown type: "+r)}},stringToBuffer:cn,bufferToString:un};function ln(e,t){let n=e.name+"/";return e.storeName!==t.storeName&&(n+=e.storeName+"/"),n}const fn={serializer:{serialize:dn.serialize,deserialize:dn.deserialize}};var hn={_driver:"sessionStorageWrapper",_initStorage:function(e){if(fn.keyPrefix=ln(e,this._defaultConfig),e)for(const t in e)fn[t]=e[t]},_support:function(){try{if(sessionStorage&&"setItem"in sessionStorage)return!0}catch(e){console.log(e)}return!1}(),iterate:function(e,t){const n=this.ready().then((function(){const t=fn.keyPrefix,n=t.length,r=sessionStorage.length;let i=1;for(let o=0;o<r;o++){const r=sessionStorage.key(o);if(0!==r.indexOf(t))continue;let s=sessionStorage.getItem(r);if(s&&(s=fn.serializer.deserialize(s)),s=e(s,r.substring(n),i++),void 0!==s)return s}}));return Kt(n,t),n},getItem:function(e,t){e=en(e);const n=this.ready().then((function(){let t=sessionStorage.getItem(fn.keyPrefix+e);return t&&(t=fn.serializer.deserialize(t)),t}));return Kt(n,t),n},setItem:function(e,t,n){e=en(e);const r=this.ready().then((function(){void 0===t&&(t=null);const n=t;return new Promise((function(r,i){fn.serializer.serialize(t,(function(t,o){if(o)i(o);else try{sessionStorage.setItem(fn.keyPrefix+e,t),r(n)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||i(e),i(e)}}))}))}));return Kt(r,n),r},removeItem:function(e,t){e=en(e);const n=this.ready().then((function(){sessionStorage.removeItem(fn.keyPrefix+e)}));return Kt(n,t),n},clear:function(e){const t=this.ready().then((function(){const e=fn.keyPrefix;for(let t=sessionStorage.length-1;t>=0;t--){const n=sessionStorage.key(t);0===n.indexOf(e)&&sessionStorage.removeItem(n)}}));return Kt(t,e),t},length:function(e){const t=this.keys().then((function(e){return e.length}));return Kt(t,e),t},key:function(e,t){const n=this.ready().then((function(){let t;try{t=sessionStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(fn.keyPrefix.length)),t}));return Kt(n,t),n},keys:function(e){const t=this.ready().then((function(){const e=sessionStorage.length,t=[];for(let n=0;n<e;n++){const e=sessionStorage.key(n);0===e.indexOf(fn.keyPrefix)&&t.push(e.substring(fn.keyPrefix.length))}return t}));return Kt(t,e),t},dropInstance:function(e,t){if(t=Zt.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){const t=this.config();e.name=e.name||t.name,e.storeName=e.storeName||t.storeName}const n=this;let r;return r=e.name?new Promise((function(t){e.storeName?t(ln(e,n._defaultConfig)):t("".concat(e.name,"/"))})).then((function(e){for(let t=sessionStorage.length-1;t>=0;t--){const n=sessionStorage.key(t);0===n.indexOf(e)&&sessionStorage.removeItem(n)}})):Promise.reject(new Error("Invalid arguments")),Kt(r,t),r}};function pn(){return(65536*(1+Math.random())|0).toString(16).substring(1)}class gn{constructor(e,t){if("local"===t&&!window.localStorage)throw new Error("Skeletor.storage: Environment does not support localStorage.");if("session"===t&&!window.sessionStorage)throw new Error("Skeletor.storage: Environment does not support sessionStorage.");Qt(t)?this.storeInitialized=this.initStore(t):(this.store=t,this.storeInitialized=Promise.resolve()),this.name=e}async initStore(e){if("session"===e)r.setDriver(hn._driver);else if("local"===e)await r.config({driver:r.LOCALSTORAGE});else if("indexed"!==e)throw new Error("Skeletor.storage: No storage type was specified");this.store=r}async clear(){await this.store.removeItem(this.name).catch(e=>console.error(e));const e=new RegExp("^".concat(this.name,"-")),t=(await this.store.keys()).filter(t=>e.test(t));await Promise.all(t.map(e=>this.store.removeItem(e).catch(e=>console.error(e))))}sync(e){const t=this;async function n(e,n,r){let i,o,s,a;const c=n.collection;["patch","update"].includes(e)&&(a=Xt(n.attributes)),await t.storeInitialized;try{const o=n.attributes;switch(e){case"read":i=void 0!==n.id?await t.find(n):await t.findAll();break;case"create":i=await t.create(n,r);break;case"patch":case"update":r.wait&&(n.attributes=a),s=t.update(n,r),r.wait&&(n.attributes=o),i=await s;break;case"delete":i=await t.destroy(n,c)}}catch(e){o=22===e.code&&0===t.getStorageSize()?"Private browsing is unsupported":e.message}if(i){if(r&&r.success){const t="read"===e?i:null;r.success(t,r)}}else o=o||"Record Not Found",r&&r.error&&r.error(o)}return n.__name__="localSync",n}removeCollectionReference(e,t){if(!t)return;const n=t.filter(t=>t.id!==e.id).map(e=>this.getItemName(e.id));return this.store.setItem(this.name,n)}addCollectionReference(e,t){if(!t)return;const n=t.map(e=>this.getItemName(e.id)),r=this.getItemName(e.id);return n.includes(r)||n.push(r),this.store.setItem(this.name,n)}async save(e,t={}){const n=this.getItemName(e.id),r=await this.store.setItem(n,e.toJSON());return await this.addCollectionReference(e,e.collection),r}create(e,t){return e.id||(e.id=pn()+pn()+"-"+pn()+"-"+pn()+"-"+pn()+"-"+pn()+pn()+pn(),e.set(e.idAttribute,e.id,t)),this.save(e)}update(e,t){return this.save(e,t)}find(e){return this.store.getItem(this.getItemName(e.id))}async findAll(){const e=await this.store.getItem(this.name);return e&&e.length?Promise.all(e.map(e=>this.store.getItem(e))):[]}async destroy(e,t){return await this.store.removeItem(this.getItemName(e.id)),await this.removeCollectionReference(e,t),e}getStorageSize(){return this.store.length}getItemName(e){return this.name+"-"+e}}gn.sessionStorageInitialized=r.defineDriver(hn),gn.localForage=r;var mn=gn,vn=n(145),_n=n.n(vn),yn=n(16),bn=n.n(yn),wn=Function.prototype,Sn=Object.prototype,xn=wn.toString,En=Sn.hasOwnProperty,An=xn.call(Object);var Nn=function(e){if(!Se(e)||"[object Object]"!=j(e))return!1;var t=dt(e);if(null===t)return!0;var n=En.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&xn.call(n)==An};var On,jn,Tn,Cn,In=function(e){return Se(e)&&1===e.nodeType&&!Nn(e)};const Rn={debug:0,info:1,warn:2,error:3,fatal:4},Mn=Object.assign({debug:(null===(On=console)||void 0===On?void 0:On.log)?console.log.bind(console):function(){},error:(null===(jn=console)||void 0===jn?void 0:jn.log)?console.log.bind(console):function(){},info:(null===(Tn=console)||void 0===Tn?void 0:Tn.log)?console.log.bind(console):function(){},warn:(null===(Cn=console)||void 0===Cn?void 0:Cn.log)?console.log.bind(console):function(){}},console);var kn={setLogLevel(e){if(!["debug","info","warn","error","fatal"].includes(e))throw new Error("Invalid loglevel: ".concat(e));this.loglevel=e},log(e,t,n=""){if(Rn[t]<Rn[this.loglevel])return;"error"===t||"fatal"===t?n=n||"color: maroon":"debug"===t&&(n=n||"color: green"),e instanceof Error?e=e.stack:In(e)&&(e=e.outerHTML);const r=n?"%c":"";"error"===t?Mn.error("".concat(r," ERROR: ").concat(e),n):"warn"===t?Mn.warn("".concat(r," ").concat((new Date).toISOString()," WARNING: ").concat(e),n):"fatal"===t?Mn.error("".concat(r," FATAL: ").concat(e),n):"debug"===t?Mn.debug("".concat(r," ").concat((new Date).toISOString()," DEBUG: ").concat(e),n):Mn.info("".concat(r," ").concat((new Date).toISOString()," INFO: ").concat(e),n)},debug(e,t){this.log(e,"debug",t)},error(e,t){this.log(e,"error",t)},info(e,t){this.log(e,"info",t)},warn(e,t){this.log(e,"warn",t)},fatal(e,t){this.log(e,"fatal",t)}},Dn=n(146),Pn=n.n(Dn),Ln=n(35),Fn=n.n(Ln),Un=n(36),zn=n.n(Un),Bn=n(28),Hn=n.n(Bn),qn=n(147),$n=n.n(qn),Wn=n(52),Jn=n.n(Wn),Vn=n(148),Gn=n.n(Vn),Yn=n(27),Xn=n.n(Yn),Qn=n(81),Kn=n.n(Qn),Zn=n(149),er=n.n(Zn),tr=n(150),nr=n.n(tr),rr=n(80),ir=n.n(rr);function or(e,t){this.name=t,this.plugged=e,void 0===this.plugged.__super__?this.plugged.__super__={}:"string"==typeof this.plugged.__super__&&(this.plugged.__super__={__string__:this.plugged.__super__}),this.plugged.__super__[t]=this.plugged,this.plugins={},this.initialized_plugins=[]}zn()(or.prototype,{wrappedOverride:function(e,t,n,r){return"function"==typeof n&&(void 0===this.__super__&&(this.__super__=r),this.__super__[e]=n.bind(this)),t.apply(this,Pn()(arguments,4))},_overrideAttribute:function(e,t){let n=t.overrides[e];if("function"==typeof n){let t={};t[this.name]=this.plugged;let r=Kn()(this.wrappedOverride,e,n,this.plugged[e],t);this.plugged[e]=r}else this.plugged[e]=n},_extendObject:function(e,t){e.prototype.__super__||(e.prototype.__super__={},e.prototype.__super__[this.name]=this.plugged);let n=this;Fn()(t,(function(t,r){if("events"===r)e.prototype[r]=zn()(t,e.prototype[r]);else if("function"==typeof t){let i={};i[n.name]=n.plugged;let o=Kn()(n.wrappedOverride,r,t,e.prototype[r],i);e.prototype[r]=o}else e.prototype[r]=t}))},loadPluginDependencies:function(e){Fn()(e.dependencies,t=>{let n=this.plugins[t];if(n){if(Hn()(n.dependencies,e.__name__))throw'Found a circular dependency between the plugins "'+e.__name__+'" and "'+t+'"';this.initializePlugin(n)}else this.throwUndefinedDependencyError('Could not find dependency "'+t+'" for the plugin "'+e.__name__+"\". If it's needed, make sure it's loaded by require.js")})},throwUndefinedDependencyError:function(e){if(this.plugged.strict_plugin_dependencies)throw e;console.warn?console.warn(e):console.log(e)},applyOverrides:function(e){Fn()(Object.keys(e.overrides||{}),t=>{let n=e.overrides[t];"object"==typeof n?void 0===this.plugged[t]?this.throwUndefinedDependencyError('Plugin "'.concat(e.__name__,'" tried to override "').concat(t,"\" but it's not found.")):this._extendObject(this.plugged[t],n):this._overrideAttribute(t,e)})},initializePlugin:function(e){Hn()(Xn()(this.allowed_plugins),e.__name__)&&(Hn()(this.initialized_plugins,e.__name__)||($n()(e.enabled)&&e.enabled||Jn()(e.enabled)&&e.enabled(this.plugged)||Gn()(e.enabled))&&(zn()(e,this.properties),e.dependencies&&this.loadPluginDependencies(e),this.applyOverrides(e),"function"==typeof e.initialize&&e.initialize.bind(e)(this),this.initialized_plugins.push(e.__name__)))},registerPlugin:function(e,t){if(e in this.plugins)throw new Error("Error: Plugin name "+e+" is already taken");t.__name__=e,this.plugins[e]=t},initializePlugins:function(e={},t=[],n=[]){nr()(this.plugins)&&(this.properties=e,this.allowed_plugins=er()(this.plugins,(function(e,r){return(!t.length||t.length&&Hn()(t,r))&&!Hn()(n,r)})),Fn()(ir()(this.allowed_plugins),this.initializePlugin.bind(this)))}});var sr={enable:function(e,t,n){void 0===n&&(n="pluginSocket"),void 0===t&&(t="plugged");let r={};return r[n]=new or(e,t),zn()(e,r)}},ar=n(151),cr=n.n(ar),ur=n(152),dr=n.n(ur),lr=n(2),fr=n.n(lr),hr=n(0);var pr=function(e,t){var n=zt(e);return null==t?n:Ye(n,t)};var gr=function(e){return e};var mr=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},vr=Math.max;var _r=function(e,t,n){return t=vr(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=vr(r.length-t,0),s=Array(o);++i<o;)s[i]=r[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=r[i];return a[t]=n(s),mr(e,this,a)}};var yr=function(e){return function(){return e}},br=me?function(e,t){return me(e,"toString",{configurable:!0,enumerable:!1,value:yr(t),writable:!0})}:gr,wr=Date.now;var Sr=function(e){var t=0,n=0;return function(){var r=wr(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(br);var xr=function(e,t){return Sr(_r(e,t,gr),e+"")};var Er=function(e,t,n){if(!T(n))return!1;var r=typeof t;return!!("number"==r?Ve(n)&&Ie(t,n.length):"string"==r&&t in n)&&o(n[t],e)};var Ar=function(e){return xr((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,s=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,s&&Er(n[0],n[1],s)&&(o=i<3?void 0:o,i=1),t=Object(t);++r<i;){var a=n[r];a&&e(t,a,r,o)}return t}))}((function(e,t){be(t,Ze(t),e)})),Nr=Object.prototype.hasOwnProperty;var Or=function(e,t){return null!=e&&Nr.call(e,t)};var jr=function(e){return"symbol"==typeof e||Se(e)&&"[object Symbol]"==j(e)},Tr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Cr=/^\w*$/;var Ir=function(e,t){if(je(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!jr(e))||(Cr.test(e)||!Tr.test(e)||null!=t&&e in Object(t))};function Rr(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(Rr.Cache||le),n}Rr.Cache=le;var Mr=Rr;var kr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Dr=/\\(\\)?/g,Pr=function(e){var t=Mr(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(kr,(function(e,n,r,i){t.push(r?i.replace(Dr,"$1"):n||e)})),t}));var Lr=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i},Fr=y?y.prototype:void 0,Ur=Fr?Fr.toString:void 0;var zr=function e(t){if("string"==typeof t)return t;if(je(t))return Lr(t,e)+"";if(jr(t))return Ur?Ur.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n};var Br=function(e){return null==e?"":zr(e)};var Hr=function(e,t){return je(e)?e:Ir(e,t)?[e]:Pr(Br(e))};var qr=function(e){if("string"==typeof e||jr(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t};var $r=function(e,t,n){for(var r=-1,i=(t=Hr(t,e)).length,o=!1;++r<i;){var s=qr(t[r]);if(!(o=null!=e&&n(e,s)))break;e=e[s]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&Re(i)&&Ie(s,i)&&(je(e)||Oe(e))};var Wr=function(e,t){return null!=e&&$r(e,t,Or)};var Jr=function(e,t,n){var r=-1,i=(t=Hr(t,e)).length;for(i||(i=1,e=void 0);++r<i;){var o=null==e?void 0:e[qr(t[r])];void 0===o&&(r=i,o=n),e=I(o)?o.call(e):o}return e};Error;function Vr(e,t){const n=this;let r;return r=e&&Wr(e,"constructor")?e.constructor:function(){return n.apply(this,arguments)},Ar(r,n,t),r.prototype=pr(n.prototype,e),r.prototype.constructor=r,r.__super__=n.prototype,r}function Gr(){const e={isResolved:!1,isPending:!0,isRejected:!1},t=new Promise((t,n)=>{e.resolve=t,e.reject=n});return Object.assign(t,e),t.then((function(e){return t.isResolved=!0,t.isPending=!1,t.isRejected=!1,e}),(function(e){throw t.isResolved=!1,t.isPending=!1,t.isRejected=!0,e})),t}function Yr(){throw new Error('A "url" property or function must be specified')}function Xr(e,t){const n=t.error;t.error=function(r){n&&n.call(t.context,e,r,t),e.trigger("error",e,r,t)}}const Qr={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};function Kr(e){const t=Jr(e,"browserStorage")||Jr(e.collection,"browserStorage");return t?t.sync():Zr}function Zr(e,t,n={}){const r={type:Qr[e],dataType:"json"};n.url||(r.url=Jr(t,"url")||Yr()),null!=n.data||!t||"create"!==e&&"update"!==e&&"patch"!==e||(r.contentType="application/json",r.data=JSON.stringify(n.attrs||t.toJSON(n))),"GET"!==r.type&&(r.processData=!1);const i=n.error;n.error=function(e,t,r){n.textStatus=t,n.errorThrown=r,i&&i.call(n.context,e,t,r)};const o=n.xhr=function(){return fetch.apply(this,arguments)}(Ar(r,n));return t.trigger("request",t,o,n),o}var ei=Object.prototype.hasOwnProperty;var ti=function(e){if(null==e)return!0;if(Ve(e)&&(je(e)||"string"==typeof e||"function"==typeof e.splice||Object(Te.a)(e)||Fe(e)||Oe(e)))return!e.length;var t=Nt(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(He(e))return!Je(e).length;for(var n in e)if(ei.call(e,n))return!1;return!0},ni=/^\s+|\s+$/g,ri=/^[-+]0x[0-9a-f]+$/i,ii=/^0b[01]+$/i,oi=/^0o[0-7]+$/i,si=parseInt;var ai=function(e){if("number"==typeof e)return e;if(jr(e))return NaN;if(T(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=T(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(ni,"");var n=ii.test(e);return n||oi.test(e)?si(e.slice(2),n?2:8):ri.test(e)?NaN:+e};var ci=function(e){return e?(e=ai(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0};var ui=function(e){var t=ci(e),n=t%1;return t==t?n?t-n:t:0};var di=function(e,t){var n;if("function"!=typeof t)throw new TypeError("Expected a function");return e=ui(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=void 0),n}};var li=function(e){return di(2,e)},fi=0;var hi=function(e){var t=++fi;return Br(e)+t};const pi={},gi=/\s+/;let mi;const vi=function e(t,n,r,i,o){let s,a=0;if(r&&"object"==typeof r){void 0!==i&&"context"in o&&void 0===o.context&&(o.context=i);for(s=Ge(r);a<s.length;a++)n=e(t,n,s[a],r[s[a]],o)}else if(r&&gi.test(r))for(s=r.split(gi);a<s.length;a++)n=t(n,s[a],i,o);else n=t(n,r,i,o);return n};pi.on=function(e,t,n){if(this._events=vi(_i,this._events||{},e,t,{context:n,ctx:this,listening:mi}),mi){(this._listeners||(this._listeners={}))[mi.id]=mi,mi.interop=!1}return this},pi.listenTo=function(e,t,n){if(!e)return this;const r=e._listenId||(e._listenId=hi("l")),i=this._listeningTo||(this._listeningTo={});let o=mi=i[r];o||(this._listenId||(this._listenId=hi("l")),o=mi=i[r]=new Ei(this,e));const s=yi(e,t,n,this);if(mi=void 0,s)throw s;return o.interop&&o.on(t,n),this};const _i=function(e,t,n,r){if(n){const i=e[t]||(e[t]=[]),o=r.context,s=r.ctx,a=r.listening;a&&a.count++,i.push({callback:n,context:o,ctx:o||s,listening:a})}return e},yi=function(e,t,n,r){try{e.on(t,n,r)}catch(e){return e}};pi.off=function(e,t,n){return this._events?(this._events=vi(bi,this._events,e,t,{context:n,listeners:this._listeners}),this):this},pi.stopListening=function(e,t,n){const r=this._listeningTo;if(!r)return this;const i=e?[e._listenId]:Ge(r);for(let e=0;e<i.length;e++){const o=r[i[e]];if(!o)break;o.obj.off(t,n,this),o.interop&&o.off(t,n)}return ti(r)&&(this._listeningTo=void 0),this};const bi=function(e,t,n,r){if(!e)return;const i=r.context,o=r.listeners;let s,a=0;if(t||i||n){for(s=t?[t]:Ge(e);a<s.length;a++){const r=e[t=s[a]];if(!r)break;const o=[];for(let e=0;e<r.length;e++){const s=r[e];if(n&&n!==s.callback&&n!==s.callback._callback||i&&i!==s.context)o.push(s);else{const e=s.listening;e&&e.off(t,n)}}o.length?e[t]=o:delete e[t]}return e}for(s=Ge(o);a<s.length;a++)o[s[a]].cleanup()};pi.once=function(e,t,n){const r=vi(wi,{},e,t,this.off.bind(this));return"string"==typeof e&&null==n&&(t=void 0),this.on(r,t,n)},pi.listenToOnce=function(e,t,n){const r=vi(wi,{},t,n,this.stopListening.bind(this,e));return this.listenTo(e,r)};const wi=function(e,t,n,r){if(n){const i=e[t]=li((function(){r(t,i),n.apply(this,arguments)}));i._callback=n}return e};pi.trigger=function(e){if(!this._events)return this;const t=Math.max(0,arguments.length-1),n=Array(t);for(let e=0;e<t;e++)n[e]=arguments[e+1];return vi(Si,this._events,e,void 0,n),this};const Si=function(e,t,n,r){if(e){const n=e[t];let i=e.all;n&&i&&(i=i.slice()),n&&xi(n,r),i&&xi(i,[t].concat(r))}return e},xi=function(e,t){let n,r=-1;const i=e.length,o=t[0],s=t[1],a=t[2];switch(t.length){case 0:for(;++r<i;)(n=e[r]).callback.call(n.ctx);return;case 1:for(;++r<i;)(n=e[r]).callback.call(n.ctx,o);return;case 2:for(;++r<i;)(n=e[r]).callback.call(n.ctx,o,s);return;case 3:for(;++r<i;)(n=e[r]).callback.call(n.ctx,o,s,a);return;default:for(;++r<i;)(n=e[r]).callback.apply(n.ctx,t);return}},Ei=function(e,t){this.id=e._listenId,this.listener=e,this.obj=t,this.interop=!0,this.count=0,this._events=void 0};Ei.prototype.on=pi.on,Ei.prototype.off=function(e,t){let n;this.interop?(this._events=vi(bi,this._events,e,t,{context:void 0,listeners:void 0}),n=!this._events):(this.count--,n=0===this.count),n&&this.cleanup()},Ei.prototype.cleanup=function(){delete this.listener._listeningTo[this.obj._listenId],this.interop||delete this.obj._listeners[this.id]},pi.bind=pi.on,pi.unbind=pi.off;var Ai=function(e){return Yt(e,4)},Ni=Object.prototype,Oi=Ni.hasOwnProperty,ji=xr((function(e,t){e=Object(e);var n=-1,r=t.length,i=r>2?t[2]:void 0;for(i&&Er(t[0],t[1],i)&&(r=1);++n<r;)for(var s=t[n],a=Ze(s),c=-1,u=a.length;++c<u;){var d=a[c],l=e[d];(void 0===l||o(l,Ni[d])&&!Oi.call(e,d))&&(e[d]=s[d])}return e}));var Ti=function(e,t,n){if("function"!=typeof e)throw new TypeError("Expected a function");return setTimeout((function(){e.apply(void 0,n)}),t)},Ci=xr((function(e,t){return Ti(e,1,t)}));var Ii=function(e){return function(t){return null==e?void 0:e[t]}}({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),Ri=/[&<>"']/g,Mi=RegExp(Ri.source);var ki=function(e){return(e=Br(e))&&Mi.test(e)?e.replace(Ri,Ii):e};var Di=function(e){return function(t,n,r){for(var i=-1,o=Object(t),s=r(t),a=s.length;a--;){var c=s[e?a:++i];if(!1===n(o[c],c,o))break}return t}}();var Pi=function(e,t){return e&&Di(e,t,Ge)};var Li=function(e,t,n,r){return Pi(e,(function(e,i,o){t(r,n(e),i,o)})),r};var Fi=function(e,t){return function(n,r){return Li(n,e,t(r),{})}},Ui=Object.prototype.toString,zi=Fi((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Ui.call(t)),e[t]=n}),yr(gr));var Bi=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this};var Hi=function(e){return this.__data__.has(e)};function qi(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new le;++t<n;)this.add(e[t])}qi.prototype.add=qi.prototype.push=Bi,qi.prototype.has=Hi;var $i=qi;var Wi=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1};var Ji=function(e,t){return e.has(t)};var Vi=function(e,t,n,r,i,o){var s=1&n,a=e.length,c=t.length;if(a!=c&&!(s&&c>a))return!1;var u=o.get(e),d=o.get(t);if(u&&d)return u==t&&d==e;var l=-1,f=!0,h=2&n?new $i:void 0;for(o.set(e,t),o.set(t,e);++l<a;){var p=e[l],g=t[l];if(r)var m=s?r(g,p,l,t,e,o):r(p,g,l,e,t,o);if(void 0!==m){if(m)continue;f=!1;break}if(h){if(!Wi(t,(function(e,t){if(!Ji(h,t)&&(p===e||i(p,e,n,r,o)))return h.push(t)}))){f=!1;break}}else if(p!==g&&!i(p,g,n,r,o)){f=!1;break}}return o.delete(e),o.delete(t),f};var Gi=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n};var Yi=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n},Xi=y?y.prototype:void 0,Qi=Xi?Xi.valueOf:void 0;var Ki=function(e,t,n,r,i,s,a){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!s(new Tt(e),new Tt(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var c=Gi;case"[object Set]":var u=1&r;if(c||(c=Yi),e.size!=t.size&&!u)return!1;var d=a.get(e);if(d)return d==t;r|=2,a.set(e,t);var l=Vi(c(e),c(t),r,i,s,a);return a.delete(e),l;case"[object Symbol]":if(Qi)return Qi.call(e)==Qi.call(t)}return!1},Zi=Object.prototype.hasOwnProperty;var eo=function(e,t,n,r,i,o){var s=1&n,a=pt(e),c=a.length;if(c!=pt(t).length&&!s)return!1;for(var u=c;u--;){var d=a[u];if(!(s?d in t:Zi.call(t,d)))return!1}var l=o.get(e),f=o.get(t);if(l&&f)return l==t&&f==e;var h=!0;o.set(e,t),o.set(t,e);for(var p=s;++u<c;){var g=e[d=a[u]],m=t[d];if(r)var v=s?r(m,g,d,t,e,o):r(g,m,d,e,t,o);if(!(void 0===v?g===m||i(g,m,n,r,o):v)){h=!1;break}p||(p="constructor"==d)}if(h&&!p){var _=e.constructor,y=t.constructor;_==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof _&&_ instanceof _&&"function"==typeof y&&y instanceof y||(h=!1)}return o.delete(e),o.delete(t),h},to=Object.prototype.hasOwnProperty;var no=function(e,t,n,r,i,o){var s=je(e),a=je(t),c=s?"[object Array]":Nt(e),u=a?"[object Array]":Nt(t),d="[object Object]"==(c="[object Arguments]"==c?"[object Object]":c),l="[object Object]"==(u="[object Arguments]"==u?"[object Object]":u),f=c==u;if(f&&Object(Te.a)(e)){if(!Object(Te.a)(t))return!1;s=!0,d=!1}if(f&&!d)return o||(o=new pe),s||Fe(e)?Vi(e,t,n,r,i,o):Ki(e,t,c,n,r,i,o);if(!(1&n)){var h=d&&to.call(e,"__wrapped__"),p=l&&to.call(t,"__wrapped__");if(h||p){var g=h?e.value():e,m=p?t.value():t;return o||(o=new pe),i(g,m,n,r,o)}}return!!f&&(o||(o=new pe),eo(e,t,n,r,i,o))};var ro=function e(t,n,r,i,o){return t===n||(null==t||null==n||!Se(t)&&!Se(n)?t!=t&&n!=n:no(t,n,r,i,e,o))};var io=function(e,t){return ro(e,t)};var oo=function(e,t,n,r){var i=n.length,o=i,s=!r;if(null==e)return!o;for(e=Object(e);i--;){var a=n[i];if(s&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++i<o;){var c=(a=n[i])[0],u=e[c],d=a[1];if(s&&a[2]){if(void 0===u&&!(c in e))return!1}else{var l=new pe;if(r)var f=r(u,d,c,e,t,l);if(!(void 0===f?ro(d,u,3,r,l):f))return!1}}return!0};var so=function(e){return e==e&&!T(e)};var ao=function(e){for(var t=Ge(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,so(i)]}return t};var co=function(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}};var uo=function(e){var t=ao(e);return 1==t.length&&t[0][2]?co(t[0][0],t[0][1]):function(n){return n===e||oo(n,e,t)}};var lo=function(e,t){for(var n=0,r=(t=Hr(t,e)).length;null!=e&&n<r;)e=e[qr(t[n++])];return n&&n==r?e:void 0};var fo=function(e,t,n){var r=null==e?void 0:lo(e,t);return void 0===r?n:r};var ho=function(e,t){return null!=e&&t in Object(e)};var po=function(e,t){return null!=e&&$r(e,t,ho)};var go=function(e,t){return Ir(e)&&so(t)?co(qr(e),t):function(n){var r=fo(n,e);return void 0===r&&r===t?po(n,e):ro(t,r,3)}};var mo=function(e){return function(t){return null==t?void 0:t[e]}};var vo=function(e){return function(t){return lo(t,e)}};var _o=function(e){return Ir(e)?mo(qr(e)):vo(e)};var yo=function(e){return"function"==typeof e?e:null==e?gr:"object"==typeof e?je(e)?go(e[0],e[1]):uo(e):_o(e)};var bo=function(e){return yo("function"==typeof e?e:Yt(e,1))};var wo=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0};var So=function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o};var xo=function(e,t){return t.length<2?e:lo(e,So(t,0,-1))};var Eo=function(e,t){return t=Hr(t,e),null==(e=xo(e,t))||delete e[qr(wo(t))]};var Ao=function(e){return Nn(e)?void 0:e},No=y?y.isConcatSpreadable:void 0;var Oo=function(e){return je(e)||Oe(e)||!!(No&&e&&e[No])};var jo=function e(t,n,r,i,o){var s=-1,a=t.length;for(r||(r=Oo),o||(o=[]);++s<a;){var c=t[s];n>0&&r(c)?n>1?e(c,n-1,r,i,o):ut(o,c):i||(o[o.length]=c)}return o};var To=function(e){return(null==e?0:e.length)?jo(e,1):[]};var Co=function(e){return Sr(_r(e,void 0,To),e+"")},Io=Co((function(e,t){var n={};if(null==e)return n;var r=!1;t=Lr(t,(function(t){return t=Hr(t,e),r||(r=t.length>1),t})),be(e,gt(e),n),r&&(n=Yt(n,7,Ao));for(var i=t.length;i--;)Eo(n,t[i]);return n}));var Ro=function(e,t,n,r){if(!T(e))return e;for(var i=-1,o=(t=Hr(t,e)).length,s=o-1,a=e;null!=a&&++i<o;){var c=qr(t[i]),u=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(i!=s){var d=a[c];void 0===(u=r?r(d,c,a):void 0)&&(u=T(d)?d:Ie(t[i+1])?[]:{})}ye(a,c,u),a=a[c]}return e};var Mo=function(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var s=t[r],a=lo(e,s);n(a,s)&&Ro(o,Hr(s,e),a)}return o};var ko=function(e,t){return Mo(e,t,(function(t,n){return po(e,n)}))},Do=Co((function(e,t){return null==e?{}:ko(e,t)}));const Po=function(e,t){let n=e||{};t||(t={}),this.preinitialize.apply(this,arguments),this.cid=hi(this.cidPrefix),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(n=this.parse(n,t)||{});const r=Jr(this,"defaults");n=ji(Ar({},r,n),r),this.set(n,t),this.changed={},this.initialize.apply(this,arguments)};Po.extend=Vr,Object.assign(Po.prototype,pi,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",preinitialize:function(){},initialize:function(){},toJSON:function(e){return Ai(this.attributes)},sync:function(e,t,n){return Kr(this)(e,t,n)},get:function(e){return this.attributes[e]},keys:function(){return Object.keys(this.attributes)},values:function(){return Object.values(this.attributes)},pairs:function(){return this.entries()},entries:function(){return Object.entries(this.attributes)},invert:function(){return zi(this.attributes)},pick:function(...e){return 1===e.length&&Array.isArray(e[0])&&(e=e[0]),Do(this.attributes,e)},omit:function(...e){return 1===e.length&&Array.isArray(e[0])&&(e=e[0]),Io(this.attributes,e)},isEmpty:function(){return ti(this.attributes)},escape:function(e){return ki(this.get(e))},has:function(e){return null!=this.get(e)},matches:function(e){return!!bo(e,this)(this.attributes)},set:function(e,t,n){if(null==e)return this;let r;if("object"==typeof e?(r=e,n=t):(r={})[e]=t,n||(n={}),!this._validate(r,n))return!1;const i=n.unset,o=n.silent,s=[],a=this._changing;this._changing=!0,a||(this._previousAttributes=Ai(this.attributes),this.changed={});const c=this.attributes,u=this.changed,d=this._previousAttributes;for(const e in r)t=r[e],io(c[e],t)||s.push(e),io(d[e],t)?delete u[e]:u[e]=t,i?delete c[e]:c[e]=t;if(this.idAttribute in r&&(this.id=this.get(this.idAttribute)),!o){s.length&&(this._pending=n);for(let e=0;e<s.length;e++)this.trigger("change:"+s[e],this,c[s[e]],n)}if(a)return this;if(!o)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,Ar({},t,{unset:!0}))},clear:function(e){const t={};for(const e in this.attributes)t[e]=void 0;return this.set(t,Ar({},e,{unset:!0}))},hasChanged:function(e){return null==e?!ti(this.changed):Wr(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&Ai(this.changed);const t=this._changing?this._previousAttributes:this.attributes,n={};let r;for(const i in e){const o=e[i];io(t[i],o)||(n[i]=o,r=!0)}return!!r&&n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return Ai(this._previousAttributes)},fetch:function(e){e=Ar({parse:!0},e);const t=this,n=e.success;return e.success=function(r){const i=e.parse?t.parse(r,e):r;if(!t.set(i,e))return!1;n&&n.call(e.context,t,r,e),t.trigger("sync",t,r,e)},Xr(this,e),this.sync("read",this,e)},save:function(e,t,n){let r;null==e||"object"==typeof e?(r=e,n=t):(r={})[e]=t;const i=(n=Ar({validate:!0,parse:!0},n)).wait,o=n.promise,s=o&&Gr();if(r&&!i){if(!this.set(r,n))return!1}else if(!this._validate(r,n))return!1;const a=this,c=n.success,u=n.error,d=this.attributes;n.success=function(e){a.attributes=d;let t=n.parse?a.parse(e,n):e;if(i&&(t=Ar({},r,t)),t&&!a.set(t,n))return!1;c&&c.call(n.context,a,e,n),a.trigger("sync",a,e,n),o&&s.resolve()},n.error=function(e,t,n){u&&u.call(n.context,e,t,n),o&&s.reject(t)},Xr(this,n),r&&i&&(this.attributes=Ar({},d,r));const l=this.isNew()?"create":n.patch?"patch":"update";"patch"!==l||n.attrs||(n.attrs=r);const f=this.sync(l,this,n);return this.attributes=d,o?s:f},destroy:function(e){e=e?Ai(e):{};const t=this,n=e.success,r=e.wait,i=function(){t.stopListening(),t.trigger("destroy",t,t.collection,e)};e.success=function(o){r&&i(),n&&n.call(e.context,t,o,e),t.isNew()||t.trigger("sync",t,o,e)};let o=!1;return this.isNew()?Ci(e.success):(Xr(this,e),o=this.sync("delete",this,e)),r||i(),o},url:function(){const e=Jr(this,"urlRoot")||Jr(this.collection,"url")||Yr();if(this.isNew())return e;const t=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(t)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},Ar({},e,{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=Ar({},this.attributes,e);const n=this.validationError=this.validate(e,t)||null;return!n||(this.trigger("invalid",this,n,Ar(t,{validationError:n})),!1)}});var Lo=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i};
/**
 * @copyright 2020, the Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 * @description This is the core utilities module.
 */const Fo=hr.f.Strophe,Uo={isTagEqual:function(e,t){if(e.nodeTree)return Uo.isTagEqual(e.nodeTree,t);if(e instanceof Element)return Fo.isTagEqual(e,t);throw Error("isTagEqual called with value which isn't an element or Strophe.Builder instance")}},zo=new DOMParser,Bo=zo.parseFromString("invalid","text/xml").getElementsByTagName("parsererror")[0].namespaceURI;
/**
 * Clears the specified timeout and interval.
 * @method u#clearTimers
 * @param {number} timeout - Id if the timeout to clear.
 * @param {number} interval - Id of the interval to clear.
 * @private
 * @copyright Simen Bekkhus 2016
 * @license MIT
 */
function Ho(e,t){clearTimeout(e),clearInterval(t)}
/**
 * Creates a {@link Promise} that resolves if the passed in function returns a truthy value.
 * Rejects if it throws or does not return truthy within the given max_wait.
 * @method u#waitUntil
 * @param {Function} func - The function called every check_delay,
 *  and the result of which is the resolved value of the promise.
 * @param {number} [max_wait=300] - The time to wait before rejecting the promise.
 * @param {number} [check_delay=3] - The time to wait before each invocation of {func}.
 * @returns {Promise} A promise resolved with the value of func,
 *  or rejected with the exception thrown by it or it times out.
 * @copyright Simen Bekkhus 2016
 * @license MIT
 */Uo.getJIDFromURI=function(e){return e.startsWith("xmpp:")&&e.endsWith("?join")?e.replace(/^xmpp:/,"").replace(/\?join$/,""):e},Uo.toStanza=function(e){const t=zo.parseFromString(e,"text/xml");if(t.getElementsByTagNameNS(Bo,"parsererror").length)throw new Error("Parser Error: ".concat(e));return t.firstElementChild},Uo.getLongestSubstring=function(e,t){return t.reduce((function(t,n){return e.startsWith(n)&&n.length>t.length?n:t}),"")},Uo.prefixMentions=function(e){let t=e.get("message");return(e.get("references")||[]).sort((e,t)=>t.begin-e.begin).forEach(e=>{t="".concat(t.slice(0,e.begin),"@").concat(t.slice(e.begin))}),t},Uo.isValidJID=function(e){return"string"==typeof e&&(2===Lo(e.split("@")).length&&!e.startsWith("@")&&!e.endsWith("@"))},Uo.isValidMUCJID=function(e){return!e.startsWith("@")&&!e.endsWith("@")},Uo.isSameBareJID=function(e,t){return"string"==typeof e&&"string"==typeof t&&Fo.getBareJidFromJid(e).toLowerCase()===Fo.getBareJidFromJid(t).toLowerCase()},Uo.isSameDomain=function(e,t){return"string"==typeof e&&"string"==typeof t&&Fo.getDomainFromJid(e).toLowerCase()===Fo.getDomainFromJid(t).toLowerCase()},Uo.isNewMessage=function(e){return e instanceof Element?!(fr()('result[xmlns="'.concat(Fo.NS.MAM,'"]'),e).length&&fr()('delay[xmlns="'.concat(Fo.NS.DELAY,'"]'),e).length):(e instanceof Po&&(e=e.attributes),!(e.is_delayed&&e.is_archived))},Uo.shouldCreateMessage=function(e){return e.retracted||!Uo.isEmptyMessage(e)},Uo.shouldCreateGroupchatMessage=function(e){return e.nick&&(Uo.shouldCreateMessage(e)||e.is_tombstone)},Uo.isEmptyMessage=function(e){return e instanceof Po&&(e=e.attributes),!(e.oob_url||e.file||e.is_encrypted&&e.plaintext||e.message)},Uo.isOnlyChatStateNotification=function(e){return e instanceof Element?null===e.querySelector("body")&&(null!==e.querySelector("active")||null!==e.querySelector("composing")||null!==e.querySelector("inactive")||null!==e.querySelector("paused")||null!==e.querySelector("gone")):(e instanceof Po&&(e=e.attributes),e.chat_state&&Uo.isEmptyMessage(e))},Uo.isOnlyMessageDeliveryReceipt=function(e){return e instanceof Element?null===e.querySelector("body")&&null!==e.querySelector("received"):(e instanceof Po&&(e=e.attributes),e.received&&Uo.isEmptyMessage(e))},Uo.isChatRoom=function(e){return e&&"chatroom"===e.get("type")},Uo.isErrorObject=function(e){return e instanceof Error},Uo.isErrorStanza=function(e){return!!In(e)&&"error"===e.getAttribute("type")},Uo.isForbiddenError=function(e){return!!In(e)&&fr()('error[type="auth"] forbidden[xmlns="'.concat(Fo.NS.STANZAS,'"]'),e).length>0},Uo.isServiceUnavailableError=function(e){return!!In(e)&&fr()('error[type="cancel"] service-unavailable[xmlns="'.concat(Fo.NS.STANZAS,'"]'),e).length>0},Uo.merge=function e(t,n){for(const r in n)T(t[r])?e(t[r],n[r]):t[r]=n[r]},Uo.getOuterWidth=function(e,t=!1){let n=e.offsetWidth;if(!t)return n;const r=window.getComputedStyle(e);return n+=parseInt(r.marginLeft?r.marginLeft:0,10)+parseInt(r.marginRight?r.marginRight:0,10),n},Uo.stringToElement=function(e){var t=document.createElement("div");return t.innerHTML=e,t.firstElementChild},Uo.matchesSelector=function(e,t){const n=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector;return!!n&&n.call(e,t)},Uo.queryChildren=function(e,t){return Array.from(e.childNodes).filter(e=>Uo.matchesSelector(e,t))},Uo.contains=function(e,t){const n=(e,n)=>e.get(n).toLowerCase().includes(t.toLowerCase());return function(t){if("object"==typeof e)return Object.keys(e).reduce((e,r)=>e||n(t,r),!1);if("string"==typeof e)return n(t,e);throw new TypeError("contains: wrong attribute type. Must be string or array.")}},Uo.isOfType=function(e,t){return t.get("type")==e},Uo.isInstance=function(e,t){return t instanceof e},Uo.getAttribute=function(e,t){return t.get(e)},Uo.contains.not=function(e,t){return function(n){return!Uo.contains(e,t)(n)}},Uo.rootContains=function(e,t){return e!==document||e.contains?e.contains?e.contains(t):window.HTMLElement.prototype.contains.call(e,t):document.head.contains(t)||document.body.contains(t)},Uo.createFragmentFromText=function(e){var t,n=document.createDocumentFragment(),r=document.createElement("body");for(r.innerHTML=e;t=r.firstChild;)n.appendChild(t);return n},Uo.isPersistableModel=function(e){return e.collection&&e.collection.browserStorage},Uo.getResolveablePromise=function(){const e={isResolved:!1,isPending:!0,isRejected:!1},t=new Promise((t,n)=>{e.resolve=t,e.reject=n});return Object.assign(t,e),t.then((function(e){return t.isResolved=!0,t.isPending=!1,t.isRejected=!1,e}),(function(e){throw t.isResolved=!1,t.isPending=!1,t.isRejected=!0,e})),t},Uo.interpolate=function(e,t){return e.replace(/{{{([^{}]*)}}}/g,(e,n)=>{var r=t[n];return"string"==typeof r||"number"==typeof r?r:e})},Uo.onMultipleEvents=function(e=[],t){let n=[];function r(r){n.push(r),e.length===n.length&&(t(n),n=[])}e.forEach(e=>e.object.on(e.event,r))},Uo.safeSave=function(e,t,n){Uo.isPersistableModel(e)?e.save(t,n):e.set(t,n)},Uo.siblingIndex=function(e){for(var t=0;e=e.previousElementSibling;t++);return t},Uo.getCurrentWord=function(e,t,n){t||(t=e.selectionEnd||void 0);let[r]=e.value.slice(0,t).split(/\s/).slice(-1);return n&&([r]=r.split(n).slice(-1)),r},Uo.replaceCurrentWord=function(e,t){const n=e.selectionEnd||void 0,r=wo(e.value.slice(0,n).split(" ")),i=e.value;e.value=i.slice(0,n-r.length)+"".concat(t," ")+i.slice(n),e.selectionEnd=n-r.length+t.length+1},Uo.triggerEvent=function(e,t,n="Event",r=!0,i=!0){const o=document.createEvent(n);o.initEvent(t,r,i),e.dispatchEvent(o)},Uo.getSelectValues=function(e){const t=[],n=e&&e.options;for(var r=0,i=n.length;r<i;r++){const e=n[r];e.selected&&t.push(e.value||e.text)}return t},Uo.formatFingerprint=function(e){e=e.replace(/^05/,"");for(let t=1;t<8;t++){const n=8*t+t-1;e=e.slice(0,n)+" "+e.slice(n)}return e},Uo.appendArrayBuffer=function(e,t){const n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer},Uo.arrayBufferToHex=function(e){return Array.prototype.map.call(new Uint8Array(e),e=>("00"+e.toString(16)).slice(-2)).join("")},Uo.arrayBufferToString=function(e){return new TextDecoder("utf-8").decode(e)},Uo.stringToArrayBuffer=function(e){return new TextEncoder("utf-8").encode(e).buffer},Uo.arrayBufferToBase64=function(e){return btoa(new Uint8Array(e).reduce((e,t)=>e+String.fromCharCode(t),""))},Uo.base64ToArrayBuffer=function(e){const t=window.atob(e),n=t.length,r=new Uint8Array(n);for(let e=0;e<n;e++)r[e]=t.charCodeAt(e);return r.buffer},Uo.getRandomInt=function(e){return Math.floor(Math.random()*Math.floor(e))},Uo.placeCaretAtEnd=function(e){e!==document.activeElement&&e.focus();const t=2*e.value.length;setTimeout(()=>e.setSelectionRange(t,t),1),this.scrollTop=999999},Uo.getUniqueId=function(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}));return"string"==typeof e||"number"==typeof e?t+":"+e:t},Uo.waitUntil=function(e,t=300,n=3){try{const t=e();if(t)return Promise.resolve(t)}catch(e){return Promise.reject(e)}const r=Uo.getResolveablePromise(),i=new Error;const o=setInterval((function(){try{const t=e();t&&(Ho(s,o),r.resolve(t))}catch(e){Ho(s,o),r.reject(e)}}),n);const s=setTimeout((function(){Ho(s,o);const e="Wait until promise timed out: \n\n".concat(i.stack);console.trace(),kn.error(e),r.reject(new Error(e))}),t);return r};var qo=Uo;const $o=hr.f.Strophe,Wo=hr.f.$msg,{NS:Jo}=$o;function Vo(e){const t=fr()('spoiler[xmlns="'.concat($o.NS.SPOILER,'"]'),e).pop();return{is_spoiler:!!t,spoiler_hint:null==t?void 0:t.textContent}}function Go(e){const t=fr()('x[xmlns="'.concat($o.NS.OUTOFBAND,'"]'),e).pop();var n,r;return t?{oob_url:null===(n=t.querySelector("url"))||void 0===n?void 0:n.textContent,oob_desc:null===(r=t.querySelector("desc"))||void 0===r?void 0:r.textContent}:{}}function Yo(e,t){const n=fr()('replace[xmlns="'.concat($o.NS.MESSAGE_CORRECT,'"]'),e).pop();if(n){const e=n.getAttribute("id"),r=e;if(e){const n=fr()('delay[xmlns="'.concat($o.NS.DELAY,'"]'),t).pop();return{msgid:r,replace_id:e,edited:n?bn()(n.getAttribute("stamp")).toISOString():(new Date).toISOString()}}}return{}}function Xo(e,t){var n;const r=fr()('encrypted[xmlns="'.concat($o.NS.OMEMO,'"]'),e).pop(),i={is_encrypted:!!r};if(!r||Mc.settings.get("clear_cache_on_logout"))return i;const o=r.querySelector("header");i.encrypted={device_id:o.getAttribute("sid")};const s=null===(n=t.omemo_store)||void 0===n?void 0:n.get("device_id"),a=s&&fr()('key[rid="'.concat(s,'"]'),r).pop();var c;a&&Object.assign(i.encrypted,{iv:o.querySelector("iv").textContent,key:a.textContent,payload:(null===(c=r.querySelector("payload"))||void 0===c?void 0:c.textContent)||null,prekey:["true","1"].includes(a.getAttribute("prekey"))});return i}function Qo(e,t){return"me"!==t.sender&&!t.is_carbon&&!t.is_archived&&fr()('request[xmlns="'.concat($o.NS.RECEIPTS,'"]'),e).length}function Ko(e){const t=fr()('received[xmlns="'.concat($o.NS.RECEIPTS,'"]'),e).pop();return null==t?void 0:t.getAttribute("id")}function Zo(e){var t;return null===(t=fr()('\n        composing[xmlns="'.concat(Jo.CHATSTATES,'"],\n        paused[xmlns="').concat(Jo.CHATSTATES,'"],\n        inactive[xmlns="').concat(Jo.CHATSTATES,'"],\n        active[xmlns="').concat(Jo.CHATSTATES,'"],\n        gone[xmlns="').concat(Jo.CHATSTATES,'"]'),e).pop())||void 0===t?void 0:t.nodeName}function es(e){const t=$o.NS.CARBONS;return fr()('message > received[xmlns="'.concat(t,'"]'),e).length>0||fr()('message > sent[xmlns="'.concat(t,'"]'),e).length>0}function ts(e,t){const n={},r=fr()('stanza-id[xmlns="'.concat($o.NS.SID,'"]'),e).reduce((e,t)=>(e["stanza_id ".concat(t.getAttribute("by"))]=t.getAttribute("id"),e),{});Object.assign(n,r);const i=fr()('message > result[xmlns="'.concat($o.NS.MAM,'"]'),t).pop();if(i){const e=t.getAttribute("from")||Tc.bare_jid;n["stanza_id ".concat(e)]=i.getAttribute("id")}const o=fr()('origin-id[xmlns="'.concat($o.NS.SID,'"]'),e).pop();return o&&(n.origin_id=o.getAttribute("id")),n}function ns(e,t){const n=fr()('> apply-to[xmlns="'.concat($o.NS.FASTEN,'"]'),e).pop();if(n){const e=n.getAttribute("id");if(fr()('> retract[xmlns="'.concat($o.NS.RETRACT,'"]'),n).pop()){const n=fr()('delay[xmlns="'.concat($o.NS.DELAY,'"]'),t).pop();return{editable:!1,retracted:n?bn()(n.getAttribute("stamp")).toISOString():(new Date).toISOString(),retracted_id:e}}}else{const t=fr()('> retracted[xmlns="'.concat($o.NS.RETRACT,'"]'),e).pop();if(t)return{editable:!1,is_tombstone:!0,retracted:t.getAttribute("stamp")}}return{}}function rs(e){var t;const n=null===(t=e.querySelector("body"))||void 0===t?void 0:t.textContent;return fr()('reference[xmlns="'.concat($o.NS.REFERENCE,'"]'),e).map(e=>{const t=e.getAttribute("begin"),r=e.getAttribute("end");return{begin:t,end:r,type:e.getAttribute("type"),value:n.slice(t,r),uri:e.getAttribute("uri")}})}function is(e,t){Mc.send(Wo({to:e.getAttribute("from"),type:"error",id:e.getAttribute("id")}).c("error",{type:"cancel"}).c("not-allowed",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"}).up().c("text",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"}).t(t)),kn.warn("Rejecting message stanza with the following reason: ".concat(t)),kn.warn(e)}function os(e){if("error"===e.getAttribute("type")){const t=e.querySelector("error"),n=fr()('text[xmlns="'.concat($o.NS.STANZAS,'"]'),t).pop();return{is_error:!0,error_text:null==n?void 0:n.textContent,error_type:t.getAttribute("type"),error_condition:t.firstElementChild.nodeName}}return{}}class ss extends Error{constructor(e,t){super(e,t),this.name="StanzaParseError",this.stanza=t}}function as(e){if(fr()('message > forwarded[xmlns="'.concat($o.NS.FORWARD,'"]'),e).length){is(e,"Forwarded messages not part of an encapsulating protocol are not supported");const t=e.getAttribute("from");return new ss("Ignoring unencapsulated forwarded message from ".concat(t),e)}}const cs={isHeadline:e=>"headline"===e.getAttribute("type"),isServerMessage(e){const t=e.getAttribute("from");return!("error"===e.getAttribute("type")||!t||t.includes("@"))},getChatMarker:e=>fr()('\n            acknowledged[xmlns="'.concat($o.NS.MARKERS,'"],\n            displayed[xmlns="').concat($o.NS.MARKERS,'"],\n            received[xmlns="').concat($o.NS.MARKERS,'"]'),e).pop(),isArchived:e=>!!fr()('message > result[xmlns="'.concat($o.NS.MAM,'"]'),e).pop(),getAttributes:e=>e.getAttributeNames().reduce((t,n)=>(t[n]=$o.xmlunescape(e.getAttribute(n)),t),{}),async parseMessage(e,t){var n,r,i,o,s,a;const c=as(e);if(c)return c;let u=e.getAttribute("to");const d=$o.getResourceFromJid(u);if(Mc.settings.get("filter_by_resource")&&d&&d!==t.resource)return new ss("Ignoring incoming message intended for a different resource: ".concat(u),e);const l=e;let f=e.getAttribute("from")||t.bare_jid;if(es(e)){if(f!==t.bare_jid)return is(e,"Rejecting carbon from invalid JID"),new ss("Rejecting carbon from invalid JID ".concat(u),e);{const t='[xmlns="'.concat($o.NS.CARBONS,'"] > forwarded[xmlns="').concat($o.NS.FORWARD,'"] > message');u=(e=fr()(t,e).pop()).getAttribute("to"),f=e.getAttribute("from")}}const h=cs.isArchived(e);if(h){if(f!==t.bare_jid)return new ss("Invalid Stanza: alleged MAM message from ".concat(e.getAttribute("from")),e);{const t='[xmlns="'.concat($o.NS.MAM,'"] > forwarded[xmlns="').concat($o.NS.FORWARD,'"] > message');u=(e=fr()(t,e).pop()).getAttribute("to"),f=e.getAttribute("from")}}const p=$o.getBareJidFromJid(f),g=p===t.bare_jid;if(g&&null===u)return new ss("Don't know how to handle message stanza without 'to' attribute. ".concat(e.outerHTML),e);const m=cs.isHeadline(e),v=cs.isServerMessage(e);let _,y;if(!m&&!v&&(y=g?$o.getBareJidFromJid(u):p,_=await Mc.contacts.get(y),void 0===_&&!Mc.settings.get("allow_non_roster_messaging")))return kn.error(e),new ss("Blocking messaging with a JID not in our roster because allow_non_roster_messaging is false.",e);const b=fr()('delay[xmlns="'.concat($o.NS.DELAY,'"]'),l).pop(),w=cs.getChatMarker(e),S=(new Date).toISOString();let x=Object.assign({contact_jid:y,is_archived:h,is_headline:m,is_server_message:v,body:null===(n=e.querySelector("body"))||void 0===n||null===(r=n.textContent)||void 0===r?void 0:r.trim(),chat_state:Zo(e),from:$o.getBareJidFromJid(e.getAttribute("from")),is_carbon:es(l),is_delayed:!!b,is_markable:!!fr()('markable[xmlns="'.concat($o.NS.MARKERS,'"]'),e).length,is_marker:!!w,marker_id:w&&w.getAttribute("id"),msgid:e.getAttribute("id")||l.getAttribute("id"),nick:null===(i=_)||void 0===i||null===(o=i.attributes)||void 0===o?void 0:o.nickname,receipt_id:Ko(e),received:(new Date).toISOString(),references:rs(e),sender:g?"me":"them",subject:null===(s=e.querySelector("subject"))||void 0===s?void 0:s.textContent,thread:null===(a=e.querySelector("thread"))||void 0===a?void 0:a.textContent,time:b?bn()(b.getAttribute("stamp")).toISOString():S,to:e.getAttribute("to"),type:e.getAttribute("type")},os(e),Go(e),Vo(e),Yo(e,l),ts(e,l),ns(e,l),Xo(e,t));if(x.is_archived){const n=l.getAttribute("from");if(n&&n!==t.bare_jid)return new ss("Invalid Stanza: Forged MAM message from ".concat(n),e)}return await Mc.emojis.initialize(),x=Object.assign({message:x.body||x.error,is_only_emojis:!!x.body&&qo.isOnlyEmojis(x.body),is_valid_receipt_request:Qo(e,x)},x),x.id=x.origin_id||x["stanza_id ".concat(x.from)]||qo.getUniqueId(),Mc.hook("parseMessage",e,x)},async parseMUCMessage(e,t,n){var r,i,o,s,a;const c=as(e);if(c)return c;const u='[xmlns="'.concat(Jo.MAM,'"] > forwarded[xmlns="').concat(Jo.FORWARD,'"] > message'),d=e;if(e=fr()(u,e).pop()||e,fr()('message > forwarded[xmlns="'.concat($o.NS.FORWARD,'"]'),e).length)return new ss("Invalid Stanza: Forged MAM groupchat message from ".concat(e.getAttribute("from")),e);const l=fr()('delay[xmlns="'.concat($o.NS.DELAY,'"]'),d).pop(),f=e.getAttribute("from"),h=$o.unescapeNode($o.getResourceFromJid(f)),p=cs.getChatMarker(e),g=(new Date).toISOString();let m=Object.assign({from:f,nick:h,body:null===(r=e.querySelector("body"))||void 0===r||null===(i=r.textContent)||void 0===i?void 0:i.trim(),chat_state:Zo(e),from_muc:$o.getBareJidFromJid(f),from_real_jid:null===(o=t.occupants.findOccupant({nick:h}))||void 0===o?void 0:o.get("jid"),is_archived:cs.isArchived(d),is_carbon:es(d),is_delayed:!!l,is_headline:cs.isHeadline(e),is_markable:!!fr()('markable[xmlns="'.concat($o.NS.MARKERS,'"]'),e).length,is_marker:!!p,marker_id:p&&p.getAttribute("id"),msgid:e.getAttribute("id")||d.getAttribute("id"),receipt_id:Ko(e),received:(new Date).toISOString(),references:rs(e),subject:null===(s=e.querySelector("subject"))||void 0===s?void 0:s.textContent,thread:null===(a=e.querySelector("thread"))||void 0===a?void 0:a.textContent,time:l?bn()(l.getAttribute("stamp")).toISOString():g,to:e.getAttribute("to"),type:e.getAttribute("type")},os(e),Go(e),Vo(e),Yo(e,d),ts(e,d),ns(e,d),function(e){const t=fr()('apply-to[xmlns="'.concat($o.NS.FASTEN,'"]'),e).pop();if(t){const e=t.getAttribute("id"),r=fr()('moderated[xmlns="'.concat($o.NS.MODERATE,'"]'),t).pop();if(r){var n;if(fr()('retract[xmlns="'.concat($o.NS.RETRACT,'"]'),r).pop())return{editable:!1,moderated:"retracted",moderated_by:r.getAttribute("by"),moderated_id:e,moderation_reason:null===(n=r.querySelector("reason"))||void 0===n?void 0:n.textContent}}}else{const t=fr()('> moderated[xmlns="'.concat($o.NS.MODERATE,'"]'),e).pop();if(t){var r;if(fr()('retracted[xmlns="'.concat($o.NS.RETRACT,'"]'),t).pop())return{editable:!1,is_tombstone:!0,moderated_by:t.getAttribute("by"),retracted:t.getAttribute("stamp"),moderation_reason:null===(r=t.querySelector("reason"))||void 0===r?void 0:r.textContent}}}return{}}(e),Xo(e,n));return await Mc.emojis.initialize(),m=Object.assign({is_only_emojis:!!m.body&&qo.isOnlyEmojis(m.body),is_valid_receipt_request:Qo(e,m),message:m.body||m.error,sender:m.nick===t.get("nick")?"me":"them"},m),m.is_archived&&d.getAttribute("from")!==m.from_muc?new ss("Invalid Stanza: Forged MAM message from ".concat(d.getAttribute("from")),e):m.is_archived&&d.getAttribute("from")!==t.get("jid")?new ss("Invalid Stanza: Forged MAM groupchat message from ".concat(e.getAttribute("from")),e):m.is_carbon?new ss("Invalid Stanza: MUC messages SHOULD NOT be XEP-0280 carbon copied",e):(m.id=m.origin_id||m["stanza_id ".concat(m.from_muc||m.from)]||qo.getUniqueId(),Mc.hook("parseMUCMessage",e,m))},parseMUCPresence(e){const t=e.getAttribute("from"),n=e.getAttribute("type"),r={from:t,nick:$o.getResourceFromJid(t),type:n,states:[],hats:[],show:"unavailable"!==n?"online":"offline"};return Array.from(e.children).forEach(e=>{if(e.matches("status"))r.status=e.textContent||null;else if(e.matches("show"))r.show=e.textContent||"online";else if(e.matches("x")&&e.getAttribute("xmlns")===$o.NS.MUC_USER)Array.from(e.children).forEach(e=>{"item"===e.nodeName?(r.affiliation=e.getAttribute("affiliation"),r.role=e.getAttribute("role"),r.jid=e.getAttribute("jid"),r.nick=e.getAttribute("nick")||r.nick):"status"==e.nodeName&&e.getAttribute("code")&&r.states.push(e.getAttribute("code"))});else if(e.matches("x")&&e.getAttribute("xmlns")===$o.NS.VCARDUPDATE){var t;r.image_hash=null===(t=e.querySelector("photo"))||void 0===t?void 0:t.textContent}else e.matches("hats")&&e.getAttribute("xmlns")===$o.NS.MUC_HATS&&(r.hats=Array.from(e.children).map(e=>e.matches("hat")&&{title:e.getAttribute("title"),uri:e.getAttribute("uri")}))}),r}};var us=cs;var ds=function(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var s=e[i];t(r,s,n(s),e)}return r};var ls=function(e,t){return function(n,r){if(null==n)return n;if(!Ve(n))return e(n,r);for(var i=n.length,o=t?i:-1,s=Object(n);(t?o--:++o<i)&&!1!==r(s[o],o,s););return n}}(Pi);var fs=function(e,t,n,r){return ls(e,(function(e,i,o){t(r,e,n(e),o)})),r};var hs=function(e,t){return function(n,r){var i=je(n)?ds:fs,o=t?t():{};return i(n,e,yo(r,2),o)}},ps=Object.prototype.hasOwnProperty,gs=hs((function(e,t,n){ps.call(e,n)?++e[n]:ve(e,n,1)}));var ms=function(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1};var vs=function(e){return e!=e};var _s=function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1};var ys=function(e,t,n){return t==t?_s(e,t,n):ms(e,vs,n)};var bs=function(e,t){return!!(null==e?0:e.length)&&ys(e,t,0)>-1};var ws=function(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1};var Ss=function(e,t,n,r){var i=-1,o=bs,s=!0,a=e.length,c=[],u=t.length;if(!a)return c;n&&(t=Lr(t,De(n))),r?(o=ws,s=!1):t.length>=200&&(o=Ji,s=!1,t=new $i(t));e:for(;++i<a;){var d=e[i],l=null==n?d:n(d);if(d=r||0!==d?d:0,s&&l==l){for(var f=u;f--;)if(t[f]===l)continue e;c.push(d)}else o(t,l,r)||c.push(d)}return c};var xs=function(e){return Se(e)&&Ve(e)},Es=xr((function(e,t){return xs(e)?Ss(e,jo(t,1,xs,!0)):[]}));var As=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0};var Ns=function(e,t){var n=!0;return ls(e,(function(e,r,i){return n=!!t(e,r,i)})),n};var Os=function(e,t,n){var r=je(e)?As:Ns;return n&&Er(e,t,n)&&(t=void 0),r(e,yo(t,3))},js=Math.max;var Ts=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:ui(n);return i<0&&(i=js(r+i,0)),ms(e,yo(t,3),i)},Cs=Math.max,Is=Math.min;var Rs=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r-1;return void 0!==n&&(i=ui(n),i=n<0?Cs(r+i,0):Is(i,r-1)),ms(e,yo(t,3),i,!0)},Ms=Object.prototype.hasOwnProperty,ks=hs((function(e,t,n){Ms.call(e,n)?e[n].push(t):ve(e,n,[t])})),Ds=Math.max;var Ps=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:ui(n);return i<0&&(i=Ds(r+i,0)),ys(e,t,i)},Ls=hs((function(e,t,n){ve(e,n,t)}));var Fs=function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r},Us=Math.max,zs=Math.min;var Bs=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r;return void 0!==n&&(i=(i=ui(n))<0?Us(r+i,0):zs(i,r-1)),t==t?Fs(e,t,i):ms(e,vs,i,!0)};var Hs=function(e,t){var n;return ls(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n};var qs=function(e,t,n){var r=je(e)?Wi:Hs;return n&&Er(e,t,n)&&(t=void 0),r(e,yo(t,3))};var $s=function(e,t){var n=-1,r=Ve(e)?Array(e.length):[];return ls(e,(function(e,i,o){r[++n]=t(e,i,o)})),r};var Ws=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e};var Js=function(e,t){if(e!==t){var n=void 0!==e,r=null===e,i=e==e,o=jr(e),s=void 0!==t,a=null===t,c=t==t,u=jr(t);if(!a&&!u&&!o&&e>t||o&&s&&c&&!a&&!u||r&&s&&c||!n&&c||!i)return 1;if(!r&&!o&&!u&&e<t||u&&n&&i&&!r&&!o||a&&n&&i||!s&&i||!c)return-1}return 0};var Vs=function(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,s=i.length,a=n.length;++r<s;){var c=Js(i[r],o[r]);if(c)return r>=a?c:c*("desc"==n[r]?-1:1)}return e.index-t.index};var Gs=function(e,t,n){t=t.length?Lr(t,(function(e){return je(e)?function(t){return lo(t,1===e.length?e[0]:e)}:e})):[gr];var r=-1;t=Lr(t,De(yo));var i=$s(e,(function(e,n,i){return{criteria:Lr(t,(function(t){return t(e)})),index:++r,value:e}}));return Ws(i,(function(e,t){return Vs(e,t,n)}))},Ys=xr((function(e,t){if(null==e)return[];var n=t.length;return n>1&&Er(e,t[0],t[1])?t=[]:n>2&&Er(t[0],t[1],t[2])&&(t=[t[0]]),Gs(e,jo(t,1),[])}));const Xs=Array.prototype.slice,Qs=function(e,t){t||(t={}),this.preinitialize.apply(this,arguments),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,Ar({silent:!0},t))};Qs.extend=Vr;const Ks={add:!0,remove:!0,merge:!0},Zs={add:!0,remove:!1},ea=function(e,t,n){n=Math.min(Math.max(n,0),e.length);const r=Array(e.length-n),i=t.length;let o;for(o=0;o<r.length;o++)r[o]=e[o+n];for(o=0;o<i;o++)e[o+n]=t[o];for(o=0;o<r.length;o++)e[o+i+n]=r[o]};Object.assign(Qs.prototype,pi,{model:Po,preinitialize:function(){},initialize:function(){},toJSON:function(e){return this.map((function(t){return t.toJSON(e)}))},sync:function(e,t,n){return Kr(this)(e,t,n)},add:function(e,t){return this.set(e,Ar({merge:!1},t,Zs))},remove:function(e,t){t=Ar({},t);const n=!Array.isArray(e);e=n?[e]:e.slice();const r=this._removeModels(e,t);return!t.silent&&r.length&&(t.changes={added:[],merged:[],removed:r},this.trigger("update",this,t)),n?r[0]:r},set:function(e,t){if(null==e)return;(t=Ar({},Ks,t)).parse&&!this._isModel(e)&&(e=this.parse(e,t)||[]);const n=!Array.isArray(e);e=n?[e]:e.slice();let r=t.at;null!=r&&(r=+r),r>this.length&&(r=this.length),r<0&&(r+=this.length+1);const i=[],o=[],s=[],a=[],c={},u=t.add,d=t.merge,l=t.remove;let f=!1;const h=this.comparator&&null==r&&!1!==t.sort,p=Qt(this.comparator)?this.comparator:null;let g,m;for(m=0;m<e.length;m++){g=e[m];const n=this.get(g);if(n){if(d&&g!==n){let e=this._isModel(g)?g.attributes:g;t.parse&&(e=n.parse(e,t)),n.set(e,t),s.push(n),h&&!f&&(f=n.hasChanged(p))}c[n.cid]||(c[n.cid]=!0,i.push(n)),e[m]=n}else u&&(g=e[m]=this._prepareModel(g,t),g&&(o.push(g),this._addReference(g,t),c[g.cid]=!0,i.push(g)))}if(l){for(m=0;m<this.length;m++)g=this.models[m],c[g.cid]||a.push(g);a.length&&this._removeModels(a,t)}let v=!1;const _=!h&&u&&l;if(i.length&&_?(v=this.length!==i.length||qs(this.models,(e,t)=>e!==i[t]),this.models.length=0,ea(this.models,i,0),this.length=this.models.length):o.length&&(h&&(f=!0),ea(this.models,o,null==r?this.length:r),this.length=this.models.length),f&&this.sort({silent:!0}),!t.silent){for(m=0;m<o.length;m++)null!=r&&(t.index=r+m),g=o[m],g.trigger("add",g,this,t);(f||v)&&this.trigger("sort",this,t),(o.length||a.length||s.length)&&(t.changes={added:o,removed:a,merged:s},this.trigger("update",this,t))}return n?e[0]:e},clearStore:async function(e={},t=(e=>e)){await Promise.all(this.models.filter(t).map(t=>new Promise(n=>{t.destroy(Object.assign(e,{success:n,error:(e,t)=>{console.error(t),n()}}))}))),await this.browserStorage.clear(),this.reset()},reset:function(e,t){t=t?Ai(t):{};for(let e=0;e<this.models.length;e++)this._removeReference(this.models[e],t);return t.previousModels=this.models,this._reset(),e=this.add(e,Ar({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,Ar({at:this.length},t))},pop:function(e){const t=this.at(this.length-1);return this.remove(t,e)},unshift:function(e,t){return this.add(e,Ar({at:0},t))},shift:function(e){const t=this.at(0);return this.remove(t,e)},slice:function(){return Xs.apply(this.models,arguments)},filter:function(e,t){return this.models.filter(I(e)?e:t=>t.matches(e),t)},every:function(e){return Os(this.models.map(e=>e.attributes),e)},difference:function(e){return Es(this.models,e)},max:function(){return Math.max.apply(Math,this.models)},min:function(){return Math.min.apply(Math,this.models)},drop:function(e=1){return this.models.slice(e)},some:function(e){return qs(this.models.map(e=>e.attributes),e)},sortBy:function(e){return Ys(this.models,I(e)?e:t=>Qt(e)?t.get(e):t.matches(e))},isEmpty:function(){return ti(this.models)},keyBy:function(e){return Ls(this.models,e)},each:function(e,t){return this.forEach(e,t)},forEach:function(e,t){return this.models.forEach(e,t)},includes:function(e){return this.models.includes(e)},size:function(){return this.models.length},countBy:function(e){return gs(this.models,I(e)?e:t=>Qt(e)?t.get(e):t.matches(e))},groupBy:function(e){return ks(this.models,I(e)?e:t=>Qt(e)?t.get(e):t.matches(e))},indexOf:function(e){return Ps(this.models,e)},findLastIndex:function(e,t){return Rs(this.models,I(e)?e:t=>Qt(e)?t.get(e):t.matches(e),t)},lastIndexOf:function(e){return Bs(this.models,e)},findIndex:function(e){return Ts(this.models,I(e)?e:t=>Qt(e)?t.get(e):t.matches(e))},last:function(){const e=null==this.models?0:this.models.length;return e?this.models[e-1]:void 0},head:function(){return this.models[0]},first:function(){return this.head()},map:function(e,t){return this.models.map(I(e)?e:t=>Qt(e)?t.get(e):t.matches(e),t)},reduce:function(e,t){return this.models.reduce(e,t||this.models[0])},reduceRight:function(e,t){return this.models.reduceRight(e,t||this.models[0])},toArray:function(){return Array.from(this.models)},get:function(e){if(null!=e)return this._byId[e]||this._byId[this.modelId(this._isModel(e)?e.attributes:e)]||e.cid&&this._byId[e.cid]},has:function(e){return null!=this.get(e)},at:function(e){return e<0&&(e+=this.length),this.models[e]},where:function(e,t){return this[t?"find":"filter"](e)},findWhere:function(e){return this.where(e,!0)},find:function(e,t){const n=I(e)?e:t=>t.matches(e);return this.models.find(n,t)},sort:function(e){let t=this.comparator;if(!t)throw new Error("Cannot sort a set without a comparator");e||(e={});const n=t.length;return I(t)&&(t=t.bind(this)),1===n||Qt(t)?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return this.map(e+"")},fetch:function(e){const t=(e=Ar({parse:!0},e)).success,n=this,r=e.promise&&Gr();return e.success=function(i){const o=e.reset?"reset":"set";n[o](i,e),t&&t.call(e.context,n,i,e),r&&r.resolve(),n.trigger("sync",n,i,e)},Xr(this,e),r||this.sync("read",this,e)},create:function(e,t){const n=(t=t?Ai(t):{}).wait,r=t.promise,i=r&&Gr();if(!(e=this._prepareModel(e,t)))return!1;n||this.add(e,t);const o=this,s=t.success,a=t.error;return t.success=function(e,t,a){n&&o.add(e,a),s&&s.call(a.context,e,t,a),r&&i.resolve(e)},t.error=function(e,t,n){a&&a.call(n.context,e,t,n),r&&i.reject(t)},e.save(null,Object.assign(t,{promise:!1})),r?i:e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(e){return e[this.model.prototype.idAttribute||"id"]},values:function(){return new na(this,ra)},keys:function(){return new na(this,ia)},entries:function(){return new na(this,oa)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(this._isModel(e))return e.collection||(e.collection=this),e;(t=t?Ai(t):{}).collection=this;const n=new this.model(e,t);return n.validationError?(this.trigger("invalid",this,n.validationError,t),!1):n},_removeModels:function(e,t){const n=[];for(let r=0;r<e.length;r++){const i=this.get(e[r]);if(!i)continue;const o=this.indexOf(i);this.models.splice(o,1),this.length--,delete this._byId[i.cid];const s=this.modelId(i.attributes);null!=s&&delete this._byId[s],t.silent||(t.index=o,i.trigger("remove",i,this,t)),n.push(i),this._removeReference(i,t)}return n},_isModel:function(e){return e instanceof Po},_addReference:function(e,t){this._byId[e.cid]=e;const n=this.modelId(e.attributes);null!=n&&(this._byId[n]=e),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){delete this._byId[e.cid];const n=this.modelId(e.attributes);null!=n&&delete this._byId[n],this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if(t){if(("add"===e||"remove"===e)&&n!==this)return;if("destroy"===e&&this.remove(t,r),"change"===e){const e=this.modelId(t.previousAttributes()),n=this.modelId(t.attributes);e!==n&&(null!=e&&delete this._byId[e],null!=n&&(this._byId[n]=t))}}this.trigger.apply(this,arguments)}});const ta="function"==typeof Symbol&&Symbol.iterator;ta&&(Qs.prototype[ta]=Qs.prototype.values);const na=function(e,t){this._collection=e,this._kind=t,this._index=0},ra=1,ia=2,oa=3;ta&&(na.prototype[ta]=function(){return this}),na.prototype.next=function(){if(this._collection){if(this._index<this._collection.length){const e=this._collection.at(this._index);let t;if(this._index++,this._kind===ra)t=e;else{const n=this._collection.modelId(e.attributes);t=this._kind===ia?n:[n,e]}return{value:t,done:!1}}this._collection=void 0}return{value:void 0,done:!0}};var sa=n(54);class aa extends hr.e.Connection{constructor(e,t){super(e,t),this.debouncedReconnect=Object(sa.debounce)(this.reconnect,2e3)}static generateResource(){return"/converse.js-".concat(Math.floor(139749528*Math.random()).toString())}async bind(){await Mc.trigger("beforeResourceBinding",{synchronous:!0}),super.bind()}async onDomainDiscovered(e){const t=await e.text(),n=(new window.DOMParser).parseFromString(t,"text/xml").firstElementChild;if("XRD"!=n.nodeName||"http://docs.oasis-open.org/ns/xri/xrd-1.0"!=n.namespaceURI)return kn.warn("Could not discover XEP-0156 connection methods");const r=fr()('Link[rel="urn:xmpp:alt-connections:xbosh"]',n),i=fr()('Link[rel="urn:xmpp:alt-connections:websocket"]',n),o=r.map(e=>e.getAttribute("href")),s=i.map(e=>e.getAttribute("href"));0===o.length&&0===s.length?kn.warn("Neither BOSH nor WebSocket connection methods have been specified with XEP-0156."):(Mc.settings.set("websocket_url",s.pop()),Mc.settings.set("bosh_service_url",o.pop()),this.service=Mc.settings.get("websocket_url")||Mc.settings.get("bosh_service_url"),this.setProtocol())}async discoverConnectionMethods(e){const t={mode:"cors",headers:{Accept:"application/xrd+xml, text/xml"}},n="https://".concat(e,"/.well-known/host-meta");let r;try{r=await fetch(n,t)}catch(e){return kn.error("Failed to discover alternative connection methods at ".concat(n)),void kn.error(e)}r.status>=200&&r.status<400?await this.onDomainDiscovered(r):kn.warn("Could not discover XEP-0156 connection methods")}async connect(e,t,n){if(Mc.settings.get("discover_connection_methods")){const t=hr.e.getDomainFromJid(e);await this.discoverConnectionMethods(t)}super.connect(e,t,n||this.onConnectStatusChanged,59)}async reconnect(){const{__:e}=Tc;return kn.debug("RECONNECTING: the connection has dropped, attempting to reconnect."),this.setConnectionStatus(hr.e.Status.RECONNECTING,e("The connection has dropped, attempting to reconnect.")),Mc.trigger("will-reconnect"),this.reconnecting=!0,await Pc(),Mc.user.login()}async onConnected(e){delete this.reconnecting,this.flush(),await Tc.setUserJID(this.jid),await Mc.trigger("afterResourceBinding",e,{synchronous:!0}),e?Mc.trigger("reconnected"):Mc.trigger("connected")}setDisconnectionCause(e,t,n){void 0===e?(delete this.disconnection_cause,delete this.disconnection_reason):(void 0===this.disconnection_cause||n)&&(this.disconnection_cause=e,this.disconnection_reason=t)}setConnectionStatus(e,t){this.status=e,Tc.connfeedback.set({connection_status:e,message:t})}async finishDisconnection(){kn.debug("DISCONNECTED"),delete this.reconnecting,this.reset(),Pc(),await Fc(),delete Tc.connection,Mc.trigger("disconnected")}onDisconnected(){if(!Mc.settings.get("auto_reconnect"))return this.finishDisconnection();{const e=this.disconnection_reason;if(this.disconnection_cause===hr.e.Status.AUTHFAIL)return Mc.settings.get("credentials_url")||Mc.settings.get("authentication")===Tc.ANONYMOUS?Mc.connection.reconnect():this.finishDisconnection();if(this.disconnection_cause===Tc.LOGOUT||e===hr.e.ErrorCondition.NO_AUTH_MECH||"host-unknown"===e||"remote-connection-failed"===e)return this.finishDisconnection();Mc.connection.reconnect()}}onConnectStatusChanged(e,t){const{__:n}=Tc;var r;if(kn.debug("Status changed to: ".concat(Tc.CONNECTION_STATUS[e])),e===hr.e.Status.ATTACHFAIL)this.setConnectionStatus(e),null===(r=this.worker_attach_promise)||void 0===r||r.resolve(!1);else if(e===hr.e.Status.CONNECTED||e===hr.e.Status.ATTACHED){var i,o;if((null===(i=this.worker_attach_promise)||void 0===i?void 0:i.isResolved)&&this.status===hr.e.Status.ATTACHED)return;this.setConnectionStatus(e),null===(o=this.worker_attach_promise)||void 0===o||o.resolve(!0),Tc.send_initial_presence=!0,this.setDisconnectionCause(),this.reconnecting?(kn.debug(e===hr.e.Status.CONNECTED?"Reconnected":"Reattached"),this.onConnected(!0)):(kn.debug(e===hr.e.Status.CONNECTED?"Connected":"Attached"),this.restored&&(Tc.send_initial_presence=!1),this.onConnected())}else if(e===hr.e.Status.DISCONNECTED)this.setDisconnectionCause(e,t),this.onDisconnected();else if(e===hr.e.Status.BINDREQUIRED)this.bind();else if(e===hr.e.Status.ERROR)this.setConnectionStatus(e,n("An error occurred while connecting to the chat server."));else if(e===hr.e.Status.CONNECTING)this.setConnectionStatus(e);else if(e===hr.e.Status.AUTHENTICATING)this.setConnectionStatus(e);else if(e===hr.e.Status.AUTHFAIL)t||(t=n("Your XMPP address and/or password is incorrect. Please try again.")),this.setConnectionStatus(e,t),this.setDisconnectionCause(e,t,!0),this.onDisconnected();else if(e===hr.e.Status.CONNFAIL){var s;let r=t;"host-unknown"===t||"remote-connection-failed"==t?r=n("Sorry, we could not connect to the XMPP host with domain: %1$s",'"'.concat(hr.e.getDomainFromJid(this.jid),'"')):void 0!==t&&t===(null===hr.e||void 0===hr.e||null===(s=hr.e.ErrorCondition)||void 0===s?void 0:s.NO_AUTH_MECH)&&(r=n("The XMPP server did not offer a supported authentication mechanism")),this.setConnectionStatus(e,r),this.setDisconnectionCause(e,t)}else e===hr.e.Status.DISCONNECTING&&this.setDisconnectionCause(e,t)}isType(e){return"websocket"===e.toLowerCase()?this._proto instanceof hr.e.Websocket:"bosh"===e.toLowerCase()?hr.e.Bosh&&this._proto instanceof hr.e.Bosh:void 0}hasResumed(){var e;return(null===(e=Mc.settings.get("connection_options"))||void 0===e?void 0:e.worker)||this.isType("bosh")?Tc.connfeedback.get("connection_status")===hr.e.Status.ATTACHED:!this.do_bind}restoreWorkerSession(){return this.attach(this.onConnectStatusChanged),this.worker_attach_promise=qo.getResolveablePromise(),this.worker_attach_promise}}class ca extends aa{constructor(e,t){super(e,t),this.sent_stanzas=[],this.IQ_stanzas=[],this.IQ_ids=[],this.features=hr.e.xmlHtmlNode('<stream:features xmlns:stream="http://etherx.jabber.org/streams" xmlns="jabber:client"><ver xmlns="urn:xmpp:features:rosterver"/><csi xmlns="urn:xmpp:csi:0"/><this xmlns="http://jabber.org/protocol/caps" ver="UwBpfJpEt3IoLYfWma/o/p3FFRo=" hash="sha-1" node="http://prosody.im"/><bind xmlns="urn:ietf:params:xml:ns:xmpp-bind"><required/></bind><sm xmlns=\'urn:xmpp:sm:3\'/><session xmlns="urn:ietf:params:xml:ns:xmpp-session"><optional/></session></stream:features>').firstChild,this._proto._processRequest=()=>{},this._proto._disconnect=()=>this._onDisconnectTimeout(),this._proto._onDisconnectTimeout=()=>{},this._proto._connect=()=>{this.connected=!0,this.mock=!0,this.jid="romeo@montague.lit/orchard",this._changeConnectStatus(hr.e.Status.BINDREQUIRED)}}_processRequest(){}sendIQ(e,t,n){Object(sa.isElement)(e)||(e=e.nodeTree),this.IQ_stanzas.push(e);const r=super.sendIQ(e,t,n);return this.IQ_ids.push(r),r}send(e){return Object(sa.isElement)(e)?this.sent_stanzas.push(e):this.sent_stanzas.push(e.nodeTree),super.send(e)}async bind(){await Mc.trigger("beforeResourceBinding",{synchronous:!0}),this.authenticated=!0,Tc.no_connection_on_bind||this._changeConnectStatus(hr.e.Status.CONNECTED)}}
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const ua="undefined"!=typeof window&&null!=window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,da=(e,t,n=null)=>{for(;t!==n;){const n=t.nextSibling;e.removeChild(t),t=n}},la=`{{lit-${String(Math.random()).slice(2)}}}`,fa=`\x3c!--${la}--\x3e`,ha=new RegExp(`${la}|${fa}`);class pa{constructor(e,t){this.parts=[],this.element=t;const n=[],r=[],i=document.createTreeWalker(t.content,133,null,!1);let o=0,s=-1,a=0;const{strings:c,values:{length:u}}=e;for(;a<u;){const e=i.nextNode();if(null!==e){if(s++,1===e.nodeType){if(e.hasAttributes()){const t=e.attributes,{length:n}=t;let r=0;for(let e=0;e<n;e++)ga(t[e].name,"$lit$")&&r++;for(;r-- >0;){const t=c[a],n=_a.exec(t)[2],r=n.toLowerCase()+"$lit$",i=e.getAttribute(r);e.removeAttribute(r);const o=i.split(ha);this.parts.push({type:"attribute",index:s,name:n,strings:o}),a+=o.length-1}}"TEMPLATE"===e.tagName&&(r.push(e),i.currentNode=e.content)}else if(3===e.nodeType){const t=e.data;if(t.indexOf(la)>=0){const r=e.parentNode,i=t.split(ha),o=i.length-1;for(let t=0;t<o;t++){let n,o=i[t];if(""===o)n=va();else{const e=_a.exec(o);null!==e&&ga(e[2],"$lit$")&&(o=o.slice(0,e.index)+e[1]+e[2].slice(0,-"$lit$".length)+e[3]),n=document.createTextNode(o)}r.insertBefore(n,e),this.parts.push({type:"node",index:++s})}""===i[o]?(r.insertBefore(va(),e),n.push(e)):e.data=i[o],a+=o}}else if(8===e.nodeType)if(e.data===la){const t=e.parentNode;null!==e.previousSibling&&s!==o||(s++,t.insertBefore(va(),e)),o=s,this.parts.push({type:"node",index:s}),null===e.nextSibling?e.data="":(n.push(e),s--),a++}else{let t=-1;for(;-1!==(t=e.data.indexOf(la,t+1));)this.parts.push({type:"node",index:-1}),a++}}else i.currentNode=r.pop()}for(const e of n)e.parentNode.removeChild(e)}}const ga=(e,t)=>{const n=e.length-t.length;return n>=0&&e.slice(n)===t},ma=e=>-1!==e.index,va=()=>document.createComment(""),_a=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;function ya(e,t){const{element:{content:n},parts:r}=e,i=document.createTreeWalker(n,133,null,!1);let o=wa(r),s=r[o],a=-1,c=0;const u=[];let d=null;for(;i.nextNode();){a++;const e=i.currentNode;for(e.previousSibling===d&&(d=null),t.has(e)&&(u.push(e),null===d&&(d=e)),null!==d&&c++;void 0!==s&&s.index===a;)s.index=null!==d?-1:s.index-c,o=wa(r,o),s=r[o]}u.forEach(e=>e.parentNode.removeChild(e))}const ba=e=>{let t=11===e.nodeType?0:1;const n=document.createTreeWalker(e,133,null,!1);for(;n.nextNode();)t++;return t},wa=(e,t=-1)=>{for(let n=t+1;n<e.length;n++){const t=e[n];if(ma(t))return n}return-1};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const Sa=new WeakMap,xa=e=>"function"==typeof e&&Sa.has(e),Ea={},Aa={};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
class Na{constructor(e,t,n){this.__parts=[],this.template=e,this.processor=t,this.options=n}update(e){let t=0;for(const n of this.__parts)void 0!==n&&n.setValue(e[t]),t++;for(const e of this.__parts)void 0!==e&&e.commit()}_clone(){const e=ua?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),t=[],n=this.template.parts,r=document.createTreeWalker(e,133,null,!1);let i,o=0,s=0,a=r.nextNode();for(;o<n.length;)if(i=n[o],ma(i)){for(;s<i.index;)s++,"TEMPLATE"===a.nodeName&&(t.push(a),r.currentNode=a.content),null===(a=r.nextNode())&&(r.currentNode=t.pop(),a=r.nextNode());if("node"===i.type){const e=this.processor.handleTextExpression(this.options);e.insertAfterNode(a.previousSibling),this.__parts.push(e)}else this.__parts.push(...this.processor.handleAttributeExpressions(a,i.name,i.strings,this.options));o++}else this.__parts.push(void 0),o++;return ua&&(document.adoptNode(e),customElements.upgrade(e)),e}}
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const Oa=` ${la} `;class ja{constructor(e,t,n,r){this.strings=e,this.values=t,this.type=n,this.processor=r}getHTML(){const e=this.strings.length-1;let t="",n=!1;for(let r=0;r<e;r++){const e=this.strings[r],i=e.lastIndexOf("\x3c!--");n=(i>-1||n)&&-1===e.indexOf("--\x3e",i+1);const o=_a.exec(e);t+=null===o?e+(n?Oa:fa):e.substr(0,o.index)+o[1]+o[2]+"$lit$"+o[3]+la}return t+=this.strings[e],t}getTemplateElement(){const e=document.createElement("template");return e.innerHTML=this.getHTML(),e}}
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const Ta=e=>null===e||!("object"==typeof e||"function"==typeof e),Ca=e=>Array.isArray(e)||!(!e||!e[Symbol.iterator]);class Ia{constructor(e,t,n){this.dirty=!0,this.element=e,this.name=t,this.strings=n,this.parts=[];for(let e=0;e<n.length-1;e++)this.parts[e]=this._createPart()}_createPart(){return new Ra(this)}_getValue(){const e=this.strings,t=e.length-1;let n="";for(let r=0;r<t;r++){n+=e[r];const t=this.parts[r];if(void 0!==t){const e=t.value;if(Ta(e)||!Ca(e))n+="string"==typeof e?e:String(e);else for(const t of e)n+="string"==typeof t?t:String(t)}}return n+=e[t],n}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class Ra{constructor(e){this.value=void 0,this.committer=e}setValue(e){e===Ea||Ta(e)&&e===this.value||(this.value=e,xa(e)||(this.committer.dirty=!0))}commit(){for(;xa(this.value);){const e=this.value;this.value=Ea,e(this)}this.value!==Ea&&this.committer.commit()}}class Ma{constructor(e){this.value=void 0,this.__pendingValue=void 0,this.options=e}appendInto(e){this.startNode=e.appendChild(va()),this.endNode=e.appendChild(va())}insertAfterNode(e){this.startNode=e,this.endNode=e.nextSibling}appendIntoPart(e){e.__insert(this.startNode=va()),e.__insert(this.endNode=va())}insertAfterPart(e){e.__insert(this.startNode=va()),this.endNode=e.endNode,e.endNode=this.startNode}setValue(e){this.__pendingValue=e}commit(){if(null===this.startNode.parentNode)return;for(;xa(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=Ea,e(this)}const e=this.__pendingValue;e!==Ea&&(Ta(e)?e!==this.value&&this.__commitText(e):e instanceof ja?this.__commitTemplateResult(e):e instanceof Node?this.__commitNode(e):Ca(e)?this.__commitIterable(e):e===Aa?(this.value=Aa,this.clear()):this.__commitText(e))}__insert(e){this.endNode.parentNode.insertBefore(e,this.endNode)}__commitNode(e){this.value!==e&&(this.clear(),this.__insert(e),this.value=e)}__commitText(e){const t=this.startNode.nextSibling,n="string"==typeof(e=null==e?"":e)?e:String(e);t===this.endNode.previousSibling&&3===t.nodeType?t.data=n:this.__commitNode(document.createTextNode(n)),this.value=e}__commitTemplateResult(e){const t=this.options.templateFactory(e);if(this.value instanceof Na&&this.value.template===t)this.value.update(e.values);else{const n=new Na(t,e.processor,this.options),r=n._clone();n.update(e.values),this.__commitNode(r),this.value=n}}__commitIterable(e){Array.isArray(this.value)||(this.value=[],this.clear());const t=this.value;let n,r=0;for(const i of e)n=t[r],void 0===n&&(n=new Ma(this.options),t.push(n),0===r?n.appendIntoPart(this):n.insertAfterPart(t[r-1])),n.setValue(i),n.commit(),r++;r<t.length&&(t.length=r,this.clear(n&&n.endNode))}clear(e=this.startNode){da(this.startNode.parentNode,e.nextSibling,this.endNode)}}class ka{constructor(e,t,n){if(this.value=void 0,this.__pendingValue=void 0,2!==n.length||""!==n[0]||""!==n[1])throw new Error("Boolean attributes can only contain a single expression");this.element=e,this.name=t,this.strings=n}setValue(e){this.__pendingValue=e}commit(){for(;xa(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=Ea,e(this)}if(this.__pendingValue===Ea)return;const e=!!this.__pendingValue;this.value!==e&&(e?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=e),this.__pendingValue=Ea}}class Da extends Ia{constructor(e,t,n){super(e,t,n),this.single=2===n.length&&""===n[0]&&""===n[1]}_createPart(){return new Pa(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class Pa extends Ra{}let La=!1;(()=>{try{const e={get capture(){return La=!0,!1}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){}})();class Fa{constructor(e,t,n){this.value=void 0,this.__pendingValue=void 0,this.element=e,this.eventName=t,this.eventContext=n,this.__boundHandleEvent=e=>this.handleEvent(e)}setValue(e){this.__pendingValue=e}commit(){for(;xa(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=Ea,e(this)}if(this.__pendingValue===Ea)return;const e=this.__pendingValue,t=this.value,n=null==e||null!=t&&(e.capture!==t.capture||e.once!==t.once||e.passive!==t.passive),r=null!=e&&(null==t||n);n&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),r&&(this.__options=Ua(e),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=e,this.__pendingValue=Ea}handleEvent(e){"function"==typeof this.value?this.value.call(this.eventContext||this.element,e):this.value.handleEvent(e)}}const Ua=e=>e&&(La?{capture:e.capture,passive:e.passive,once:e.once}:e.capture)
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */;function za(e){let t=Ba.get(e.type);void 0===t&&(t={stringsArray:new WeakMap,keyString:new Map},Ba.set(e.type,t));let n=t.stringsArray.get(e.strings);if(void 0!==n)return n;const r=e.strings.join(la);return n=t.keyString.get(r),void 0===n&&(n=new pa(e,e.getTemplateElement()),t.keyString.set(r,n)),t.stringsArray.set(e.strings,n),n}const Ba=new Map,Ha=new WeakMap;
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const qa=new
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
class{handleAttributeExpressions(e,t,n,r){const i=t[0];if("."===i){return new Da(e,t.slice(1),n).parts}return"@"===i?[new Fa(e,t.slice(1),r.eventContext)]:"?"===i?[new ka(e,t.slice(1),n)]:new Ia(e,t,n).parts}handleTextExpression(e){return new Ma(e)}};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.2.1");const $a=(e,...t)=>new ja(e,t,"html",qa),Wa=(e,t)=>`${e}--${t}`;let Ja=!0;void 0===window.ShadyCSS?Ja=!1:void 0===window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1."),Ja=!1);const Va=e=>t=>{const n=Wa(t.type,e);let r=Ba.get(n);void 0===r&&(r={stringsArray:new WeakMap,keyString:new Map},Ba.set(n,r));let i=r.stringsArray.get(t.strings);if(void 0!==i)return i;const o=t.strings.join(la);if(i=r.keyString.get(o),void 0===i){const n=t.getTemplateElement();Ja&&window.ShadyCSS.prepareTemplateDom(n,e),i=new pa(t,n),r.keyString.set(o,i)}return r.stringsArray.set(t.strings,i),i},Ga=["html","svg"],Ya=new Set,Xa=(e,t,n)=>{Ya.add(e);const r=n?n.element:document.createElement("template"),i=t.querySelectorAll("style"),{length:o}=i;if(0===o)return void window.ShadyCSS.prepareTemplateStyles(r,e);const s=document.createElement("style");for(let e=0;e<o;e++){const t=i[e];t.parentNode.removeChild(t),s.textContent+=t.textContent}(e=>{Ga.forEach(t=>{const n=Ba.get(Wa(t,e));void 0!==n&&n.keyString.forEach(e=>{const{element:{content:t}}=e,n=new Set;Array.from(t.querySelectorAll("style")).forEach(e=>{n.add(e)}),ya(e,n)})})})(e);const a=r.content;n?function(e,t,n=null){const{element:{content:r},parts:i}=e;if(null==n)return void r.appendChild(t);const o=document.createTreeWalker(r,133,null,!1);let s=wa(i),a=0,c=-1;for(;o.nextNode();){for(c++,o.currentNode===n&&(a=ba(t),n.parentNode.insertBefore(t,n));-1!==s&&i[s].index===c;){if(a>0){for(;-1!==s;)i[s].index+=a,s=wa(i,s);return}s=wa(i,s)}}}(n,s,a.firstChild):a.insertBefore(s,a.firstChild),window.ShadyCSS.prepareTemplateStyles(r,e);const c=a.querySelector("style");if(window.ShadyCSS.nativeShadow&&null!==c)t.insertBefore(c.cloneNode(!0),t.firstChild);else if(n){a.insertBefore(s,a.firstChild);const e=new Set;e.add(s),ya(n,e)}};window.JSCompiler_renameProperty=(e,t)=>e;const Qa={toAttribute(e,t){switch(t){case Boolean:return e?"":null;case Object:case Array:return null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){switch(t){case Boolean:return null!==e;case Number:return null===e?null:Number(e);case Object:case Array:return JSON.parse(e)}return e}},Ka=(e,t)=>t!==e&&(t==t||e==e),Za={attribute:!0,type:String,converter:Qa,reflect:!1,hasChanged:Ka};class ec extends HTMLElement{constructor(){super(),this._updateState=0,this._instanceProperties=void 0,this._updatePromise=new Promise(e=>this._enableUpdatingResolver=e),this._changedProperties=new Map,this._reflectingProperties=void 0,this.initialize()}static get observedAttributes(){this.finalize();const e=[];return this._classProperties.forEach((t,n)=>{const r=this._attributeNameForProperty(n,t);void 0!==r&&(this._attributeToPropertyMap.set(r,n),e.push(r))}),e}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const e=Object.getPrototypeOf(this)._classProperties;void 0!==e&&e.forEach((e,t)=>this._classProperties.set(t,e))}}static createProperty(e,t=Za){if(this._ensureClassProperties(),this._classProperties.set(e,t),t.noAccessor||this.prototype.hasOwnProperty(e))return;const n="symbol"==typeof e?Symbol():"__"+e,r=this.getPropertyDescriptor(e,n,t);void 0!==r&&Object.defineProperty(this.prototype,e,r)}static getPropertyDescriptor(e,t,n){return{get(){return this[t]},set(n){const r=this[e];this[t]=n,this._requestUpdate(e,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this._classProperties&&this._classProperties.get(e)||Za}static finalize(){const e=Object.getPrototypeOf(this);if(e.hasOwnProperty("finalized")||e.finalize(),this.finalized=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const e=this.properties,t=[...Object.getOwnPropertyNames(e),..."function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e):[]];for(const n of t)this.createProperty(n,e[n])}}static _attributeNameForProperty(e,t){const n=t.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof e?e.toLowerCase():void 0}static _valueHasChanged(e,t,n=Ka){return n(e,t)}static _propertyValueFromAttribute(e,t){const n=t.type,r=t.converter||Qa,i="function"==typeof r?r:r.fromAttribute;return i?i(e,n):e}static _propertyValueToAttribute(e,t){if(void 0===t.reflect)return;const n=t.type,r=t.converter;return(r&&r.toAttribute||Qa.toAttribute)(e,n)}initialize(){this._saveInstanceProperties(),this._requestUpdate()}_saveInstanceProperties(){this.constructor._classProperties.forEach((e,t)=>{if(this.hasOwnProperty(t)){const e=this[t];delete this[t],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(t,e)}})}_applyInstanceProperties(){this._instanceProperties.forEach((e,t)=>this[t]=e),this._instanceProperties=void 0}connectedCallback(){this.enableUpdating()}enableUpdating(){void 0!==this._enableUpdatingResolver&&(this._enableUpdatingResolver(),this._enableUpdatingResolver=void 0)}disconnectedCallback(){}attributeChangedCallback(e,t,n){t!==n&&this._attributeToProperty(e,n)}_propertyToAttribute(e,t,n=Za){const r=this.constructor,i=r._attributeNameForProperty(e,n);if(void 0!==i){const e=r._propertyValueToAttribute(t,n);if(void 0===e)return;this._updateState=8|this._updateState,null==e?this.removeAttribute(i):this.setAttribute(i,e),this._updateState=-9&this._updateState}}_attributeToProperty(e,t){if(8&this._updateState)return;const n=this.constructor,r=n._attributeToPropertyMap.get(e);if(void 0!==r){const e=n.getPropertyOptions(r);this._updateState=16|this._updateState,this[r]=n._propertyValueFromAttribute(t,e),this._updateState=-17&this._updateState}}_requestUpdate(e,t){let n=!0;if(void 0!==e){const r=this.constructor,i=r.getPropertyOptions(e);r._valueHasChanged(this[e],t,i.hasChanged)?(this._changedProperties.has(e)||this._changedProperties.set(e,t),!0!==i.reflect||16&this._updateState||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(e,i))):n=!1}!this._hasRequestedUpdate&&n&&(this._updatePromise=this._enqueueUpdate())}requestUpdate(e,t){return this._requestUpdate(e,t),this.updateComplete}async _enqueueUpdate(){this._updateState=4|this._updateState;try{await this._updatePromise}catch(e){}const e=this.performUpdate();return null!=e&&await e,!this._hasRequestedUpdate}get _hasRequestedUpdate(){return 4&this._updateState}get hasUpdated(){return 1&this._updateState}performUpdate(){this._instanceProperties&&this._applyInstanceProperties();let e=!1;const t=this._changedProperties;try{e=this.shouldUpdate(t),e?this.update(t):this._markUpdated()}catch(t){throw e=!1,this._markUpdated(),t}e&&(1&this._updateState||(this._updateState=1|this._updateState,this.firstUpdated(t)),this.updated(t))}_markUpdated(){this._changedProperties=new Map,this._updateState=-5&this._updateState}get updateComplete(){return this._getUpdateComplete()}_getUpdateComplete(){return this._updatePromise}shouldUpdate(e){return!0}update(e){void 0!==this._reflectingProperties&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach((e,t)=>this._propertyToAttribute(t,this[t],e)),this._reflectingProperties=void 0),this._markUpdated()}updated(e){}firstUpdated(e){}}ec.finalized=!0;
/**
@license
Copyright (c) 2019 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
const tc="adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype;Symbol();
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
(window.litElementVersions||(window.litElementVersions=[])).push("2.3.1");const nc={};class rc extends ec{static getStyles(){return this.styles}static _getUniqueStyles(){if(this.hasOwnProperty(JSCompiler_renameProperty("_styles",this)))return;const e=this.getStyles();if(void 0===e)this._styles=[];else if(Array.isArray(e)){const t=(e,n)=>e.reduceRight((e,n)=>Array.isArray(n)?t(n,e):(e.add(n),e),n),n=t(e,new Set),r=[];n.forEach(e=>r.unshift(e)),this._styles=r}else this._styles=[e]}initialize(){super.initialize(),this.constructor._getUniqueStyles(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow({mode:"open"})}adoptStyles(){const e=this.constructor._styles;0!==e.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?tc?this.renderRoot.adoptedStyleSheets=e.map(e=>e.styleSheet):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(e.map(e=>e.cssText),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}update(e){const t=this.render();super.update(e),t!==nc&&this.constructor.render(t,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach(e=>{const t=document.createElement("style");t.textContent=e.cssText,this.renderRoot.appendChild(t)}))}render(){return nc}}rc.finalized=!0,rc.render=(e,t,n)=>{if(!n||"object"!=typeof n||!n.scopeName)throw new Error("The `scopeName` option is required.");const r=n.scopeName,i=Ha.has(t),o=Ja&&11===t.nodeType&&!!t.host,s=o&&!Ya.has(r),a=s?document.createDocumentFragment():t;if(((e,t,n)=>{let r=Ha.get(t);void 0===r&&(da(t,t.firstChild),Ha.set(t,r=new Ma(Object.assign({templateFactory:za},n))),r.appendInto(t)),r.setValue(e),r.commit()})(e,a,Object.assign({templateFactory:Va(r)},n)),s){const e=Ha.get(a);Ha.delete(a);const n=e.value instanceof Na?e.value.template:void 0;Xa(r,a,n),da(t,t.firstChild),t.appendChild(a),Ha.set(t,e)}!i&&o&&window.ShadyCSS.styleElement(t.host)};const ic=function(){this.handlers=[],this.checkUrl=this.checkUrl.bind(this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)};ic.extend=Vr;const oc=/^[#\/]|\s+$/g,sc=/^\/+|\/+$/g,ac=/#.*$/;ic.started=!1,Object.assign(ic.prototype,pi,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(e){return decodeURI(e.replace(/%25/g,"%2525"))},getSearch:function(){const e=this.location.href.replace(/#.*/,"").match(/\?.+/);return e?e[0]:""},getHash:function(e){const t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){const e=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===e.charAt(0)?e.slice(1):e},getFragment:function(e){return null==e&&(e=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),e.replace(oc,"")},start:function(e){if(ic.started)throw new Error("history has already been started");if(ic.started=!0,this.options=Ar({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(sc,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){const e=this.root.slice(0,-1)||"/";return this.location.replace(e+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;const e=document.body,t=e.insertBefore(this.iframe,e.firstChild).contentWindow;t.document.open(),t.document.close(),t.location.hash="#"+this.fragment}if(this._usePushState?addEventListener("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?addEventListener("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){this._usePushState?removeEventListener("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&removeEventListener("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),ic.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){let t=this.getFragment();if(t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe.contentWindow)),t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return!!this.matchRoot()&&(e=this.fragment=this.getFragment(e),qs(this.handlers,(function(t){if(t.route.test(e))return t.callback(e),!0})))},navigate:function(e,t){if(!ic.started)return!1;t&&!0!==t||(t={trigger:!!t}),e=this.getFragment(e||"");let n=this.root;""!==e&&"?"!==e.charAt(0)||(n=n.slice(0,-1)||"/");const r=n+e;e=e.replace(ac,"");const i=this.decodeFragment(e);if(this.fragment!==i){if(this.fragment=i,this._usePushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,r);else{if(!this._wantsHashChange)return this.location.assign(r);if(this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getHash(this.iframe.contentWindow)){const n=this.iframe.contentWindow;t.replace||(n.document.open(),n.document.close()),this._updateHash(n.location,e,t.replace)}}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,n){if(n){const n=e.href.replace(/(javascript:|#).*$/,"");e.replace(n+"#"+t)}else e.hash="#"+t}});var cc=ic;var uc=function(e){return Se(e)&&"[object RegExp]"==j(e)},dc=Pe.a&&Pe.a.isRegExp,lc=dc?De(dc):uc;const fc=function(e={}){this.history=e.history||new cc,this.preinitialize.apply(this,arguments),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)};fc.extend=Vr;const hc=/\((.*?)\)/g,pc=/(\(\?)?:\w+/g,gc=/\*\w+/g,mc=/[\-{}\[\]+?.,\\\^$|#\s]/g;Object.assign(fc.prototype,pi,{preinitialize:function(){},initialize:function(){},route:function(e,t,n){return lc(e)||(e=this._routeToRegExp(e)),I(t)&&(n=t,t=""),n||(n=this[t]),this.history.route(e,r=>{const i=this._extractParameters(e,r);!1!==this.execute(n,i,t)&&(this.trigger.apply(this,["route:"+t].concat(i)),this.trigger("route",t,i),this.history.trigger("route",this,t,i))}),this},execute:function(e,t,n){e&&e.apply(this,t)},navigate:function(e,t){return this.history.navigate(e,t),this},_bindRoutes:function(){if(!this.routes)return;let e;this.routes=Jr(this,"routes");const t=Ge(this.routes);for(;null!=(e=t.pop());)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(mc,"\\$&").replace(hc,"(?:$1)?").replace(pc,(function(e,t){return t?e:"([^/?]+)"})).replace(gc,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){const n=e.exec(t).slice(1);return n.map((function(e,t){return t===n.length-1?e||null:e?decodeURIComponent(e):null}))}});var vc=n(1),_c=function(){return _.a.Date.now()},yc=Math.max,bc=Math.min;var wc=function(e,t,n){var r,i,o,s,a,c,u=0,d=!1,l=!1,f=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function h(t){var n=r,o=i;return r=i=void 0,u=t,s=e.apply(o,n)}function p(e){return u=e,a=setTimeout(m,t),d?h(e):s}function g(e){var n=e-c;return void 0===c||n>=t||n<0||l&&e-u>=o}function m(){var e=_c();if(g(e))return v(e);a=setTimeout(m,function(e){var n=t-(e-c);return l?bc(n,o-(e-u)):n}(e))}function v(e){return a=void 0,f&&r?h(e):(r=i=void 0,s)}function _(){var e=_c(),n=g(e);if(r=arguments,i=this,c=e,n){if(void 0===a)return p(c);if(l)return clearTimeout(a),a=setTimeout(m,t),h(c)}return void 0===a&&(a=setTimeout(m,t)),s}return t=ai(t)||0,T(n)&&(d=!!n.leading,o=(l="maxWait"in n)?yc(ai(n.maxWait)||0,t):o,f="trailing"in n?!!n.trailing:f),_.cancel=function(){void 0!==a&&clearTimeout(a),u=0,r=c=i=a=void 0},_.flush=function(){return void 0===a?s:v(_c())},_};var Sc=xr((function(e,t,n){t=Hr(t,e);var r=null==(e=xo(e,t))?e:e[qr(wo(t))];return null==r?void 0:mr(r,e,n)})),xc=n(82);
/**
 * @module converse-core
 * @copyright The Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 */
bn.a.extend(_n.a),vc.e.addNamespace("CARBONS","urn:xmpp:carbons:2"),vc.e.addNamespace("CHATSTATES","http://jabber.org/protocol/chatstates"),vc.e.addNamespace("CSI","urn:xmpp:csi:0"),vc.e.addNamespace("DELAY","urn:xmpp:delay"),vc.e.addNamespace("FASTEN","urn:xmpp:fasten:0"),vc.e.addNamespace("FORWARD","urn:xmpp:forward:0"),vc.e.addNamespace("HINTS","urn:xmpp:hints"),vc.e.addNamespace("HTTPUPLOAD","urn:xmpp:http:upload:0"),vc.e.addNamespace("IDLE","urn:xmpp:idle:1"),vc.e.addNamespace("MAM","urn:xmpp:mam:2"),vc.e.addNamespace("MODERATE","urn:xmpp:message-moderate:0"),vc.e.addNamespace("NICK","http://jabber.org/protocol/nick"),vc.e.addNamespace("OMEMO","eu.siacs.conversations.axolotl"),vc.e.addNamespace("OUTOFBAND","jabber:x:oob"),vc.e.addNamespace("PUBSUB","http://jabber.org/protocol/pubsub"),vc.e.addNamespace("REGISTER","jabber:iq:register"),vc.e.addNamespace("RETRACT","urn:xmpp:message-retract:0"),vc.e.addNamespace("ROSTERX","http://jabber.org/protocol/rosterx"),vc.e.addNamespace("RSM","http://jabber.org/protocol/rsm"),vc.e.addNamespace("SID","urn:xmpp:sid:0"),vc.e.addNamespace("SPOILER","urn:xmpp:spoiler:0"),vc.e.addNamespace("STANZAS","urn:ietf:params:xml:ns:xmpp-stanzas"),vc.e.addNamespace("VCARD","vcard-temp"),vc.e.addNamespace("VCARDUPDATE","vcard-temp:x:update"),vc.e.addNamespace("XFORM","jabber:x:data");class Ec extends Error{}const Ac=["converse-adhoc","converse-bookmarks","converse-bosh","converse-caps","converse-carbons","converse-chat","converse-chatboxes","converse-disco","converse-emoji","converse-headlines","converse-mam","converse-muc","converse-ping","converse-pubsub","converse-roster","converse-smacks","converse-status","converse-vcard"],Nc={allow_non_roster_messaging:!1,assets_path:"/dist",authentication:"login",auto_login:!1,auto_reconnect:!0,blacklisted_plugins:[],clear_cache_on_logout:!1,connection_options:{},credentials_url:null,discover_connection_methods:!0,geouri_regex:/https\:\/\/www.openstreetmap.org\/.*#map=[0-9]+\/([\-0-9.]+)\/([\-0-9.]+)\S*/g,geouri_replacement:"https://www.openstreetmap.org/?mlat=$1&mlon=$2#map=18/$1/$2",i18n:"en",idle_presence_timeout:300,jid:void 0,keepalive:!0,loglevel:"info",locales:["af","ar","bg","ca","cs","de","eo","es","eu","en","fi","fr","gl","he","hi","hu","id","it","ja","nb","nl","mr","oc","pl","pt","pt_BR","ro","ru","tr","uk","vi","zh_CN","zh_TW"],nickname:void 0,password:void 0,persistent_store:"localStorage",rid:void 0,root:window.document,sid:void 0,singleton:!1,strict_plugin_dependencies:!1,view_mode:"overlayed",websocket_url:void 0,whitelisted_plugins:[]},Oc={};Oc[vc.e.Status.ATTACHED]="ATTACHED",Oc[vc.e.Status.AUTHENTICATING]="AUTHENTICATING",Oc[vc.e.Status.AUTHFAIL]="AUTHFAIL",Oc[vc.e.Status.CONNECTED]="CONNECTED",Oc[vc.e.Status.CONNECTING]="CONNECTING",Oc[vc.e.Status.CONNFAIL]="CONNFAIL",Oc[vc.e.Status.DISCONNECTED]="DISCONNECTED",Oc[vc.e.Status.DISCONNECTING]="DISCONNECTING",Oc[vc.e.Status.ERROR]="ERROR",Oc[vc.e.Status.RECONNECTING]="RECONNECTING",Oc[vc.e.Status.REDIRECT]="REDIRECT";const jc={initialize(){},__:(...e)=>Object(xc.sprintf)(...e)},Tc={log:kn,CONNECTION_STATUS:Oc,templates:{},promises:{initialized:qo.getResolveablePromise()},STATUS_WEIGHTS:{offline:6,unavailable:5,xa:4,away:3,dnd:2,chat:1,online:1},ANONYMOUS:"anonymous",CLOSED:"closed",EXTERNAL:"external",LOGIN:"login",LOGOUT:"logout",OPENED:"opened",PREBIND:"prebind",STANZA_TIMEOUT:1e4,SUCCESS:"success",FAILURE:"failure",DEFAULT_IMAGE_TYPE:"image/svg+xml",DEFAULT_IMAGE:"PD94bWwgdmVyc2lvbj0iMS4wIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCI+CiA8cmVjdCB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgZmlsbD0iIzU1NSIvPgogPGNpcmNsZSBjeD0iNjQiIGN5PSI0MSIgcj0iMjQiIGZpbGw9IiNmZmYiLz4KIDxwYXRoIGQ9Im0yOC41IDExMiB2LTEyIGMwLTEyIDEwLTI0IDI0LTI0IGgyMyBjMTQgMCAyNCAxMiAyNCAyNCB2MTIiIGZpbGw9IiNmZmYiLz4KPC9zdmc+Cg==",TIMEOUTS:{PAUSED:1e4,INACTIVE:9e4},INACTIVE:"inactive",ACTIVE:"active",COMPOSING:"composing",PAUSED:"paused",GONE:"gone",PRIVATE_CHAT_TYPE:"chatbox",CHATROOMS_TYPE:"chatroom",HEADLINES_TYPE:"headline",CONTROLBOX_TYPE:"controlbox",default_connection_options:{explicitResourceBinding:!0},router:new fc,TimeoutError:Ec,isTestEnv:()=>"montague.lit/http-bind"===Ic.bosh_service_url,__:(...e)=>jc.__(...e),___:e=>e};let Cc;Tc.VERSION_NAME="v7.0.4",Object.assign(Tc,pi),sr.enable(Tc,"_converse","pluggable");let Ic={};function Rc(){var e;if(!Tc.bare_jid){const e="No JID to fetch user settings for";throw kn.error(e),Error(e)}if(!(null===(e=Cc)||void 0===e?void 0:e.fetched)){const e="converse.user-settings.".concat(Tc.bare_jid);Cc=new Po({id:e}),Cc.browserStorage=Dc(e),Cc.fetched=Cc.fetch({promise:!0})}return Cc.fetched}const Mc=Tc.api={connection:{connected(){var e;return(null==Tc||null===(e=Tc.connection)||void 0===e?void 0:e.connected)&&!0},disconnect(){Tc.connection&&Tc.connection.disconnect()},async reconnect(){const e=Tc.connfeedback.get("connection_status");if(Mc.settings.get("authentication")===Tc.ANONYMOUS&&(await Pc(),await Fc()),e===vc.e.Status.CONNFAIL?Mc.connection.isType("websocket")&&Mc.settings.get("bosh_service_url")?(await Tc.setUserJID(Tc.bare_jid),Tc.connection._proto._doDisconnect(),Tc.connection._proto=new vc.e.Bosh(Tc.connection),Tc.connection.service=Mc.settings.get("bosh_service_url")):Mc.connection.isType("bosh")&&Mc.settings.get("websocket_url")&&(Mc.settings.get("authentication")===Tc.ANONYMOUS?await Tc.setUserJID(Mc.settings.get("jid")):await Tc.setUserJID(Tc.bare_jid),Tc.connection._proto._doDisconnect(),Tc.connection._proto=new vc.e.Websocket(Tc.connection),Tc.connection.service=Mc.settings.get("websocket_url")):e===vc.e.Status.AUTHFAIL&&Mc.settings.get("authentication")===Tc.ANONYMOUS&&await Tc.setUserJID(Mc.settings.get("jid")),!Tc.connection.reconnecting)return Tc.connection.reconnect();Tc.connection.debouncedReconnect()},isType:e=>Tc.connection.isType(e)},async trigger(e){if(!Tc._events)return;const t=Array.from(arguments),n=t.pop();if(n&&n.synchronous){const n=Tc._events[e]||[];await Promise.all(n.map(e=>e.callback.apply(e.ctx,t.splice(1))))}else Tc.trigger.apply(Tc,arguments);const r=Tc.promises[e];void 0!==r&&r.resolve()},hook(e,t,n){const r=Tc._events[e]||[];if(r.length){const e=r.reduce((e,n)=>e.then(e=>n.callback(t,e)),Promise.resolve(n));return e.catch(e=>{throw kn.error(e),e}),e}return n},user:{jid:()=>Tc.connection.jid,async login(e,t,n=!1){var r,i;if(e=e||Tc.jid,(!(null===(r=Tc.connection)||void 0===r?void 0:r.jid)||e&&!qo.isSameDomain(Tc.connection.jid,e))&&await Tc.initConnection(),(null===(i=Mc.settings.get("connection_options"))||void 0===i?void 0:i.worker)&&await Tc.connection.restoreWorkerSession())return;e&&(e=await Tc.setUserJID(e));const o=Tc.pluggable.plugins["converse-bosh"];if(o&&o.enabled()){if(await Tc.restoreBOSHSession())return;if(Mc.settings.get("authentication")===Tc.PREBIND&&(!n||Mc.settings.get("auto_login")))return Tc.startNewPreboundBOSHSession()}t=t||Mc.settings.get("password"),async function(e,t){const{api:n}=Tc;n.settings.get("authentication")===Tc.LOGIN?e?Lc(e):Tc.api.settings.get("credentials_url")?Lc(await async function(){let e,t=0;for(;!e;){try{e=await Hc(t)}catch(e){kn.error("Could not fetch login credentials"),kn.error(e)}t=2e3}return e}()):Tc.jid&&(Tc.api.settings.get("password")||Tc.connection.pass)?Lc():!Tc.isTestEnv()&&"credentials"in navigator?Lc(await async function(){try{const e=await navigator.credentials.get({password:!0});if(e&&"password"==e.type&&qo.isValidJID(e.id))return await Tc.setUserJID(e.id),{jid:e.id,password:e.password}}catch(e){kn.error(e)}}()):!Tc.isTestEnv()&&kn.warn("attemptNonPreboundSession: Couldn't find credentials to log in with"):![Tc.ANONYMOUS,Tc.EXTERNAL].includes(Tc.api.settings.get("authentication"))||t&&!Tc.api.settings.get("auto_login")||Lc()}(e&&t?{jid:e,password:t}:null,n)},logout(){const e=qo.getResolveablePromise(),t=()=>{Object.keys(Tc.promises).forEach(kc),delete Tc.jid,Mc.trigger("logout"),e.resolve()};return Tc.connection.setDisconnectionCause(Tc.LOGOUT,void 0,!0),void 0!==Tc.connection?(Mc.listen.once("disconnected",()=>t()),Tc.connection.disconnect()):t(),e},settings:{getModel:async()=>(await Rc(),Cc),get:async(e,t)=>(await Rc(),void 0===Cc.get(e)?t:Cc.get(e)),async set(e,t){if(await Rc(),T(e))return Cc.save(e,{promise:!0});{const n={};return n[e]=t,Cc.save(n,{promise:!0})}},async clear(){await Rc(),Cc.clear()}}},settings:{extend(e){qo.merge(Nc,e);const t=Object.keys(Do(e,Object.keys(Nc))),n=Do(Ic,t),r=Ar(Do(e,t),n);qo.merge(Tc.settings,r),qo.merge(Tc,r)},update(e){return kn.warn("The api.settings.update method has been deprecated and will be removed. Please use api.settings.extend instead."),this.extend(e)},get(e){if(Object.keys(Nc).includes(e))return Tc[e]},set(e,t){const n={};T(e)?(Ar(Tc,Do(e,Object.keys(Nc))),Ar(Tc.settings,Do(e,Object.keys(Nc)))):"string"==typeof e&&(n[e]=t,Ar(Tc,Do(n,Object.keys(Nc))),Ar(Tc.settings,Do(n,Object.keys(Nc))))}},promises:{add(e,t=!0){(e=Array.isArray(e)?e:[e]).forEach(e=>{const n=qo.getResolveablePromise();n.replace=t,Tc.promises[e]=n})}},listen:{once:Tc.once.bind(Tc),on:Tc.on.bind(Tc),not:Tc.off.bind(Tc),stanza(e,t,n){I(t)?(n=t,t={}):t=t||{},Tc.connection.addHandler(n,t.ns,e,t.type,t.id,t.from,t)}},waitUntil(e){if(I(e))return qo.waitUntil(e);{const t=Tc.promises[e];return void 0===t?null:t}},send:e=>Mc.connection.connected()?("string"==typeof e&&(e=qo.toStanza(e)),"iq"===e.tagName?Mc.sendIQ(e):(Tc.connection.send(e),void Mc.trigger("send",e))):(kn.warn("Not sending stanza because we're not connected!"),void kn.warn(vc.e.serialize(e))),sendIQ(e,t=Tc.STANZA_TIMEOUT,n=!0){var r,i;let o;return e=null!==(r=null===(i=e)||void 0===i?void 0:i.nodeTree)&&void 0!==r?r:e,["get","set"].includes(e.getAttribute("type"))?(t=t||Tc.STANZA_TIMEOUT,n?(o=new Promise((n,r)=>Tc.connection.sendIQ(e,n,r,t)),o.catch(n=>{if(null===n)throw new Ec("Timeout error after ".concat(t,"ms for the following IQ stanza: ").concat(vc.e.serialize(e)))})):o=new Promise(n=>Tc.connection.sendIQ(e,n,n,t))):(Tc.connection.sendIQ(e),o=Promise.resolve()),Mc.trigger("send",e),o}};function kc(e){const t=Tc.promises[e];if(!t)throw new Error("Tried to replace non-existing promise: ".concat(e));if(t.replace){const n=qo.getResolveablePromise();n.replace=t.replace,Tc.promises[e]=n}else kn.debug('Not replacing promise "'.concat(e,'"'))}function Dc(e,t){const n=Tc.storage[t||Tc.getDefaultStore()];return new mn(e,n)}async function Pc(){return await Tc.api.trigger("beforeTearDown",{synchronous:!0}),window.removeEventListener("click",Tc.onUserActivity),window.removeEventListener("focus",Tc.onUserActivity),window.removeEventListener("keypress",Tc.onUserActivity),window.removeEventListener("mousemove",Tc.onUserActivity),window.removeEventListener(Tc.unloadevent,Tc.onUserActivity),window.clearInterval(Tc.everySecondTrigger),Tc.api.trigger("afterTearDown"),Tc}function Lc(e){if([Tc.ANONYMOUS,Tc.EXTERNAL].includes(Tc.api.settings.get("authentication"))){if(!Tc.jid)throw new Error("Config Error: when using anonymous login you need to provide the server's domain via the 'jid' option. Either when calling converse.initialize, or when calling _converse.api.user.login.");Tc.connection.reconnecting||Tc.connection.reset(),Tc.connection.connect(Tc.jid.toLowerCase())}else if(Tc.api.settings.get("authentication")===Tc.LOGIN){var t;const n=e?e.password:(null===(t=Tc.connection)||void 0===t?void 0:t.pass)||Tc.api.settings.get("password");if(!n){if(Tc.api.settings.get("auto_login"))throw new Error("autoLogin: If you use auto_login and authentication='login' then you also need to provide a password.");return Tc.connection.setDisconnectionCause(vc.e.Status.AUTHFAIL,void 0,!0),void Tc.api.connection.disconnect()}Tc.connection.reconnecting||Tc.connection.reset(),Tc.connection.connect(Tc.jid,n)}}function Fc(){var e;return null===(e=Tc.session)||void 0===e||e.destroy(),delete Tc.session,Tc.shouldClearCache()&&Tc.api.user.settings.clear(),Tc.api.trigger("clearSession",{synchronous:!0})}async function Uc(e){var t;const n=Mc.settings.get("connection_options").worker,r=vc.e.getBareJidFromJid(e).toLowerCase(),i="converse.session-".concat(r);(null===(t=Tc.session)||void 0===t?void 0:t.get("id"))!==i?(Tc.session=new Po({id:i}),Tc.session.browserStorage=Dc(i,n?"persistent":"session"),await new Promise(e=>Tc.session.fetch({success:e,error:e})),!n&&Tc.session.get("active")&&(Tc.session.clear(),Tc.session.save({id:i})),zc(e),function(){if("sessionStorage"===Mc.settings.get("persistent_store"))return;if("BrowserExtLocal"===Tc.api.settings.get("persistent_store"))return mn.localForage.defineDriver(dr.a).then(()=>mn.localForage.setDriver("webExtensionLocalStorage")),void(Tc.storage.persistent=mn.localForage);if("BrowserExtSync"===Tc.api.settings.get("persistent_store"))return mn.localForage.defineDriver(cr.a).then(()=>mn.localForage.setDriver("webExtensionSyncStorage")),void(Tc.storage.persistent=mn.localForage);const e={name:Tc.isTestEnv()?"converse-test-persistent":"converse-persistent",storeName:Tc.bare_jid};"localStorage"===Tc.api.settings.get("persistent_store")?(e.description="localStorage instance",e.driver=[mn.localForage.LOCALSTORAGE]):"IndexedDB"===Tc.api.settings.get("persistent_store")&&(e.description="indexedDB instance",e.driver=[mn.localForage.INDEXEDDB]),Tc.storage.persistent=mn.localForage.createInstance(e)}(),Tc.api.trigger("userSessionInitialized")):zc(e)}function zc(e){e=Tc.session.get("jid")||e,Tc.api.settings.get("authentication")===Tc.ANONYMOUS||vc.e.getResourceFromJid(e)||(e=e.toLowerCase()+aa.generateResource()),Tc.jid=e,Tc.bare_jid=vc.e.getBareJidFromJid(e),Tc.resource=vc.e.getResourceFromJid(e),Tc.domain=vc.e.getDomainFromJid(e),Tc.session.save({jid:e,bare_jid:Tc.bare_jid,resource:Tc.resource,domain:Tc.domain,active:!0}),Tc.connection.jid=e}async function Bc(){var e;await Mc.trigger("cleanup",{synchronous:!0}),Tc.router.history.stop(),document.removeEventListener("visibilitychange",Tc.saveWindowState),Mc.trigger("unregisteredGlobalEventHandlers"),null===(e=Tc.connection)||void 0===e||e.reset(),Tc.stopListening(),Tc.off(),Tc.promises.initialized.isResolved&&Mc.promises.add("initialized")}function Hc(e=0){return new Promise(wc((e,t)=>{const n=new XMLHttpRequest;n.open("GET",Mc.settings.get("credentials_url"),!0),n.setRequestHeader("Accept","application/json, text/javascript"),n.onload=()=>{if(n.status>=200&&n.status<400){const t=JSON.parse(n.responseText);Tc.setUserJID(t.jid).then(()=>{e({jid:t.jid,password:t.password})})}else t(new Error("".concat(n.status,": ").concat(n.responseText)))},n.onerror=t,n.send()},e))}Tc.isUniView=function(){return["mobile","fullscreen","embedded"].includes(Mc.settings.get("view_mode"))},Tc.getDefaultStore=function(){if(Tc.config.get("trusted")){return"sessionStorage"===Mc.settings.get("persistent_store")?"session":"persistent"}return"session"},Tc.createStore=Dc,Tc.shouldClearCache=()=>!Tc.config.get("trusted")||Mc.settings.get("clear_cache_on_logout")||Tc.isTestEnv(),Tc.initConnection=function(){const e=Tc.api;if(!e.settings.get("bosh_service_url")){if(e.settings.get("authentication")===Tc.PREBIND)throw new Error("authentication is set to 'prebind' but we don't have a BOSH connection");if(!e.settings.get("websocket_url"))throw new Error("initConnection: you must supply a value for either the bosh_service_url or websocket_url or both.")}const t=Tc.isTestEnv()?ca:aa;if(("WebSocket"in window||"MozWebSocket"in window)&&e.settings.get("websocket_url"))Tc.connection=new t(e.settings.get("websocket_url"),Object.assign(Tc.default_connection_options,e.settings.get("connection_options")));else{if(!e.settings.get("bosh_service_url"))throw new Error("initConnection: this browser does not support websockets and bosh_service_url wasn't specified.");Tc.connection=new t(e.settings.get("bosh_service_url"),Object.assign(Tc.default_connection_options,e.settings.get("connection_options"),{keepalive:e.settings.get("keepalive")}))}!function(){const e={};e[vc.e.LogLevel.DEBUG]="debug",e[vc.e.LogLevel.INFO]="info",e[vc.e.LogLevel.WARN]="warn",e[vc.e.LogLevel.ERROR]="error",e[vc.e.LogLevel.FATAL]="fatal",vc.e.log=(t,n)=>kn.log(n,e[t]),vc.e.error=e=>kn.error(e),Tc.connection.xmlInput=e=>kn.debug(e.outerHTML,"color: darkgoldenrod"),Tc.connection.xmlOutput=e=>kn.debug(e.outerHTML,"color: darkcyan")}(),e.trigger("connectionInitialized")},Tc.setUserJID=async function(e){return await Uc(e),Tc.api.trigger("setUserJID"),e},Tc.saveWindowState=function(e){let t;const n={focus:"visible",focusin:"visible",pageshow:"visible",blur:"hidden",focusout:"hidden",pagehide:"hidden"};t=(e=e||document.createEvent("Events")).type in n?n[e.type]:document.hidden?"hidden":"visible",Tc.windowState=t,Mc.trigger("windowStateChanged",{state:t})},Tc.ConnectionFeedback=Po.extend({defaults:{connection_status:vc.e.Status.DISCONNECTED,message:""},initialize(){this.on("change",()=>Mc.trigger("connfeedback",Tc.connfeedback))}});const qc=window.converse||{};Object.assign(qc,{CHAT_STATES:["active","composing","gone","inactive","paused"],keycodes:{TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESCAPE:27,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,FORWARD_SLASH:47,AT:50,META:91,META_RIGHT:93},async initialize(e){if(await Bc(),"onpagehide"in window?Tc.unloadevent="pagehide":"onbeforeunload"in window?Tc.unloadevent="beforeunload":"onunload"in window&&(Tc.unloadevent="unload"),function(e){Tc.settings={},Ic=e;const t=Do(e,Object.keys(Nc));Ar(Tc.settings,Nc,t),Ar(Tc,Nc,t)}(e),Tc.strict_plugin_dependencies=e.strict_plugin_dependencies,kn.setLogLevel(Mc.settings.get("loglevel")),Mc.settings.get("authentication")===Tc.ANONYMOUS&&Mc.settings.get("auto_login")&&!Mc.settings.get("jid"))throw new Error("Config Error: you need to provide the server's domain via the 'jid' option when using anonymous authentication with auto_login.");Tc.router.route(/^converse\?loglevel=(debug|info|warn|error|fatal)$/,"loglevel",e=>kn.setLogLevel(e)),Tc.connfeedback=new Tc.ConnectionFeedback,Tc.send_initial_presence=!0,await async function(){await mn.sessionStorageInitialized,Tc.storage={session:mn.localForage.createInstance({name:Tc.isTestEnv()?"converse-test-session":"converse-session",description:"sessionStorage instance",driver:["sessionStorageWrapper"]})}}(),await async function(){const e="converse.client-config";Tc.config=new Po({id:e,trusted:!0}),Tc.config.browserStorage=Dc(e,"session"),await new Promise(e=>Tc.config.fetch({success:e,error:e})),Tc.api.trigger("clientConfigInitialized")}(),await jc.initialize(),function(){Tc.pluggable.initialized_plugins=[];const e=Ac.concat(Tc.api.settings.get("whitelisted_plugins"));Tc.api.settings.get("singleton")&&["converse-bookmarks","converse-controlbox","converse-headline","converse-register"].forEach(e=>Tc.api.settings.get("blacklisted_plugins").push(e)),Tc.pluggable.initializePlugins({_converse:Tc},e,Tc.api.settings.get("blacklisted_plugins")),Tc.api.trigger("pluginsInitialized")}(),document.addEventListener("visibilitychange",Tc.saveWindowState),Tc.saveWindowState({type:document.hidden?"blur":"focus"}),Mc.trigger("registeredGlobalEventHandlers"),!History.started&&Tc.router.history.start(),Mc.settings.get("idle_presence_timeout")>0&&Mc.listen.on("addClientFeatures",()=>Mc.disco.own.features.add(vc.e.NS.IDLE));const t=Tc.pluggable.plugins;if((Mc.settings.get("auto_login")||Mc.settings.get("keepalive")&&Sc(t["converse-bosh"],"enabled"))&&await Mc.user.login(null,null,!0),Mc.trigger("initialized"),Tc.isTestEnv())return Tc},plugins:{add(e,t){if(t.__name__=e,void 0!==Tc.pluggable.plugins[e])throw new TypeError('Error: plugin with name "'.concat(e,'" has already been ')+"registered!");Tc.pluggable.plugins[e]=t}},env:{$build:vc.a,$iq:vc.b,$msg:vc.c,$pres:vc.d,utils:qo,Collection:Qs,CustomElement:class extends rc{constructor(){super(),Object.assign(this,pi)}createRenderRoot(){return this}disconnectedCallback(){super.disconnectedCallback(),this.stopListening()}},Model:Po,Promise:Promise,Strophe:vc.e,dayjs:bn.a,html:$a,log:kn,sizzle:fr.a,sprintf:xc.sprintf,stanza_utils:us,u:qo}});const $c=new CustomEvent("converse-loaded",{detail:{converse:qc}});window.dispatchEvent($c);const{Strophe:Wc}=qc.env;let Jc,Vc;Wc.addNamespace("ADHOC","http://jabber.org/protocol/commands");const Gc={adhoc:{async getCommands(e){let t=[];try{n=await Vc.disco.items(e,Wc.NS.ADHOC),t=fr()('query[xmlns="'.concat(Wc.NS.DISCO_ITEMS,'"][node="').concat(Wc.NS.ADHOC,'"] item'),n).map(us.getAttributes)}catch(t){null===t?kn.error("Error: timeout while fetching ad-hoc commands for ".concat(e)):(kn.error("Error while fetching ad-hoc commands for ".concat(e)),kn.error(t))}var n;return t}}};qc.plugins.add("converse-adhoc",{dependencies:["converse-disco"],initialize(){Jc=this._converse,Vc=Jc.api,Object.assign(Vc,Gc)}});var Yc=n(153),Xc=n.n(Yc);var Qc=function(e){return function(t,n,r){var i=Object(t);if(!Ve(t)){var o=yo(n,3);t=Ge(t),n=function(e){return o(i[e],e,i)}}var s=e(t,n,r);return s>-1?i[o?t[s]:s]:void 0}}(Ts);var Kc=function(e,t){return e===t||oo(e,t,ao(t))};
/**
 * @module converse-chat
 * @copyright 2020, the Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 */const{$msg:Zc,Strophe:eu,sizzle:tu,utils:nu}=qc.env,ru=qc.env.utils;qc.plugins.add("converse-chat",{dependencies:["converse-chatboxes","converse-disco"],initialize(){const{__:e}=Tc;Mc.settings.extend({allow_message_corrections:"all",allow_message_retraction:"all",auto_join_private_chats:[],clear_messages_on_reconnection:!1,filter_by_resource:!1,send_chat_state_notifications:!0});const t=Po.extend({initialize(){this.rosterContactAdded=ru.getResolveablePromise()},async setRosterContact(e){const t=await Mc.contacts.get(e);t&&(this.contact=t,this.set("nickname",t.get("nickname")),this.rosterContactAdded.resolve())}});Tc.Message=t.extend({defaults:()=>({msgid:ru.getUniqueId(),time:(new Date).toISOString(),is_ephemeral:!1}),async initialize(){this.checkValidity()&&(this.initialized=ru.getResolveablePromise(),"chat"===this.get("type")&&(t.prototype.initialize.apply(this,arguments),this.setRosterContact(eu.getBareJidFromJid(this.get("from")))),this.get("file")&&this.on("change:put",this.uploadFile,this),this.setTimerForEphemeralMessage(),await Mc.trigger("messageInitialized",this,{Synchronous:!0}),this.initialized.resolve())},setTimerForEphemeralMessage(){const e=()=>{this.ephemeral_timer=window.setTimeout(this.safeDestroy.bind(this),1e4)};return this.isEphemeral()?(e(),!0):(this.on("change:is_ephemeral",()=>this.isEphemeral()?e():clearTimeout(this.ephemeral_timer)),!1)},checkValidity(){return 3!==Object.keys(this.attributes).length||(this.validationError="Empty message",this.safeDestroy(),!1)},mayBeRetracted(){return"me"===this.get("sender")&&["all","own"].includes(Mc.settings.get("allow_message_retraction"))},safeDestroy(){try{this.destroy()}catch(e){kn.error(e)}},isEphemeral(){return this.get("is_ephemeral")},getDisplayName(){return"groupchat"===this.get("type")?this.get("nick"):this.contact?this.contact.getDisplayName():this.vcard?this.vcard.getDisplayName():this.get("from")},getMessageText(){return this.get("is_encrypted")?this.get("plaintext")||this.get("body")||e("Undecryptable OMEMO message"):this.get("message")},isMeCommand(){const e=this.getMessageText();return!!e&&e.startsWith("/me ")},sendSlotRequestStanza(){if(!this.file)return Promise.reject(new Error("file is undefined"));const e=qc.env.$iq({from:Tc.jid,to:this.get("slot_request_url"),type:"get"}).c("request",{xmlns:eu.NS.HTTPUPLOAD,filename:this.file.name,size:this.file.size,"content-type":this.file.type});return Mc.sendIQ(e)},async getRequestSlotURL(){let t;try{t=await this.sendSlotRequestStanza()}catch(t){return kn.error(t),this.save({type:"error",message:e("Sorry, could not determine upload URL."),is_ephemeral:!0})}const n=t.querySelector("slot");if(!n)return this.save({type:"error",message:e("Sorry, could not determine file upload URL."),is_ephemeral:!0});this.save({get:n.querySelector("get").getAttribute("url"),put:n.querySelector("put").getAttribute("url")})},uploadFile(){const t=new XMLHttpRequest;t.onreadystatechange=()=>{t.readyState===XMLHttpRequest.DONE&&(kn.info("Status: "+t.status),200===t.status||201===t.status?this.save({upload:Tc.SUCCESS,oob_url:this.get("get"),message:this.get("get")}):t.onerror())},t.upload.addEventListener("progress",e=>{e.lengthComputable&&this.set("progress",e.loaded/e.total)},!1),t.onerror=()=>{let n;n=t.responseText?e('Sorry, could not succesfully upload your file. Your server’s response: "%1$s"',t.responseText):e("Sorry, could not succesfully upload your file."),this.save({type:"error",upload:Tc.FAILURE,message:n,is_ephemeral:!0})},t.open("PUT",this.get("put"),!0),t.setRequestHeader("Content-type",this.file.type),t.send(this.file)}}),Tc.Messages=Qs.extend({model:Tc.Message,comparator:"time"}),Tc.ChatBox=t.extend({messagesCollection:Tc.Messages,defaults(){return{bookmarked:!1,chat_state:void 0,hidden:Tc.isUniView()&&!Mc.settings.get("singleton"),message_type:"chat",nickname:void 0,num_unread:0,time_sent:new Date(0).toISOString(),time_opened:this.get("time_opened")||(new Date).getTime(),type:Tc.PRIVATE_CHAT_TYPE,url:""}},async initialize(){this.initialized=ru.getResolveablePromise(),t.prototype.initialize.apply(this,arguments);const e=this.get("jid");e&&(this.set({box_id:"box-".concat(e)}),this.initNotifications(),this.initMessages(),this.get("type")===Tc.PRIVATE_CHAT_TYPE&&(this.presence=Tc.presences.findWhere({jid:e})||Tc.presences.create({jid:e}),await this.setRosterContact(e)),this.on("change:chat_state",this.sendChatState,this),await this.fetchMessages(),await Mc.trigger("chatBoxInitialized",this,{Synchronous:!0}),this.initialized.resolve())},getMessagesCacheKey(){return"converse.messages-".concat(this.get("jid"),"-").concat(Tc.bare_jid)},initMessages(){this.messages=new this.messagesCollection,this.messages.fetched=ru.getResolveablePromise(),this.messages.fetched.then(()=>{Mc.trigger("afterMessagesFetched",this)}),this.messages.chatbox=this,this.messages.browserStorage=Tc.createStore(this.getMessagesCacheKey()),this.listenTo(this.messages,"change:upload",e=>{e.get("upload")===Tc.SUCCESS&&Mc.send(this.createMessageStanza(e))})},initNotifications(){this.notifications=new Po},afterMessagesFetched(){Mc.trigger("afterMessagesFetched",this)},fetchMessages(){if(this.messages.fetched_flag)return void kn.info("Not re-fetching messages for ".concat(this.get("jid")));this.messages.fetched_flag=!0;const e=this.messages.fetched.resolve;return this.messages.fetch({add:!0,success:()=>{this.afterMessagesFetched(),e()},error:()=>{this.afterMessagesFetched(),e()}}),this.messages.fetched},async handleErrorMessageStanza(t){const n=await us.parseMessage(t,Tc);if(!await this.shouldShowErrorMessage(n))return;const r=this.getMessageReferencedByError(n);if(r){const t={error:n.error,error_condition:n.error_condition,error_text:n.error_text,error_type:n.error_type,editable:!1};n.msgid===r.get("retraction_id")?(t.retraction_id=void 0,n.error||("forbidden"===n.error_condition?t.error=e("You're not allowed to retract your message."):t.error=e("Sorry, an error occurred while trying to retract your message."))):n.error||("forbidden"===n.error_condition?t.error=e("You're not allowed to send a message."):t.error=e("Sorry, an error occurred while trying to send your message.")),r.save(t)}else this.createMessage(n)},queueMessage(e){return this.msg_chain=(this.msg_chain||this.messages.fetched).then(()=>this.onMessage(e)).catch(e=>kn.error(e)),this.msg_chain},async onMessage(e){if(e=await e,ru.isErrorObject(e))return e.stanza&&kn.error(e.stanza),kn.error(e.message);const t=this.getDuplicateMessage(e);if(t)this.updateMessage(t,e);else if(!this.handleReceipt(e)&&!this.handleChatMarker(e)&&!await this.handleRetraction(e)&&(this.setEditable(e,e.time),e.chat_state&&"them"===e.sender&&this.notifications.set("chat_state",e.chat_state),ru.shouldCreateMessage(e))){const t=this.handleCorrection(e)||await this.createMessage(e);this.notifications.set({chat_state:null}),this.handleUnreadMessage(t)}},async clearMessages(){try{await this.messages.clearStore()}catch(e){this.messages.trigger("reset"),kn.error(e)}finally{delete this.msg_chain,delete this.messages.fetched_flag,this.messages.fetched=ru.getResolveablePromise()}},async close(){try{await new Promise((e,t)=>this.destroy({success:e,error:(e,n)=>t(n)}))}catch(e){kn.error(e)}finally{Mc.settings.get("clear_messages_on_reconnection")&&await this.clearMessages()}},announceReconnection(){Mc.trigger("chatReconnected",this)},async onReconnection(){Mc.settings.get("clear_messages_on_reconnection")&&await this.clearMessages(),this.announceReconnection()},validate(e){if(!e.jid)return"Ignored ChatBox without JID";const t=Tc.auto_join_rooms.map(e=>T(e)?e.jid:e),n=Mc.settings.get("auto_join_private_chats").concat(t);if(Mc.settings.get("singleton")&&!n.includes(e.jid)&&!Mc.settings.get("auto_join_on_invite")){const t="".concat(e.jid," is not allowed because singleton is true and it's not being auto_joined");return kn.warn(t),t}},getDisplayName(){return this.contact?this.contact.getDisplayName():this.vcard?this.vcard.getDisplayName():this.get("jid")},async createMessageFromError(e){if(e instanceof Tc.TimeoutError){(await this.createMessage({type:"error",message:e.message,retry_event_id:e.retry_event_id})).error=e}},getOldestMessage(){for(let e=0;e<this.messages.length;e++){const t=this.messages.at(e);if(t.get("type")===this.get("message_type"))return t}},getMostRecentMessage(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages.at(e);if(t.get("type")===this.get("message_type"))return t}},getUpdatedMessageAttributes:(e,t)=>(({is_archived:e})=>({is_archived:e}))(t),updateMessage(e,t){const n=this.getUpdatedMessageAttributes(e,t);n&&e.save(n)},setChatState(e,t){return void 0!==this.chat_state_timeout&&(window.clearTimeout(this.chat_state_timeout),delete this.chat_state_timeout),e===Tc.COMPOSING?this.chat_state_timeout=window.setTimeout(this.setChatState.bind(this),Tc.TIMEOUTS.PAUSED,Tc.PAUSED):e===Tc.PAUSED&&(this.chat_state_timeout=window.setTimeout(this.setChatState.bind(this),Tc.TIMEOUTS.INACTIVE,Tc.INACTIVE)),this.set("chat_state",e,t),this},getMessageReferencedByError(e){const t=e.msgid;return t&&this.messages.models.find(e=>[e.get("msgid"),e.get("retraction_id")].includes(t))},shouldShowErrorMessage(e){if(this.getMessageReferencedByError(e)||e.body)return!0},isSameUser:(e,t)=>ru.isSameBareJID(e,t),findDanglingRetraction(e){if(!e.origin_id||!this.messages.length)return null;if(this.messages.last().get("time")>e.time){const t=Array.from(this.messages.models);return t.reverse(),t.find(({attributes:t})=>t.retracted_id===e.origin_id&&t.from===e.from&&!t.moderated_by)}},async handleRetraction(e){const t=["retracted","retracted_id","editable"];if(e.retracted){if(e.is_tombstone)return!1;const n=this.messages.findWhere({origin_id:e.retracted_id,from:e.from});return n?(n.save(Do(e,t)),!0):(e.dangling_retraction=!0,await this.createMessage(e),!0)}{const n=this.findDanglingRetraction(e);if(n){const r=Do(n.attributes,t),i=Object.assign({dangling_retraction:!1},e,r);return delete i.id,n.save(i),!0}}return!1},handleCorrection(e){if(!e.replace_id||!e.from)return;const t=this.messages.findWhere({msgid:e.replace_id,from:e.from});if(!t)return;const n=t.get("older_versions")||{};return e.time<t.get("time")&&t.get("edited")?(n[e.time]=e.message,t.save({older_versions:n})):(Object.keys(n).length?n[t.get("edited")]=t.get("message"):n[t.get("time")]=t.get("message"),delete(e=Object.assign(e,{older_versions:n})).id,e.time=t.get("time"),t.save(e)),t},getDuplicateMessage(e){const t=[...this.getStanzaIdQueryAttrs(e),this.getOriginIdQueryAttrs(e),this.getMessageBodyQueryAttrs(e)].filter(e=>e),n=this.messages.models;return Qc(n,e=>t.reduce((t,n)=>t||Kc(e.attributes,n),!1))},getOriginIdQueryAttrs:e=>e.origin_id&&{origin_id:e.origin_id,from:e.from},getStanzaIdQueryAttrs:e=>Object.keys(e).filter(e=>e.startsWith("stanza_id ")).map(t=>{const n=t.replace(/^stanza_id /,""),r={};return r["stanza_id ".concat(n)]=e[t],r}),getMessageBodyQueryAttrs(e){if(e.message&&e.msgid){const t={from:e.from,msgid:e.msgid};return e.is_encrypted||(t.message=e.message),t}},retractOwnMessage(e){this.sendRetractionMessage(e),e.save({retracted:(new Date).toISOString(),retracted_id:e.get("origin_id"),retraction_id:e.get("id"),is_ephemeral:!0,editable:!1})},sendRetractionMessage(e){const t=e.get("origin_id");if(!t)throw new Error("Can't retract message without a XEP-0359 Origin ID");const n=Zc({id:ru.getUniqueId(),to:this.get("jid"),type:"chat"}).c("store",{xmlns:eu.NS.HINTS}).up().c("apply-to",{id:t,xmlns:eu.NS.FASTEN}).c("retract",{xmlns:eu.NS.RETRACT});return Tc.connection.send(n)},sendMarkerForMessage(e){if(null==e?void 0:e.get("is_markable")){const t=eu.getBareJidFromJid(e.get("from"));this.sendMarker(t,e.get("msgid"),"displayed",e.get("type"))}},sendMarker(e,t,n,r){const i=Zc({from:Tc.connection.jid,id:ru.getUniqueId(),to:e,type:r||"chat"}).c(n,{xmlns:eu.NS.MARKERS,id:t});Mc.send(i)},handleChatMarker(e){if(eu.getBareJidFromJid(e.to)!==Tc.bare_jid)return!1;if(e.is_markable)return!this.contact||e.is_archived||e.is_carbon||this.sendMarker(e.from,e.msgid,"received"),!1;if(e.marker_id){const t=this.messages.findWhere({msgid:e.marker_id}),n="marker_".concat(e.marker);return t&&!t.get(n)&&t.save({field_name:(new Date).toISOString()}),!0}},sendReceiptStanza(e,t){const n=Zc({from:Tc.connection.jid,id:ru.getUniqueId(),to:e,type:"chat"}).c("received",{xmlns:eu.NS.RECEIPTS,id:t}).up().c("store",{xmlns:eu.NS.HINTS}).up();Mc.send(n)},handleReceipt(e){if("them"===e.sender)if(e.is_valid_receipt_request)this.sendReceiptStanza(e.from,e.msgid);else if(e.receipt_id){const t=this.messages.findWhere({msgid:e.receipt_id});return t&&!t.get("received")&&t.save({received:(new Date).toISOString()}),!0}return!1},createMessageStanza(e){const t=Zc({from:Tc.connection.jid,to:this.get("jid"),type:this.get("message_type"),id:e.get("edited")&&ru.getUniqueId()||e.get("msgid")}).c("body").t(e.get("message")).up().c(Tc.ACTIVE,{xmlns:eu.NS.CHATSTATES}).root();return"chat"===e.get("type")&&t.c("request",{xmlns:eu.NS.RECEIPTS}).root(),e.get("is_spoiler")&&(e.get("spoiler_hint")?t.c("spoiler",{xmlns:eu.NS.SPOILER},e.get("spoiler_hint")).root():t.c("spoiler",{xmlns:eu.NS.SPOILER}).root()),(e.get("references")||[]).forEach(e=>{const n={xmlns:eu.NS.REFERENCE,begin:e.begin,end:e.end,type:e.type};e.uri&&(n.uri=e.uri),t.c("reference",n).root()}),e.get("oob_url")&&t.c("x",{xmlns:eu.NS.OUTOFBAND}).c("url").t(e.get("oob_url")).root(),e.get("edited")&&t.c("replace",{xmlns:eu.NS.MESSAGE_CORRECT,id:e.get("msgid")}).root(),e.get("origin_id")&&t.c("origin-id",{xmlns:eu.NS.SID,id:e.get("origin_id")}).root(),t},getOutgoingMessageAttributes(e,t){const n=this.get("composing_spoiler"),r=ru.getUniqueId(),i=e?ru.httpToGeoUri(ru.shortnamesToUnicode(e),Tc):void 0;return{from:Tc.bare_jid,fullname:Tc.xmppstatus.get("fullname"),id:r,is_only_emojis:!!e&&ru.isOnlyEmojis(e),jid:this.get("jid"),message:i,msgid:r,nickname:this.get("nickname"),sender:"me",spoiler_hint:n?t:void 0,time:(new Date).toISOString(),type:this.get("message_type"),body:i,is_spoiler:n,origin_id:r}},setEditable(e,t){if(!e.is_headline&&!ru.isEmptyMessage(e)&&"me"===e.sender)if("all"===Mc.settings.get("allow_message_corrections"))e.editable=!(e.file||e.retracted||"oob_url"in e);else if("last"===Mc.settings.get("allow_message_corrections")&&t>this.get("time_sent")){this.set({time_sent:t});const n=this.messages.findWhere({editable:!0});n&&n.save({editable:!1}),e.editable=!(e.file||e.retracted||"oob_url"in e)}},async createMessage(e,t){return e.time=e.time||(new Date).toISOString(),await this.messages.fetched,this.messages.create(e,Object.assign({wait:!0,promise:!0},t))},async sendMessage(e,t){const n=this.getOutgoingMessageAttributes(e,t);let r=this.messages.findWhere("correcting");if(r){const e=r.get("older_versions")||{};e[r.get("time")]=r.get("message"),r.save({correcting:!1,edited:(new Date).toISOString(),message:n.message,older_versions:e,references:n.references,is_only_emojis:n.is_only_emojis,origin_id:ru.getUniqueId(),received:void 0})}else this.setEditable(n,(new Date).toISOString()),r=await this.createMessage(n);return Mc.send(this.createMessageStanza(r)),Mc.trigger("sendMessage",{chatbox:this,message:r}),r},sendChatState(){if(Mc.settings.get("send_chat_state_notifications")&&this.get("chat_state")){const e=Mc.settings.get("send_chat_state_notifications");if(Array.isArray(e)&&!e.includes(this.get("chat_state")))return;Mc.send(Zc({id:ru.getUniqueId(),to:this.get("jid"),type:"chat"}).c(this.get("chat_state"),{xmlns:eu.NS.CHATSTATES}).up().c("no-store",{xmlns:eu.NS.HINTS}).up().c("no-permanent-store",{xmlns:eu.NS.HINTS}))}},async sendFiles(t){var n;const r=(await Mc.disco.features.get(eu.NS.HTTPUPLOAD,Tc.domain)).pop();if(!r)return void this.createMessage({message:e("Sorry, looks like file upload is not supported by your server."),type:"error",is_ephemeral:!0});const i=r.dataforms.where({FORM_TYPE:{value:eu.NS.HTTPUPLOAD,type:"hidden"}}).pop(),o=window.parseInt(null===(n=((null==i?void 0:i.attributes)||{})["max-file-size"])||void 0===n?void 0:n.value),s=null==r?void 0:r.id;s?Array.from(t).forEach(async t=>{if(!window.isNaN(o)&&window.parseInt(t.size)>o)return this.createMessage({message:e("The size of your file, %1$s, exceeds the maximum allowed by your server, which is %2$s.",t.name,Xc()(o)),type:"error",is_ephemeral:!0});{const e=Object.assign(this.getOutgoingMessageAttributes(),{file:!0,progress:0,slot_request_url:s});this.setEditable(e,(new Date).toISOString());const n=await this.createMessage(e,{silent:!0});n.file=t,this.messages.trigger("add",n),n.getRequestSlotURL()}}):this.createMessage({message:e("Sorry, looks like file upload is not supported by your server."),type:"error",is_ephemeral:!0})},maybeShow(e){if(e){if(Tc.isUniView()){const e=e=>!e.get("hidden")&&e.get("jid")!==this.get("jid")&&"controlbox"!==e.get("id");Tc.chatboxes.filter(e).forEach(e=>ru.safeSave(e,{hidden:!0}))}ru.safeSave(this,{hidden:!1})}return Tc.isUniView()&&this.get("hidden")?void 0:this.trigger("show")},isHidden(){return Tc.isUniView()&&this.get("hidden")||this.isScrolledUp()||"hidden"===Tc.windowState},handleUnreadMessage(e){if((null==e?void 0:e.get("body"))&&nu.isNewMessage(e))if(this.isHidden()){const t={num_unread:this.get("num_unread")+1};0===this.get("num_unread")&&(t.first_unread_id=e.get("id")),this.save(t)}else this.sendMarkerForMessage(e)},clearUnreadMsgCounter(){this.get("num_unread")>0&&this.sendMarkerForMessage(this.messages.last()),ru.safeSave(this,{num_unread:0})},isScrolledUp(){return this.get("scrolled",!0)}}),Tc.handleMessageStanza=async function(e){if(us.isServerMessage(e)){const t=e.getAttribute("from");return kn.info("handleMessageStanza: Ignoring incoming server message from JID: ".concat(t))}const t=await us.parseMessage(e,Tc);if(ru.isErrorObject(t))return t.stanza&&kn.error(t.stanza),kn.error(t.message);const n=!!tu('body, encrypted[xmlns="'.concat(eu.NS.OMEMO,'"]'),e).length,r=await Mc.chats.get(t.contact_jid,{nickname:t.nick},n);await(null==r?void 0:r.queueMessage(t));const i={stanza:e,attrs:t,chatbox:r};Mc.trigger("message",i)},Tc.router.route("converse/chat?jid=:jid",(function(e){if(!nu.isValidJID(e))return kn.warn('Invalid JID "'.concat(e,'" provided in URL fragment'));Mc.chats.open(e)})),Mc.listen.on("chatBoxesFetched",(function(){Mc.settings.get("auto_join_private_chats").forEach(e=>{Tc.chatboxes.where({jid:e}).length||("string"==typeof e?Mc.chats.open(e):kn.error('Invalid jid criteria specified for "auto_join_private_chats"'))}),Mc.trigger("privateChatsAutoJoined")})),Mc.listen.on("presencesInitialized",(function(){Tc.connection.addHandler(e=>tu('message > result[xmlns="'.concat(eu.NS.MAM,'"]'),e).pop()?(kn.warn('Received a MAM message with type "chat".'),!0):(Tc.handleMessageStanza(e),!0),null,"message","chat"),Tc.connection.addHandler(e=>(null!==e.getAttribute("type")||Tc.handleMessageStanza(e),!0),eu.NS.RECEIPTS,"message"),Tc.connection.addHandler(e=>(async function(e){const t=eu.getBareJidFromJid(e.getAttribute("from"));if(nu.isSameBareJID(t,Tc.bare_jid))return;const n=await Mc.chatboxes.get(t);null==n||n.handleErrorMessageStanza(e)}(e),!0),null,"message","error")})),Mc.listen.on("clearSession",async()=>{if(Tc.shouldClearCache()){await Promise.all(Tc.chatboxes.map(e=>e.messages&&e.messages.clearStore({silent:!0})));const e=e=>e.get("type")!==Tc.CONTROLBOX_TYPE;Tc.chatboxes.clearStore({silent:!0},e)}}),Object.assign(Mc,{chats:{async create(e,t){if("string"==typeof e){if(t&&!(null==t?void 0:t.fullname)){var n;const r=await Mc.contacts.get(e);t.fullname=null==r||null===(n=r.attributes)||void 0===n?void 0:n.fullname}const r=Mc.chats.get(e,t,!0);return r||void kn.error("Could not open chatbox for JID: "+e)}return Array.isArray(e)?Promise.all(e.forEach(async n=>{var r;const i=await Mc.contacts.get(e);return t.fullname=null==i||null===(r=i.attributes)||void 0===r?void 0:r.fullname,Mc.chats.get(n,t,!0).maybeShow()})):(kn.error("chats.create: You need to provide at least one JID"),null)},async open(e,t,n){if("string"==typeof e){const r=await Mc.chats.get(e,t,!0);return r?r.maybeShow(n):r}if(Array.isArray(e))return Promise.all(e.map(e=>Mc.chats.get(e,t,!0).then(e=>e&&e.maybeShow(n))).filter(e=>e));const r="chats.open: You need to provide at least one JID";throw kn.error(r),new Error(r)},async get(e,t={},n=!1){async function r(e){let r=await Mc.chatboxes.get(e);return!r&&n?r=await Mc.chatboxes.create(e,t,Tc.ChatBox):(r=r&&r.get("type")===Tc.PRIVATE_CHAT_TYPE?r:null,r&&Object.keys(t).length&&r.save(t)),r}if(void 0===e){return(await Mc.chatboxes.get()).filter(e=>e.get("type")===Tc.PRIVATE_CHAT_TYPE)}return"string"==typeof e?r(e):Promise.all(e.map(e=>r(e)))}}})}});
/**
 * @module converse-disco
 * @copyright The Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 * @description Converse plugin which add support for XEP-0030: Service Discovery
 */
const{Strophe:iu,$iq:ou,utils:su}=qc.env;qc.plugins.add("converse-disco",{initialize(){function e(){if(!Tc.stream_features){const e=iu.getBareJidFromJid(Tc.jid),t="converse.stream-features-".concat(e);Mc.promises.add("streamFeaturesAdded"),Tc.stream_features=new Qs,Tc.stream_features.browserStorage=Tc.createStore(t,"session")}}function t(){Mc.trigger("streamFeaturesAdded")}Mc.promises.add("discoInitialized"),Mc.promises.add("streamFeaturesAdded"),Tc.DiscoEntity=Po.extend({idAttribute:"jid",initialize(e,t){this.waitUntilFeaturesDiscovered=su.getResolveablePromise(),this.dataforms=new Qs;let n="converse.dataforms-".concat(this.get("jid"));this.dataforms.browserStorage=Tc.createStore(n,"session"),this.features=new Qs,n="converse.features-".concat(this.get("jid")),this.features.browserStorage=Tc.createStore(n,"session"),this.listenTo(this.features,"add",this.onFeatureAdded),this.fields=new Qs,n="converse.fields-".concat(this.get("jid")),this.fields.browserStorage=Tc.createStore(n,"session"),this.listenTo(this.fields,"add",this.onFieldAdded),this.identities=new Qs,n="converse.identities-".concat(this.get("jid")),this.identities.browserStorage=Tc.createStore(n,"session"),this.fetchFeatures(t),this.items=new Tc.DiscoEntities,n="converse.disco-items-".concat(this.get("jid")),this.items.browserStorage=Tc.createStore(n,"session"),this.items.fetch()},async getIdentity(e,t){return await this.waitUntilFeaturesDiscovered,this.identities.findWhere({category:e,type:t})},async hasFeature(e){if(await this.waitUntilFeaturesDiscovered,this.features.findWhere({var:e}))return this},onFeatureAdded(e){e.entity=this,Mc.trigger("serviceDiscovered",e)},onFieldAdded(e){e.entity=this,Mc.trigger("discoExtensionFieldDiscovered",e)},async fetchFeatures(e){if(e.ignore_cache)this.queryInfo();else{const e=this.features.browserStorage.name,t=await this.features.browserStorage.store.getItem(e);t&&0===t.length||null===t?this.queryInfo():(this.features.fetch({add:!0,success:()=>{this.waitUntilFeaturesDiscovered.resolve(this),this.trigger("featuresDiscovered")}}),this.identities.fetch({add:!0}))}},async queryInfo(){let e;try{e=await Mc.disco.info(this.get("jid"),null)}catch(e){return null===e?kn.error("Timeout for disco#info query for ".concat(this.get("jid"))):kn.error(e),void this.waitUntilFeaturesDiscovered.resolve(this)}this.onInfo(e)},onDiscoItems(e){fr()('query[xmlns="'.concat(iu.NS.DISCO_ITEMS,'"] item'),e).forEach(e=>{if(e.getAttribute("node"))return;const t=e.getAttribute("jid");if(void 0===this.items.get(t)){const e=Tc.disco_entities.get(t);e?this.items.add(e):this.items.create({jid:t})}})},async queryForItems(){if(0===this.identities.where({category:"server"}).length)return;const e=await Mc.disco.items(this.get("jid"));this.onDiscoItems(e)},onInfo(e){Array.from(e.querySelectorAll("identity")).forEach(e=>{this.identities.create({category:e.getAttribute("category"),type:e.getAttribute("type"),name:e.getAttribute("name")})}),fr()('x[type="result"][xmlns="'.concat(iu.NS.XFORM,'"]'),e).forEach(e=>{const t={};fr()("field",e).forEach(e=>{var n;t[e.getAttribute("var")]={value:null===(n=e.querySelector("value"))||void 0===n?void 0:n.textContent,type:e.getAttribute("type")}}),this.dataforms.create(t)}),e.querySelector('feature[var="'.concat(iu.NS.DISCO_ITEMS,'"]'))&&this.queryForItems(),Array.from(e.querySelectorAll("feature")).forEach(t=>{this.features.create({var:t.getAttribute("var"),from:e.getAttribute("from")})}),fr()('x[type="result"][xmlns="jabber:x:data"] field',e).forEach(t=>{var n;this.fields.create({var:t.getAttribute("var"),value:null===(n=t.querySelector("value"))||void 0===n?void 0:n.textContent,from:e.getAttribute("from")})}),this.waitUntilFeaturesDiscovered.resolve(this),this.trigger("featuresDiscovered")}}),Tc.DiscoEntities=Qs.extend({model:Tc.DiscoEntity,fetchEntities(){return new Promise((e,t)=>{this.fetch({add:!0,success:e,error(e,n){kn.error(n),t(new Error("Could not fetch disco entities"))}})})}});const n=this;function r(e){const t=e.getElementsByTagName("query")[0].getAttribute("node"),r={xmlns:iu.NS.DISCO_INFO};t&&(r.node=t);const i=ou({type:"result",id:e.getAttribute("id")}),o=e.getAttribute("from");return null!==o&&i.attrs({to:o}),i.c("query",r),n._identities.forEach(e=>{const t={category:e.category,type:e.type};e.name&&(t.name=e.name),e.lang&&(t["xml:lang"]=e.lang),i.c("identity",t).up()}),n._features.forEach(e=>i.c("feature",{var:e}).up()),Mc.send(i.tree()),!0}async function i(){Mc.disco.own.identities.add("client","web","Converse"),Mc.disco.own.features.add(iu.NS.CHATSTATES),Mc.disco.own.features.add(iu.NS.DISCO_INFO),Mc.disco.own.features.add(iu.NS.ROSTERX),Mc.settings.get("message_carbons")&&Mc.disco.own.features.add(iu.NS.CARBONS),Mc.trigger("addClientFeatures"),Tc.connection.addHandler(r,iu.NS.DISCO_INFO,"iq","get",null,null),Tc.disco_entities=new Tc.DiscoEntities;const e="converse.disco-entities-".concat(Tc.bare_jid);Tc.disco_entities.browserStorage=Tc.createStore(e,"session");const t=await Tc.disco_entities.fetchEntities();0!==t.length&&t.get(Tc.domain)||Tc.disco_entities.create({jid:Tc.domain}),Mc.trigger("discoInitialized")}n._identities=[],n._features=[],Mc.listen.on("userSessionInitialized",async()=>{e(),Tc.connfeedback.get("connection_status")===iu.Status.ATTACHED&&(await new Promise((e,t)=>Tc.stream_features.fetch({success:e,error:t})),t())}),Mc.listen.on("beforeResourceBinding",(function(){e(),Array.from(Tc.connection.features.childNodes).forEach(e=>{Tc.stream_features.create({name:e.nodeName,xmlns:e.getAttribute("xmlns")})}),t()})),Mc.listen.on("reconnected",i),Mc.listen.on("connected",i),Mc.listen.on("beforeTearDown",async()=>{Mc.promises.add("streamFeaturesAdded"),Tc.stream_features&&(await Tc.stream_features.clearStore(),delete Tc.stream_features)}),Mc.listen.on("clearSession",()=>{Tc.shouldClearCache()&&Tc.disco_entities&&(Array.from(Tc.disco_entities.models).forEach(e=>e.features.clearStore()),Array.from(Tc.disco_entities.models).forEach(e=>e.identities.clearStore()),Array.from(Tc.disco_entities.models).forEach(e=>e.dataforms.clearStore()),Array.from(Tc.disco_entities.models).forEach(e=>e.fields.clearStore()),Tc.disco_entities.clearStore(),delete Tc.disco_entities)}),Object.assign(Mc,{disco:{stream:{async getFeature(e,t){if(await Mc.waitUntil("streamFeaturesAdded"),!e||!t)throw new Error("name and xmlns need to be provided when calling disco.stream.getFeature");if(void 0!==Tc.stream_features||Mc.connection.connected())return Tc.stream_features.findWhere({name:e,xmlns:t});{const n="Tried to get feature ".concat(e," ").concat(t," but _converse.stream_features has been torn down");kn.warn(n)}}},own:{identities:{add(e,t,r,i){for(var o=0;o<n._identities.length;o++)if(n._identities[o].category==e&&n._identities[o].type==t&&n._identities[o].name==r&&n._identities[o].lang==i)return!1;n._identities.push({category:e,type:t,name:r,lang:i})},clear(){n._identities=[]},get:()=>n._identities},features:{add(e){for(var t=0;t<n._features.length;t++)if(n._features[t]==e)return!1;n._features.push(e)},clear(){n._features=[]},get:()=>n._features}},info(e,t){const n={xmlns:iu.NS.DISCO_INFO};t&&(n.node=t);const r=ou({from:Tc.connection.jid,to:e,type:"get"}).c("query",n);return Mc.sendIQ(r)},items(e,t){const n={xmlns:iu.NS.DISCO_ITEMS};return t&&(n.node=t),Mc.sendIQ(ou({from:Tc.connection.jid,to:e,type:"get"}).c("query",n))},entities:{async get(e,t=!1){if(await Mc.waitUntil("discoInitialized"),!e)return Tc.disco_entities;if(void 0===Tc.disco_entities&&!Mc.connection.connected()){const t="Tried to look up entity ".concat(e," but _converse.disco_entities has been torn down");return void kn.warn(t)}const n=Tc.disco_entities.get(e);return n||!t?n:Mc.disco.entities.create(e)},create:(e,t)=>Tc.disco_entities.create({jid:e},t)},features:{async get(e,t){if(!t)throw new TypeError("You need to provide an entity JID");await Mc.waitUntil("discoInitialized");let n=await Mc.disco.entities.get(t,!0);if(void 0===Tc.disco_entities&&!Mc.connection.connected()){const n="Tried to get feature ".concat(e," for ").concat(t," but _converse.disco_entities has been torn down");return void kn.warn(n)}n=await n.waitUntilFeaturesDiscovered;const r=[...n.items.map(t=>t.hasFeature(e)),n.hasFeature(e)];return(await Promise.all(r)).filter(T)}},supports:async(e,t)=>(await Mc.disco.features.get(e,t)).length>0,async refresh(e){if(!e)throw new TypeError("api.disco.refresh: You need to provide an entity JID");await Mc.waitUntil("discoInitialized");let t=await Mc.disco.entities.get(e);return t?(t.features.reset(),t.fields.reset(),t.identities.reset(),t.waitUntilFeaturesDiscovered.isPending||(t.waitUntilFeaturesDiscovered=su.getResolveablePromise()),t.queryInfo()):t=await Mc.disco.entities.create(e,{ignore_cache:!0}),t.waitUntilFeaturesDiscovered},refreshFeatures:e=>Mc.refresh(e),async getFeatures(e){if(!e)throw new TypeError("api.disco.getFeatures: You need to provide an entity JID");await Mc.waitUntil("discoInitialized");let t=await Mc.disco.entities.get(e,!0);return t=await t.waitUntilFeaturesDiscovered,t.features},async getFields(e){if(!e)throw new TypeError("api.disco.getFields: You need to provide an entity JID");await Mc.waitUntil("discoInitialized");let t=await Mc.disco.entities.get(e,!0);return t=await t.waitUntilFeaturesDiscovered,t.fields},async getIdentity(e,t,n){const r=await Mc.disco.entities.get(n,!0);if(void 0!==r||Mc.connection.connected())return r.getIdentity(e,t);{const t="Tried to look up category ".concat(e," for ").concat(n," but _converse.disco_entities has been torn down");kn.warn(t)}}}})}});const au=new RegExp("<object[^>]*>.*?</object>|<span[^>]*>.*?</span>|<(?:object|embed|svg|img|div|span|p|a)[^>]*>|((\\s|^)(\\*\\\\0\\/\\*|\\*\\\\O\\/\\*|\\-___\\-|\\:'\\-\\)|'\\:\\-\\)|'\\:\\-D|\\>\\:\\-\\)|>\\:\\-\\)|'\\:\\-\\(|\\>\\:\\-\\(|>\\:\\-\\(|\\:'\\-\\(|O\\:\\-\\)|0\\:\\-3|0\\:\\-\\)|0;\\^\\)|O;\\-\\)|0;\\-\\)|O\\:\\-3|\\-__\\-|\\:\\-Þ|\\:\\-Þ|\\<\\/3|<\\/3|\\:'\\)|\\:\\-D|'\\:\\)|'\\=\\)|'\\:D|'\\=D|\\>\\:\\)|>\\:\\)|\\>;\\)|>;\\)|\\>\\=\\)|>\\=\\)|;\\-\\)|\\*\\-\\)|;\\-\\]|;\\^\\)|'\\:\\(|'\\=\\(|\\:\\-\\*|\\:\\^\\*|\\>\\:P|>\\:P|X\\-P|\\>\\:\\[|>\\:\\[|\\:\\-\\(|\\:\\-\\[|\\>\\:\\(|>\\:\\(|\\:'\\(|;\\-\\(|\\>\\.\\<|>\\.<|#\\-\\)|%\\-\\)|X\\-\\)|\\\\0\\/|\\\\O\\/|0\\:3|0\\:\\)|O\\:\\)|O\\=\\)|O\\:3|B\\-\\)|8\\-\\)|B\\-D|8\\-D|\\-_\\-|\\>\\:\\\\|>\\:\\\\|\\>\\:\\/|>\\:\\/|\\:\\-\\/|\\:\\-\\.|\\:\\-P|\\:Þ|\\:Þ|\\:\\-b|\\:\\-O|O_O|\\>\\:O|>\\:O|\\:\\-X|\\:\\-#|\\:\\-\\)|\\(y\\)|\\<3|<3|\\:D|\\=D|;\\)|\\*\\)|;\\]|;D|\\:\\*|\\=\\*|\\:\\(|\\:\\[|\\=\\(|\\:@|;\\(|D\\:|\\:\\$|\\=\\$|#\\)|%\\)|X\\)|B\\)|8\\)|\\:\\/|\\:\\\\|\\=\\/|\\=\\\\|\\:L|\\=L|\\:P|\\=P|\\:b|\\:O|\\:X|\\:#|\\=X|\\=#|\\:\\)|\\=\\]|\\=\\)|\\:\\])(?=\\s|$|[!,.?]))","gi"),cu=/(?:\ud83d\udc68\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc68\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc68\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\u200d\ud83e\udd1d\u200d\ud83e\uddd1|\ud83d\udc6b\ud83c[\udffb-\udfff]|\ud83d\udc6c\ud83c[\udffb-\udfff]|\ud83d\udc6d\ud83c[\udffb-\udfff]|\ud83d[\udc6b-\udc6d])|(?:\ud83d[\udc68\udc69]|\ud83e\uddd1)(?:\ud83c[\udffb-\udfff])?\u200d(?:\u2695\ufe0f|\u2696\ufe0f|\u2708\ufe0f|\ud83c[\udf3e\udf73\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75]|\u26f9)((?:\ud83c[\udffb-\udfff]|\ufe0f)\u200d[\u2640\u2642]\ufe0f)|(?:\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd35\udd37-\udd39\udd3d\udd3e\uddb8\uddb9\uddcd-\uddcf\uddd6-\udddd])(?:\ud83c[\udffb-\udfff])?\u200d[\u2640\u2642]\ufe0f|(?:\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f|\ud83c\udff3\ufe0f\u200d\ud83c\udf08|\ud83c\udff4\u200d\u2620\ufe0f|\ud83d\udc15\u200d\ud83e\uddba|\ud83d\udc41\u200d\ud83d\udde8|\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc6f\u200d\u2640\ufe0f|\ud83d\udc6f\u200d\u2642\ufe0f|\ud83e\udd3c\u200d\u2640\ufe0f|\ud83e\udd3c\u200d\u2642\ufe0f|\ud83e\uddde\u200d\u2640\ufe0f|\ud83e\uddde\u200d\u2642\ufe0f|\ud83e\udddf\u200d\u2640\ufe0f|\ud83e\udddf\u200d\u2642\ufe0f)|[#*0-9]\ufe0f?\u20e3|(?:[©®\u2122\u265f]\ufe0f)|(?:\ud83c[\udc04\udd70\udd71\udd7e\udd7f\ude02\ude1a\ude2f\ude37\udf21\udf24-\udf2c\udf36\udf7d\udf96\udf97\udf99-\udf9b\udf9e\udf9f\udfcd\udfce\udfd4-\udfdf\udff3\udff5\udff7]|\ud83d[\udc3f\udc41\udcfd\udd49\udd4a\udd6f\udd70\udd73\udd76-\udd79\udd87\udd8a-\udd8d\udda5\udda8\uddb1\uddb2\uddbc\uddc2-\uddc4\uddd1-\uddd3\udddc-\uddde\udde1\udde3\udde8\uddef\uddf3\uddfa\udecb\udecd-\udecf\udee0-\udee5\udee9\udef0\udef3]|[\u203c\u2049\u2139\u2194-\u2199\u21a9\u21aa\u231a\u231b\u2328\u23cf\u23ed-\u23ef\u23f1\u23f2\u23f8-\u23fa\u24c2\u25aa\u25ab\u25b6\u25c0\u25fb-\u25fe\u2600-\u2604\u260e\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262a\u262e\u262f\u2638-\u263a\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267b\u267f\u2692-\u2697\u2699\u269b\u269c\u26a0\u26a1\u26a7\u26aa\u26ab\u26b0\u26b1\u26bd\u26be\u26c4\u26c5\u26c8\u26cf\u26d1\u26d3\u26d4\u26e9\u26ea\u26f0-\u26f5\u26f8\u26fa\u26fd\u2702\u2708\u2709\u270f\u2712\u2714\u2716\u271d\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u2764\u27a1\u2934\u2935\u2b05-\u2b07\u2b1b\u2b1c\u2b50\u2b55\u3030\u303d\u3297\u3299])(?:\ufe0f|(?!\ufe0e))|(?:(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75\udd90]|[\u261d\u26f7\u26f9\u270c\u270d])(?:\ufe0f|(?!\ufe0e))|(?:\ud83c[\udf85\udfc2-\udfc4\udfc7\udfca]|\ud83d[\udc42\udc43\udc46-\udc50\udc66-\udc69\udc6e\udc70-\udc78\udc7c\udc81-\udc83\udc85-\udc87\udcaa\udd7a\udd95\udd96\ude45-\ude47\ude4b-\ude4f\udea3\udeb4-\udeb6\udec0\udecc]|\ud83e[\udd0f\udd18-\udd1c\udd1e\udd1f\udd26\udd30-\udd39\udd3d\udd3e\uddb5\uddb6\uddb8\uddb9\uddbb\uddcd-\uddcf\uddd1-\udddd]|[\u270a\u270b]))(?:\ud83c[\udffb-\udfff])?|(?:\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f|\ud83c\udde6\ud83c[\udde8-\uddec\uddee\uddf1\uddf2\uddf4\uddf6-\uddfa\uddfc\uddfd\uddff]|\ud83c\udde7\ud83c[\udde6\udde7\udde9-\uddef\uddf1-\uddf4\uddf6-\uddf9\uddfb\uddfc\uddfe\uddff]|\ud83c\udde8\ud83c[\udde6\udde8\udde9\uddeb-\uddee\uddf0-\uddf5\uddf7\uddfa-\uddff]|\ud83c\udde9\ud83c[\uddea\uddec\uddef\uddf0\uddf2\uddf4\uddff]|\ud83c\uddea\ud83c[\udde6\udde8\uddea\uddec\udded\uddf7-\uddfa]|\ud83c\uddeb\ud83c[\uddee-\uddf0\uddf2\uddf4\uddf7]|\ud83c\uddec\ud83c[\udde6\udde7\udde9-\uddee\uddf1-\uddf3\uddf5-\uddfa\uddfc\uddfe]|\ud83c\udded\ud83c[\uddf0\uddf2\uddf3\uddf7\uddf9\uddfa]|\ud83c\uddee\ud83c[\udde8-\uddea\uddf1-\uddf4\uddf6-\uddf9]|\ud83c\uddef\ud83c[\uddea\uddf2\uddf4\uddf5]|\ud83c\uddf0\ud83c[\uddea\uddec-\uddee\uddf2\uddf3\uddf5\uddf7\uddfc\uddfe\uddff]|\ud83c\uddf1\ud83c[\udde6-\udde8\uddee\uddf0\uddf7-\uddfb\uddfe]|\ud83c\uddf2\ud83c[\udde6\udde8-\udded\uddf0-\uddff]|\ud83c\uddf3\ud83c[\udde6\udde8\uddea-\uddec\uddee\uddf1\uddf4\uddf5\uddf7\uddfa\uddff]|\ud83c\uddf4\ud83c\uddf2|\ud83c\uddf5\ud83c[\udde6\uddea-\udded\uddf0-\uddf3\uddf7-\uddf9\uddfc\uddfe]|\ud83c\uddf6\ud83c\udde6|\ud83c\uddf7\ud83c[\uddea\uddf4\uddf8\uddfa\uddfc]|\ud83c\uddf8\ud83c[\udde6-\uddea\uddec-\uddf4\uddf7-\uddf9\uddfb\uddfd-\uddff]|\ud83c\uddf9\ud83c[\udde6\udde8\udde9\uddeb-\udded\uddef-\uddf4\uddf7\uddf9\uddfb\uddfc\uddff]|\ud83c\uddfa\ud83c[\udde6\uddec\uddf2\uddf3\uddf8\uddfe\uddff]|\ud83c\uddfb\ud83c[\udde6\udde8\uddea\uddec\uddee\uddf3\uddfa]|\ud83c\uddfc\ud83c[\uddeb\uddf8]|\ud83c\uddfd\ud83c\uddf0|\ud83c\uddfe\ud83c[\uddea\uddf9]|\ud83c\uddff\ud83c[\udde6\uddf2\uddfc]|\ud83c[\udccf\udd8e\udd91-\udd9a\udde6-\uddff\ude01\ude32-\ude36\ude38-\ude3a\ude50\ude51\udf00-\udf20\udf2d-\udf35\udf37-\udf7c\udf7e-\udf84\udf86-\udf93\udfa0-\udfc1\udfc5\udfc6\udfc8\udfc9\udfcf-\udfd3\udfe0-\udff0\udff4\udff8-\udfff]|\ud83d[\udc00-\udc3e\udc40\udc44\udc45\udc51-\udc65\udc6a\udc6f\udc79-\udc7b\udc7d-\udc80\udc84\udc88-\udca9\udcab-\udcfc\udcff-\udd3d\udd4b-\udd4e\udd50-\udd67\udda4\uddfb-\ude44\ude48-\ude4a\ude80-\udea2\udea4-\udeb3\udeb7-\udebf\udec1-\udec5\uded0-\uded2\uded5\udeeb\udeec\udef4-\udefa\udfe0-\udfeb]|\ud83e[\udd0d\udd0e\udd10-\udd17\udd1d\udd20-\udd25\udd27-\udd2f\udd3a\udd3c\udd3f-\udd45\udd47-\udd71\udd73-\udd76\udd7a-\udda2\udda5-\uddaa\uddae-\uddb4\uddb7\uddba\uddbc-\uddca\uddd0\uddde-\uddff\ude70-\ude73\ude78-\ude7a\ude80-\ude82\ude90-\ude95]|[\u23e9-\u23ec\u23f0\u23f3\u267e\u26ce\u2705\u2728\u274c\u274e\u2753-\u2755\u2795-\u2797\u27b0\u27bf\ue50a])|\ufe0f/g;function uu(){const e=fu(['<img class="emoji"\n            draggable="false"\n            title="','"\n            alt="','"\n            src="','">']);return uu=function(){return e},e}function du(){const e=fu(['<img class="emoji"\n                draggable="false"\n                title="','"\n                alt="','"\n                src="',"/72x72/",'.png"/>']);return du=function(){return e},e}function lu(){const e=fu(['<span title="','">',"</span>"]);return lu=function(){return e},e}function fu(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}
/**
 * @module converse-emoji
 * @copyright 2020, the Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 */const hu=qc.env.utils;qc.emojis={initialized:!1,initialized_promise:hu.getResolveablePromise()};const pu={"*\\0/*":"1f646","*\\O/*":"1f646","-___-":"1f611",":'-)":"1f602","':-)":"1f605","':-D":"1f605",">:-)":"1f606","':-(":"1f613",">:-(":"1f620",":'-(":"1f622","O:-)":"1f607","0:-3":"1f607","0:-)":"1f607","0;^)":"1f607","O;-)":"1f607","0;-)":"1f607","O:-3":"1f607","-__-":"1f611",":-Þ":"1f61b","</3":"1f494",":')":"1f602",":-D":"1f603","':)":"1f605","'=)":"1f605","':D":"1f605","'=D":"1f605",">:)":"1f606",">;)":"1f606",">=)":"1f606",";-)":"1f609","*-)":"1f609",";-]":"1f609",";^)":"1f609","':(":"1f613","'=(":"1f613",":-*":"1f618",":^*":"1f618",">:P":"1f61c","X-P":"1f61c",">:[":"1f61e",":-(":"1f61e",":-[":"1f61e",">:(":"1f620",":'(":"1f622",";-(":"1f622",">.<":"1f623","#-)":"1f635","%-)":"1f635","X-)":"1f635","\\0/":"1f646","\\O/":"1f646","0:3":"1f607","0:)":"1f607","O:)":"1f607","O=)":"1f607","O:3":"1f607","B-)":"1f60e","8-)":"1f60e","B-D":"1f60e","8-D":"1f60e","-_-":"1f611",">:\\":"1f615",">:/":"1f615",":-/":"1f615",":-.":"1f615",":-P":"1f61b",":Þ":"1f61b",":-b":"1f61b",":-O":"1f62e",O_O:"1f62e",">:O":"1f62e",":-X":"1f636",":-#":"1f636",":-)":"1f642","(y)":"1f44d","<3":"2764",":D":"1f603","=D":"1f603",";)":"1f609","*)":"1f609",";]":"1f609",";D":"1f609",":*":"1f618","=*":"1f618",":(":"1f61e",":[":"1f61e","=(":"1f61e",":@":"1f620",";(":"1f622","D:":"1f628",":$":"1f633","=$":"1f633","#)":"1f635","%)":"1f635","X)":"1f635","B)":"1f60e","8)":"1f60e",":/":"1f615",":\\":"1f615","=/":"1f615","=\\":"1f615",":L":"1f615","=L":"1f615",":P":"1f61b","=P":"1f61b",":b":"1f61b",":O":"1f62e",":X":"1f636",":#":"1f636","=X":"1f636","=#":"1f636",":)":"1f642","=]":"1f642","=)":"1f642",":]":"1f642"};function gu(e){if(e.indexOf("-")>-1){const t=[],n=e.split("-");for(let e=0;e<n.length;e++){let r=parseInt(n[e],16);if(r>=65536&&r<=1114111){const e=Math.floor((r-65536)/1024)+55296,t=(r-65536)%1024+56320;r=String.fromCharCode(e)+String.fromCharCode(t)}else r=String.fromCharCode(r);t.push(r)}return t.join("")}return function(e){let t="string"==typeof e?parseInt(e,16):e;return t<65536?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}(e)}function mu(){var e;return qc.emojis.toned||(qc.emojis.toned=(e=Object.values(qc.emojis.json.people).filter(e=>e.sn.includes("_tone")).map(e=>e.sn.replace(/_tone[1-5]/,"")),[...new Set(e)])),qc.emojis.toned}function vu(e){if(!qc.emojis.initialized)throw new Error("getShortnameReferences called before emojis are initialized. To avoid this problem, first await the converse.emojis.initilaized_promise.");return[...e.matchAll(qc.emojis.shortnames_regex)].filter(e=>e[0].length>0).map(e=>{const t=qc.emojis.by_sn[e[0]].cp;return{cp:t,begin:e.index,end:e.index+e[0].length,shortname:e[0],emoji:t?gu(t):null}})}function _u(e){const t=[];return function(e,t){const n=/\uFE0F/g,r=String.fromCharCode(8205);String(e).replace(cu,(e,i,o)=>{const s=function(e){const t=[];let n=0,r=0;for(;r<e.length;){const i=e.charCodeAt(r++);n?(t.push((65536+(n-55296<<10)+(i-56320)).toString(16)),n=0):55296<=i&&i<=56319?n=i:t.push(i.toString(16))}return t.join("-")}(e.indexOf(r)<0?e.replace(n,""):e);s&&t(s,e,o)})}(e,(e,n,r)=>{var i;t.push({begin:r,cp:e,emoji:n,end:r+n.length,shortname:(null===(i=hu.getEmojisByAtrribute("cp")[e])||void 0===i?void 0:i.sn)||""})}),t}function yu(e,t){let n=[e];return[...vu(e),..._u(e)].sort((e,t)=>t.begin-e.begin).forEach(e=>{const r=n.shift(),i=function(e,t={unicode_only:!1,add_title_wrapper:!1}){const n=e.emoji,r=e.shortname;if(n){if(t.unicode_only)return n;if(Mc.settings.get("use_system_emojis"))return t.add_title_wrapper&&r?$a(lu(),r,n):n;{const t=Mc.settings.get("emoji_image_path");return $a(du(),r,n,t,e.cp)}}return t.unicode_only?r:$a(uu(),r,r,qc.emojis.by_sn[r].url)}(e,t);n="string"==typeof i?[r.slice(0,e.begin)+i+r.slice(e.end),...n]:[r.slice(0,e.begin),i,r.slice(e.end),...n]}),n}qc.plugins.add("converse-emoji",{initialize(){const{___:e}=Tc;Mc.settings.extend({emoji_image_path:"https://twemoji.maxcdn.com/v/12.1.6/",emoji_categories:{smileys:":grinning:",people:":thumbsup:",activity:":soccer:",travel:":motorcycle:",objects:":bomb:",nature:":rainbow:",food:":hotdog:",symbols:":musical_note:",flags:":flag_ac:",custom:null},emoji_category_labels:{smileys:e("Smileys and emotions"),people:e("People"),activity:e("Activities"),travel:e("Travel"),objects:e("Objects"),nature:e("Animals and nature"),food:e("Food and drink"),symbols:e("Symbols"),flags:e("Flags"),custom:e("Stickers")}}),Tc.EmojiPicker=Po.extend({defaults:{current_category:"smileys",current_skintone:"",scroll_position:0}});const t={};Object.assign(hu,{shortnamesToEmojis:(e,t={unicode_only:!1,add_title_wrapper:!1})=>yu(e=function(e){return e.replace(au,(e,t,n,r)=>{if(void 0===r||""===r||!(hu.unescapeHTML(r)in pu))return e;return r=hu.unescapeHTML(r),n+gu(pu[r].toUpperCase())})}(e),t),shortnamesToUnicode:e=>hu.shortnamesToEmojis(e,{unicode_only:!0})[0],isOnlyEmojis(e){const t=e.trim().split(/\s+/);return!(0===t.length||t.length>3)&&t.filter(e=>{const t=_u(hu.shortnamesToUnicode(e));return 1===t.length&&(e===t[0].shortname||e===t[0].emoji)}).length===t.length},getEmojisByAtrribute(e){if(t[e])return t[e];if("category"===e)return qc.emojis.json;const n=qc.emojis.list.map(t=>t[e]).filter((e,t,n)=>n.indexOf(e)==t);return t[e]={},n.forEach(n=>t[e][n]=qc.emojis.list.find(t=>t[e]===n)),t[e]}}),Object.assign(Mc,{emojis:{async initialize(){if(!qc.emojis.initialized){qc.emojis.initialized=!0;const{default:e}=await n.e(0).then(n.t.bind(null,323,3));qc.emojis.json=e,qc.emojis.by_sn=Object.keys(e).reduce((t,n)=>Object.assign(t,e[n]),{}),qc.emojis.list=Object.values(qc.emojis.by_sn),qc.emojis.list.sort((e,t)=>e.sn<t.sn?-1:e.sn>t.sn?1:0),qc.emojis.shortnames=qc.emojis.list.map(e=>e.sn);const t=()=>qc.emojis.shortnames.map(e=>e.replace(/[+]/g,"\\$&")).join("|");qc.emojis.shortnames_regex=new RegExp(t(),"gi"),qc.emojis.toned=mu(),qc.emojis.initialized_promise.resolve()}return qc.emojis.initialized_promise}}})}});var bu=function(e,t,n){for(var r=-1,i=e.length,o=t.length,s={};++r<i;){var a=r<o?t[r]:void 0;n(s,e[r],a)}return s};var wu=function(e,t){return bu(e||[],t||[],ye)},Su=Math.min;var xu=function(e,t,n){for(var r=n?ws:bs,i=e[0].length,o=e.length,s=o,a=Array(o),c=1/0,u=[];s--;){var d=e[s];s&&t&&(d=Lr(d,De(t))),c=Su(d.length,c),a[s]=!n&&(t||i>=120&&d.length>=120)?new $i(s&&d):void 0}d=e[0];var l=-1,f=a[0];e:for(;++l<i&&u.length<c;){var h=d[l],p=t?t(h):h;if(h=n||0!==h?h:0,!(f?Ji(f,p):r(u,p,n))){for(s=o;--s;){var g=a[s];if(!(g?Ji(g,p):r(e[s],p,n)))continue e}f&&f.push(p),u.push(h)}}return u};var Eu=function(e){return xs(e)?e:[]},Au=xr((function(e){var t=Lr(e,Eu);return t.length&&t[0]===e[0]?xu(t):[]}));
/**
 * @copyright The Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 * @description This is the MUC utilities module.
 */
const{Strophe:Nu,sizzle:Ou}=qc.env;var ju={computeAffiliationsDelta(e,t,n,r){const i=n.map(e=>e.jid),o=r.map(e=>e.jid);let s=Es(i,o).map(e=>n[Ps(i,e)]);return e||(s=s.concat(n.filter(e=>{const t=Ps(o,e.jid);return t>=0&&e.affiliation!==r[t].affiliation}))),t&&(s=s.concat(Es(o,i).map(e=>({jid:e,affiliation:"none"})))),s},parseMemberListIQ:e=>Ou('query[xmlns="'.concat(Nu.NS.MUC_ADMIN,'"] item'),e).map(e=>{const t={affiliation:e.getAttribute("affiliation")},n=e.getAttribute("jid");qo.isValidJID(n)?t.jid=n:t.nick=n;const r=e.getAttribute("nick");return r&&(t.nick=r),e.getAttribute("role")&&(t.role=r),t})};
/**
 * @copyright 2020, the Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 * @description This is the form utilities module.
 */qo.webForm2xForm=function(e){const t=e.getAttribute("name");if(!t)return null;let n;return n="checkbox"===e.getAttribute("type")?e.checked?1:0:"TEXTAREA"==e.tagName?e.value.split("\n").filter(e=>e.trim()):"SELECT"==e.tagName?qo.getSelectValues(e):e.value,qo.toStanza('\n        <field var="'.concat(t,'">\n            ').concat(n.constructor===Array?n.map(e=>"<value>".concat(e,"</value>")):"<value>".concat(n,"</value>"),"\n        </field>"))};var Tu=qo;function Cu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Iu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cu(Object(n),!0).forEach((function(t){Ru(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ru(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/**
 * @copyright 2020, the Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 * @description Pure functions to help funcitonally parse messages.
 * @todo Other parsing helpers can be made more abstract and placed here.
 */const Mu={mention_regex:/(?:\s|^)([@][\w_-]+(?:\.\w+)*)/gi,matchRegexInText:e=>t=>e.matchAll(t)},ku=(e,t)=>e.replace(RegExp("\\"+t,"ig"),"\\"+t);Mu.escapeCharacters=e=>t=>e.split("").reduce(ku,t),Mu.escapeRegexString=Mu.escapeCharacters("[\\^$.?*+(){}"),Mu.findFirstMatchInArray=e=>t=>{for(let n=0;n<e.length;n++)if(0===t.localeCompare(e[n],void 0,{sensitivity:"base"}))return e[n];return null};const Du=([e,t],n,r)=>{let i=e,{begin:o,end:s}=n;const{value:a}=n;return o-=r,s=s-r-1,i="".concat(i.slice(0,o)).concat(a).concat(i.slice(s+1)),[i,[...t,Iu(Iu({},n),{},{begin:o,end:s})]]};Mu.reduceTextFromReferences=(e,t)=>t.reduce(Du,[e,[]]);var Pu=Mu;function Lu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/**
 * @module converse-muc
 * @copyright The Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 * @description Implements the non-view logic for XEP-0045 Multi-User Chat
 */qc.MUC_TRAFFIC_STATES=["entered","exited"],qc.MUC_ROLE_CHANGES=["op","deop","voice","mute"];const Uu=["301","303","333","307","321","322"],zu={moderator:1,participant:2,visitor:3,none:2},{Strophe:Bu,$iq:Hu,$build:qu,$msg:$u,$pres:Wu,sizzle:Ju}=qc.env;Bu.addNamespace("MUC_ADMIN",Bu.NS.MUC+"#admin"),Bu.addNamespace("MUC_OWNER",Bu.NS.MUC+"#owner"),Bu.addNamespace("MUC_REGISTER","jabber:iq:register"),Bu.addNamespace("MUC_ROOMCONF",Bu.NS.MUC+"#roomconfig"),Bu.addNamespace("MUC_USER",Bu.NS.MUC+"#user"),Bu.addNamespace("MUC_HATS","xmpp:prosody.im/protocol/hats:1"),qc.MUC_NICK_CHANGED_CODE="303",qc.ROOM_FEATURES=["passwordprotected","unsecured","hidden","publicroom","membersonly","open","persistent","temporary","nonanonymous","semianonymous","moderated","unmoderated","mam_enabled"],qc.ROOMSTATUS={CONNECTED:0,CONNECTING:1,NICKNAME_REQUIRED:2,PASSWORD_REQUIRED:3,DISCONNECTED:4,ENTERED:5,DESTROYED:6},qc.plugins.add("converse-muc",{dependencies:["converse-chatboxes","converse-chat","converse-disco","converse-controlbox"],overrides:{ChatBoxes:{model(e,t){const{_converse:n}=this.__super__;return e&&e.type==n.CHATROOMS_TYPE?new n.ChatRoom(e,t):this.__super__.model.apply(this,arguments)}}},initialize(){const{__:e,___:t}=Tc;if(Mc.settings.extend({allow_muc:!0,allow_muc_invitations:!0,auto_join_on_invite:!1,auto_join_rooms:[],auto_register_muc_nickname:!1,hide_muc_participants:!1,locked_muc_domain:!1,muc_domain:void 0,muc_fetch_members:!0,muc_history_max_stanzas:void 0,muc_instant_rooms:!0,muc_nickname_from_jid:!1,muc_send_probes:!1,muc_show_join_leave:!0,muc_show_logs_before_join:!1}),Mc.promises.add(["roomsAutoJoined"]),Mc.settings.get("locked_muc_domain")&&"string"!=typeof Mc.settings.get("muc_domain"))throw new Error("Config Error: it makes no sense to set locked_muc_domain to true when muc_domain is not set");Tc.muc={info_messages:{100:e("This groupchat is not anonymous"),102:e("This groupchat now shows unavailable members"),103:e("This groupchat does not show unavailable members"),104:e("The groupchat configuration has changed"),170:e("Groupchat logging is now enabled"),171:e("Groupchat logging is now disabled"),172:e("This groupchat is now no longer anonymous"),173:e("This groupchat is now semi-anonymous"),174:e("This groupchat is now fully-anonymous"),201:e("A new groupchat has been created")},new_nickname_messages:{210:t("Your nickname has been automatically set to %1$s"),303:t("Your nickname has been changed to %1$s")},disconnect_messages:{301:e("You have been banned from this groupchat"),333:e("You have exited this groupchat due to a technical problem"),307:e("You have been kicked from this groupchat"),321:e("You have been removed from this groupchat because of an affiliation change"),322:e("You have been removed from this groupchat because the groupchat has changed to members-only and you're not a member"),332:e("You have been removed from this groupchat because the service hosting it is being shut down")}},Tc.router.route("converse/room?jid=:jid",(async function(e){if(!Tu.isValidMUCJID(e))return kn.warn('invalid jid "'.concat(e,'" provided in url fragment'));await Mc.waitUntil("roomsAutoJoined"),Mc.settings.get("allow_bookmarks")&&await Mc.waitUntil("bookmarksInitialized"),Mc.rooms.open(e)})),Tc.getDefaultMUCNickname=function(){if(!Tc.xmppstatus)throw new Error("Can't call _converse.getDefaultMUCNickname before the statusInitialized has been fired.");const e=Tc.xmppstatus.getNickname();return e||(Mc.settings.get("muc_nickname_from_jid")?Bu.unescapeNode(Bu.getNodeFromJid(Tc.bare_jid)):void 0)},Tc.ChatRoomMessage=Tc.Message.extend({initialize(){this.checkValidity()&&(this.get("file")&&this.on("change:put",this.uploadFile,this),this.setTimerForEphemeralMessage()||this.setOccupant(),Mc.trigger("chatRoomMessageInitialized",this))},mayBeModerated(){return["all","moderator"].includes(Mc.settings.get("allow_message_retraction"))&&this.collection.chatbox.canModerateMessages()},checkValidity(){const e=Tc.Message.prototype.checkValidity.call(this);return!e&&this.collection.chatbox.debouncedRejoin(),e},onOccupantRemoved(){var e;this.stopListening(this.occupant),delete this.occupant;const t=null==this||null===(e=this.collection)||void 0===e?void 0:e.chatbox;if(!t)return kn.error("Could not get collection.chatbox for message: ".concat(JSON.stringify(this.toJSON())));this.listenTo(t.occupants,"add",this.onOccupantAdded)},onOccupantAdded(e){if(e.get("nick")===Bu.getResourceFromJid(this.get("from"))){var t;this.occupant=e,this.trigger("occupantAdded"),this.listenTo(this.occupant,"destroy",this.onOccupantRemoved);const n=null==this||null===(t=this.collection)||void 0===t?void 0:t.chatbox;if(!n)return kn.error("Could not get collection.chatbox for message: ".concat(JSON.stringify(this.toJSON())));this.stopListening(n.occupants,"add",this.onOccupantAdded)}},setOccupant(){var e;if("groupchat"!==this.get("type"))return;const t=null==this||null===(e=this.collection)||void 0===e?void 0:e.chatbox;if(!t)return kn.error("Could not get collection.chatbox for message: ".concat(JSON.stringify(this.toJSON())));const n=Bu.getResourceFromJid(this.get("from"));if(this.occupant=t.occupants.findWhere({nick:n}),!this.occupant&&Mc.settings.get("muc_send_probes")){this.occupant=t.occupants.create({nick:n,type:"unavailable"});const e="".concat(t.get("jid"),"/").concat(n);Mc.user.presence.send("probe",e)}this.occupant?this.listenTo(this.occupant,"destroy",this.onOccupantRemoved):this.listenTo(t.occupants,"add",this.onOccupantAdded)}});const n=Po.extend({defaults:()=>({connection_status:qc.ROOMSTATUS.DISCONNECTED})});if(Tc.ChatRoomMessages=Qs.extend({model:Tc.ChatRoomMessage,comparator:"time"}),Tc.ChatRoom=Tc.ChatBox.extend({messagesCollection:Tc.ChatRoomMessages,defaults(){return{num_unread_general:0,bookmarked:!1,chat_state:void 0,hidden:Tc.isUniView()&&!Mc.settings.get("singleton"),hidden_occupants:!!Mc.settings.get("hide_muc_participants"),message_type:"groupchat",name:"",num_unread:0,roomconfig:{},time_opened:this.get("time_opened")||(new Date).getTime(),time_sent:new Date(0).toISOString(),type:Tc.CHATROOMS_TYPE}},async initialize(){this.initialized=Tu.getResolveablePromise(),this.debouncedRejoin=wc(this.rejoin,250),this.set("box_id","box-".concat(this.get("jid"))),this.initNotifications(),this.initMessages(),this.initOccupants(),this.initDiscoModels(),this.registerHandlers(),this.on("change:chat_state",this.sendChatState,this),await this.restoreSession(),this.session.on("change:connection_status",this.onConnectionStatusChanged,this),this.listenTo(this.occupants,"add",this.onOccupantAdded),this.listenTo(this.occupants,"remove",this.onOccupantRemoved),this.listenTo(this.occupants,"change:show",this.onOccupantShowChanged),this.listenTo(this.occupants,"change:affiliation",this.createAffiliationChangeMessage),this.listenTo(this.occupants,"change:role",this.createRoleChangeMessage),await this.restoreFromCache()||this.join(),await Mc.trigger("chatRoomInitialized",this,{Synchronous:!0}),this.initialized.resolve()},async restoreFromCache(){return this.session.get("connection_status")===qc.ROOMSTATUS.ENTERED&&await this.isJoined()?(await new Promise(e=>this.features.fetch({success:e,error:e})),await this.fetchOccupants().catch(e=>kn.error(e)),await this.fetchMessages().catch(e=>kn.error(e)),!0):(await this.clearCache(),!1)},async join(e,t){if(this.session.get("connection_status")===qc.ROOMSTATUS.ENTERED)return this;if(await this.refreshDiscoInfo(),!(e=await this.getAndPersistNickname(e)))return Tu.safeSave(this.session,{connection_status:qc.ROOMSTATUS.NICKNAME_REQUIRED}),Mc.settings.get("muc_show_logs_before_join")&&await this.fetchMessages(),this;const n=Wu({from:Tc.connection.jid,to:this.getRoomJIDAndNick()}).c("x",{xmlns:Bu.NS.MUC}).c("history",{maxstanzas:this.features.get("mam_enabled")?0:Mc.settings.get("muc_history_max_stanzas")}).up();return(t=t||this.get("password"))&&n.cnode(Bu.xmlElement("password",[],t)),this.session.save("connection_status",qc.ROOMSTATUS.CONNECTING),Mc.send(n),this},async clearCache(){this.session.save("connection_status",qc.ROOMSTATUS.DISCONNECTED),this.occupants.length?this.occupants.filter(e=>!e.isMember()).forEach(e=>e.destroy()):this.occupants.clearStore(),Mc.settings.get("clear_messages_on_reconnection")&&await this.clearMessages()},onOccupantAdded(e){Mc.settings.get("muc_show_join_leave")&&this.session.get("connection_status")===qc.ROOMSTATUS.ENTERED&&"online"===e.get("show")&&this.updateNotifications(e.get("nick"),"entered")},onOccupantRemoved(e){Mc.settings.get("muc_show_join_leave")&&this.session.get("connection_status")===qc.ROOMSTATUS.ENTERED&&"online"===e.get("show")&&this.updateNotifications(e.get("nick"),"exited")},onOccupantShowChanged(e){!e.get("states").includes("303")&&Mc.settings.get("muc_show_join_leave")&&("offline"===e.get("show")?this.updateNotifications(e.get("nick"),"exited"):"online"===e.get("show")&&this.updateNotifications(e.get("nick"),"entered"))},rejoin(){return this.clearCache(),this.join()},async onConnectionStatusChanged(){this.session.get("connection_status")===qc.ROOMSTATUS.ENTERED&&(await this.occupants.fetchMembers(),await this.fetchMessages(),Mc.trigger("enteredNewRoom",this),Mc.settings.get("auto_register_muc_nickname")&&await Mc.disco.supports(Bu.NS.MUC_REGISTER,this.get("jid"))&&this.registerNickname())},async onReconnection(){this.registerHandlers(),await this.rejoin(),this.announceReconnection()},restoreSession(){const e="muc.session-".concat(Tc.bare_jid,"-").concat(this.get("jid"));return this.session=new n({id:e}),this.session.browserStorage=Tc.createStore(e,"session"),new Promise(e=>this.session.fetch({success:e,error:e}))},initDiscoModels(){let e="converse.muc-features-".concat(Tc.bare_jid,"-").concat(this.get("jid"));this.features=new Po(Object.assign({id:e},wu(qc.ROOM_FEATURES,qc.ROOM_FEATURES.map(()=>!1)))),this.features.browserStorage=Tc.createStore(e,"session"),e="converse.muc-config-{_converse.bare_jid}-".concat(this.get("jid")),this.config=new Po,this.config.browserStorage=Tc.createStore(e,"session")},initOccupants(){this.occupants=new Tc.ChatRoomOccupants;const e="converse.occupants-".concat(Tc.bare_jid).concat(this.get("jid"));this.occupants.browserStorage=Tc.createStore(e,"session"),this.occupants.chatroom=this},fetchOccupants(){return this.occupants.fetched=new Promise(e=>{this.occupants.fetch({add:!0,silent:!0,success:e,error:e})}),this.occupants.fetched},handleAffiliationChangedMessage(e){const t=Ju('x[xmlns="'.concat(Bu.NS.MUC_USER,'"] item'),e).pop();if(t){const n=e.getAttribute("from"),r=e.getAttribute("type"),i=t.getAttribute("affiliation"),o=t.getAttribute("jid"),s={from:n,type:r,affiliation:i,nick:Bu.getNodeFromJid(o),states:[],show:"unavailable"==r?"offline":"online",role:t.getAttribute("role"),jid:Bu.getBareJidFromJid(o),resource:Bu.getResourceFromJid(o)},a=this.occupants.findOccupant({jid:s.jid});a?a.save(s):this.occupants.create(s)}},async handleErrorMessageStanza(t){const n=await us.parseMUCMessage(t,this,Tc);if(!await this.shouldShowErrorMessage(n))return;const r=this.getMessageReferencedByError(n);if(r){const t={error:n.error,error_condition:n.error_condition,error_text:n.error_text,error_type:n.error_type,editable:!1};n.msgid===r.get("retraction_id")?(t.retraction_id=void 0,n.error||("forbidden"===n.error_condition?t.error=e("You're not allowed to retract your message."):"not-acceptable"===n.error_condition?t.error=e("Your retraction was not delivered because you're not present in the groupchat."):t.error=e("Sorry, an error occurred while trying to retract your message."))):n.error||("forbidden"===n.error_condition?t.error=e("Your message was not delivered because you weren't allowed to send it."):"not-acceptable"===n.error_condition?t.error=e("Your message was not delivered because you're not present in the groupchat."):t.error=e("Sorry, an error occurred while trying to send your message.")),r.save(t)}else this.createMessage(n)},async handleMessageStanza(e){if(us.isArchived(e))return kn.warn('Received a MAM message with type "groupchat"');this.createInfoMessages(e),this.fetchFeaturesIfConfigurationChanged(e);const t=await us.parseMUCMessage(e,this,Tc),n={stanza:e,attrs:t,chatbox:this};return Mc.trigger("message",n),t&&this.queueMessage(t)},registerHandlers(){const e=this.get("jid");this.removeHandlers(),this.presence_handler=Tc.connection.addHandler(e=>this.onPresence(e)||!0,null,"presence",null,null,e,{ignoreNamespaceFragment:!0,matchBareFromJid:!0}),this.message_handler=Tc.connection.addHandler(e=>!!this.handleMessageStanza(e)||!0,null,"message","groupchat",null,e,{matchBareFromJid:!0}),this.affiliation_message_handler=Tc.connection.addHandler(e=>this.handleAffiliationChangedMessage(e)||!0,Bu.NS.MUC_USER,"message",null,null,e)},removeHandlers(){return this.message_handler&&(Tc.connection&&Tc.connection.deleteHandler(this.message_handler),delete this.message_handler),this.presence_handler&&(Tc.connection&&Tc.connection.deleteHandler(this.presence_handler),delete this.presence_handler),this.affiliation_message_handler&&(Tc.connection&&Tc.connection.deleteHandler(this.affiliation_message_handler),delete this.affiliation_message_handler),this},invitesAllowed(){return Mc.settings.get("allow_muc_invitations")&&(this.features.get("open")||"owner"===this.getOwnAffiliation())},getDisplayName(){const e=this.get("name");return e||("hidden"===Mc.settings.get("locked_muc_domain")?Bu.getNodeFromJid(this.get("jid")):this.get("jid"))},sendTimedMessage(e){"function"==typeof e.tree&&(e=e.tree());let t=e.getAttribute("id");t||(t=this.getUniqueId("sendIQ"),e.setAttribute("id",t));const n=Tu.getResolveablePromise(),r=Tc.connection.addTimedHandler(Tc.STANZA_TIMEOUT,()=>(Tc.connection.deleteHandler(i),n.reject(new Tc.TimeoutError("Timeout Error: No response from server")),!1)),i=Tc.connection.addHandler(e=>{r&&Tc.connection.deleteTimedHandler(r),"groupchat"===e.getAttribute("type")?n.resolve(e):n.reject(e)},null,"message",["error","groupchat"],t);return Mc.send(e),n},async retractOwnMessage(t){const n=t.get("origin_id");if(!n)throw new Error("Can't retract message without a XEP-0359 Origin ID");const r=t.get("editable"),i=$u({id:Tu.getUniqueId(),to:this.get("jid"),type:"groupchat"}).c("store",{xmlns:Bu.NS.HINTS}).up().c("apply-to",{id:n,xmlns:Bu.NS.FASTEN}).c("retract",{xmlns:Bu.NS.RETRACT});t.set({retracted:(new Date).toISOString(),retracted_id:n,retraction_id:i.nodeTree.getAttribute("id"),editable:!1});try{await this.sendTimedMessage(i)}catch(n){throw t.save({editable:r,error_type:"timeout",error:e("A timeout happened while while trying to retract your message."),retracted:void 0,retracted_id:void 0}),n}},async retractOtherMessage(e,t){const n=e.get("editable");e.save({moderated:"retracted",moderated_by:Tc.bare_jid,moderated_id:e.get("msgid"),moderation_reason:t,editable:!1});const r=await this.sendRetractionIQ(e,t);return(null===r||Tu.isErrorStanza(r))&&e.save({editable:n,moderated:void 0,moderated_by:void 0,moderated_id:void 0,moderation_reason:void 0}),r},sendRetractionIQ(e,t){const n=Hu({to:this.get("jid"),type:"set"}).c("apply-to",{id:e.get("stanza_id ".concat(this.get("jid"))),xmlns:Bu.NS.FASTEN}).c("moderate",{xmlns:Bu.NS.MODERATE}).c("retract",{xmlns:Bu.NS.RETRACT}).up().c("reason").t(t||"");return Mc.sendIQ(n,null,!1)},sendDestroyIQ(e,t){const n=qu("destroy");t&&n.attrs({jid:t});const r=Hu({to:this.get("jid"),type:"set"}).c("query",{xmlns:Bu.NS.MUC_OWNER}).cnode(n.node);return e&&e.length>0&&r.c("reason",e),Mc.sendIQ(r)},async leave(e){if(this.features.destroy(),this.occupants.clearStore(),Tc.disco_entities){const e=Tc.disco_entities.get(this.get("jid"));e&&await new Promise((t,n)=>e.destroy({success:t,error:n}))}Mc.connection.connected()&&Mc.user.presence.send("unavailable",this.getRoomJIDAndNick(),e),Tu.safeSave(this.session,{connection_status:qc.ROOMSTATUS.DISCONNECTED}),this.removeHandlers()},async close(){return await new Promise(e=>this.session.destroy({success:e,error:(t,n)=>{kn.error(n),e()}})),await new Promise(e=>this.features.destroy({success:e,error:(t,n)=>{kn.error(n),e()}})),Tc.ChatBox.prototype.close.call(this)},canModerateMessages(){const e=this.getOwnOccupant();return e&&e.isModerator()&&Mc.disco.supports(Bu.NS.MODERATE,this.get("jid"))},getAllKnownNicknames(){return[...new Set([...this.occupants.map(e=>e.get("nick")),...this.messages.map(e=>e.get("nick"))])].filter(e=>e)},getAllKnownNicknamesRegex(){const e=this.getAllKnownNicknames().join("|"),t=Pu.escapeRegexString(e);return RegExp("(?:\\s|^)@(".concat(t,")(?![\\w@-])"),"ig")},getOccupantByJID(e){return this.occupants.findOccupant({jid:e})},getOccupantByNickname(e){return this.occupants.findOccupant({nick:e})},parseTextForReferences(e){if(!e)return["",[]];const t=Pu.matchRegexInText(e);if(!t(Pu.mention_regex))return[e,[]];const n=this.getAllKnownNicknames(),r=Pu.findFirstMatchInArray(n),i=e=>{const t=this.get("jid"),n=this.getOccupant(e)||this.getOccupant(t),r=n&&n.get("jid")||"".concat(t,"/").concat(e);return encodeURI("xmpp:".concat(r))},o=[...t(this.getAllKnownNicknamesRegex())].map(e=>{const t=e[0].indexOf("@"),n=e.index+t,o=n+e[0].length-t,s=r(e[1]);return{begin:n,end:o,value:s,type:"mention",uri:i(s)}}),[s,a]=Pu.reduceTextFromReferences(e,o);return[s,a]},getOutgoingMessageAttributes(e,t){const n=this.get("composing_spoiler"),[r,i]=this.parseTextForReferences(e),o=Tu.getUniqueId(),s=r?Tu.httpToGeoUri(Tu.shortnamesToUnicode(r),Tc):void 0;return{body:s,is_spoiler:n,origin_id:o,references:i,id:o,msgid:o,from:"".concat(this.get("jid"),"/").concat(this.get("nick")),fullname:this.get("nick"),is_only_emojis:!!r&&Tu.isOnlyEmojis(r),message:s,nick:this.get("nick"),sender:"me",spoiler_hint:n?t:void 0,type:"groupchat"}},getRoomJIDAndNick(){const e=this.get("nick");return Bu.getBareJidFromJid(this.get("jid"))+(null!==e?"/".concat(e):"")},sendChatState(){if(!Mc.settings.get("send_chat_state_notifications")||!this.get("chat_state")||this.session.get("connection_status")!==qc.ROOMSTATUS.ENTERED||this.features.get("moderated")&&"visitor"===this.getOwnRole())return;const e=Mc.settings.get("send_chat_state_notifications");if(Array.isArray(e)&&!e.includes(this.get("chat_state")))return;const t=this.get("chat_state");t!==Tc.GONE&&Mc.send($u({to:this.get("jid"),type:"groupchat"}).c(t,{xmlns:Bu.NS.CHATSTATES}).up().c("no-store",{xmlns:Bu.NS.HINTS}).up().c("no-permanent-store",{xmlns:Bu.NS.HINTS}))},directInvite(e,t){this.features.get("membersonly")&&this.updateMemberLists([{jid:e,affiliation:"member",reason:t}]);const n={xmlns:"jabber:x:conference",jid:this.get("jid")};null!==t&&(n.reason=t),this.get("password")&&(n.password=this.get("password"));const r=$u({from:Tc.connection.jid,to:e,id:Tu.getUniqueId()}).c("x",n);Mc.send(r),Mc.trigger("roomInviteSent",{room:this,recipient:e,reason:t})},refreshDiscoInfo(){return Mc.disco.refresh(this.get("jid")).then(()=>this.getDiscoInfo()).catch(e=>kn.error(e))},getDiscoInfo(){return Mc.disco.getIdentity("conference","text",this.get("jid")).then(e=>this.save({name:null==e?void 0:e.get("name")})).then(()=>this.getDiscoInfoFields()).then(()=>this.getDiscoInfoFeatures()).catch(e=>kn.error(e))},async getDiscoInfoFields(){const e=(await Mc.disco.getFields(this.get("jid"))).reduce((e,t)=>{const n=t.get("var");return n&&n.startsWith("muc#roominfo_")&&(e[n.replace("muc#roominfo_","")]=t.get("value")),e},{});this.config.save(e)},async getDiscoInfoFeatures(){const e=await Mc.disco.getFeatures(this.get("jid")),t=Object.assign(wu(qc.ROOM_FEATURES,qc.ROOM_FEATURES.map(()=>!1)),{fetched:(new Date).toISOString()});e.each(e=>{const n=e.get("var");n.startsWith("muc_")?t[n.replace("muc_","")]=!0:n===Bu.NS.MAM&&(t.mam_enabled=!0)}),this.features.save(t)},setAffiliation(e,t){return t=t.filter(t=>void 0===t.affiliation||t.affiliation===e),Promise.all(t.map(t=>this.sendAffiliationIQ(e,t)))},addFieldValue(e){const t=e.getAttribute("type");if("fixed"===t)return e;const n=e.getAttribute("var").replace("muc#roomconfig_",""),r=this.get("roomconfig");if(n in r){let i;switch(t){case"boolean":i=[r[n]?1:0];break;case"list-multi":i=r[n];break;default:i=[r[n]]}e.innerHTML=i.map(e=>qu("value").t(e)).join("")}return e},async autoConfigureChatRoom(){const e=await this.fetchRoomConfiguration(),t=Ju("field",e).map(e=>this.addFieldValue(e));if(t.length)return this.sendConfiguration(t)},fetchRoomConfiguration(){return Mc.sendIQ(Hu({to:this.get("jid"),type:"get"}).c("query",{xmlns:Bu.NS.MUC_OWNER}))},sendConfiguration(e=[]){const t=Hu({to:this.get("jid"),type:"set"}).c("query",{xmlns:Bu.NS.MUC_OWNER}).c("x",{xmlns:Bu.NS.XFORM,type:"submit"});return e.forEach(e=>t.cnode(e).up()),Mc.sendIQ(t)},getOwnRole(){var e,t;return null===(e=this.getOwnOccupant())||void 0===e||null===(t=e.attributes)||void 0===t?void 0:t.role},getOwnAffiliation(){var e,t;return null===(e=this.getOwnOccupant())||void 0===e||null===(t=e.attributes)||void 0===t?void 0:t.affiliation},getOwnOccupant(){return this.occupants.findWhere({jid:Tc.bare_jid})},sendAffiliationIQ(e,t){const n=Hu({to:this.get("jid"),type:"set"}).c("query",{xmlns:Bu.NS.MUC_ADMIN}).c("item",{affiliation:t.affiliation||e,nick:t.nick,jid:t.jid});return void 0!==t.reason&&n.c("reason",t.reason),Mc.sendIQ(n)},setAffiliations(e){const t=[...new Set(e.map(e=>e.affiliation))];return Promise.all(t.map(t=>this.setAffiliation(t,e)))},setRole(e,t,n,r,i){const o=qu("item",{nick:e.get("nick"),role:t}),s=Hu({to:this.get("jid"),type:"set"}).c("query",{xmlns:Bu.NS.MUC_ADMIN}).cnode(o.node);return null!==n&&s.c("reason",n),Mc.sendIQ(s).then(r).catch(i)},getOccupant(e){return Tu.isValidJID(e)?this.getOccupantByJID(e):this.getOccupantByNickname(e)},getOccupantsWithRole(e){return this.getOccupantsSortedBy("nick").filter(t=>t.get("role")===e).map(e=>({jid:e.get("jid"),nick:e.get("nick"),role:e.get("role")}))},getOccupantsWithAffiliation(e){return this.getOccupantsSortedBy("nick").filter(t=>t.get("affiliation")===e).map(e=>({jid:e.get("jid"),nick:e.get("nick"),affiliation:e.get("affiliation")}))},getOccupantsSortedBy(e){return Array.from(this.occupants.models).sort((t,n)=>t.get(e)<n.get(e)?-1:t.get(e)>n.get(e)?1:0)},async getAffiliationList(e){const t=Hu({to:this.get("jid"),type:"get"}).c("query",{xmlns:Bu.NS.MUC_ADMIN}).c("item",{affiliation:e}),n=await Mc.sendIQ(t,null,!1);if(null===n){const t="Error: timeout while fetching ".concat(e," list for MUC ").concat(this.get("jid")),r=new Error(t);return kn.warn(t),kn.warn(n),r}if(Tu.isErrorStanza(n)){const t="Error: not allowed to fetch ".concat(e," list for MUC ").concat(this.get("jid")),r=new Error(t);return kn.warn(t),kn.warn(n),r}return ju.parseMemberListIQ(n).filter(e=>e).sort((e,t)=>e.nick<t.nick?-1:e.nick>t.nick?1:0)},async updateMemberLists(e){const t=(await Promise.all(["member","admin","owner"].map(e=>this.getAffiliationList(e)))).reduce((e,t)=>Tu.isErrorObject(t)?e:[...t,...e],[]);await this.setAffiliations(ju.computeAffiliationsDelta(!0,!1,e,t)),await this.occupants.fetchMembers()},async getAndPersistNickname(e){return(e=e||this.get("nick")||await this.getReservedNick()||Tc.getDefaultMUCNickname())&&this.save({nick:e},{silent:!0}),e},async getReservedNick(){const e=Hu({to:this.get("jid"),from:Tc.connection.jid,type:"get"}).c("query",{xmlns:Bu.NS.DISCO_INFO,node:"x-roomuser-item"}),t=await Mc.sendIQ(e,null,!1);if(Tu.isErrorObject(t))throw t;const n=t.querySelector('query[node="x-roomuser-item"] identity');return n?n.getAttribute("name"):null},async registerNickname(){const t=this.get("nick"),n=this.get("jid");let r,i;try{r=await Mc.sendIQ(Hu({to:n,from:Tc.connection.jid,type:"get"}).c("query",{xmlns:Bu.NS.MUC_REGISTER}))}catch(t){return Ju('not-allowed[xmlns="'.concat(Bu.NS.STANZAS,'"]'),t).length?i=e("You're not allowed to register yourself in this groupchat."):Ju('registration-required[xmlns="'.concat(Bu.NS.STANZAS,'"]'),t).length&&(i=e("You're not allowed to register in this groupchat because it's members-only.")),kn.error(t),i}const o=Ju("field required",r).map(e=>e.parentElement);if(o.length>1&&"muc#register_roomnick"!==o[0].getAttribute("var"))return kn.error("Can't register the user register in the groupchat ".concat(n," due to the required fields"));try{await Mc.sendIQ(Hu({to:n,from:Tc.connection.jid,type:"set"}).c("query",{xmlns:Bu.NS.MUC_REGISTER}).c("x",{xmlns:Bu.NS.XFORM,type:"submit"}).c("field",{var:"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#register").up().up().c("field",{var:"muc#register_roomnick"}).c("value").t(t))}catch(t){return Ju('service-unavailable[xmlns="'.concat(Bu.NS.STANZAS,'"]'),t).length?i=e("Can't register your nickname in this groupchat, it doesn't support registration."):Ju('bad-request[xmlns="'.concat(Bu.NS.STANZAS,'"]'),t).length&&(i=e("Can't register your nickname in this groupchat, invalid data form supplied.")),kn.error(i),kn.error(t),i}},updateOccupantsOnPresence(e){var t,n;const r=us.parseMUCPresence(e);if("error"===r.type||!r.jid&&!r.nick)return!0;const i=this.occupants.findOccupant(r);if("unavailable"===r.type&&i&&!r.states.includes(qc.MUC_NICK_CHANGED_CODE)&&!["admin","owner","member"].includes(r.affiliation))return i.set(r),void i.destroy();const o=r.jid||"",s=Object.assign(r,{jid:Bu.getBareJidFromJid(o)||(null==i||null===(t=i.attributes)||void 0===t?void 0:t.jid),resource:Bu.getResourceFromJid(o)||(null==i||null===(n=i.attributes)||void 0===n?void 0:n.resource)});i?i.save(s):this.occupants.create(s)},fetchFeaturesIfConfigurationChanged(e){const t=["104","170","171","172","173","174"];Ju("status",e).filter(e=>t.includes(e.getAttribute("status"))).length&&this.refreshDiscoInfo()},isSameUser(e,t){const n=Bu.getBareJidFromJid(e),r=Bu.getBareJidFromJid(t),i=Bu.getResourceFromJid(e),o=Bu.getResourceFromJid(t);if(Tu.isSameBareJID(e,t))return n!==this.get("jid")||i===o;return(n===this.get("jid")?this.occupants.findOccupant({nick:i}):this.occupants.findOccupant({jid:n}))===(r===this.get("jid")?this.occupants.findOccupant({nick:o}):this.occupants.findOccupant({jid:r}))},async isSubjectHidden(){return(await Mc.user.settings.get("mucs_with_hidden_subject",[])).includes(this.get("jid"))},async toggleSubjectHiddenState(){const e=this.get("jid"),t=await Mc.user.settings.get("mucs_with_hidden_subject",[]);t.includes(this.get("jid"))?Mc.user.settings.set("mucs_with_hidden_subject",t.filter(t=>t!==e)):Mc.user.settings.set("mucs_with_hidden_subject",[...t,e])},async handleSubjectChange(t){if("string"==typeof t.subject&&!t.thread&&!t.message){const n=t.subject,r=t.nick;if(Tu.safeSave(this,{subject:{author:r,text:t.subject||""}}),!t.is_delayed&&r){const i=e(n?"Topic set by %1$s":"Topic cleared by %1$s",r),o=this.messages.last();(null==o?void 0:o.get("nick"))===t.nick&&"info"===(null==o?void 0:o.get("type"))&&(null==o?void 0:o.get("message"))===i||this.createMessage({message:i,nick:t.nick,type:"info"}),await this.isSubjectHidden()&&this.toggleSubjectHiddenState()}return!0}return!1},setSubject(e=""){Mc.send($u({to:this.get("jid"),from:Tc.connection.jid,type:"groupchat"}).c("subject",{xmlns:"jabber:client"}).t(e).tree())},ignorableCSN(e){return e.chat_state&&!e.body&&(e.is_delayed||this.isOwnMessage(e))},isOwnMessage(e){let t;return t=In(e)?e.getAttribute("from"):e instanceof Tc.Message?e.get("from"):e.from,Bu.getResourceFromJid(t)==this.get("nick")},getUpdatedMessageAttributes(e,t){const n=Tc.ChatBox.prototype.getUpdatedMessageAttributes.call(this,e,t);if(this.isOwnMessage(t)){const r=Object.keys(t).filter(e=>e.startsWith("stanza_id"));Object.assign(n,Do(t,r)),e.get("received")||(n.received=(new Date).toISOString())}return n},async isJoined(){const e=this.get("jid"),t=Hu({to:"".concat(e,"/").concat(this.get("nick")),type:"get"}).c("ping",{xmlns:Bu.NS.PING});try{await Mc.sendIQ(t)}catch(t){return null===t?kn.warn("isJoined: Timeout error while checking whether we're joined to MUC: ".concat(e)):kn.warn("isJoined: Apparently we're no longer connected to MUC: ".concat(e)),!1}return!0},async rejoinIfNecessary(){if(!await this.isJoined())return this.rejoin(),!0},async shouldShowErrorMessage(e){return("not-acceptable"!==e.error_condition||!await this.rejoinIfNecessary())&&Tc.ChatBox.prototype.shouldShowErrorMessage.call(this,e)},findDanglingModeration(e){if(!this.messages.length)return null;if(this.messages.last().get("time")>e.time){const t=Array.from(this.messages.models),n=e["stanza_id ".concat(this.get("jid"))];return n?(t.reverse(),t.find(({attributes:e})=>"retracted"===e.moderated&&e.moderated_id===n&&e.moderated_by)):null}},async handleModeration(e){const t=["editable","moderated","moderated_by","moderated_id","moderation_reason"];if("retracted"===e.moderated){const n={};n["stanza_id ".concat(this.get("jid"))]=e.moderated_id;const r=this.messages.findWhere(n);return r?(r.save(Do(e,t)),!0):(e.dangling_moderation=!0,await this.createMessage(e),!0)}{const n=this.findDanglingModeration(e);if(n){const r=Do(n.attributes,t),i=Object.assign({dangling_moderation:!1},e,r);return delete i.id,n.save(i),!0}}return!1},removeNotification(e,t){const n=this.notifications.toJSON();(t=Array.isArray(t)?t:[t]).forEach(t=>{const r=Array.from(n[t]||[]);if(r.includes(e)){const n=r.indexOf(e);r.splice(n,1),this.notifications.set(t,Array.from(r))}})},updateNotifications(e,t){const n=this.notifications.toJSON(),r=n[t]||[];if(r.includes(e))return;const i=(i,o)=>(i[o]=o===t?[...r,e]:(n[o]||[]).filter(t=>t!==e),i),o=qc.CHAT_STATES.reduce(i,{}),s=qc.MUC_TRAFFIC_STATES.reduce(i,{}),a=qc.MUC_ROLE_CHANGES.reduce(i,{});this.notifications.set(Object.assign(o,s,a)),window.setTimeout(()=>this.removeNotification(e,t),1e4)},async onMessage(e){if(e=await e,Tu.isErrorObject(e))return e.stanza&&kn.error(e.stanza),kn.error(e.message);const t=this.getDuplicateMessage(e);if(t)return this.updateMessage(t,e);if(!(e.is_valid_receipt_request||e.is_marker||this.ignorableCSN(e))){if(await this.handleRetraction(e)||await this.handleModeration(e)||await this.handleSubjectChange(e))return this.removeNotification(e.nick,["composing","paused"]);if(this.setEditable(e,e.time),e.chat_state&&this.updateNotifications(e.nick,e.chat_state),Tu.shouldCreateGroupchatMessage(e)){const t=this.handleCorrection(e)||await this.createMessage(e);this.removeNotification(e.nick,["composing","paused"]),this.handleUnreadMessage(t)}}},handleModifyError(e){var t;const n=null===(t=e.querySelector("error text"))||void 0===t?void 0:t.textContent;if(n)if(this.session.get("connection_status")===qc.ROOMSTATUS.CONNECTING)this.setDisconnectionMessage(n);else{const e={type:"error",message:n,is_ephemeral:!0};this.createMessage(e)}},handleDisconnection(e){var t;const n=null!==e.querySelector("status[code='110']"),r=Ju('x[xmlns="'.concat(Bu.NS.MUC_USER,'"]'),e).pop();if(!r)return;const i=Ju("status",r).map(e=>e.getAttribute("code")),o=Au(i,Object.keys(Tc.muc.disconnect_messages));if(!(n&&o.length>0))return;const s=r.querySelector("item"),a=s?null===(t=s.querySelector("reason"))||void 0===t?void 0:t.textContent:void 0,c=s?Sc(s.querySelector("actor"),"getAttribute","nick"):void 0,u=Tc.muc.disconnect_messages[o[0]];this.setDisconnectionMessage(u,a,c)},getActionInfoMessage:(t,n,r)=>"301"===t?r?e("%1$s has been banned by %2$s",n,r):e("%1$s has been banned",n):"303"===t?e("%1$s's nickname has changed",n):"307"===t?r?e("%1$s has been kicked out by %2$s",n,r):e("%1$s has been kicked out",n):"321"===t?e("%1$s has been removed because of an affiliation change",n):"322"===t?e("%1$s has been removed for not being a member",n):void 0,createAffiliationChangeMessage(t){const n=t._previousAttributes.affiliation;if(!n)return;const r=t.get("affiliation");"admin"===n?this.createMessage({type:"info",message:e("%1$s is no longer an admin of this groupchat",t.get("nick"))}):"owner"===n?this.createMessage({type:"info",message:e("%1$s is no longer an owner of this groupchat",t.get("nick"))}):"outcast"===n&&this.createMessage({type:"info",message:e("%1$s is no longer banned from this groupchat",t.get("nick"))}),"none"===r&&"member"===n&&this.createMessage({type:"info",message:e("%1$s is no longer a member of this groupchat",t.get("nick"))}),"member"===r?this.createMessage({type:"info",message:e("%1$s is now a member of this groupchat",t.get("nick"))}):"admin"!==r&&"owner"!=r||this.createMessage({type:"info",message:e("%1$s is now an %2$s of this groupchat",t.get("nick"),r)})},createRoleChangeMessage(e,t){if("none"===t||e.changed.affiliation)return;const n=e._previousAttributes.role;"moderator"===n?this.updateNotifications(e.get("nick"),"deop"):"visitor"===n&&this.updateNotifications(e.get("nick"),"voice"),"visitor"===e.get("role")?this.updateNotifications(e.get("nick"),"mute"):"moderator"===e.get("role")&&(["owner","admin"].includes(e.get("affiliation"))||this.updateNotifications(e.get("nick"),"op"))},createInfoMessage(t,n,r){const i={type:"info"};if("110"!==t&&("100"!==t||r)){if(t in Tc.muc.info_messages)i.message=Tc.muc.info_messages[t];else if(!r&&Uu.includes(t)){var o,s;const e=Bu.getResourceFromJid(n.getAttribute("from")),r=n.querySelector('x[xmlns="'.concat(Bu.NS.MUC_USER,'"] item'));i.actor=r?null===(o=r.querySelector("actor"))||void 0===o?void 0:o.getAttribute("nick"):void 0,i.reason=r?null===(s=r.querySelector("reason"))||void 0===s?void 0:s.textContent:void 0,i.message=this.getActionInfoMessage(t,e,i.actor)}else if(r&&t in Tc.muc.new_nickname_messages){let o;r&&"210"===t?o=Bu.getResourceFromJid(n.getAttribute("from")):r&&"303"===t&&(o=n.querySelector('x[xmlns="'.concat(Bu.NS.MUC_USER,'"] item')).getAttribute("nick")),this.save("nick",o),i.message=e(Tc.muc.new_nickname_messages[t],o)}if(i.message){if("201"===t&&this.messages.findWhere(i))return;if(t in Tc.muc.info_messages&&this.messages.length&&this.messages.pop().get("message")===i.message)return;this.createMessage(i)}}},createInfoMessages(e){const t=Ju('x[xmlns="'.concat(Bu.NS.MUC_USER,'"] status'),e).map(e=>e.getAttribute("code"));t.includes("333")&&t.includes("307")&&t.splice(t.indexOf("307"),1);const n=t.includes("110");t.forEach(t=>this.createInfoMessage(t,e,n))},setDisconnectionMessage(e,t,n){this.save({disconnection_message:e,disconnection_reason:t,disconnection_actor:n}),this.session.save({connection_status:qc.ROOMSTATUS.DISCONNECTED})},onNicknameClash(t){if(Mc.settings.get("muc_nickname_from_jid")){const e=t.getAttribute("from").split("/")[1];if(e===Tc.getDefaultMUCNickname())this.join(e+"-2");else{const t=e.lastIndexOf("-"),n=e.substring(t+1,e.length);this.join(e.substring(0,t+1)+String(Number(n)+1))}}else this.save({nickname_validation_message:e("The nickname you chose is reserved or currently in use, please choose a different one.")}),this.session.save({connection_status:qc.ROOMSTATUS.NICKNAME_REQUIRED})},onErrorPresence(t){var n;const r=t.querySelector("error"),i=r.getAttribute("type"),o=null===(n=Ju('text[xmlns="'.concat(Bu.NS.STANZAS,'"]'),r).pop())||void 0===n?void 0:n.textContent;if("modify"===i)this.handleModifyError(t);else if("auth"===i){if(Ju('not-authorized[xmlns="'.concat(Bu.NS.STANZAS,'"]'),r).length&&(this.save({password_validation_message:o||e("Password incorrect")}),this.session.save({connection_status:qc.ROOMSTATUS.PASSWORD_REQUIRED})),r.querySelector("registration-required")){const t=e("You are not on the member list of this groupchat.");this.setDisconnectionMessage(t,o)}else if(r.querySelector("forbidden")){const t=e("You have been banned from this groupchat.");this.setDisconnectionMessage(t,o)}}else if("cancel"===i)if(r.querySelector("not-allowed")){const t=e("You are not allowed to create new groupchats.");this.setDisconnectionMessage(t,o)}else if(r.querySelector("not-acceptable")){const t=e("Your nickname doesn't conform to this groupchat's policies.");this.setDisconnectionMessage(t,o)}else if(Ju('gone[xmlns="'.concat(Bu.NS.STANZAS,'"]'),r).length){var s;const e=null===(s=Ju('gone[xmlns="'.concat(Bu.NS.STANZAS,'"]'),r).pop())||void 0===s?void 0:s.textContent.replace(/^xmpp:/,"").replace(/\?join$/,"");this.save({moved_jid:e,destroyed_reason:o}),this.session.save({connection_status:qc.ROOMSTATUS.DESTROYED})}else if(r.querySelector("conflict"))this.onNicknameClash(t);else if(r.querySelector("item-not-found")){const t=e("This groupchat does not (yet) exist.");this.setDisconnectionMessage(t,o)}else if(r.querySelector("service-unavailable")){const t=e("This groupchat has reached its maximum number of participants.");this.setDisconnectionMessage(t,o)}else if(r.querySelector("remote-server-not-found")){const t=e("Remote server not found"),n=o?e('The explanation given is: "%1$s".',o):void 0;this.setDisconnectionMessage(t,n)}},onPresence(e){if("error"===e.getAttribute("type"))return this.onErrorPresence(e);this.createInfoMessages(e),e.querySelector("status[code='110']")?(this.onOwnPresence(e),"none"!==this.getOwnRole()&&this.session.get("connection_status")===qc.ROOMSTATUS.CONNECTING&&this.session.save("connection_status",qc.ROOMSTATUS.CONNECTED)):this.updateOccupantsOnPresence(e)},onOwnPresence(e){if("unavailable"!==e.getAttribute("type")){const t=this.session.get("connection_status");t!==qc.ROOMSTATUS.ENTERED?(this.session.save("connection_status",qc.ROOMSTATUS.ENTERED,{silent:!0}),this.updateOccupantsOnPresence(e),this.session.trigger("change:connection_status",this.session,t)):this.updateOccupantsOnPresence(e)}else this.updateOccupantsOnPresence(e);if("unavailable"===e.getAttribute("type"))this.handleDisconnection(e);else{if(e.querySelector("status[code='201']"))if(this.get("auto_configure"))this.autoConfigureChatRoom().then(()=>this.refreshDiscoInfo());else{if(!Mc.settings.get("muc_instant_rooms"))return void this.trigger("configurationNeeded");this.sendConfiguration().then(()=>this.refreshDiscoInfo())}else this.features.get("fetched")||("owner"===this.getOwnAffiliation()&&this.get("auto_configure")?this.autoConfigureChatRoom().then(()=>this.refreshDiscoInfo()):this.getDiscoInfo())}this.session.save({connection_status:qc.ROOMSTATUS.ENTERED})},isUserMentioned(e){const t=this.get("nick");if(e.get("references").length){return e.get("references").filter(e=>"mention"===e.type).map(e=>e.value).includes(t)}return new RegExp("\\b".concat(t,"\\b")).test(e.get("message"))},handleUnreadMessage(e){if((null==e?void 0:e.get("body"))&&Tu.isNewMessage(e))if(this.isHidden()){const t={num_unread_general:this.get("num_unread_general")+1};0===this.get("num_unread_general")&&(t.first_unread_id=e.get("id")),this.isUserMentioned(e)&&(t.num_unread=this.get("num_unread")+1),this.save(t)}else this.sendMarkerForMessage(e)},clearUnreadMsgCounter(){(this.get("num_unread_general")>0||this.get("num_unread")>0)&&this.sendMarkerForMessage(this.messages.last()),Tu.safeSave(this,{num_unread:0,num_unread_general:0})}}),Tc.ChatRoomOccupant=Po.extend({defaults:{hats:[],show:"offline",states:[]},initialize(e){this.set(Object.assign({id:Tu.getUniqueId()},e)),this.on("change:image_hash",this.onAvatarChanged,this)},onAvatarChanged(){const e=this.get("image_hash"),t=[];this.get("jid")&&t.push(Tc.vcards.findWhere({jid:this.get("jid")})),t.push(Tc.vcards.findWhere({jid:this.get("from")})),t.filter(e=>e).forEach(t=>{e&&t.get("image_hash")!==e&&Mc.vcard.update(t,!0)})},getDisplayName(){return this.get("nick")||this.get("jid")},isMember(){return["admin","owner","member"].includes(this.get("affiliation"))},isModerator(){return["admin","owner"].includes(this.get("affiliation"))||"moderator"===this.get("role")},isSelf(){return this.get("states").includes("110")}}),Tc.ChatRoomOccupants=Qs.extend({model:Tc.ChatRoomOccupant,comparator(e,t){const n=e.get("role")||"none",r=t.get("role")||"none";if(zu[n]===zu[r]){const n=e.getDisplayName().toLowerCase(),r=t.getDisplayName().toLowerCase();return n<r?-1:n>r?1:0}return zu[n]<zu[r]?-1:1},getAutoFetchedAffiliationLists(){const e=Mc.settings.get("muc_fetch_members");return Array.isArray(e)?e:e?["member","admin","owner"]:[]},async fetchMembers(){const e=this.getAutoFetchedAffiliationLists();if(0===e.length)return;const t=await Promise.all(e.map(e=>this.chatroom.getAffiliationList(e))),n=t.reduce((e,t)=>Tu.isErrorObject(t)?e:[...t,...e],[]),r=e.filter(n=>!Tu.isErrorObject(t[e.indexOf(n)])),i=n.map(e=>e.jid).filter(e=>void 0!==e),o=n.map(e=>!e.jid&&e.nick||void 0).filter(e=>void 0!==e);this.filter(e=>r.includes(e.get("affiliation"))&&!o.includes(e.get("nick"))&&!i.includes(e.get("jid"))).forEach(e=>{e.get("jid")!==Tc.bare_jid&&("offline"===e.get("show")?e.destroy():e.save("affiliation",null))}),n.forEach(e=>{const t=e.jid?this.findOccupant({jid:e.jid}):this.findOccupant({nick:e.nick});t?t.save(e):this.create(e)}),Mc.trigger("membersFetched")},findOccupant(e){const t=Bu.getBareJidFromJid(e.jid);return t&&this.findWhere({jid:t})||this.findWhere({nick:e.nick})}}),Tc.RoomsPanelModel=Po.extend({defaults:function(){return{muc_domain:Mc.settings.get("muc_domain"),nick:Tc.getDefaultMUCNickname()}},setDomain(e){Mc.settings.get("locked_muc_domain")||this.save("muc_domain",Bu.getDomainFromJid(e))}}),Tc.onDirectMUCInvitation=async function(t){const n=Ju('x[xmlns="jabber:x:conference"]',t).pop(),r=Bu.getBareJidFromJid(t.getAttribute("from")),i=n.getAttribute("jid"),o=n.getAttribute("reason");let s;if(Mc.settings.get("auto_join_on_invite"))s=!0;else{let t=Tc.roster.get(r);t=t?t.getDisplayName():r,s=o?confirm(e('%1$s has invited you to join a groupchat: %2$s, and left the following reason: "%3$s"',t,i,o)):confirm(e("%1$s has invited you to join a groupchat: %2$s",t,i))}if(!0===s){(await async function(e,t){t.type=Tc.CHATROOMS_TYPE,t.id=e;const n=await Mc.rooms.get(e,t,!0);return n.maybeShow(!0),n}(i,{password:n.getAttribute("password")})).session.get("connection_status")===qc.ROOMSTATUS.DISCONNECTED&&Tc.chatboxes.get(i).rejoin()}},Mc.settings.get("allow_muc_invitations")){const e=function(){Tc.connection.addHandler(e=>(Tc.onDirectMUCInvitation(e),!0),"jabber:x:conference","message")};Mc.listen.on("connected",e),Mc.listen.on("reconnected",e)}function r(){return Tc.chatboxes.filter(e=>e.get("type")===Tc.CHATROOMS_TYPE).forEach(e=>e.session.save({connection_status:qc.ROOMSTATUS.DISCONNECTED}))}Mc.listen.on("beforeTearDown",()=>{Tc.chatboxes.where({type:Tc.CHATROOMS_TYPE}).forEach(e=>Tu.safeSave(e.session,{connection_status:qc.ROOMSTATUS.DISCONNECTED}))}),Mc.listen.on("windowStateChanged",(async function(e){if("visible"===e.state&&Mc.connection.connected()){(await Mc.rooms.get()).forEach(e=>e.rejoinIfNecessary())}})),Mc.listen.on("addClientFeatures",()=>{Mc.settings.get("allow_muc")&&Mc.disco.own.features.add(Bu.NS.MUC),Mc.settings.get("allow_muc_invitations")&&Mc.disco.own.features.add("jabber:x:conference")}),Mc.listen.on("chatBoxesFetched",(async function(){await Promise.all(Mc.settings.get("auto_join_rooms").map(e=>"string"==typeof e?Tc.chatboxes.where({jid:e}).length?Promise.resolve():Mc.rooms.open(e):T(e)?Mc.rooms.open(e.jid,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lu(Object(n),!0).forEach((function(t){Fu(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e)):(kn.error('Invalid muc criteria specified for "auto_join_rooms"'),Promise.resolve()))),Mc.trigger("roomsAutoJoined")})),Mc.listen.on("beforeResourceBinding",()=>{Tc.connection.addHandler(e=>{const t=Bu.getBareJidFromJid(e.getAttribute("from"));return Tc.chatboxes.get(t)||Mc.waitUntil("chatBoxesFetched").then(async()=>{const n=Tc.chatboxes.get(t);n&&(await n.initialized,n.message_handler.run(e))}),!0},null,"message","groupchat")}),Mc.listen.on("disconnected",r),Mc.listen.on("statusInitialized",()=>{window.addEventListener(Tc.unloadevent,()=>{!Mc.connection.isType("websocket")||Mc.settings.get("enable_smacks")&&Tc.session.get("smacks_stream_id")||r()})}),qc.env.muc_utils=ju,Object.assign(Mc,{rooms:{create(e,t={}){if(!(t="string"==typeof t?{nick:t}:t||{}).nick&&Mc.settings.get("muc_nickname_from_jid")&&(t.nick=Bu.getNodeFromJid(Tc.bare_jid)),void 0===e)throw new TypeError("rooms.create: You need to provide at least one JID");return"string"==typeof e?Mc.rooms.get(Tu.getJIDFromURI(e),t,!0):e.map(e=>Mc.rooms.get(Tu.getJIDFromURI(e),t,!0))},async open(e,t={},n=!1){if(await Mc.waitUntil("chatBoxesFetched"),void 0===e){const e="rooms.open: You need to provide at least one JID";throw kn.error(e),new TypeError(e)}if("string"==typeof e){const r=await Mc.rooms.get(e,t,!0);return r&&r.maybeShow(n),r}{const r=await Promise.all(e.map(e=>Mc.rooms.get(e,t,!0)));return r.forEach(e=>e.maybeShow(n)),r}},async get(e,t={},n=!1){async function r(e){e=Tu.getJIDFromURI(e);let r=await Mc.chatboxes.get(e);return!r&&n?r=await Mc.chatboxes.create(e,t,Tc.ChatRoom):(r=r&&r.get("type")===Tc.CHATROOMS_TYPE?r:null,r&&Object.keys(t).length&&r.save(t)),r}if(void 0===e){return(await Mc.chatboxes.get()).filter(e=>e.get("type")===Tc.CHATROOMS_TYPE)}return"string"==typeof e?r(e):Promise.all(e.map(e=>r(e)))}}})}});
/**
 * @module converse-bookmarks
 * @description
 * Converse.js plugin which adds views for bookmarks specified in XEP-0048.
 * @copyright 2020, the Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 */
const{Strophe:Vu,$iq:Gu,sizzle:Yu}=qc.env,Xu=qc.env.utils;function Qu(e){return Yu('event[xmlns="'.concat(Vu.NS.PUBSUB,'#event"] items[node="').concat(Vu.NS.BOOKMARKS,'"]'),e).length&&Mc.waitUntil("bookmarksInitialized").then(()=>Tc.bookmarks.createBookmarksFromStanza(e)).catch(e=>kn.fatal(e)),!0}Vu.addNamespace("BOOKMARKS","storage:bookmarks"),qc.plugins.add("converse-bookmarks",{dependencies:["converse-chatboxes","converse-muc"],overrides:{ChatRoom:{getDisplayName(){const{_converse:e}=this.__super__;if(this.get("bookmarked")&&e.bookmarks){const t=e.bookmarks.findWhere({jid:this.get("jid")});if(t)return t.get("name")}return this.__super__.getDisplayName.apply(this,arguments)},getAndPersistNickname(e){const{_converse:t}=this.__super__;return e=e||t.getNicknameFromBookmark(this.get("jid")),this.__super__.getAndPersistNickname.call(this,e)}}},initialize(){const{__:e}=Tc;Mc.settings.extend({allow_bookmarks:!0,allow_public_bookmarks:!1,muc_respect_autojoin:!0}),Mc.promises.add("bookmarksInitialized"),Tc.getNicknameFromBookmark=function(e){if(!Tc.bookmarks||!Mc.settings.get("allow_bookmarks"))return null;const t=Tc.bookmarks.findWhere({jid:e});return t?t.get("nick"):void 0},Tc.Bookmark=Po.extend({idAttribute:"jid",getDisplayName(){return Vu.xmlunescape(this.get("name"))}}),Tc.Bookmarks=Qs.extend({model:Tc.Bookmark,comparator:e=>e.get("name").toLowerCase(),initialize(){this.on("add",e=>this.openBookmarkedRoom(e).then(e=>this.markRoomAsBookmarked(e)).catch(e=>kn.fatal(e))),this.on("remove",this.markRoomAsUnbookmarked,this),this.on("remove",this.sendBookmarkStanza,this);const e="converse.room-bookmarks".concat(Tc.bare_jid);this.fetched_flag=e+"fetched",this.browserStorage=Tc.createStore(e)},async openBookmarkedRoom(e){if(Mc.settings.get("muc_respect_autojoin")&&e.get("autojoin")){(await Mc.rooms.create(e.get("jid"),{nick:e.get("nick")})).maybeShow()}return e},fetchBookmarks(){const e=Xu.getResolveablePromise();return window.sessionStorage.getItem(this.fetched_flag)?this.fetch({success:()=>e.resolve(),error:()=>e.resolve()}):this.fetchBookmarksFromServer(e),e},createBookmark(e){this.create(e),this.sendBookmarkStanza().catch(t=>this.onBookmarkError(t,e))},sendBookmarkStanza(){const e=Gu({type:"set",from:Tc.connection.jid}).c("pubsub",{xmlns:Vu.NS.PUBSUB}).c("publish",{node:Vu.NS.BOOKMARKS}).c("item",{id:"current"}).c("storage",{xmlns:Vu.NS.BOOKMARKS});return this.forEach(t=>{e.c("conference",{name:t.get("name"),autojoin:t.get("autojoin"),jid:t.get("jid")}).c("nick").t(t.get("nick")).up().up()}),e.up().up().up(),e.c("publish-options").c("x",{xmlns:Vu.NS.XFORM,type:"submit"}).c("field",{var:"FORM_TYPE",type:"hidden"}).c("value").t("http://jabber.org/protocol/pubsub#publish-options").up().up().c("field",{var:"pubsub#persist_items"}).c("value").t("true").up().up().c("field",{var:"pubsub#access_model"}).c("value").t("whitelist"),Mc.sendIQ(e)},onBookmarkError(t,n){kn.error("Error while trying to add bookmark"),kn.error(t),Mc.alert("error",e("Error"),[e("Sorry, something went wrong while trying to save your bookmark.")]),this.findWhere({jid:n.jid}).destroy()},fetchBookmarksFromServer(e){const t=Gu({from:Tc.connection.jid,type:"get"}).c("pubsub",{xmlns:Vu.NS.PUBSUB}).c("items",{node:Vu.NS.BOOKMARKS});Mc.sendIQ(t).then(t=>this.onBookmarksReceived(e,t)).catch(t=>this.onBookmarksReceivedError(e,t))},markRoomAsBookmarked(e){const t=Tc.chatboxes.get(e.get("jid"));void 0!==t&&t.save("bookmarked",!0)},markRoomAsUnbookmarked(e){const t=Tc.chatboxes.get(e.get("jid"));void 0!==t&&t.save("bookmarked",!1)},createBookmarksFromStanza(e){const t=Vu.NS.BOOKMARKS,n='items[node="'.concat(t,'"] item storage[xmlns="').concat(t,'"] conference');Yu(n,e).forEach(e=>{var t;const n=e.getAttribute("jid"),r=this.get(n),i={jid:n,name:e.getAttribute("name")||n,autojoin:"true"===e.getAttribute("autojoin"),nick:(null===(t=e.querySelector("nick"))||void 0===t?void 0:t.textContent)||""};r?r.save(i):this.create(i)})},onBookmarksReceived(e,t){if(this.createBookmarksFromStanza(t),window.sessionStorage.setItem(this.fetched_flag,!0),void 0!==e)return e.resolve()},onBookmarksReceivedError(t,n){if(null===n)kn.error("Error: timeout while fetching bookmarks"),Mc.alert("error",e("Timeout Error"),[e("The server did not return your bookmarks within the allowed time. You can reload the page to request them again.")]);else{if(t)return n.querySelector('error[type="cancel"] item-not-found')?(window.sessionStorage.setItem(this.fetched_flag,!0),t.resolve()):(kn.error("Error while fetching bookmarks"),kn.error(n),t.reject(new Error("Could not fetch bookmarks")));kn.error("Error while fetching bookmarks"),kn.error(n)}},getUnopenedBookmarks(){return this.filter(e=>!Tc.chatboxes.get(e.get("jid")))}}),Tc.BookmarksList=Po.extend({defaults:{"toggle-state":Tc.OPENED}}),Tc.checkBookmarksSupport=async function(){const e=await Mc.disco.getIdentity("pubsub","pep",Tc.bare_jid);return Tc.allow_public_bookmarks?!!e:Mc.disco.supports(Vu.NS.PUBSUB+"#publish-options",Tc.bare_jid)};const t=async function(){Mc.settings.get("allow_bookmarks")&&await Tc.checkBookmarksSupport()&&(Tc.bookmarks=new Tc.Bookmarks,await Tc.bookmarks.fetchBookmarks(),Mc.trigger("bookmarksInitialized"))};Mc.listen.on("addClientFeatures",()=>{Mc.settings.get("allow_bookmarks")&&Mc.disco.own.features.add(Vu.NS.BOOKMARKS+"+notify")}),Mc.listen.on("clearSession",()=>{void 0!==Tc.bookmarks&&(Tc.bookmarks.clearStore({silent:!0}),window.sessionStorage.removeItem(Tc.bookmarks.fetched_flag),delete Tc.bookmarks)}),Mc.listen.on("reconnected",t),Mc.listen.on("connected",async()=>{const{connection:e}=Tc;e.addHandler(Qu,null,"message","headline",null,Tc.bare_jid),await Promise.all([Mc.waitUntil("chatBoxesFetched")]),t()})}});n(142);
/**
 * @module converse-bosh
 * @copyright The Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 * @description Converse.js plugin which add support for XEP-0206: XMPP Over BOSH
 */const{Strophe:Ku}=qc.env;qc.plugins.add("converse-bosh",{enabled:()=>!Tc.api.settings.get("blacklisted_plugins").includes("converse-bosh"),initialize(){Mc.settings.extend({bosh_service_url:void 0,prebind_url:null}),Tc.startNewPreboundBOSHSession=function(){if(!Mc.settings.get("prebind_url"))throw new Error("startNewPreboundBOSHSession: If you use prebind then you MUST supply a prebind_url");const e=new XMLHttpRequest;e.open("GET",Mc.settings.get("prebind_url"),!0),e.setRequestHeader("Accept","application/json, text/javascript"),e.onload=async function(){if(e.status>=200&&e.status<400){const t=JSON.parse(e.responseText),n=await Tc.setUserJID(t.jid);Tc.connection.attach(n,t.sid,t.rid,Tc.connection.onConnectStatusChanged)}else e.onerror()},e.onerror=function(){delete Tc.connection,Mc.trigger("noResumeableBOSHSession",Tc)},e.send()},Tc.restoreBOSHSession=async function(){const e=(await async function(){const e="converse.bosh-session";if(Tc.bosh_session||(Tc.bosh_session=new Po({id:e}),Tc.bosh_session.browserStorage=Tc.createStore(e,"session"),await new Promise(e=>Tc.bosh_session.fetch({success:e,error:e}))),Tc.jid){if(Tc.bosh_session.get("jid")!==Tc.jid){const e=await Tc.setUserJID(Tc.jid);Tc.bosh_session.clear({silent:!0}),Tc.bosh_session.save({jid:e})}}else{const e=Tc.bosh_session.get("jid");e&&await Tc.setUserJID(e)}return Tc.bosh_session}()).get("jid");if(e&&Tc.connection._proto instanceof Ku.Bosh)try{return Tc.connection.restore(e,Tc.connection.onConnectStatusChanged),!0}catch(t){return!Tc.isTestEnv()&&kn.warn("Could not restore session for jid: "+e+" Error message: "+t.message),!1}return!1},Mc.listen.on("clearSession",()=>{if(void 0===Tc.bosh_session){const e="converse.bosh-session";sessionStorage.removeItem(e),sessionStorage.removeItem("".concat(e,"-").concat(e))}else Tc.bosh_session.destroy(),delete Tc.bosh_session}),Mc.listen.on("setUserJID",()=>{void 0!==Tc.bosh_session&&Tc.bosh_session.save({jid:Tc.jid})}),Mc.listen.on("addClientFeatures",()=>Mc.disco.own.features.add(Ku.NS.BOSH)),Object.assign(Mc,{tokens:{get:e=>void 0===Tc.connection?null:"rid"===e.toLowerCase()?Tc.connection.rid||Tc.connection._proto.rid:"sid"===e.toLowerCase()?Tc.connection.sid||Tc.connection._proto.sid:void 0}})}});var Zu=n(4);
/**
 * @module converse-caps
 * @copyright 2020, the Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 */const{Strophe:ed,$build:td}=qc.env;function nd(e,t){return e.sort((e,n)=>e[t]>n[t]?-1:1)}function rd(e){const t=e.api.disco.own.identities.get(),n=e.api.disco.own.features.get();t.length>1&&(nd(t,"category"),nd(t,"type"),nd(t,"lang"));let r=t.reduce((e,t)=>{var n;return"".concat(e).concat(t.category,"/").concat(t.type,"/").concat(null!==(n=null==t?void 0:t.lang)&&void 0!==n?n:"","/").concat(t.name,"<")},"");return n.sort(),r=n.reduce((e,t)=>"".concat(e).concat(t,"<"),r),Zu.a.b64_sha1(r)}
/**
 * @module converse-carbons
 * @copyright The Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 * @description Implements support for XEP-0280 Message Carbons
 */
function id(e){var t,n;e&&(null===(n=Tc.session)||void 0===n||n.set({carbons_enabled:!1}));if(!Mc.settings.get("message_carbons")||(null===(t=Tc.session)||void 0===t?void 0:t.get("carbons_enabled")))return;const r=new vc.e.Builder("iq",{from:Tc.connection.jid,id:"enablecarbons",type:"set"}).c("enable",{xmlns:vc.e.NS.CARBONS});Tc.connection.addHandler(e=>{e.querySelectorAll("error").length>0?kn.warn("An error occurred while trying to enable message carbons."):(Tc.session.set({carbons_enabled:!0}),kn.debug("Message carbons have been enabled.")),Tc.session.save()},null,"iq",null,"enablecarbons"),Tc.connection.send(r)}ed.addNamespace("CAPS","http://jabber.org/protocol/caps"),qc.plugins.add("converse-caps",{overrides:{XMPPStatus:{constructPresence(){const e=this.__super__.constructPresence.apply(this,arguments);var t;return e.root().cnode((t=this.__super__._converse,td("c",{xmlns:ed.NS.CAPS,hash:"sha-1",node:"https://conversejs.org",ver:rd(t)}).nodeTree)),e}}}}),qc.plugins.add("converse-carbons",{initialize(){Mc.settings.extend({message_carbons:!0}),Mc.listen.on("afterResourceBinding",id)}});
/**
 * @module converse-chatboxes
 * @copyright 2020, the Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 */
const{Strophe:od}=qc.env;od.addNamespace("MESSAGE_CORRECT","urn:xmpp:message-correct:0"),od.addNamespace("RECEIPTS","urn:xmpp:receipts"),od.addNamespace("REFERENCE","urn:xmpp:reference:0"),od.addNamespace("MARKERS","urn:xmpp:chat-markers:0"),qc.plugins.add("converse-chatboxes",{dependencies:["converse-emoji","converse-roster","converse-vcard"],initialize(){async function e(e,t,n){let r;e=od.getBareJidFromJid(e.toLowerCase()),Object.assign(t,{jid:e,id:e});try{r=new n(t,{collection:Tc.chatboxes})}catch(e){return kn.error(e),null}return await r.initialized,r.isValid()?(Tc.chatboxes.add(r),r):(r.destroy(),null)}Mc.promises.add(["chatBoxesFetched","chatBoxesInitialized","privateChatsAutoJoined"]),Tc.ChatBoxes=Qs.extend({comparator:"time_opened",model:(e,t)=>new Tc.ChatBox(e,t),onChatBoxesFetched(e){e.filter(e=>!e.isValid()).forEach(e=>e.destroy()),Mc.trigger("chatBoxesFetched")},onConnected(e){e||(this.browserStorage=Tc.createStore("converse.chatboxes-".concat(Tc.bare_jid)),this.fetch({add:!0,success:e=>this.onChatBoxesFetched(e)}))}}),Mc.listen.on("addClientFeatures",()=>{Mc.disco.own.features.add(od.NS.MESSAGE_CORRECT),Mc.disco.own.features.add(od.NS.HTTPUPLOAD),Mc.disco.own.features.add(od.NS.OUTOFBAND)}),Mc.listen.on("pluginsInitialized",()=>{Tc.chatboxes=new Tc.ChatBoxes,Mc.trigger("chatBoxesInitialized")}),Mc.listen.on("presencesInitialized",e=>Tc.chatboxes.onConnected(e)),Mc.listen.on("reconnected",()=>Tc.chatboxes.forEach(e=>e.onReconnection())),Object.assign(Mc,{chatboxes:{create:async(t=[],n={},r)=>(await Mc.waitUntil("chatBoxesFetched"),"string"==typeof t?e(t,n,r):Promise.all(t.map(t=>e(t,n,r)))),get:async e=>(await Mc.waitUntil("chatBoxesFetched"),void 0===e?Tc.chatboxes.models:"string"==typeof e?Tc.chatboxes.get(e.toLowerCase()):(e=e.map(e=>e.toLowerCase()),Tc.chatboxes.models.filter(t=>e.includes(t.get("jid")))))}})}}),qc.plugins.add("converse-headlines",{dependencies:["converse-chat"],overrides:{ChatBoxes:{model(e,t){const{_converse:n}=this.__super__;return e.type==n.HEADLINES_TYPE?new n.HeadlinesBox(e,t):this.__super__.model.apply(this,arguments)}}},initialize(){function e(){Tc.connection.addHandler(e=>async function(e){if(us.isHeadline(e)||us.isServerMessage(e)){const t=e.getAttribute("from");if(t.includes("@")&&!Tc.roster.get(t)&&!Mc.settings.get("allow_non_roster_messaging"))return;if(null===e.querySelector("body"))return;const n=Tc.chatboxes.create({id:t,jid:t,type:Tc.HEADLINES_TYPE,from:t}),r=await us.parseMessage(e,Tc);await n.createMessage(r),Mc.trigger("message",{chatbox:n,stanza:e,attrs:r})}}(e)||!0,null,"message")}Tc.HeadlinesBox=Tc.ChatBox.extend({defaults(){return{bookmarked:!1,hidden:["mobile","fullscreen"].includes(Mc.settings.get("view_mode")),message_type:"headline",num_unread:0,time_opened:this.get("time_opened")||(new Date).getTime(),type:Tc.HEADLINES_TYPE}},async initialize(){this.set({box_id:"box-".concat(this.get("jid"))}),this.initMessages(),await this.fetchMessages(),Mc.trigger("headlinesBoxInitialized",this)}}),Mc.listen.on("connected",e),Mc.listen.on("reconnected",e),Object.assign(Mc,{headlines:{async get(e,t={},n=!1){async function r(e){let r=await Mc.chatboxes.get(e);return!r&&n?r=await Mc.chatboxes.create(e,t,Tc.HeadlinesBox):(r=r&&r.get("type")===Tc.HEADLINES_TYPE?r:null,r&&Object.keys(t).length&&r.save(t)),r}if(void 0===e){return(await Mc.chatboxes.get()).filter(e=>e.get("type")===Tc.HEADLINES_TYPE)}return"string"==typeof e?r(e):Promise.all(e.map(e=>r(e)))}}})}});
/**
 * @module converse-rsm
 * @copyright The Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 * @description XEP-0059 Result Set Management
 *   Some code taken from the Strophe RSM plugin, licensed under the MIT License
 *   Copyright 2006-2017 Strophe (https://github.com/strophe/strophejs)
 */
const{Strophe:sd,$build:ad}=qc.env;sd.addNamespace("RSM","http://jabber.org/protocol/rsm");const cd=["after","before","index","max"],ud=e=>Number(e),dd=e=>e.toString(),ld={after:dd,before:dd,count:ud,first:dd,index:ud,last:dd,max:ud},fd=e=>void 0===e,hd=Object.keys(ld);class pd{static getQueryParameters(e={}){return Do(e,cd)}static parseXMLResult(e){const t={};for(var n=0;n<hd.length;n++){const r=hd[n],i=e.getElementsByTagName(r)[0];fd(i)||null===i||(t[r]=ld[r](sd.getText(i)),"first"==r&&(t.index=ld.index(i.getAttribute("index"))))}return t}constructor(e={}){this.query=pd.getQueryParameters(e),this.result=e.xml?pd.parseXMLResult(e.xml):{}}toXML(){const e=ad("set",{xmlns:sd.NS.RSM});return cd.reduce((e,t)=>fd(this.query[t])?e:e.c(t).t((this.query[t]||"").toString()).up(),e).tree()}next(e,t){const n=Object.assign({},this.query,{after:this.result.last,before:t,max:e});return new pd(n)}previous(e,t){const n=Object.assign({},this.query,{after:t,before:this.result.first,max:e});return new pd(n)}}function gd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function md(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gd(Object(n),!0).forEach((function(t){vd(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/**
 * @module converse-mam
 * @description XEP-0313 Message Archive Management
 * @copyright 2020, the Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 */Tc.RSM_ATTRIBUTES=hd,Tc.RSM=pd;const{Strophe:_d,$iq:yd,dayjs:bd}=qc.env,{NS:wd}=_d,Sd=qc.env.utils,xd={fetchNewestMessages(){if(this.disable_mam)return;const e=this.getMostRecentMessage();if(e&&!Mc.settings.get("clear_messages_on_reconnection")){const t=e.get("stanza_id ".concat(this.get("jid")));t?this.fetchArchivedMessages({after:t},"forwards"):this.fetchArchivedMessages({start:e.get("time")},"forwards")}else this.fetchArchivedMessages({before:""})},async handleMAMResult(e,t,n,r){await Mc.emojis.initialize();const i=this.get("type")===Tc.CHATROOMS_TYPE;e.messages=e.messages.map(e=>i?us.parseMUCMessage(e,this,Tc):us.parseMessage(e,Tc));const o={query:t,chatbox:this,messages:e.messages};if(await Mc.trigger("MAMResult",o,{synchronous:!0}),e.messages.forEach(e=>this.queueMessage(e)),e.error){const t=e.error.retry_event_id=Sd.getUniqueId();Mc.listen.once(t,()=>this.fetchArchivedMessages(n,r)),this.createMessageFromError(e.error)}},async fetchArchivedMessages(e={},t){if(this.disable_mam)return;const n=this.get("type")===Tc.CHATROOMS_TYPE,r=n?this.get("jid"):Tc.bare_jid;if(!await Mc.disco.supports(wd.MAM,r))return;const i=Mc.settings.get("archived_messages_page_size"),o=Object.assign({groupchat:n,max:i,with:this.get("jid")},e),s=await Mc.archive.query(o);return await this.handleMAMResult(s,o,e,t),t&&s.rsm&&!s.complete?("forwards"===t?e=s.rsm.next(i,e.before).query:"backwards"===t&&(e=s.rsm.previous(i,e.after).query),this.fetchArchivedMessages(e,t)):void 0}};qc.plugins.add("converse-mam",{dependencies:["converse-disco","converse-muc"],initialize(){function e(e){Mc.settings.get("muc_show_logs_before_join")&&e.features.get("mam_enabled")&&!e.get("prejoin_mam_fetched")&&(e.fetchNewestMessages(),e.save({prejoin_mam_fetched:!0}))}Mc.settings.extend({archived_messages_page_size:"50",message_archiving:void 0,message_archiving_timeout:2e4}),Object.assign(Tc.ChatBox.prototype,xd),Tc.onMAMError=function(e){(null==e?void 0:e.querySelectorAll("feature-not-implemented").length)?kn.warn("Message Archive Management (XEP-0313) not supported by ".concat(e.getAttribute("from"))):(kn.error("Error while trying to set archiving preferences for ".concat(e.getAttribute("from"),".")),kn.error(e))},Tc.onMAMPreferences=function(e,t){const n=fr()('prefs[xmlns="'.concat(wd.MAM,'"]'),e).pop();if(n.getAttribute("default")!==Mc.settings.get("message_archiving")){const e=yd({type:"set"}).c("prefs",{xmlns:wd.MAM,default:Mc.settings.get("message_archiving")});Array.from(n.children).forEach(t=>e.cnode(t).up()),Mc.sendIQ(e).then(()=>t.save({preferences:{default:Mc.settings.get("message_archiving")}})).catch(Tc.onMAMError)}else t.save({preferences:{default:Mc.settings.get("message_archiving")}})},Mc.listen.on("addClientFeatures",()=>Mc.disco.own.features.add(wd.MAM)),Mc.listen.on("serviceDiscovered",(function(e){const t=e.get("preferences")||{};e.get("var")===wd.MAM&&void 0!==Mc.settings.get("message_archiving")&&t.default!==Mc.settings.get("message_archiving")&&Mc.sendIQ(yd({type:"get"}).c("prefs",{xmlns:wd.MAM})).then(t=>Tc.onMAMPreferences(t,e)).catch(Tc.onMAMError)})),Mc.listen.on("chatRoomViewInitialized",t=>{Mc.settings.get("muc_show_logs_before_join")&&(e(t.model),t.model.features.on("change:mam_enabled",()=>e(t.model)))}),Mc.listen.on("enteredNewRoom",e=>e.features.get("mam_enabled")&&e.fetchNewestMessages()),Mc.listen.on("chatReconnected",e=>{e.get("type")===Tc.PRIVATE_CHAT_TYPE&&e.fetchNewestMessages()}),Mc.listen.on("afterMessagesFetched",e=>{e.get("type")!==Tc.PRIVATE_CHAT_TYPE||Tc.connection.restored||e.fetchNewestMessages()}),Object.assign(Mc,{archive:{async query(e){if(!Mc.connection.connected())throw new Error("Can't call `api.archive.query` before having established an XMPP session");const t={type:"set"};if(e&&e.groupchat){if(!e.with)throw new Error('You need to specify a "with" value containing the chat room JID, when querying groupchat messages.');t.to=e.with}const n=t.to||Tc.bare_jid;if(!await Mc.disco.supports(wd.MAM,n))return kn.warn("Did not fetch MAM archive for ".concat(n," because it doesn't support ").concat(wd.MAM)),{messages:[]};const r=Sd.getUniqueId(),i=yd(t).c("query",{xmlns:wd.MAM,queryid:r});if(e){i.c("x",{xmlns:wd.XFORM,type:"submit"}).c("field",{var:"FORM_TYPE",type:"hidden"}).c("value").t(wd.MAM).up().up(),e.with&&!e.groupchat&&i.c("field",{var:"with"}).c("value").t(e.with).up().up(),["start","end"].forEach(t=>{if(e[t]){const n=bd(e[t]);if(!n.isValid())throw new TypeError("archive.query: invalid date provided for: ".concat(t));i.c("field",{var:t}).c("value").t(n.toISOString()).up().up()}}),i.up();const t=new pd(e);Object.keys(t.query).length&&i.cnode(t.toXML())}const o=[],s=Tc.connection.addHandler(t=>{const n=fr()('message > result[xmlns="'.concat(wd.MAM,'"]'),t).pop();if(void 0===n||n.getAttribute("queryid")!==r)return!0;const i=t.getAttribute("from")||Tc.bare_jid;if(e.groupchat){if(i!==e.with)return kn.warn("Ignoring alleged groupchat MAM message from ".concat(t.getAttribute("from"))),!0}else if(i!==Tc.bare_jid)return kn.warn("Ignoring alleged MAM message from ".concat(t.getAttribute("from"))),!0;return o.push(t),!0},wd.MAM);let a;const c=await Mc.sendIQ(i,Mc.settings.get("message_archiving_timeout"),!1);if(null===c){const{__:e}=Tc,t=e("Timeout while trying to fetch archived messages.");return kn.error(t),a=new Tc.TimeoutError(t),{messages:o,error:a}}if(Sd.isErrorStanza(c)){const{__:e}=Tc,t=e("An error occurred while querying for archived messages.");return kn.error(t),kn.error(c),a=new Error(t),{messages:o,error:a}}let u;Tc.connection.deleteHandler(s);const d=c&&fr()('fin[xmlns="'.concat(wd.MAM,'"]'),c).pop(),l="true"===(null==d?void 0:d.getAttribute("complete")),f=fr()('set[xmlns="'.concat(wd.RSM,'"]'),d).pop();return f&&(u=new pd(md(md({},e),{},{xml:f}))),{messages:o,rsm:u,complete:l}}}})}});
/**
 * @module converse-ping
 * @description
 * Converse.js plugin which add support for application-level pings
 * as specified in XEP-0199 XMPP Ping.
 * @copyright 2020, the Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 */
const{Strophe:Ed,$iq:Ad}=qc.env,Nd=qc.env.utils;Ed.addNamespace("PING","urn:xmpp:ping"),qc.plugins.add("converse-ping",{initialize(){let e;function t(t){e=new Date;const n=t.getAttribute("from"),r=t.getAttribute("id"),i=Ad({type:"result",to:n,id:r});return Tc.connection.sendIQ(i),!0}Mc.settings.extend({ping_interval:60}),setTimeout(()=>{if(Mc.settings.get("ping_interval")>0){const t=new Date;return e||(e=t),!((t-e)/1e3>Mc.settings.get("ping_interval"))||Mc.ping()}},1e3);const n=function(){void 0!==Tc.connection.disco&&Mc.disco.own.features.add(Ed.NS.PING),Tc.connection.addHandler(t,Ed.NS.PING,"iq","get"),Tc.connection.addHandler(()=>{if(Mc.settings.get("ping_interval")>0)return e=new Date,!0})};Mc.listen.on("connected",n),Mc.listen.on("reconnected",n),Mc.listen.on("windowStateChanged",(function(e){"visible"===e.state&&Mc.connection.connected()&&Mc.ping(null,5e3)})),Object.assign(Mc,{async ping(t,n){if(e=new Date,t=t||Ed.getDomainFromJid(Tc.bare_jid),Tc.connection){const e=Ad({type:"get",to:t,id:Nd.getUniqueId("ping")}).c("ping",{xmlns:Ed.NS.PING}),r=await Mc.sendIQ(e,n||1e4,!1);return null===r?(kn.warn("Timeout while pinging ".concat(t)),t===Ed.getDomainFromJid(Tc.bare_jid)&&Mc.connection.reconnect()):Nd.isErrorStanza(r)&&(kn.error("Error while pinging ".concat(t)),kn.error(r)),!0}return!1}})}});
/**
 * @module converse-pubsub
 * @copyright The Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 */
const{Strophe:Od,$iq:jd}=qc.env;Od.addNamespace("PUBSUB_ERROR",Od.NS.PUBSUB+"#errors"),qc.plugins.add("converse-pubsub",{dependencies:["converse-disco"],initialize(){Object.assign(Tc.api,{pubsub:{async publish(e,t,n,r,i=!0){const o=jd({from:Tc.bare_jid,type:"set",to:e}).c("pubsub",{xmlns:Od.NS.PUBSUB}).c("publish",{node:t}).cnode(n.tree()).up().up();r&&(e=e||Tc.bare_jid,await Mc.disco.supports(Od.NS.PUBSUB+"#publish-options",e)?(o.c("publish-options").c("x",{xmlns:Od.NS.XFORM,type:"submit"}).c("field",{var:"FORM_TYPE",type:"hidden"}).c("value").t("".concat(Od.NS.PUBSUB,"#publish-options")).up().up(),Object.keys(r).forEach(e=>o.c("field",{var:e}).c("value").t(r[e]).up().up())):kn.warn("_converse.api.publish: ".concat(e," does not support #publish-options, ")+"so we didn't set them even though they were provided."));try{await Mc.sendIQ(o)}catch(e){if(!(e instanceof Element&&i&&e.querySelector('precondition-not-met[xmlns="'.concat(Od.NS.PUBSUB_ERROR,'"]'))))throw e;{const e=o.nodeTree;e.querySelector("publish-options").outerHTML="",kn.warn("PubSub: Republishing without publish options. ".concat(e.outerHTML)),await Mc.sendIQ(e)}}}}})}});var Td=function(e){return"number"==typeof e||Se(e)&&"[object Number]"==j(e)};var Cd=function(e){return Td(e)&&e!=+e};
/**
 * @module converse-status
 * @copyright The Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 */const{Strophe:Id,$build:Rd,$pres:Md}=qc.env;qc.plugins.add("converse-status",{initialize(){function e(e){Mc.trigger("statusInitialized",e)}function t(t){if(t=void 0!==Tc.xmppstatus&&t)e(t);else{const n="converse.xmppstatus-".concat(Tc.bare_jid);Tc.xmppstatus=new Tc.XMPPStatus({id:n}),Tc.xmppstatus.browserStorage=Tc.createStore(n,"session"),Tc.xmppstatus.fetch({success:()=>e(t),error:()=>e(t),silent:!0})}}Mc.settings.extend({auto_away:0,auto_xa:0,csi_waiting_time:0,default_state:"online",priority:0}),Mc.promises.add(["statusInitialized"]),Tc.XMPPStatus=Po.extend({defaults:()=>({status:Mc.settings.get("default_state")}),initialize(){this.on("change",e=>{T(e.changed)&&("status"in e.changed||"status_message"in e.changed)&&Mc.user.presence.send(this.get("status"),null,this.get("status_message"))})},getNickname:()=>Tc.nickname,getFullname:()=>"",constructPresence(e,t=null,n){let r;e="string"==typeof e?e:this.get("status")||Mc.settings.get("default_state"),n="string"==typeof n?n:this.get("status_message");const i={to:t};"unavailable"===e||"probe"===e||"error"===e||"unsubscribe"===e||"unsubscribed"===e||"subscribe"===e||"subscribed"===e?(i.type=e,r=Md(i)):"offline"===e?(i.type="unavailable",r=Md(i)):r="online"===e?Md(i):Md(i).c("show").t(e).up(),n&&r.c("status").t(n).up();const o=Mc.settings.get("priority");if(r.c("priority").t(Cd(Number(o))?0:o).up(),Tc.idle){const e=new Date;e.setSeconds(e.getSeconds()-Tc.idle_seconds),r.c("idle",{xmlns:Id.NS.IDLE,since:e.toISOString()})}return r}}),Tc.sendCSI=function(e){Mc.send(Rd(e,{xmlns:Id.NS.CSI})),Tc.inactive=e===Tc.INACTIVE},Tc.onUserActivity=function(){var e;Tc.idle_seconds>0&&(Tc.idle_seconds=0),(null===(e=Tc.connection)||void 0===e?void 0:e.authenticated)&&(Tc.inactive&&Tc.sendCSI(Tc.ACTIVE),Tc.idle&&(Tc.idle=!1,Mc.user.presence.send()),!0===Tc.auto_changed_status&&(Tc.auto_changed_status=!1,Tc.xmppstatus.set("status",Mc.settings.get("default_state"))))},Tc.onEverySecond=function(){var e;if(!(null===(e=Tc.connection)||void 0===e?void 0:e.authenticated))return;const t=Tc.xmppstatus.get("status");Tc.idle_seconds++,Mc.settings.get("csi_waiting_time")>0&&Tc.idle_seconds>Mc.settings.get("csi_waiting_time")&&!Tc.inactive&&Tc.sendCSI(Tc.INACTIVE),Mc.settings.get("idle_presence_timeout")>0&&Tc.idle_seconds>Mc.settings.get("idle_presence_timeout")&&!Tc.idle&&(Tc.idle=!0,Mc.user.presence.send()),Mc.settings.get("auto_away")>0&&Tc.idle_seconds>Mc.settings.get("auto_away")&&"away"!==t&&"xa"!==t&&"dnd"!==t?(Tc.auto_changed_status=!0,Tc.xmppstatus.set("status","away")):Mc.settings.get("auto_xa")>0&&Tc.idle_seconds>Mc.settings.get("auto_xa")&&"xa"!==t&&"dnd"!==t&&(Tc.auto_changed_status=!0,Tc.xmppstatus.set("status","xa"))},Tc.registerIntervalHandler=function(){if(Mc.settings.get("auto_away")<1&&Mc.settings.get("auto_xa")<1&&Mc.settings.get("csi_waiting_time")<1&&Mc.settings.get("idle_presence_timeout")<1)return;Tc.idle_seconds=0,Tc.auto_changed_status=!1;const{unloadevent:e}=Tc;window.addEventListener("click",Tc.onUserActivity),window.addEventListener("focus",Tc.onUserActivity),window.addEventListener("keypress",Tc.onUserActivity),window.addEventListener("mousemove",Tc.onUserActivity),window.addEventListener(e,Tc.onUserActivity,{once:!0,passive:!0}),window.addEventListener(e,()=>{var e;return null===(e=Tc.session)||void 0===e?void 0:e.save("active",!1)}),Tc.everySecondTrigger=window.setInterval(Tc.onEverySecond,1e3)},Mc.listen.on("presencesInitialized",e=>{e||Tc.registerIntervalHandler()}),Mc.listen.on("clearSession",()=>{Tc.shouldClearCache()&&Tc.xmppstatus&&(Tc.xmppstatus.destroy(),delete Tc.xmppstatus,Mc.promises.add(["statusInitialized"]))}),Mc.listen.on("connected",()=>t(!1)),Mc.listen.on("reconnected",()=>t(!0)),Object.assign(Tc.api.user,{presence:{async send(e,t,n){await Mc.waitUntil("statusInitialized"),Mc.send(Tc.xmppstatus.constructPresence(e,t,n))}},status:{get:async()=>(await Mc.waitUntil("statusInitialized"),Tc.xmppstatus.get("status")),async set(e,t){const n={status:e};if(!Object.keys(Tc.STATUS_WEIGHTS).includes(e))throw new Error("Invalid availability value. See https://xmpp.org/rfcs/rfc3921.html#rfc.section.2.2.2.1");"string"==typeof t&&(n.status_message=t),await Mc.waitUntil("statusInitialized"),Tc.xmppstatus.save(n)},message:{get:async()=>(await Mc.waitUntil("statusInitialized"),Tc.xmppstatus.get("status_message")),async set(e){await Mc.waitUntil("statusInitialized"),Tc.xmppstatus.save({status_message:e})}}}})}});var kd=function(e){return function(t){return null==e?void 0:lo(e,t)}};var Dd=function(e,t){for(var n,r=-1,i=e.length;++r<i;){var o=t(e[r]);void 0!==o&&(n=void 0===n?o:n+o)}return n};var Pd=function(e){return e&&e.length?Dd(e,gr):0};
/**
 * @module converse-roster
 * @copyright The Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 */const{Strophe:Ld,$iq:Fd,$pres:Ud,dayjs:zd,sizzle:Bd}=qc.env,Hd=qc.env.utils;qc.plugins.add("converse-roster",{dependencies:["converse-status"],initialize(){const{__:e}=Tc;Mc.settings.extend({allow_contact_requests:!0,auto_subscribe:!1,synchronize_availability:!0}),Mc.promises.add(["cachedRoster","roster","rosterContactsFetched","rosterGroupsFetched","rosterInitialized"]),Tc.HEADER_CURRENT_CONTACTS=e("My contacts"),Tc.HEADER_PENDING_CONTACTS=e("Pending contacts"),Tc.HEADER_REQUESTING_CONTACTS=e("Contact requests"),Tc.HEADER_UNGROUPED=e("Ungrouped"),Tc.HEADER_UNREAD=e("New messages");const t={};t[Tc.HEADER_UNREAD]=0,t[Tc.HEADER_REQUESTING_CONTACTS]=1,t[Tc.HEADER_CURRENT_CONTACTS]=2,t[Tc.HEADER_UNGROUPED]=3,t[Tc.HEADER_PENDING_CONTACTS]=4,Tc.registerPresenceHandler=function(){Tc.unregisterPresenceHandler(),Tc.presence_ref=Tc.connection.addHandler(e=>(Tc.roster.presenceHandler(e),!0),null,"presence",null)},Tc.rejectPresenceSubscription=function(e,t){const n=Ud({to:e,type:"unsubscribed"});t&&""!==t&&n.c("status").t(t),Mc.send(n)},Tc.sendInitialPresence=function(){Tc.send_initial_presence&&Mc.user.presence.send()},Tc.populateRoster=async function(e=!1){e&&(Tc.send_initial_presence=!0);try{await Tc.rostergroups.fetchRosterGroups(),Mc.trigger("rosterGroupsFetched"),await Tc.roster.fetchRosterContacts(),Mc.trigger("rosterContactsFetched")}catch(e){kn.error(e)}finally{Tc.sendInitialPresence()}};const n=Po.extend({idAttribute:"name"}),r=Qs.extend({model:n});function i(e){const t=Tc.roster&&Tc.roster.findWhere({jid:e.get("jid")});void 0!==t&&t.save({num_unread:e.get("num_unread")})}async function o(){Tc.presences&&await Tc.presences.clearStore()}Tc.Presence=Po.extend({defaults:{show:"offline"},initialize(){this.resources=new r;const e="converse.identities-".concat(this.get("jid"));this.resources.browserStorage=Tc.createStore(e,"session"),this.listenTo(this.resources,"update",this.onResourcesChanged),this.listenTo(this.resources,"change",this.onResourcesChanged)},onResourcesChanged(){var e;const t=this.getHighestPriorityResource(),n=(null==t||null===(e=t.attributes)||void 0===e?void 0:e.show)||"offline";this.get("show")!==n&&this.save({show:n})},getHighestPriorityResource(){return this.resources.sortBy(e=>"".concat(e.get("priority"),"-").concat(e.get("timestamp"))).reverse()[0]},addResource(e){const t=e.getAttribute("from"),n=Ld.getResourceFromJid(t),r=Bd('delay[xmlns="'.concat(Ld.NS.DELAY,'"]'),e).pop(),i=kd(e.querySelector("priority"))("textContent")||0,o=this.resources.get(n),s={name:n,priority:Cd(parseInt(i,10))?0:parseInt(i,10),show:kd(e.querySelector("show"))("textContent")||"online",timestamp:r?zd(r.getAttribute("stamp")).toISOString():(new Date).toISOString()};o?o.save(s):this.resources.create(s)},removeResource(e){const t=this.resources.get(e);t&&t.destroy()}}),Tc.Presences=Qs.extend({model:Tc.Presence}),Tc.RosterContact=Po.extend({defaults:{chat_state:void 0,image:Tc.DEFAULT_IMAGE,image_type:Tc.DEFAULT_IMAGE_TYPE,num_unread:0,status:void 0},async initialize(e){this.initialized=Hd.getResolveablePromise(),this.setPresence();const{jid:t}=e,n=Ld.getBareJidFromJid(t).toLowerCase();e.jid=n,this.set(Object.assign({groups:[],id:n,jid:n,user_id:Ld.getNodeFromJid(t)},e)),this.listenTo(this.presence,"change:show",()=>Mc.trigger("contactPresenceChanged",this)),this.listenTo(this.presence,"change:show",()=>this.trigger("presenceChanged")),await Mc.trigger("rosterContactInitialized",this,{Synchronous:!0}),this.initialized.resolve()},setPresence(){const e=this.get("jid");this.presence=Tc.presences.findWhere({jid:e})||Tc.presences.create({jid:e})},openChat(){const e=this.attributes;Mc.chats.open(e.jid,e,!0)},getFilterCriteria(){const e=this.get("nickname"),t=this.get("jid");let n=this.getDisplayName();return n=n.includes(t)?n:n.concat("   ".concat(t)),n=n.includes(e)?n:n.concat("   ".concat(e)),n.toLowerCase()},getDisplayName(){return this.get("nickname")?this.get("nickname"):this.get("jid")},getFullname(){return this.get("jid")},subscribe(e){const t=Ud({to:this.get("jid"),type:"subscribe"});e&&""!==e&&t.c("status").t(e).up();const n=Tc.xmppstatus.getNickname()||Tc.xmppstatus.getFullname();return n&&t.c("nick",{xmlns:Ld.NS.NICK}).t(n).up(),Mc.send(t),this.save("ask","subscribe"),this},ackSubscribe(){Mc.send(Ud({type:"subscribe",to:this.get("jid")}))},ackUnsubscribe(){Mc.send(Ud({type:"unsubscribe",to:this.get("jid")})),this.removeFromRoster(),this.destroy()},unauthorize(e){return Tc.rejectPresenceSubscription(this.get("jid"),e),this},authorize(e){const t=Ud({to:this.get("jid"),type:"subscribed"});return e&&""!==e&&t.c("status").t(e),Mc.send(t),this},removeFromRoster(){const e=Fd({type:"set"}).c("query",{xmlns:Ld.NS.ROSTER}).c("item",{jid:this.get("jid"),subscription:"remove"});return Mc.sendIQ(e)}}),Tc.RosterContacts=Qs.extend({model:Tc.RosterContact,comparator(e,t){const n=e.presence.get("show")||"offline",r=t.presence.get("show")||"offline";if(Tc.STATUS_WEIGHTS[n]===Tc.STATUS_WEIGHTS[r]){const n=e.getDisplayName().toLowerCase(),r=t.getDisplayName().toLowerCase();return n<r?-1:n>r?1:0}return Tc.STATUS_WEIGHTS[n]<Tc.STATUS_WEIGHTS[r]?-1:1},onConnected(){this.registerRosterHandler(),this.registerRosterXHandler()},registerRosterHandler(){Tc.connection.addHandler(e=>(Tc.roster.onRosterPush(e),!0),Ld.NS.ROSTER,"iq","set")},registerRosterXHandler(){let e=0;Tc.connection.addHandler((function(t){return window.setTimeout((function(){Tc.connection.flush(),Tc.roster.subscribeToSuggestedItems.bind(Tc.roster)(t)}),e),e+=250*t.querySelectorAll("item").length,!0}),Ld.NS.ROSTERX,"message",null)},async fetchRosterContacts(){const e=await new Promise((e,t)=>{this.fetch({add:!0,silent:!0,success:e,error:(e,n)=>t(n)})});if(Hd.isErrorObject(e)&&(kn.error(e),Tc.session.set("roster_cached",!1),this.data.save("version",void 0)),!Tc.session.get("roster_cached"))return Tc.send_initial_presence=!0,Tc.roster.fetchFromServer();Mc.trigger("cachedRoster",e)},subscribeToSuggestedItems:e=>(Array.from(e.querySelectorAll("item")).forEach(e=>{"add"===e.getAttribute("action")&&Tc.roster.addAndSubscribe(e.getAttribute("jid"),Tc.xmppstatus.getNickname()||Tc.xmppstatus.getFullname())}),!0),isSelf:e=>Hd.isSameBareJID(e,Tc.connection.jid),async addAndSubscribe(e,t,n,r,i){const o=await this.addContactToRoster(e,t,n,i);o instanceof Tc.RosterContact&&o.subscribe(r)},sendContactAddIQ(e,t,n){t=t||null;const r=Fd({type:"set"}).c("query",{xmlns:Ld.NS.ROSTER}).c("item",{jid:e,name:t});return n.forEach(e=>r.c("group").t(e).up()),Mc.sendIQ(r)},async addContactToRoster(t,n,r,i){await Mc.waitUntil("rosterContactsFetched"),r=r||[];try{await this.sendContactAddIQ(t,n,r)}catch(r){return kn.error(r),alert(e("Sorry, there was an error while trying to add %1$s as a contact.",n||t)),r}return this.create(Object.assign({ask:void 0,nickname:n,groups:r,jid:t,requesting:!1,subscription:"none"},i),{sort:!1})},async subscribeBack(e,t){const n=this.get(e);if(n instanceof Tc.RosterContact)n.authorize().subscribe();else{var r;const n=(null===(r=Bd('nick[xmlns="'.concat(Ld.NS.NICK,'"]'),t).pop())||void 0===r?void 0:r.textContent)||null,i=await this.addContactToRoster(e,n,[],{subscription:"from"});i instanceof Tc.RosterContact&&i.authorize().subscribe()}},getNumOnlineContacts(){const e=["offline","unavailable"];return Pd(this.models.filter(t=>!e.includes(t.presence.get("show"))))},onRosterPush(e){const t=e.getAttribute("id"),n=e.getAttribute("from");if(n&&n!==Tc.bare_jid)return void kn.warn("Ignoring roster illegitimate roster push message from ".concat(e.getAttribute("from")));Mc.send(Fd({type:"result",id:t,from:Tc.connection.jid}));const r=Bd('query[xmlns="'.concat(Ld.NS.ROSTER,'"]'),e).pop();this.data.save("version",r.getAttribute("ver"));const i=Bd("item",r);if(i.length>1)throw kn.error(e),new Error('Roster push query may not contain more than one "item" element.');if(0===i.length)return kn.warn(e),void kn.warn('Received a roster push stanza without an "item" element.');this.updateContact(i.pop()),Mc.trigger("rosterPush",e)},rosterVersioningSupported(){return Mc.disco.stream.getFeature("ver","urn:xmpp:features:rosterver")&&this.data.get("version")},async fetchFromServer(){const e=Fd({type:"get",id:Hd.getUniqueId("roster")}).c("query",{xmlns:Ld.NS.ROSTER});this.rosterVersioningSupported()&&e.attrs({ver:this.data.get("version")});const t=await Mc.sendIQ(e,null,!1);if("error"!==t.getAttribute("type")){const e=Bd('query[xmlns="'.concat(Ld.NS.ROSTER,'"]'),t).pop();if(e){Bd("item",e).forEach(e=>this.updateContact(e)),this.data.save("version",e.getAttribute("ver"))}}else if(!Hd.isServiceUnavailableError(t))return kn.error(t),void kn.error("Error while trying to fetch roster from the server");Tc.session.save("roster_cached",!0),Mc.trigger("roster",t)},updateContact(e){const t=e.getAttribute("jid"),n=this.get(t),r=e.getAttribute("subscription"),i=e.getAttribute("ask"),o=Array.from(e.getElementsByTagName("group")).map(e=>e.textContent);if(n){if("remove"===r)return n.destroy();n.save({subscription:r,ask:i,nickname:e.getAttribute("name"),requesting:null,groups:o})}else{if("none"===r&&null===i||"remove"===r)return;this.create({ask:i,nickname:e.getAttribute("name"),groups:o,jid:t,subscription:r},{sort:!1})}},createRequestingContact(e){var t;const n={jid:Ld.getBareJidFromJid(e.getAttribute("from")),subscription:"none",ask:null,requesting:!0,nickname:(null===(t=Bd('nick[xmlns="'.concat(Ld.NS.NICK,'"]'),e).pop())||void 0===t?void 0:t.textContent)||null};Mc.trigger("contactRequest",this.create(n))},handleIncomingSubscription(t){const n=t.getAttribute("from"),r=Ld.getBareJidFromJid(n),i=this.get(r);Mc.settings.get("allow_contact_requests")||Tc.rejectPresenceSubscription(n,e("This client does not allow presence subscriptions")),Mc.settings.get("auto_subscribe")?i&&"to"===i.get("subscription")?i.authorize():this.subscribeBack(r,t):i?("none"!==i.get("subscription")||"subscribe"===i.get("ask"))&&i.authorize():this.createRequestingContact(t)},handleOwnPresence(e){const t=e.getAttribute("from"),n=Ld.getResourceFromJid(t),r=e.getAttribute("type");if(Tc.connection.jid!==t&&"unavailable"!==r&&(!0===Mc.settings.get("synchronize_availability")||Mc.settings.get("synchronize_availability")===n)){const t=kd(e.querySelector("show"))("textContent")||"online";Tc.xmppstatus.save({status:t},{silent:!0});const n=kd(e.querySelector("status"))("textContent");n&&Tc.xmppstatus.save({status_message:n})}Tc.jid===t&&"unavailable"===r&&Mc.user.presence.send()},presenceHandler(e){const t=e.getAttribute("type");if("error"===t)return!0;const n=e.getAttribute("from"),r=Ld.getBareJidFromJid(n);if(this.isSelf(r))return this.handleOwnPresence(e);if(Bd('query[xmlns="'.concat(Ld.NS.MUC,'"]'),e).length)return;const i=kd(e.querySelector("status"))("textContent"),o=this.get(r);if(o&&i!==o.get("status")&&o.save({status:i}),"subscribed"===t&&o)o.ackSubscribe();else if("unsubscribed"===t&&o)o.ackUnsubscribe();else{if("unsubscribe"===t)return;if("subscribe"===t)this.handleIncomingSubscription(e);else if("unavailable"===t&&o){const e=Ld.getResourceFromJid(n);o.presence.removeResource(e)}else o&&o.presence.addResource(e)}}}),Tc.RosterGroup=Po.extend({initialize(t){this.set(Object.assign({description:e("Click to hide these contacts"),state:Tc.OPENED},t)),this.contacts=new Tc.RosterContacts}}),Tc.RosterGroups=Qs.extend({model:Tc.RosterGroup,comparator(e,n){e=e.get("name"),n=n.get("name");const r=t,i=Object.keys(t),o=i.includes(e),s=i.includes(n);if(!o&&!s)return e.toLowerCase()<n.toLowerCase()?-1:e.toLowerCase()>n.toLowerCase()?1:0;if(o&&s)return r[e]<r[n]?-1:r[e]>r[n]?1:0;if(!o&&s){const e=Tc.HEADER_CURRENT_CONTACTS;return r[e]<r[n]?-1:r[e]>r[n]?1:0}if(o&&!s){const t=Tc.HEADER_CURRENT_CONTACTS;return r[e]<r[t]?-1:r[e]>r[t]?1:0}},fetchRosterGroups(){return new Promise(e=>{this.fetch({success:e,silent:!0})})}}),Tc.unregisterPresenceHandler=function(){void 0!==Tc.presence_ref&&(Tc.connection.deleteHandler(Tc.presence_ref),delete Tc.presence_ref)},Mc.listen.on("chatBoxesInitialized",()=>{Tc.chatboxes.on("change:num_unread",i),Tc.chatboxes.on("add",e=>{e.get("type")===Tc.PRIVATE_CHAT_TYPE&&e.setRosterContact(e.get("jid"))})}),Mc.listen.on("beforeTearDown",()=>Tc.unregisterPresenceHandler()),Mc.waitUntil("rosterContactsFetched").then(()=>{Tc.roster.on("add",e=>{const t=Tc.chatboxes.findWhere({jid:e.get("jid")});t&&t.setRosterContact(e.get("jid"))})}),Mc.listen.on("streamResumptionFailed",()=>Tc.session.set("roster_cached",!1)),Mc.listen.on("clearSession",async()=>{await o(),Tc.shouldClearCache()&&(Tc.rostergroups&&(await Tc.rostergroups.clearStore(),delete Tc.rostergroups),Tc.roster&&(Sc(Tc,"roster.data.destroy"),await Tc.roster.clearStore(),delete Tc.roster))}),Mc.listen.on("statusInitialized",async e=>{if(e)!Tc.connection.hasResumed()&&await o();else{Tc.presences=new Tc.Presences;const e="converse.presences-".concat(Tc.bare_jid);Tc.presences.browserStorage=Tc.createStore(e,"session"),Tc.presences.fetch()}Mc.trigger("presencesInitialized",e)}),Mc.listen.on("presencesInitialized",async e=>{e?Mc.trigger("rosterReadyAfterReconnection"):await async function(){await Mc.waitUntil("VCardsInitialized"),Tc.roster=new Tc.RosterContacts;let e="converse.contacts-".concat(Tc.bare_jid);Tc.roster.browserStorage=Tc.createStore(e),Tc.roster.data=new Po,e="converse-roster-model-".concat(Tc.bare_jid),Tc.roster.data.id=e,Tc.roster.data.browserStorage=Tc.createStore(e),Tc.roster.data.fetch(),e="converse.roster.groups".concat(Tc.bare_jid),Tc.rostergroups=new Tc.RosterGroups,Tc.rostergroups.browserStorage=Tc.createStore(e),Mc.trigger("rosterInitialized")}(),Tc.roster.onConnected(),Tc.registerPresenceHandler(),Tc.populateRoster(!Tc.connection.restored)}),Object.assign(Tc.api,{contacts:{async get(e){await Mc.waitUntil("rosterContactsFetched");const t=e=>Tc.roster.get(Ld.getBareJidFromJid(e));if(void 0===e)e=Tc.roster.pluck("jid");else if("string"==typeof e)return t(e);return e.map(t)},async add(e,t){if(await Mc.waitUntil("rosterContactsFetched"),"string"!=typeof e||!e.includes("@"))throw new TypeError("contacts.add: invalid jid");return Tc.roster.addAndSubscribe(e,t)}}})}});
/**
 * @module converse-smacks
 * @copyright The Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 * @description Converse.js plugin which adds support for XEP-0198: Stream Management
 */
const{Strophe:qd}=qc.env,$d=qc.env.utils;function Wd(){return!(Mc.connection.isType("bosh")&&!Tc.isTestEnv())&&Mc.disco.stream.getFeature("sm",qd.NS.SM)}function Jd(e){if(!Tc.session.get("smacks_enabled"))return!0;const t=parseInt(e.getAttribute("h"),10),n=Tc.session.get("num_stanzas_handled_by_server"),r=t-n;if(r<0){const e="New reported stanza count lower than previous. "+"New: ".concat(t," - Previous: ").concat(n);kn.error(e)}const i=Tc.session.get("unacked_stanzas");if(r>i.length){const e="Higher reported acknowledge count than unacknowledged stanzas. "+"Reported Acknowledged Count: ".concat(r," -")+"Unacknowledged Stanza Count: ".concat(i.length," -")+"New: ".concat(t," - Previous: ").concat(n);kn.error(e)}return Tc.session.save({num_stanzas_handled_by_server:t,num_stanzas_since_last_ack:0,unacked_stanzas:i.slice(r)}),!0}function Vd(){if(Tc.session.get("smacks_enabled")){const e=Tc.session.get("num_stanzas_handled"),t=$d.toStanza('<a xmlns="'.concat(qd.NS.SM,'" h="').concat(e,'"/>'));Mc.send(t)}return!0}function Gd(e){if(Tc.session.get("smacks_enabled")&&($d.isTagEqual(e,"iq")||$d.isTagEqual(e,"presence")||$d.isTagEqual(e,"message"))){const e=Tc.session.get("num_stanzas_handled");Tc.session.save("num_stanzas_handled",e+1)}return!0}function Yd(){Tc.session.save({smacks_enabled:Tc.session.get("smacks_enabled")||!1,num_stanzas_handled:Tc.session.get("num_stanzas_handled")||0,num_stanzas_handled_by_server:Tc.session.get("num_stanzas_handled_by_server")||0,num_stanzas_since_last_ack:Tc.session.get("num_stanzas_since_last_ack")||0,unacked_stanzas:Tc.session.get("unacked_stanzas")||[]})}function Xd(){Tc.session&&Tc.session.save({smacks_enabled:!1,num_stanzas_handled:0,num_stanzas_handled_by_server:0,num_stanzas_since_last_ack:0,unacked_stanzas:[]})}function Qd(e){const t={smacks_enabled:!0};return["1","true"].includes(e.getAttribute("resume"))&&(t.smacks_stream_id=e.getAttribute("id")),Tc.session.save(t),!0}function Kd(e){return e.querySelector("item-not-found")?kn.warn("Could not resume previous SMACKS session, session id not found. A new session will be established."):(kn.error("Failed to enable stream management"),kn.error(e.outerHTML)),Xd(),Mc.trigger("streamResumptionFailed"),!0}function Zd(e){Qd(e),Jd(e),function(){const e=Tc.session.get("unacked_stanzas");Tc.session.save("unacked_stanzas",[]),e.forEach(e=>Mc.send(e))}(),Tc.connection.do_bind=!1,Tc.connection.authenticated=!0,Tc.connection.restored=!0,Tc.connection._changeConnectStatus(qd.Status.CONNECTED,null)}async function el(){if(Mc.settings.get("enable_smacks")&&!Tc.session.get("smacks_enabled")&&await Wd()){const e=$d.getResolveablePromise();Tc.connection._addSysHandler(t=>e.resolve(Qd(t)),qd.NS.SM,"enabled"),Tc.connection._addSysHandler(t=>e.resolve(Kd(t)),qd.NS.SM,"failed");const t=Mc.connection.isType("websocket")||Tc.isTestEnv(),n=$d.toStanza('<enable xmlns="'.concat(qd.NS.SM,'" resume="').concat(t,'"/>'));Mc.send(n),Tc.connection.flush(),await e}}qd.addNamespace("SM","urn:xmpp:sm:3");const tl=[];async function nl(){if(!Mc.settings.get("enable_smacks"))return;if(!await Wd())return;const e=Tc.connection;for(;tl.length;)e.deleteHandler(tl.pop());tl.push(e.addHandler(Gd)),tl.push(e.addHandler(Vd,qd.NS.SM,"r")),tl.push(e.addHandler(Jd,qd.NS.SM,"a")),Tc.session.get("smacks_stream_id")?await async function(){const e=$d.getResolveablePromise();Tc.connection._addSysHandler(t=>e.resolve(Zd(t)),qd.NS.SM,"resumed"),Tc.connection._addSysHandler(t=>e.resolve(Kd(t)),qd.NS.SM,"failed");const t=Tc.session.get("smacks_stream_id"),n=Tc.session.get("num_stanzas_handled"),r=$d.toStanza('<resume xmlns="'.concat(qd.NS.SM,'" h="').concat(n,'" previd="').concat(t,'"/>'));Mc.send(r),Tc.connection.flush(),await e}():Xd()}function rl(e){if(Tc.session){if(Tc.session.get("smacks_enabled")&&($d.isTagEqual(e,"iq")||$d.isTagEqual(e,"presence")||$d.isTagEqual(e,"message"))){const t=qd.serialize(e);Tc.session.save("unacked_stanzas",(Tc.session.get("unacked_stanzas")||[]).concat([t]));const n=Mc.settings.get("smacks_max_unacked_stanzas");if(n>0){const e=Tc.session.get("num_stanzas_since_last_ack")+1;e%n==0&&Mc.send($d.toStanza('<r xmlns="'.concat(qd.NS.SM,'"/>'))),Tc.session.save({num_stanzas_since_last_ack:e})}}}else kn.warn("No _converse.session!")}qc.plugins.add("converse-smacks",{initialize(){Mc.settings.extend({enable_smacks:!0,smacks_max_unacked_stanzas:5}),Mc.listen.on("afterResourceBinding",el),Mc.listen.on("beforeResourceBinding",nl),Mc.listen.on("send",rl),Mc.listen.on("userSessionInitialized",Yd)}});
/**
 * @module converse-vcard
 * @copyright The Converse.js contributors
 * @license Mozilla Public License (MPLv2)
 */
const{Strophe:il,$iq:ol,dayjs:sl}=qc.env,al=qc.env.utils;qc.plugins.add("converse-vcard",{dependencies:["converse-status","converse-roster"],overrides:{XMPPStatus:{getNickname(){const{_converse:e}=this.__super__,t=this.__super__.getNickname.apply(this);return!t&&e.xmppstatus.vcard?e.xmppstatus.vcard.get("nickname"):t},getFullname(){const{_converse:e}=this.__super__,t=this.__super__.getFullname.apply(this);return!t&&e.xmppstatus.vcard?e.xmppstatus.vcard.get("fullname"):t}},RosterContact:{getDisplayName(){return!this.get("nickname")&&this.vcard?this.vcard.getDisplayName():this.__super__.getDisplayName.apply(this)},getFullname(){return this.vcard?this.vcard.get("fullname"):this.__super__.getFullname.apply(this)}}},initialize(){function e(e,t,n){const r=ol(t?{type:e,to:t}:{type:e});return n?r.cnode(n):r.c("vCard",{xmlns:il.NS.VCARD}),r}async function t(t,n){const r=il.getBareJidFromJid(n)===t.bare_jid?null:n;let i;try{i=await Mc.sendIQ(e("get",r))}catch(i){return{stanza:i,jid:n,vcard_error:(new Date).toISOString()}}return async function(e,t){const n=t.querySelector("vCard");let r={};var i,o,s,a,c,u,d;if(null!==n&&(r={stanza:t,fullname:null===(i=n.querySelector("FN"))||void 0===i?void 0:i.textContent,nickname:null===(o=n.querySelector("NICKNAME"))||void 0===o?void 0:o.textContent,image:null===(s=n.querySelector("PHOTO BINVAL"))||void 0===s?void 0:s.textContent,image_type:null===(a=n.querySelector("PHOTO TYPE"))||void 0===a?void 0:a.textContent,url:null===(c=n.querySelector("URL"))||void 0===c?void 0:c.textContent,role:null===(u=n.querySelector("ROLE"))||void 0===u?void 0:u.textContent,email:null===(d=n.querySelector("EMAIL USERID"))||void 0===d?void 0:d.textContent,vcard_updated:(new Date).toISOString(),vcard_error:void 0}),r.image){const e=al.base64ToArrayBuffer(r.image),t=await crypto.subtle.digest("SHA-1",e);r.image_hash=al.arrayBufferToHex(t)}return r}(0,i)}async function n(e){let t;if(e instanceof Tc.Message){if("error"===e.get("type"))return;t=e.get("from")}else t=e.get("jid");await Mc.waitUntil("VCardsInitialized"),e.vcard=Tc.vcards.findWhere({jid:t}),e.vcard||(e.vcard=Tc.vcards.create({jid:t})),e.vcard.on("change",()=>e.trigger("vcard:change"))}async function r(e){await Mc.waitUntil("VCardsInitialized"),["error","info"].includes(e.get("type"))||(e.vcard=function(e){var t;const n=null==e||null===(t=e.collection)||void 0===t?void 0:t.chatbox,r=il.getResourceFromJid(e.get("from"));if(n&&n.get("nick")===r)return Tc.xmppstatus.vcard;{const t=e.occupant&&e.occupant.get("jid")||e.get("from");return t?Tc.vcards.findWhere({jid:t})||Tc.vcards.create({jid:t}):void kn.error("Could not assign VCard for message because no JID found! msgid: ".concat(e.get("msgid")))}}(e))}Mc.promises.add("VCardsInitialized"),Tc.VCard=Po.extend({defaults:{image:Tc.DEFAULT_IMAGE,image_type:Tc.DEFAULT_IMAGE_TYPE},set(e,t,n){let r;return"object"==typeof e?(r=e,n=t):(r={})[e]=t,"image"in r&&!r.image?(r.image=Tc.DEFAULT_IMAGE,r.image_type=Tc.DEFAULT_IMAGE_TYPE,Po.prototype.set.call(this,r,n)):Po.prototype.set.apply(this,arguments)},getDisplayName(){return this.get("nickname")||this.get("fullname")||this.get("jid")}}),Tc.VCards=Qs.extend({model:Tc.VCard,initialize(){this.on("add",e=>e.get("jid")&&Mc.vcard.update(e))}}),Tc.initVCardCollection=async function(){Tc.vcards=new Tc.VCards,Tc.vcards.browserStorage=Tc.createStore("".concat(Tc.bare_jid,"-converse.vcards")),await new Promise(e=>{Tc.vcards.fetch({success:e,error:e},{silent:!0})});const e=Tc.vcards;if(Tc.session){const t=Tc.session.get("bare_jid");Tc.xmppstatus.vcard=e.findWhere({jid:t})||e.create({jid:t})}Mc.trigger("VCardsInitialized")},Mc.listen.on("chatBoxInitialized",e=>n(e)),Mc.listen.on("chatRoomInitialized",e=>n(e)),Mc.listen.on("chatRoomMessageInitialized",e=>r(e)),Mc.listen.on("addClientFeatures",()=>Mc.disco.own.features.add(il.NS.VCARD)),Mc.listen.on("clearSession",()=>{Tc.shouldClearCache()&&(Mc.promises.add("VCardsInitialized"),Tc.vcards&&(Tc.vcards.clearStore(),delete Tc.vcards))}),Mc.listen.on("messageInitialized",e=>n(e)),Mc.listen.on("rosterContactInitialized",e=>n(e)),Mc.listen.on("statusInitialized",Tc.initVCardCollection),Object.assign(Tc.api,{vcard:{async set(t,n){if(!t)throw Error("No jid provided for the VCard data");const r=document.createElement("div"),i=al.toStanza('\n                        <vCard xmlns="vcard-temp">\n                            <FN>'.concat(n.fn,"</FN>\n                            <NICKNAME>").concat(n.nickname,"</NICKNAME>\n                            <URL>").concat(n.url,"</URL>\n                            <ROLE>").concat(n.role,"</ROLE>\n                            <EMAIL><INTERNET/><PREF/><USERID>").concat(n.email,"</USERID></EMAIL>\n                            <PHOTO>\n                                <TYPE>").concat(n.image_type,"</TYPE>\n                                <BINVAL>").concat(n.image,"</BINVAL>\n                            </PHOTO>\n                        </vCard>"),r);let o;try{o=await Mc.sendIQ(e("set",t,i))}catch(e){throw e}return await Mc.vcard.update(t,!0),o},get(e,n){if("string"==typeof e)return t(Tc,e);if(!n&&e.get("vcard_updated")&&sl(e.get("vcard_error")).isSame(new Date,"day"))return Promise.resolve({});{const n=e.get("jid");return n||kn.error("No JID to get vcard for"),t(Tc,n)}},async update(e,t){const n=await this.get(e,t);(e="string"==typeof e?Tc.vcards.findWhere({jid:e}):e)?(delete n.stanza,e.save(n)):kn.error("Could not find a VCard model for ".concat(e))}}})}});t.default=qc}]);
//# sourceMappingURL=converse-headless.min.js.map